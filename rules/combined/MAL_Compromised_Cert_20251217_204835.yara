import "pe"

rule MAL_Compromised_Cert_Adware_Win32_Tnega_Sectigo_4B48B8FDD2B4D70D135278B06BEFFDFE {
   meta:
      description         = "Detects Adware:Win32/Tnega with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-02"
      version             = "1.0"

      hash                = "7ed76946c8ef0829f1011ce230cae7b63c3bf061de1e5f9d8da616a97ad6e4c5"
      malware             = "Adware:Win32/Tnega"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Crowd Sync LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "4b:48:b8:fd:d2:b4:d7:0d:13:52:78:b0:6b:ef:fd:fe"
      cert_thumbprint     = "0199082ab77502eb39b605f22ec3c7b6e168a71def86fbc5c648fb7992c42f3c"
      cert_valid_from     = "2024-09-02"
      cert_valid_to       = "2025-09-02"

      country             = "US"
      state               = "Missouri"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "4b:48:b8:fd:d2:b4:d7:0d:13:52:78:b0:6b:ef:fd:fe"
      )
}

rule MAL_Compromised_Cert_AgentTesla_SSL_com_6FBF9E0C55F9A73AD5585D213AEA1228 {
   meta:
      description         = "Detects AgentTesla with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-11"
      version             = "1.0"

      hash                = "55cb1bfa69a0b593f98303a2b763f89eb204298da1ebdf2f426a15549cbd29d2"
      malware             = "AgentTesla"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DENEB Software s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6f:bf:9e:0c:55:f9:a7:3a:d5:58:5d:21:3a:ea:12:28"
      cert_thumbprint     = "15307CEEFF8BE2A658CFDCF745CE5B851FBB6819"
      cert_valid_from     = "2025-03-11"
      cert_valid_to       = "2026-03-11"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "Stodůlky"
      email               = "???"
      rdn_serial_number   = "09082301"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6f:bf:9e:0c:55:f9:a7:3a:d5:58:5d:21:3a:ea:12:28"
      )
}

rule MAL_Compromised_Cert_AgentTesla_SSL_com_7ECB39B8913C25A3E6546E3689AA9DE6 {
   meta:
      description         = "Detects AgentTesla with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-18"
      version             = "1.0"

      hash                = "b647e553e3de2f48ce32db71952f4c89b1ce74bd332ecf123723d069767a8139"
      malware             = "AgentTesla"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TA Digital Solutions Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7e:cb:39:b8:91:3c:25:a3:e6:54:6e:36:89:aa:9d:e6"
      cert_thumbprint     = "799E3E90A2CAE4989D93FE36DFA3D4A67EBDA2A0"
      cert_valid_from     = "2025-06-18"
      cert_valid_to       = "2026-06-18"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Kauniainen"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7e:cb:39:b8:91:3c:25:a3:e6:54:6e:36:89:aa:9d:e6"
      )
}

rule MAL_Compromised_Cert_AgentTesla_Sectigo_105440F57E9D04419F5A3E72195110E6 {
   meta:
      description         = "Detects AgentTesla with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-10-17"
      version             = "1.0"

      hash                = "5c276ccc993a6b068a9ba8c9f3bcd2ea8f8a8d88c318991108696b41c35d3a86"
      malware             = "AgentTesla"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CRYPTOLAYER SRL"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "10:54:40:f5:7e:9d:04:41:9f:5a:3e:72:19:51:10:e6"
      cert_thumbprint     = "5CDB3DEB4B2D41AAEAF5E840C41CD685A15CF33A"
      cert_valid_from     = "2019-10-17"
      cert_valid_to       = "2021-10-16"

      country             = "RO"
      state               = "Sibiu"
      locality            = "Sibiu"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "10:54:40:f5:7e:9d:04:41:9f:5a:3e:72:19:51:10:e6"
      )
}

rule MAL_Compromised_Cert_Agentb_GlobalSign_45ECCCB1DF303D4DDC25847D {
   meta:
      description         = "Detects Agentb with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-13"
      version             = "1.0"

      hash                = "09eddd2406db01b4f1999f7529b3175df555fbcb7f26f8a90e9ec3448a14f454"
      malware             = "Agentb"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TC SOYUZPLIT LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "45:ec:cc:b1:df:30:3d:4d:dc:25:84:7d"
      cert_thumbprint     = "D8B04523D86270CE8BF8A834D7DA22829F1A8D16"
      cert_valid_from     = "2025-02-13"
      cert_valid_to       = "2026-01-23"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "5157746066187"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "45:ec:cc:b1:df:30:3d:4d:dc:25:84:7d"
      )
}

rule MAL_Compromised_Cert_AirStalk_SSL_com_29AFB8D913DB84FDB362F4FD927B8553 {
   meta:
      description         = "Detects AirStalk with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-28"
      version             = "1.0"

      hash                = "0c444624af1c9cce6532a6f88786840ebce6ed3df9ed570ac75e07e30b0c0bde"
      malware             = "AirStalk"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Aoteng Industrial Automation (Langfang) Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "29:af:b8:d9:13:db:84:fd:b3:62:f4:fd:92:7b:85:53"
      cert_thumbprint     = "2A4AECD2A7451A60AF367A5E44294AE7E185842A"
      cert_valid_from     = "2024-06-28"
      cert_valid_to       = "2025-06-28"

      country             = "CN"
      state               = "Hebei"
      locality            = "Langfang"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "29:af:b8:d9:13:db:84:fd:b3:62:f4:fd:92:7b:85:53"
      )
}

rule MAL_Compromised_Cert_Amadey_SSL_com_3BC667FDD38FC44F09451D379221BA59 {
   meta:
      description         = "Detects Amadey with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-07"
      version             = "1.0"

      hash                = "d8acd41403f44fb7c4f32f0e641b361d1268a882c73d8c785e2225b7b022b312"
      malware             = "Amadey"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cnet Design Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3b:c6:67:fd:d3:8f:c4:4f:09:45:1d:37:92:21:ba:59"
      cert_thumbprint     = "73ADE409A35F3E84A3400E7E361E49F834D16FF1"
      cert_valid_from     = "2024-05-07"
      cert_valid_to       = "2025-05-07"

      country             = "GB"
      state               = "???"
      locality            = "Uxbridge"
      email               = "???"
      rdn_serial_number   = "08743106"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3b:c6:67:fd:d3:8f:c4:4f:09:45:1d:37:92:21:ba:59"
      )
}

rule MAL_Compromised_Cert_Amadey_Sectigo_00AC0A7B9420B369AF3DDB748385B981 {
   meta:
      description         = "Detects Amadey with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-06"
      version             = "1.0"

      hash                = "b58f6d597c88e79bb34ee776227be235121b7a0f6b99170ff57ff66a96a940ed"
      malware             = "Amadey"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO Tochka"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ac:0a:7b:94:20:b3:69:af:3d:db:74:83:85:b9:81"
      cert_thumbprint     = "15B56F8B0B22DBC7C08C00D47EE06B04FA7DF5FE"
      cert_valid_from     = "2020-11-06"
      cert_valid_to       = "2021-11-06"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ac:0a:7b:94:20:b3:69:af:3d:db:74:83:85:b9:81"
      )
}

rule MAL_Compromised_Cert_Amadey_Sectigo_00E161F76DA3B5E4623892C8E6FDA1EA3D {
   meta:
      description         = "Detects Amadey with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-10"
      version             = "1.0"

      hash                = "9c3857a1bdbfe35ff17ca8bad9fb3af520a85ebc3d563ddc3855c38e11d9d07b"
      malware             = "Amadey"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TGN Nedelica d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e1:61:f7:6d:a3:b5:e4:62:38:92:c8:e6:fd:a1:ea:3d"
      cert_thumbprint     = "DF5FBFBFD47875B580B150603DE240EAD9C7AD27"
      cert_valid_from     = "2020-11-10"
      cert_valid_to       = "2021-11-10"

      country             = "SI"
      state               = "???"
      locality            = "Turnišče"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e1:61:f7:6d:a3:b5:e4:62:38:92:c8:e6:fd:a1:ea:3d"
      )
}

rule MAL_Compromised_Cert_Amadey_Sectigo_00F8E8F6C92BA666B0688A8CACCE9ACCCF {
   meta:
      description         = "Detects Amadey with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-16"
      version             = "1.0"

      hash                = "7788316d7c265de3857cd869311e3227bad84465e2ae93f95fa5eeada4bdddd0"
      malware             = "Amadey"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "5 th Dimension LTD Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f8:e8:f6:c9:2b:a6:66:b0:68:8a:8c:ac:ce:9a:cc:cf"
      cert_thumbprint     = "135B79175F959AEFF0C7D4C7C705CD8141C0C03B"
      cert_valid_from     = "2021-04-16"
      cert_valid_to       = "2022-04-16"

      country             = "FI"
      state               = "???"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f8:e8:f6:c9:2b:a6:66:b0:68:8a:8c:ac:ce:9a:cc:cf"
      )
}

rule MAL_Compromised_Cert_Amadey_Sectigo_6000F8C02B0A15B1E53B8399845FADDF {
   meta:
      description         = "Detects Amadey with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-08"
      version             = "1.0"

      hash                = "8102d5d284037c4b27a86bf0308e91dd07efe53e825099ef92b03a291c31d505"
      malware             = "Amadey"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SAY LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "60:00:f8:c0:2b:0a:15:b1:e5:3b:83:99:84:5f:ad:df"
      cert_thumbprint     = "B08379EF00D1D83AA0ADD6DF7D9040C2DAA6B1D7"
      cert_valid_from     = "2022-02-08"
      cert_valid_to       = "2023-02-08"

      country             = "GB"
      state               = "East Sussex"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "60:00:f8:c0:2b:0a:15:b1:e5:3b:83:99:84:5f:ad:df"
      )
}

rule MAL_Compromised_Cert_Amadey_stage2_SSL_com_4429655AF626730EEAA820B59AA65772 {
   meta:
      description         = "Detects Amadey_stage2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-30"
      version             = "1.0"

      hash                = "37c5723aeb725b1aec98da1f776fd841176c687d8ad5c2a14a6ebd831f1615d1"
      malware             = "Amadey_stage2"
      malware_type        = "Unknown"
      malware_notes       = "Hidden VNC tool"

      signer              = "Horvath Brigitta Tinterne"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "44:29:65:5a:f6:26:73:0e:ea:a8:20:b5:9a:a6:57:72"
      cert_thumbprint     = "B2BB4C27712CC4EBEEE82969D1DBF04D78562875"
      cert_valid_from     = "2025-09-30"
      cert_valid_to       = "2026-09-30"

      country             = "HU"
      state               = "Budapest"
      locality            = "Budapest"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "44:29:65:5a:f6:26:73:0e:ea:a8:20:b5:9a:a6:57:72"
      )
}

rule MAL_Compromised_Cert_Amadey_stage2_Sectigo_008A47780EA1C57823F9139D9DFE59F68F {
   meta:
      description         = "Detects Amadey_stage2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-11"
      version             = "1.0"

      hash                = "eeb072d287cbacae3ffd0645731c708afde360f9974756c366fa101732315191"
      malware             = "Amadey_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gucheng County Jiemai Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:8a:47:78:0e:a1:c5:78:23:f9:13:9d:9d:fe:59:f6:8f"
      cert_thumbprint     = "5E6D4DAF176E81B6921E78BF16AAE6321D61AA88"
      cert_valid_from     = "2025-08-11"
      cert_valid_to       = "2026-08-11"

      country             = "CN"
      state               = "Hubei Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91420625MAD6RUTA1M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:8a:47:78:0e:a1:c5:78:23:f9:13:9d:9d:fe:59:f6:8f"
      )
}

rule MAL_Compromised_Cert_Amadey_stage2_Sectigo_00B34338C790556B3A8DFD62AB869A8817 {
   meta:
      description         = "Detects Amadey_stage2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-13"
      version             = "1.0"

      hash                = "b89c2aa1d897bf0927f5b714311a70eddeb1b236fcfdd907a941372817785fee"
      malware             = "Amadey_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Huizhou Langbo Wanli Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b3:43:38:c7:90:55:6b:3a:8d:fd:62:ab:86:9a:88:17"
      cert_thumbprint     = "37D460DCDC2FAACF373CA2483F9D16D6B14FC919"
      cert_valid_from     = "2025-10-13"
      cert_valid_to       = "2026-10-13"

      country             = "CN"
      state               = "广东省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b3:43:38:c7:90:55:6b:3a:8d:fd:62:ab:86:9a:88:17"
      )
}

rule MAL_Compromised_Cert_Amadey_stage2_Sectigo_2D1DC3C2E0B0682AB3594E5237DD7C23 {
   meta:
      description         = "Detects Amadey_stage2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-22"
      version             = "1.0"

      hash                = "bb42bdcbed3f8053184470cf1cef5173b39fb8876cf1bba3958da07c905c6df9"
      malware             = "Amadey_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Dongguan Yingping Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "2d:1d:c3:c2:e0:b0:68:2a:b3:59:4e:52:37:dd:7c:23"
      cert_thumbprint     = "7440B35E9B9E3140A702AA5A182A7D1869F73462"
      cert_valid_from     = "2025-10-22"
      cert_valid_to       = "2027-01-20"

      country             = "CN"
      state               = "Guangdong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "2d:1d:c3:c2:e0:b0:68:2a:b3:59:4e:52:37:dd:7c:23"
      )
}

rule MAL_Compromised_Cert_AntiemuleLoader_Certum_451062113F2D48D7D109C713A5F4CAEB {
   meta:
      description         = "Detects AntiemuleLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-14"
      version             = "1.0"

      hash                = "d8c67587a04132e9ea0ebbe34212507836d47e03b594ad1e7739789941ac6495"
      malware             = "AntiemuleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "Based on domains used in the delivery, this malware was seen used in a campaign targeting shipping companies: https://www.proofpoint.com/us/blog/threat-insight/remote-access-real-cargo-cybercriminals-targeting-trucking-and-logistics"

      signer              = "Shandong Shangchuan Smart Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "45:10:62:11:3f:2d:48:d7:d1:09:c7:13:a5:f4:ca:eb"
      cert_thumbprint     = "A3A37ED6615BC9AA84876904710E117F694BD753"
      cert_valid_from     = "2025-11-14"
      cert_valid_to       = "2026-11-14"

      country             = "CN"
      state               = "山东省"
      locality            = "德州市"
      email               = "???"
      rdn_serial_number   = "91371402MAC7JPQR3Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "45:10:62:11:3f:2d:48:d7:d1:09:c7:13:a5:f4:ca:eb"
      )
}

rule MAL_Compromised_Cert_AnyDesk_GlobalSign_15363337CE1FDC16444D8DF3 {
   meta:
      description         = "Detects AnyDesk with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-30"
      version             = "1.0"

      hash                = "251101b834ae02e78bae30ab284567b513af6697c7e7ba824b3f9ebd93570dca"
      malware             = "AnyDesk"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MIKA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "15:36:33:37:ce:1f:dc:16:44:4d:8d:f3"
      cert_thumbprint     = "59EAADA4C4F218ED6A0C32FA15D463A3638D972E"
      cert_valid_from     = "2024-12-30"
      cert_valid_to       = "2025-12-31"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700784583"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "15:36:33:37:ce:1f:dc:16:44:4d:8d:f3"
      )
}

rule MAL_Compromised_Cert_Arechclient2_GlobalSign_7E9054290FC79CAAFE9E5EC6 {
   meta:
      description         = "Detects Arechclient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-06"
      version             = "1.0"

      hash                = "abb3b093bea395593eb63864ae4333d98c5da4a585cdd4a170b23836077ae100"
      malware             = "Arechclient2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INTENDER LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:90:54:29:0f:c7:9c:aa:fe:9e:5e:c6"
      cert_thumbprint     = "E6151899B943D917C49F32B9AE3DF769793F52FD"
      cert_valid_from     = "2025-03-06"
      cert_valid_to       = "2026-03-07"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700182311"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:90:54:29:0f:c7:9c:aa:fe:9e:5e:c6"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_GlobalSign_3762FFAE6858C7B13FB6D6DE {
   meta:
      description         = "Detects AsyncRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-25"
      version             = "1.0"

      hash                = "67c0645892b01e1f72ef11e706902a7f465f005fac695806ba686528439a184c"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "安徽星战信息科技有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "37:62:ff:ae:68:58:c7:b1:3f:b6:d6:de"
      cert_thumbprint     = "6E27FDB6AEFF50188702E3AEEA723D020F22F2C5"
      cert_valid_from     = "2024-11-25"
      cert_valid_to       = "2026-01-07"

      country             = "CN"
      state               = "安徽省"
      locality            = "芜湖市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "37:62:ff:ae:68:58:c7:b1:3f:b6:d6:de"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_GlobalSign_3EEAA5A52286A652DC4D2B0B {
   meta:
      description         = "Detects AsyncRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-01"
      version             = "1.0"

      hash                = "9f65fc1f458f2c33ac5547561a6ada98688817e3c362e9d38e2b2b6ce79df4bf"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "成都云祺科技有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3e:ea:a5:a5:22:86:a6:52:dc:4d:2b:0b"
      cert_thumbprint     = "3A10BC1907E7B5ED1D180F183B8774B414D35E69"
      cert_valid_from     = "2025-07-01"
      cert_valid_to       = "2028-07-01"

      country             = "CN"
      state               = "四川省"
      locality            = "成都市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3e:ea:a5:a5:22:86:a6:52:dc:4d:2b:0b"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_GlobalSign_46DD87B21B58C57F71E8F95F {
   meta:
      description         = "Detects AsyncRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-23"
      version             = "1.0"

      hash                = "6cb1a58a42a1520c1c899e346302c552a8559209084d25d8cdb42cdaec1223ad"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LOUNGE LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "46:dd:87:b2:1b:58:c5:7f:71:e8:f9:5f"
      cert_thumbprint     = "C7BFAEF38FF74EDBEA0BF718B13B26AAC34C2E74"
      cert_valid_from     = "2025-03-23"
      cert_valid_to       = "2026-02-28"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700674198"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "46:dd:87:b2:1b:58:c5:7f:71:e8:f9:5f"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_GlobalSign_6D697B15A91B985E9398396C {
   meta:
      description         = "Detects AsyncRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-14"
      version             = "1.0"

      hash                = "330d82b2eda6678862e317d8c8e51dad2e0463ba7dda10a9df6498440eaf2968"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KIRAANEVALA TRADING PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6d:69:7b:15:a9:1b:98:5e:93:98:39:6c"
      cert_thumbprint     = "7176E99BB4A5EBDB6E65B0AA8DCB571D2739AF30"
      cert_valid_from     = "2025-01-14"
      cert_valid_to       = "2026-01-15"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "daphinefregiawaq38@gmail.com"
      rdn_serial_number   = "U74900RJ2015PTC048808"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6d:69:7b:15:a9:1b:98:5e:93:98:39:6c"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_SSL_com_0C25160C85DB0AB4E4B1B9BD30562372 {
   meta:
      description         = "Detects AsyncRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-17"
      version             = "1.0"

      hash                = "b44728674cfd2749db422893ebc649aea95f89ed5813b7a82571504d5d965953"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "James Burnell"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "0c:25:16:0c:85:db:0a:b4:e4:b1:b9:bd:30:56:23:72"
      cert_thumbprint     = "86F1603F0E5192A854DC04DB695594CEDEA8F46E"
      cert_valid_from     = "2025-09-17"
      cert_valid_to       = "2026-09-17"

      country             = "US"
      state               = "Oregon"
      locality            = "La Grande"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "0c:25:16:0c:85:db:0a:b4:e4:b1:b9:bd:30:56:23:72"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_SSL_com_46E097EBE44BF0363E5830369D708B81 {
   meta:
      description         = "Detects AsyncRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-07"
      version             = "1.0"

      hash                = "374c270caa42b3ba1a0b31c33a47fe590c38ef8997845d48ae3fb8a575f7d608"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Monni Software Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "46:e0:97:eb:e4:4b:f0:36:3e:58:30:36:9d:70:8b:81"
      cert_thumbprint     = "C0B18FA57D2D12AC58918ED685F67D930A6A785A"
      cert_valid_from     = "2025-02-07"
      cert_valid_to       = "2026-02-07"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "2665076-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "46:e0:97:eb:e4:4b:f0:36:3e:58:30:36:9d:70:8b:81"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_SSL_com_49E5E5F9E6B6D7F24FABE0429D2E9989 {
   meta:
      description         = "Detects AsyncRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-25"
      version             = "1.0"

      hash                = "5a720bf1f2099c701a7bffba78c0c50288984e10b24b32c110e570c787674a50"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiga Revolution Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "49:e5:e5:f9:e6:b6:d7:f2:4f:ab:e0:42:9d:2e:99:89"
      cert_thumbprint     = "E23E04DA6C7A0382B847C04680CDE029F2C3CD98"
      cert_valid_from     = "2024-12-25"
      cert_valid_to       = "2025-12-25"

      country             = "FI"
      state               = "Pohjois-Pohjanmaa"
      locality            = "Kiiminki"
      email               = "???"
      rdn_serial_number   = "2847642-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "49:e5:e5:f9:e6:b6:d7:f2:4f:ab:e0:42:9d:2e:99:89"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_SSL_com_5CB4D1450FEAFFD4C060859910E62C33 {
   meta:
      description         = "Detects AsyncRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-16"
      version             = "1.0"

      hash                = "9515dac6a4ff603dec56b68d9644ce438a76273199fa5723b52cb25dda396c59"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Crystal It Solution Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5c:b4:d1:45:0f:ea:ff:d4:c0:60:85:99:10:e6:2c:33"
      cert_thumbprint     = "17FEAFFE0F55899DAD8297C9D9C5AD8A2A521E81"
      cert_valid_from     = "2025-04-16"
      cert_valid_to       = "2026-04-16"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000673463"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5c:b4:d1:45:0f:ea:ff:d4:c0:60:85:99:10:e6:2c:33"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_SSL_com_668C68DB859DBAE5DCE71BFB867F5B93 {
   meta:
      description         = "Detects AsyncRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-05"
      version             = "1.0"

      hash                = "42ead68d0ff87d03dd4c171648e3ad8deb02c596f78bf4b595433ab60e6ff867"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NGUYEN THANH AN"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "66:8c:68:db:85:9d:ba:e5:dc:e7:1b:fb:86:7f:5b:93"
      cert_thumbprint     = "008CA8EE9073F9B8FBF86FD7F9626890EC7EC349"
      cert_valid_from     = "2025-06-05"
      cert_valid_to       = "2026-06-05"

      country             = "VN"
      state               = "Lâm Đồng"
      locality            = "Đưc Trọng"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "66:8c:68:db:85:9d:ba:e5:dc:e7:1b:fb:86:7f:5b:93"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_Sectigo_00A8DBD769A7546486C6C775C25610859A {
   meta:
      description         = "Detects AsyncRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-09"
      version             = "1.0"

      hash                = "98e7a6162d91a30d2b9bcc50bb18a9bde57a8e127111c5eacb80d87b99f7a91a"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiyuan Ningjiangqiang Technology Co., Ltd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:a8:db:d7:69:a7:54:64:86:c6:c7:75:c2:56:10:85:9a"
      cert_thumbprint     = "01DBDF52BC78D40D69E3A318B2EF0DC68C42B94C"
      cert_valid_from     = "2025-09-09"
      cert_valid_to       = "2026-09-09"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:a8:db:d7:69:a7:54:64:86:c6:c7:75:c2:56:10:85:9a"
      )
}

rule MAL_Compromised_Cert_AsyncRAT_Sectigo_00D5AC27BD4F6FDF41BD91C2162EB343E1 {
   meta:
      description         = "Detects AsyncRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-25"
      version             = "1.0"

      hash                = "5834d20cfc80f6fe20514b7a1e3e9764765aa3f548e2874504e9d26345f80560"
      malware             = "AsyncRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wenzhou Feixun Internet Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:d5:ac:27:bd:4f:6f:df:41:bd:91:c2:16:2e:b3:43:e1"
      cert_thumbprint     = "47E55F48CA38C8C47CD1548B72C231E64F9B0CD5"
      cert_valid_from     = "2025-11-25"
      cert_valid_to       = "2026-11-25"

      country             = "CN"
      state               = "Zhejiang Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91330302MA2H91PU2D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:d5:ac:27:bd:4f:6f:df:41:bd:91:c2:16:2e:b3:43:e1"
      )
}

rule MAL_Compromised_Cert_AsyncRat_Certum_66971145CC7A0E871D14717B0A041FF4 {
   meta:
      description         = "Detects AsyncRat with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-09"
      version             = "1.0"

      hash                = "176d1353a81e0fbf050a917e8bd26a6187f8efe5746d7aec7e24b82e11382337"
      malware             = "AsyncRat"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Open Source Developer, Jun Liu"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "66:97:11:45:cc:7a:0e:87:1d:14:71:7b:0a:04:1f:f4"
      cert_thumbprint     = "7F63BF01D47A36A31C970BF1C4113FA501209234"
      cert_valid_from     = "2024-07-09"
      cert_valid_to       = "2025-07-09"

      country             = "CN"
      state               = "江苏省"
      locality            = "淮安市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "66:97:11:45:cc:7a:0e:87:1d:14:71:7b:0a:04:1f:f4"
      )
}

rule MAL_Compromised_Cert_AsyncRat_GlobalSign_55B4626D928EF9F70BA8EEE5 {
   meta:
      description         = "Detects AsyncRat with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-24"
      version             = "1.0"

      hash                = "e0041d5fa7f5917fd0e88876ab063427f7161677e2162e633a6c2cf4ab3a126d"
      malware             = "AsyncRat"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hoozoou Leeser Smart Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "55:b4:62:6d:92:8e:f9:f7:0b:a8:ee:e5"
      cert_thumbprint     = "A6834A954077ED77EA6815689D0AF84C78ED78BE"
      cert_valid_from     = "2024-04-24"
      cert_valid_to       = "2025-04-23"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "91330108MA2B16Q83M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "55:b4:62:6d:92:8e:f9:f7:0b:a8:ee:e5"
      )
}

rule MAL_Compromised_Cert_AsyncRat_PureCrypter_GlobalSign_24540EB0C961694C2223CB99 {
   meta:
      description         = "Detects AsyncRat,PureCrypter with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-21"
      version             = "1.0"

      hash                = "f7d9a7964f72065aa9ad08dd0ba3df8abe095bae5d579919dab106f009c31d0c"
      malware             = "AsyncRat,PureCrypter"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shantou Chenhui Industry Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "24:54:0e:b0:c9:61:69:4c:22:23:cb:99"
      cert_thumbprint     = "2523e6b059d1cd2e99387c8a9331fab477a1aed5cd0f88ffb6de782711694d5e"
      cert_valid_from     = "2024-10-21"
      cert_valid_to       = "2025-10-22"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shantou"
      email               = "???"
      rdn_serial_number   = "91440500733109863H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "24:54:0e:b0:c9:61:69:4c:22:23:cb:99"
      )
}

rule MAL_Compromised_Cert_AureliaLoader_GlobalSign_34C0A364310AAAC36D86BA98 {
   meta:
      description         = "Detects AureliaLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-17"
      version             = "1.0"

      hash                = "bd7807e61b565751f8d1df788a531d988e5d2054b61ede073e6fc9c237d9e730"
      malware             = "AureliaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UBUNTU CHEFS (PTY) LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:c0:a3:64:31:0a:aa:c3:6d:86:ba:98"
      cert_thumbprint     = "66A466471DE70A652C287118AE6DE1FA90B57613"
      cert_valid_from     = "2025-06-17"
      cert_valid_to       = "2026-06-18"

      country             = "ZA"
      state               = "Gauteng"
      locality            = "Bryanston"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:c0:a3:64:31:0a:aa:c3:6d:86:ba:98"
      )
}

rule MAL_Compromised_Cert_AureliaLoader_GlobalSign_4663D820BE745ECD017B73FC {
   meta:
      description         = "Detects AureliaLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-23"
      version             = "1.0"

      hash                = "2cee9b72969beb59dd8441a637fdc8275afe13dfb6356e24a1daa1f77c555639"
      malware             = "AureliaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Organic"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "46:63:d8:20:be:74:5e:cd:01:7b:73:fc"
      cert_thumbprint     = "5FF149DDE0978C86386F244CB7C9CC0FAE7BF24C"
      cert_valid_from     = "2025-04-23"
      cert_valid_to       = "2026-04-24"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1205000018992"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "46:63:d8:20:be:74:5e:cd:01:7b:73:fc"
      )
}

rule MAL_Compromised_Cert_AureliaLoader_GlobalSign_502C9ACFE6C45CCDA77F9088 {
   meta:
      description         = "Detects AureliaLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-25"
      version             = "1.0"

      hash                = "83eb2d1dc17099a0ecf20de117ad640c919b6994f3efb83428d93d2aa1dcc4cb"
      malware             = "AureliaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Straight Side Consulting Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:2c:9a:cf:e6:c4:5c:cd:a7:7f:90:88"
      cert_thumbprint     = "DE343A0AE941D4107D6DED1EC131EC52A218F44A"
      cert_valid_from     = "2025-07-25"
      cert_valid_to       = "2026-07-26"

      country             = "CA"
      state               = "Ontario"
      locality            = "Brampton"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:2c:9a:cf:e6:c4:5c:cd:a7:7f:90:88"
      )
}

rule MAL_Compromised_Cert_AureliaLoader_SSL_com_2A2A94C6D41281D902DD1F8110914DF3 {
   meta:
      description         = "Detects AureliaLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-21"
      version             = "1.0"

      hash                = "c55526f2351a24aa298b99b26a6873bafaa274fa8d9ed57d78fc154d3d90cc8d"
      malware             = "AureliaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SG SOFT SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2a:2a:94:c6:d4:12:81:d9:02:dd:1f:81:10:91:4d:f3"
      cert_thumbprint     = "8235085B7D6380CFF005D5DC6DF0C942C9DA97AE"
      cert_valid_from     = "2025-08-21"
      cert_valid_to       = "2026-08-21"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2a:2a:94:c6:d4:12:81:d9:02:dd:1f:81:10:91:4d:f3"
      )
}

rule MAL_Compromised_Cert_AureliaLoader_SSL_com_5F6475DF5A682F22DA05AF64DD2B6CEE {
   meta:
      description         = "Detects AureliaLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-31"
      version             = "1.0"

      hash                = "d69e7d79557fedb5baccad54c1282579f289780807a1debbc7adedeaa2019179"
      malware             = "AureliaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "QORs"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5f:64:75:df:5a:68:2f:22:da:05:af:64:dd:2b:6c:ee"
      cert_thumbprint     = "11EC2DE14E10EBE7574FB8DFD57E6926C6D62634"
      cert_valid_from     = "2025-07-31"
      cert_valid_to       = "2026-07-31"

      country             = "BE"
      state               = "Flanders"
      locality            = "Dilbeek"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5f:64:75:df:5a:68:2f:22:da:05:af:64:dd:2b:6c:ee"
      )
}

rule MAL_Compromised_Cert_AureliaLoader_Sectigo_00FFD6543365C7F9ACC14C9AA6E9BA4C5A {
   meta:
      description         = "Detects AureliaLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "a29c12347e2ff618aa160e1b0f37c46dc39ced9c2336d362cfa67e59bec201e0"
      malware             = "AureliaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shaanxi Shaogekaifei Information Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:ff:d6:54:33:65:c7:f9:ac:c1:4c:9a:a6:e9:ba:4c:5a"
      cert_thumbprint     = "921D2773FA5EED42670F01D4419797324E996C5E"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2026-09-10"

      country             = "CN"
      state               = "Shaanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:ff:d6:54:33:65:c7:f9:ac:c1:4c:9a:a6:e9:ba:4c:5a"
      )
}

rule MAL_Compromised_Cert_Avanquest_Entrust_00A1064F640EBB2E456AA13A404CA3DD29 {
   meta:
      description         = "Detects Avanquest with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-20"
      version             = "1.0"

      hash                = "b1897903de6f882f17118e5ecb43e4a6e56917f972a3a64ca6aa50eae8adc4c5"
      malware             = "Avanquest"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PC Helpsoft (7270356 Canada Inc)"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "00:a1:06:4f:64:0e:bb:2e:45:6a:a1:3a:40:4c:a3:dd:29"
      cert_thumbprint     = "D518B348DD0D9EE55A1BF422D8C07E4FAD64383F"
      cert_valid_from     = "2025-06-20"
      cert_valid_to       = "2026-06-20"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = ""

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "00:a1:06:4f:64:0e:bb:2e:45:6a:a1:3a:40:4c:a3:dd:29"
      )
}

rule MAL_Compromised_Cert_AveMariaRAT_SSL_com_2848CDB4CE4AE5FE43996CA627EFCA4A {
   meta:
      description         = "Detects AveMariaRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-02"
      version             = "1.0"

      hash                = "61477ea2220941345454e63fac8daf508fb97643c73d82d5dd925a5cd472df8b"
      malware             = "AveMariaRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "EHT DESIGN PTY LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "28:48:cd:b4:ce:4a:e5:fe:43:99:6c:a6:27:ef:ca:4a"
      cert_thumbprint     = "4E4851E9A89B22260590165D653C4F6EC49619A8"
      cert_valid_from     = "2025-04-02"
      cert_valid_to       = "2026-04-02"

      country             = "AU"
      state               = "Victoria"
      locality            = "Melbourne"
      email               = "???"
      rdn_serial_number   = "68 166 123 397"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "28:48:cd:b4:ce:4a:e5:fe:43:99:6c:a6:27:ef:ca:4a"
      )
}

rule MAL_Compromised_Cert_AveMariaRAT_Sectigo_00E55BE88DDBD93C423220468D430905DD {
   meta:
      description         = "Detects AveMariaRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-24"
      version             = "1.0"

      hash                = "051400edf4aae2a1041743c1b12740a9e03cf51b6f9491e7e08138640dcd0db6"
      malware             = "AveMariaRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VALVE ACTUATION LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:e5:5b:e8:8d:db:d9:3c:42:32:20:46:8d:43:09:05:dd"
      cert_thumbprint     = "C1ED7E3E0F21C645CE3DC12ADB37D24D7754F02F"
      cert_valid_from     = "2021-11-24"
      cert_valid_to       = "2022-11-24"

      country             = "GB"
      state               = "Nottinghamshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:e5:5b:e8:8d:db:d9:3c:42:32:20:46:8d:43:09:05:dd"
      )
}

rule MAL_Compromised_Cert_AveMariaRAT_Sectigo_0690EE21E99B1CB3B599BBA7B9262CDC {
   meta:
      description         = "Detects AveMariaRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-06-20"
      version             = "1.0"

      hash                = "e6042f28df9d2c4a7f7adae1ad8ce6f6f44982e19db58463badb3a49d516eab4"
      malware             = "AveMariaRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xiamen Tongbu Networks Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "06:90:ee:21:e9:9b:1c:b3:b5:99:bb:a7:b9:26:2c:dc"
      cert_thumbprint     = "FF9A35EF5865024E49096672AB941B5C120657B9"
      cert_valid_from     = "2019-06-20"
      cert_valid_to       = "2022-06-19"

      country             = "CN"
      state               = "xiamen"
      locality            = "xiamen"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "06:90:ee:21:e9:9b:1c:b3:b5:99:bb:a7:b9:26:2c:dc"
      )
}

rule MAL_Compromised_Cert_AzoRult_Comodo_4BBF667B63E1962A30AED63B346D789B {
   meta:
      description         = "Detects AzoRult with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2018-08-15"
      version             = "1.0"

      hash                = "43d18cfc97f95e81d5f92b327714ecbb42c2deaca0cbbedca9739909daff5267"
      malware             = "AzoRult"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MONITOR, LLC"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Code Signing CA"
      cert_serial         = "4b:bf:66:7b:63:e1:96:2a:30:ae:d6:3b:34:6d:78:9b"
      cert_thumbprint     = "27CA54EE5BB0DC64978ADA5090E351FB045287C5"
      cert_valid_from     = "2018-08-15"
      cert_valid_to       = "2019-09-28"

      country             = "RU"
      state               = "Saint-Petersburg"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Code Signing CA" and
         sig.serial == "4b:bf:66:7b:63:e1:96:2a:30:ae:d6:3b:34:6d:78:9b"
      )
}

rule MAL_Compromised_Cert_Babadeda_Sectigo_00967CB0898680D1C174B2BAAE5FA332DB {
   meta:
      description         = "Detects Babadeda with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-11"
      version             = "1.0"

      hash                = "46e406fe4b978a36a98282420eed3c40ddb1c3818575015f9980597e770513d3"
      malware             = "Babadeda"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "James Caulfield"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:96:7c:b0:89:86:80:d1:c1:74:b2:ba:ae:5f:a3:32:db"
      cert_thumbprint     = "66D72ED7487F47C4BB1A329F7F748A7714B06F2F"
      cert_valid_from     = "2020-08-11"
      cert_valid_to       = "2023-08-11"

      country             = "US"
      state               = "Illinois"
      locality            = "Aurora"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:96:7c:b0:89:86:80:d1:c1:74:b2:ba:ae:5f:a3:32:db"
      )
}

rule MAL_Compromised_Cert_BadNews_Sectigo_25BA18A267D6D8E08EBC6E2457D58D1E {
   meta:
      description         = "Detects BadNews with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-31"
      version             = "1.0"

      hash                = "a065bb515d1adaa6a3c322e49a79fdfa6655d4beac334af32ebfa9f349a71b53"
      malware             = "BadNews"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "5Y TECHNOLOGY LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "25:ba:18:a2:67:d6:d8:e0:8e:bc:6e:24:57:d5:8d:1e"
      cert_thumbprint     = "0B26D02A94F4C8E14222A966B005BB7D30B45786"
      cert_valid_from     = "2022-03-31"
      cert_valid_to       = "2023-03-15"

      country             = "GB"
      state               = "Essex"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "25:ba:18:a2:67:d6:d8:e0:8e:bc:6e:24:57:d5:8d:1e"
      )
}

rule MAL_Compromised_Cert_BaoLoader_DigiCert_035A3901296CAAD75132EBA7C9116DB0 {
   meta:
      description         = "Detects BaoLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-01-21"
      version             = "1.0"

      hash                = "5c80c6a527f9c0d57c5411d9a9192235cfa88351a3d372ae05e48f36b6e41a80"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Eclipse Media Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "03:5a:39:01:29:6c:aa:d7:51:32:eb:a7:c9:11:6d:b0"
      cert_thumbprint     = "5D69F8B3A86EEA553A2F5B148542923E8ED907DF"
      cert_valid_from     = "2022-01-21"
      cert_valid_to       = "2023-01-21"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704432"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "03:5a:39:01:29:6c:aa:d7:51:32:eb:a7:c9:11:6d:b0"
      )
}

rule MAL_Compromised_Cert_BaoLoader_DigiCert_05FD71DF68B6096A10DB1E78F3F45CBA {
   meta:
      description         = "Detects BaoLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-19"
      version             = "1.0"

      hash                = "baa1d067ab1a30d8c25f3837332268b954784b1941bc1c9883f6f7ab7a548987"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Blaze Media Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:fd:71:df:68:b6:09:6a:10:db:1e:78:f3:f4:5c:ba"
      cert_thumbprint     = "4E84A36046C9C0359E728248C02514EB3CAA61A7"
      cert_valid_from     = "2022-09-19"
      cert_valid_to       = "2023-09-20"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704406"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:fd:71:df:68:b6:09:6a:10:db:1e:78:f3:f4:5c:ba"
      )
}

rule MAL_Compromised_Cert_BaoLoader_DigiCert_0F493BE626DF58694E1875FA9155D40C {
   meta:
      description         = "Detects BaoLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-10"
      version             = "1.0"

      hash                = "35ab1c46e0341e6cda9ba1db61e8d8c0496df90ee758ed02d15f564a62b35da8"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Astral Media Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA"
      cert_serial         = "0f:49:3b:e6:26:df:58:69:4e:18:75:fa:91:55:d4:0c"
      cert_thumbprint     = "5514956084DC1DADD32218509CA6F184816FAB71"
      cert_valid_from     = "2021-05-10"
      cert_valid_to       = "2022-05-12"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704413"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA" and
         sig.serial == "0f:49:3b:e6:26:df:58:69:4e:18:75:fa:91:55:d4:0c"
      )
}

rule MAL_Compromised_Cert_BaoLoader_Entrust_1B1F1930B1A227FCC57CFEBD032462F7 {
   meta:
      description         = "Detects BaoLoader with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-12"
      version             = "1.0"

      hash                = "e505e4bc6c76f8ccd1d626832d1d5d5d2852a5c78016c43bdc2f502af6e40396"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Drake Media Inc"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "1b:1f:19:30:b1:a2:27:fc:c5:7c:fe:bd:03:24:62:f7"
      cert_thumbprint     = "0269E7886EB31830E2488421756D282E2C481CDC"
      cert_valid_from     = "2023-04-12"
      cert_valid_to       = "2025-04-11"

      country             = "PA"
      state               = "Panamá"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704428"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "1b:1f:19:30:b1:a2:27:fc:c5:7c:fe:bd:03:24:62:f7"
      )
}

rule MAL_Compromised_Cert_BaoLoader_Entrust_3F744CB0496EB63557494B807C0681BE {
   meta:
      description         = "Detects BaoLoader with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-21"
      version             = "1.0"

      hash                = "6ec07c1d2dc566d59a7576cc4a89c605bcfc8abd414c77338c940fb8e3ed5f1a"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Byte Media Sdn Bhd"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "3f:74:4c:b0:49:6e:b6:35:57:49:4b:80:7c:06:81:be"
      cert_thumbprint     = "61CE7E9E22608EBC708C42B1CE5E842395C437D1"
      cert_valid_from     = "2024-08-21"
      cert_valid_to       = "2025-08-21"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "3f:74:4c:b0:49:6e:b6:35:57:49:4b:80:7c:06:81:be"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_008FE0F2949874A0F1CA17AC {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-18"
      version             = "1.0"

      hash                = "099c77409d23507d65ee7783575c77c4eeee86cd35b9338ac6fcdfef894ad472"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "INCREDIBLE MEDIA INC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "00:8f:e0:f2:94:98:74:a0:f1:ca:17:ac"
      cert_thumbprint     = "5F64004455D6A8844A46C780C41E32CFC024380D"
      cert_valid_from     = "2024-04-18"
      cert_valid_to       = "2027-04-19"

      country             = "PA"
      state               = "Panamá"
      locality            = "Ciudad de Panamá"
      email               = "???"
      rdn_serial_number   = "155722937"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "00:8f:e0:f2:94:98:74:a0:f1:ca:17:ac"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_08052628354E0AC4912C4412 {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-02"
      version             = "1.0"

      hash                = "9104b6e9f63232535b1f2ccb516122cf07bb62d3175044d7699e49c79cbc8f60"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Interlink Media Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "08:05:26:28:35:4e:0a:c4:91:2c:44:12"
      cert_thumbprint     = "1B696B16E85A11F56D98D69721FDBE7B7688A9B6"
      cert_valid_from     = "2023-11-02"
      cert_valid_to       = "2026-11-02"

      country             = "PA"
      state               = "Panamá"
      locality            = "Ciudad de Panamá"
      email               = "innfang@interlinkmediainc.com"
      rdn_serial_number   = "155704402"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "08:05:26:28:35:4e:0a:c4:91:2c:44:12"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_45E49826E8314D963DDB53B6 {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-06"
      version             = "1.0"

      hash                = "6a08f7bfe8e62249990f97ad0b1e386218b60cace5c336a656f514f7f4df2c9f"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Digital Promotions Sdn. Bhd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "45:e4:98:26:e8:31:4d:96:3d:db:53:b6"
      cert_thumbprint     = "11335A27C95A34A8F6985C2E29CA102BA941FF8E"
      cert_valid_from     = "2024-03-06"
      cert_valid_to       = "2027-03-07"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "1505433-P"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "45:e4:98:26:e8:31:4d:96:3d:db:53:b6"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_5499B3DF6966C9151EF0135D {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-17"
      version             = "1.0"

      hash                = "bbee7d6beb0b1fc2f19bbda5a0765c00af7ec16642f7b4ad6f7bc8f6d43a2cc7"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Eclipse Media Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "54:99:b3:df:69:66:c9:15:1e:f0:13:5d"
      cert_thumbprint     = "42149963068EA92A3CECA7834B2979DEE9039BB9"
      cert_valid_from     = "2024-01-17"
      cert_valid_to       = "2027-01-17"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704432-2-2021"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "54:99:b3:df:69:66:c9:15:1e:f0:13:5d"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_64351C662E8F81778E29BC8D {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-24"
      version             = "1.0"

      hash                = "4c2678aed5975d0968569000dd0092de29584b626eaaaaa9873bf0295388d1f2"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Drake Media Inc"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:35:1c:66:2e:8f:81:77:8e:29:bc:8d"
      cert_thumbprint     = "61E0D3D92882C136A6EADE1B90898BCDD4D05A5B"
      cert_valid_from     = "2023-03-24"
      cert_valid_to       = "2025-03-24"

      country             = "PA"
      state               = "Panamá"
      locality            = "Ciudad de Panamá"
      email               = "???"
      rdn_serial_number   = "155704428"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:35:1c:66:2e:8f:81:77:8e:29:bc:8d"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_6F2A7BF616E12C9E2B4DA846 {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-03"
      version             = "1.0"

      hash                = "00151cc770d6add3501a7b8cd7815858637d3fe6a0cb7a78fe98a1487cae2f83"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "ASTRAL MEDIA INC."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6f:2a:7b:f6:16:e1:2c:9e:2b:4d:a8:46"
      cert_thumbprint     = "EA67166323EDD57B9222B169F871A7E6E6C5ED02"
      cert_valid_from     = "2023-05-03"
      cert_valid_to       = "2026-05-03"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704413"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6f:2a:7b:f6:16:e1:2c:9e:2b:4d:a8:46"
      )
}

rule MAL_Compromised_Cert_BaoLoader_GlobalSign_71F4DED233C732913D3EF342 {
   meta:
      description         = "Detects BaoLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-29"
      version             = "1.0"

      hash                = "bd48834ed8fd535fce2749bf63133fa4ddbd43cf582fb9651568adead625f61a"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Byte Media Sdn. Bhd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "71:f4:de:d2:33:c7:32:91:3d:3e:f3:42"
      cert_thumbprint     = "17F77710C888E30917F71F7909086BCC2D131F61"
      cert_valid_from     = "2024-08-29"
      cert_valid_to       = "2027-08-30"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "info@byte-media.net"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "71:f4:de:d2:33:c7:32:91:3d:3e:f3:42"
      )
}

rule MAL_Compromised_Cert_BaoLoader_SSL_com_1709C0F1042395431C1283C6412C4BA5 {
   meta:
      description         = "Detects BaoLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-02"
      version             = "1.0"

      hash                = "7022b6b2caa7ecfc1a9575b74cce793336fc5fe4571955b1240716d9ab4b9e84"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Eclipse Media Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "17:09:c0:f1:04:23:95:43:1c:12:83:c6:41:2c:4b:a5"
      cert_thumbprint     = "53E58D93DC1DDC3493C0054DA2FE04F381B5F08D"
      cert_valid_from     = "2024-07-02"
      cert_valid_to       = "2027-07-02"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704432"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "17:09:c0:f1:04:23:95:43:1c:12:83:c6:41:2c:4b:a5"
      )
}

rule MAL_Compromised_Cert_BaoLoader_SSL_com_20777293799EA323C639A82A8612FD86 {
   meta:
      description         = "Detects BaoLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-22"
      version             = "1.0"

      hash                = "4c57be15f581c8ad23b416d7036b89fcfa37a5544e8e53163c0488f5e9af9073"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Digital Promotions Sdn. Bhd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "20:77:72:93:79:9e:a3:23:c6:39:a8:2a:86:12:fd:86"
      cert_thumbprint     = "F0E0C22F6150929994FA4E5C1A7B0644A5768FEF"
      cert_valid_from     = "2025-07-22"
      cert_valid_to       = "2026-06-14"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "20:77:72:93:79:9e:a3:23:c6:39:a8:2a:86:12:fd:86"
      )
}

rule MAL_Compromised_Cert_BaoLoader_SSL_com_58C7A40E98E998758DC4D2A84C7DA9D3 {
   meta:
      description         = "Detects BaoLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-24"
      version             = "1.0"

      hash                = "7fe1b5d86fa46d225f75c41b10420d1d4fc7ae4441a593b17a4e2a2a632e0495"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Interlink Media Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "58:c7:a4:0e:98:e9:98:75:8d:c4:d2:a8:4c:7d:a9:d3"
      cert_thumbprint     = "426256085EF3583D2A4224D5275BC42D36E11CAD"
      cert_valid_from     = "2023-05-24"
      cert_valid_to       = "2026-05-23"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704402"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "58:c7:a4:0e:98:e9:98:75:8d:c4:d2:a8:4c:7d:a9:d3"
      )
}

rule MAL_Compromised_Cert_BaoLoader_SSL_com_5D9B7E3724B3222A7E0265E0636D62F0 {
   meta:
      description         = "Detects BaoLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-03"
      version             = "1.0"

      hash                = "f7fb16a3b5ca5a4970b8fc1866849162707a5a65a15d1498728ce27277c9ad52"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Digital Promotions Sdn. Bhd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5d:9b:7e:37:24:b3:22:2a:7e:02:65:e0:63:6d:62:f0"
      cert_thumbprint     = "078D1597664ED2771756C53E3FCD13A3A4B12D81"
      cert_valid_from     = "2024-04-03"
      cert_valid_to       = "2027-04-02"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "202301011511"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5d:9b:7e:37:24:b3:22:2a:7e:02:65:e0:63:6d:62:f0"
      )
}

rule MAL_Compromised_Cert_BaoLoader_SSL_com_6D96912D6E0A85EC4E8EA02F304461FD {
   meta:
      description         = "Detects BaoLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-11"
      version             = "1.0"

      hash                = "3276154a7f2ea64e43cf6dbec33bfb20ee0d46b2ca03d5d0c7f51ec803f7101d"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Astral Media Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6d:96:91:2d:6e:0a:85:ec:4e:8e:a0:2f:30:44:61:fd"
      cert_thumbprint     = "4B8A14727083C59DAC9E3300F64B045BB21AD601"
      cert_valid_from     = "2023-04-11"
      cert_valid_to       = "2026-04-10"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704413"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6d:96:91:2d:6e:0a:85:ec:4e:8e:a0:2f:30:44:61:fd"
      )
}

rule MAL_Compromised_Cert_BaoLoader_Sectigo_00EF8847BDBB45210B4215C99F8FED229E {
   meta:
      description         = "Detects BaoLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-28"
      version             = "1.0"

      hash                = "8dab0c6c0afcf6e1d07b0379f2487f62df7e644a8fad771387fc03e2bdf9db85"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Byte Media Sdn Bhd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:ef:88:47:bd:bb:45:21:0b:42:15:c9:9f:8f:ed:22:9e"
      cert_thumbprint     = "97C41250FB5655834AD0AD1487EBECDD2F8DA099"
      cert_valid_from     = "2025-05-28"
      cert_valid_to       = "2026-05-28"

      country             = "MY"
      state               = "Johor"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:ef:88:47:bd:bb:45:21:0b:42:15:c9:9f:8f:ed:22:9e"
      )
}

rule MAL_Compromised_Cert_BaoLoader_Sectigo_2AB1D3C61B8A9960D12F06A8EBED525E {
   meta:
      description         = "Detects BaoLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-20"
      version             = "1.0"

      hash                = "e06c05b3e19e78108a4f4174219862c4680dd1ee4b5dbef18b9295fc846eda98"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "ECLIPSE MEDIA INC."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "2a:b1:d3:c6:1b:8a:99:60:d1:2f:06:a8:eb:ed:52:5e"
      cert_thumbprint     = "2983A181ADC283981EAAD2AC989034031959526D"
      cert_valid_from     = "2024-06-20"
      cert_valid_to       = "2027-06-21"

      country             = "PA"
      state               = "Panamá"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "155704432"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "2a:b1:d3:c6:1b:8a:99:60:d1:2f:06:a8:eb:ed:52:5e"
      )
}

rule MAL_Compromised_Cert_BaoLoader_Sectigo_313CA9C838CDDB21E4E354E6DBF0216A {
   meta:
      description         = "Detects BaoLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-28"
      version             = "1.0"

      hash                = "7c86ebc6bb775b6b35c4f70140f6e18908b7f3a15f9bffe33da96fee4601d74d"
      malware             = "BaoLoader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Native Click Marketing LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "31:3c:a9:c8:38:cd:db:21:e4:e3:54:e6:db:f0:21:6a"
      cert_thumbprint     = "2435F8517B48DACB8B000DB25A176D12714BD628"
      cert_valid_from     = "2024-11-28"
      cert_valid_to       = "2027-11-28"

      country             = "US"
      state               = "Delaware"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "31:3c:a9:c8:38:cd:db:21:e4:e3:54:e6:db:f0:21:6a"
      )
}

rule MAL_Compromised_Cert_Baoloader_DigiCert_02781A66F33F15486EE791304A20AD29 {
   meta:
      description         = "Detects Baoloader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2018-08-02"
      version             = "1.0"

      hash                = "6b6fc62a294d5ef1c619d623f1cf6d735d9f191df9ef5c745b0881b1e01b8565"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Realistic Media Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "02:78:1a:66:f3:3f:15:48:6e:e7:91:30:4a:20:ad:29"
      cert_thumbprint     = "19562FFE771A7BBF5A144F70812DFDFFE1FA04EC"
      cert_valid_from     = "2018-08-02"
      cert_valid_to       = "2019-08-06"

      country             = "VG"
      state               = "???"
      locality            = "Road Town"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "02:78:1a:66:f3:3f:15:48:6e:e7:91:30:4a:20:ad:29"
      )
}

rule MAL_Compromised_Cert_Baoloader_DigiCert_0A253234E29F318F9B6846682E99078D {
   meta:
      description         = "Detects Baoloader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-28"
      version             = "1.0"

      hash                = "2926e6a08ac1e28928573996cd82bdc19054b8ae7642b91765aab1a16e5c7128"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Millennial Media Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0a:25:32:34:e2:9f:31:8f:9b:68:46:68:2e:99:07:8d"
      cert_thumbprint     = "A00D344BDC112328D1969ADF9DECBE8A96035DC3"
      cert_valid_from     = "2022-02-28"
      cert_valid_to       = "2023-03-01"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704409"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0a:25:32:34:e2:9f:31:8f:9b:68:46:68:2e:99:07:8d"
      )
}

rule MAL_Compromised_Cert_Baoloader_DigiCert_0DEFC375DC6DCDAED0CE4B249127755A {
   meta:
      description         = "Detects Baoloader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-01"
      version             = "1.0"

      hash                = "b9b4375c1992b71f9dc08ee613b2b316b8df8b9e1fdd2c7a1e98d89f43a1625f"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Summit Nexus Holdings LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:ef:c3:75:dc:6d:cd:ae:d0:ce:4b:24:91:27:75:5a"
      cert_thumbprint     = "76C675514EEC3A27A4E551A77ED30FBB0DC43A01"
      cert_valid_from     = "2025-08-01"
      cert_valid_to       = "2026-07-31"

      country             = "US"
      state               = "Wyoming"
      locality            = "Sheridan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:ef:c3:75:dc:6d:cd:ae:d0:ce:4b:24:91:27:75:5a"
      )
}

rule MAL_Compromised_Cert_Baoloader_GlobalSign_45E49826E8314D963DDB53B6 {
   meta:
      description         = "Detects Baoloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-06"
      version             = "1.0"

      hash                = "7857a4020d08ec40f254847a9768da0432b0da6c90c7f18c68c05e0cfd0cec0b"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Digital Promotions Sdn. Bhd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "45:e4:98:26:e8:31:4d:96:3d:db:53:b6"
      cert_thumbprint     = "11335A27C95A34A8F6985C2E29CA102BA941FF8E"
      cert_valid_from     = "2024-03-06"
      cert_valid_to       = "2027-03-07"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "1505433-P"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "45:e4:98:26:e8:31:4d:96:3d:db:53:b6"
      )
}

rule MAL_Compromised_Cert_Baoloader_GlobalSign_5499B3DF6966C9151EF0135D {
   meta:
      description         = "Detects Baoloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-17"
      version             = "1.0"

      hash                = "9c5d756045fd479a742b81241ccf439d02fc668581a3002913811a341278de43"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Eclipse Media Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "54:99:b3:df:69:66:c9:15:1e:f0:13:5d"
      cert_thumbprint     = "42149963068EA92A3CECA7834B2979DEE9039BB9"
      cert_valid_from     = "2024-01-17"
      cert_valid_to       = "2027-01-17"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704432-2-2021"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "54:99:b3:df:69:66:c9:15:1e:f0:13:5d"
      )
}

rule MAL_Compromised_Cert_Baoloader_GlobalSign_582C3A4B9934B7EC1028B638 {
   meta:
      description         = "Detects Baoloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-09"
      version             = "1.0"

      hash                = "fde67ba523b2c1e517d679ad4eaf87925c6bbf2f171b9212462dc9a855faa34b"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Echo Infini Sdn. Bhd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "58:2c:3a:4b:99:34:b7:ec:10:28:b6:38"
      cert_thumbprint     = "A2278EB6A438DC528F3EBFEB238028C474401BEF"
      cert_valid_from     = "2024-12-09"
      cert_valid_to       = "2026-12-10"

      country             = "MY"
      state               = "Johor"
      locality            = "Johor Bahru"
      email               = "operation@echoinfini.net"
      rdn_serial_number   = "1577033-U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "58:2c:3a:4b:99:34:b7:ec:10:28:b6:38"
      )
}

rule MAL_Compromised_Cert_Baoloader_SSL_com_28C7E66012DAB05A4A953D88F185ED2C {
   meta:
      description         = "Detects Baoloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-24"
      version             = "1.0"

      hash                = "71edb9f9f757616fe62a49f2d5b55441f91618904517337abd9d0725b07c2a51"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "GLINT SOFTWARE SDN. BHD."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "28:c7:e6:60:12:da:b0:5a:4a:95:3d:88:f1:85:ed:2c"
      cert_thumbprint     = "99201EEE9807D24851026A8E8884E4C40245FAC7"
      cert_valid_from     = "2025-04-24"
      cert_valid_to       = "2026-04-24"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "28:c7:e6:60:12:da:b0:5a:4a:95:3d:88:f1:85:ed:2c"
      )
}

rule MAL_Compromised_Cert_Baoloader_SSL_com_3474143F285FC35B0B1AE6AB407160D1 {
   meta:
      description         = "Detects Baoloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "cf5194e7f63de52903b5d61109fd0d898b73dd3a07512e151077fba23cdf4800"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "ECHO INFINI SDN. BHD."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "34:74:14:3f:28:5f:c3:5b:0b:1a:e6:ab:40:71:60:d1"
      cert_thumbprint     = "7533D9D9C5241D0E031C21304C6A3FF064F79072"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2027-01-13"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "34:74:14:3f:28:5f:c3:5b:0b:1a:e6:ab:40:71:60:d1"
      )
}

rule MAL_Compromised_Cert_Baoloader_SSL_com_3FEBAE41896885E91FDB20E0950C6054 {
   meta:
      description         = "Detects Baoloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "1ac61435e8a508647724c7796406107b43c3c1e546782a9bcf14db88ddd5f75d"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "ECHO INFINI SDN. BHD."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3f:eb:ae:41:89:68:85:e9:1f:db:20:e0:95:0c:60:54"
      cert_thumbprint     = "29338264019B62D11F9C6C4B5A69B78B899B4DF6"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2027-01-13"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "202401031184"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3f:eb:ae:41:89:68:85:e9:1f:db:20:e0:95:0c:60:54"
      )
}

rule MAL_Compromised_Cert_Baoloader_SSL_com_624771AEE10682BDCE5A9AFCC194C951 {
   meta:
      description         = "Detects Baoloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-15"
      version             = "1.0"

      hash                = "d54b18f88cb3ee55b6175d5fb46ba395897a44dad543b0a95105b910b3318057"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Digital Promotions Sdn. Bhd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "62:47:71:ae:e1:06:82:bd:ce:5a:9a:fc:c1:94:c9:51"
      cert_thumbprint     = "DEC05EF328D74480A8955C61458977D3358A1D5A"
      cert_valid_from     = "2023-06-15"
      cert_valid_to       = "2026-06-14"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "202301011511"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "62:47:71:ae:e1:06:82:bd:ce:5a:9a:fc:c1:94:c9:51"
      )
}

rule MAL_Compromised_Cert_Baoloader_SSL_com_7DE8123E2B4CB350291ED602EDBC4592 {
   meta:
      description         = "Detects Baoloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-28"
      version             = "1.0"

      hash                = "9703d2f237c6e57dd71898dc41fb20a86da8c9a34ebd9cfb1d93a929dc8f1624"
      malware             = "Baoloader"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was originally used for adfraud but is a risk due to an arbitrary backdoor. For more information see https://expel.com/blog/the-history-of-appsuite-the-certs-of-the-baoloader-developer/ and https://www.gdatasoftware.com/blog/2025/08/38257-appsuite-pdf-editor-backdoor-analysis"

      signer              = "Apollo Technologies Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7d:e8:12:3e:2b:4c:b3:50:29:1e:d6:02:ed:bc:45:92"
      cert_thumbprint     = "EB5A7872B0563D261362F00BC6AF0AFC36877A89"
      cert_valid_from     = "2023-07-28"
      cert_valid_to       = "2026-07-25"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155722923"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7d:e8:12:3e:2b:4c:b3:50:29:1e:d6:02:ed:bc:45:92"
      )
}

rule MAL_Compromised_Cert_BatLoader_Certum_0FBD475F796001B1B63F15AD08841422 {
   meta:
      description         = "Detects BatLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-28"
      version             = "1.0"

      hash                = "1c64bc2911b32ede634aba9e44dedd8d0897cc5d234a95cb0af715381ac6a24c"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Tax In Cloud sp. z o.o."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "0f:bd:47:5f:79:60:01:b1:b6:3f:15:ad:08:84:14:22"
      cert_thumbprint     = "5C458D6AD871833CE824C4C4C87C51F450EE43F8"
      cert_valid_from     = "2022-09-28"
      cert_valid_to       = "2023-09-28"

      country             = "PL"
      state               = "mazowieckie"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000828067"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "0f:bd:47:5f:79:60:01:b1:b6:3f:15:ad:08:84:14:22"
      )
}

rule MAL_Compromised_Cert_BatLoader_Certum_218A79C93C595847559394CCE196B383 {
   meta:
      description         = "Detects BatLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-07"
      version             = "1.0"

      hash                = "7565bd4a85a95a5789d47e7c74756c38490c4ed5a6432bf7bab4fb4c289024c5"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Guangzhou Yongwu Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "21:8a:79:c9:3c:59:58:47:55:93:94:cc:e1:96:b3:83"
      cert_thumbprint     = "CE1A300B46F31EDEB192CC2D65EFD86D5063618D"
      cert_valid_from     = "2024-08-07"
      cert_valid_to       = "2025-08-07"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101MA9URAWW0Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "21:8a:79:c9:3c:59:58:47:55:93:94:cc:e1:96:b3:83"
      )
}

rule MAL_Compromised_Cert_BatLoader_Certum_5044BD6320C1B4CC47D56CC56C1E36D8 {
   meta:
      description         = "Detects BatLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-20"
      version             = "1.0"

      hash                = "4b2557cf1e0fa54051631931fd164edbfc5e1c0986aa8e776d3fe446a670c10a"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Dalian Tester Software Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "50:44:bd:63:20:c1:b4:cc:47:d5:6c:c5:6c:1e:36:d8"
      cert_thumbprint     = "A0F9C688EDA204A5B829116387BCF91A90F9FDFF"
      cert_valid_from     = "2024-06-20"
      cert_valid_to       = "2025-06-20"

      country             = "CN"
      state               = "Liaoning"
      locality            = "Dalian"
      email               = "???"
      rdn_serial_number   = "91210231MA107A346U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "50:44:bd:63:20:c1:b4:cc:47:d5:6c:c5:6c:1e:36:d8"
      )
}

rule MAL_Compromised_Cert_BatLoader_Certum_5CBF86C06CF360D5F8A1133C2C93CB55 {
   meta:
      description         = "Detects BatLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "d1dff8d1451bb6787f2abec3944deb060c05424fca4831c2c199f5706b7975b3"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Shenzhen Jingwei Electronic Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5c:bf:86:c0:6c:f3:60:d5:f8:a1:13:3c:2c:93:cb:55"
      cert_thumbprint     = "9A63A5F29AFB3F7F9553A7325E5D9EC38913A4C4"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5GXFDW60"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5c:bf:86:c0:6c:f3:60:d5:f8:a1:13:3c:2c:93:cb:55"
      )
}

rule MAL_Compromised_Cert_BatLoader_Entrust_67309D6FE835407B91D62F6216437790 {
   meta:
      description         = "Detects BatLoader with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-28"
      version             = "1.0"

      hash                = "fddf36adfee67f1deb84c18a800f847c182c15fe21e03268bbb0f0b489640dac"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Pinesville Ltd"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "67:30:9d:6f:e8:35:40:7b:91:d6:2f:62:16:43:77:90"
      cert_thumbprint     = "E7B974BC359C564CD042BA1BDC5DF9C0226A90E7"
      cert_valid_from     = "2023-01-28"
      cert_valid_to       = "2024-01-28"

      country             = "GB"
      state               = "???"
      locality            = "Enniskillen"
      email               = "???"
      rdn_serial_number   = "NI650898"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "67:30:9d:6f:e8:35:40:7b:91:d6:2f:62:16:43:77:90"
      )
}

rule MAL_Compromised_Cert_BatLoader_GlobalSign_1D9FAB7FB929C704E9205EBB {
   meta:
      description         = "Detects BatLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-27"
      version             = "1.0"

      hash                = "1c93d7e99ad24f2f4550859cdd3a1d785ad70a7c05b216b1d18a34bd569947ef"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Buicrosr Monerrka Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1d:9f:ab:7f:b9:29:c7:04:e9:20:5e:bb"
      cert_thumbprint     = "D70F10ED3920B81FD2DBDA33BE01DBB8FABC7919"
      cert_valid_from     = "2024-02-27"
      cert_valid_to       = "2025-02-27"

      country             = "CN"
      state               = "Jiangxi"
      locality            = "Jiujiang"
      email               = "???"
      rdn_serial_number   = "91360402MACJW7755M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1d:9f:ab:7f:b9:29:c7:04:e9:20:5e:bb"
      )
}

rule MAL_Compromised_Cert_BatLoader_GlobalSign_365A71D953A7E1B3A59FD64D {
   meta:
      description         = "Detects BatLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-24"
      version             = "1.0"

      hash                = "15c39d2084e399b4a0126c0b1026bd2342f8dc5d812cf0d0caae8e35ee689407"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "MK Investment Properties Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "36:5a:71:d9:53:a7:e1:b3:a5:9f:d6:4d"
      cert_thumbprint     = "C8A2E1AE0CA91D1CDFA83C4A4F6C880FA9738198"
      cert_valid_from     = "2021-12-24"
      cert_valid_to       = "2022-12-25"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ashton"
      email               = "Chloe.Miller@globaltreeinvestments.com"
      rdn_serial_number   = "10044873"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "36:5a:71:d9:53:a7:e1:b3:a5:9f:d6:4d"
      )
}

rule MAL_Compromised_Cert_BatLoader_GlobalSign_7FAC4E218B3327DC2A1DE2A9 {
   meta:
      description         = "Detects BatLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-11-30"
      version             = "1.0"

      hash                = "7a11299b01c06a9ae30db6c51e59d9a5b8ab69e15db8f757718e5b52ce3184ed"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Provizan Business Solutions, Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7f:ac:4e:21:8b:33:27:dc:2a:1d:e2:a9"
      cert_thumbprint     = "418869222E0B6A46BED1AC26F91176AD79D2483E"
      cert_valid_from     = "2022-11-30"
      cert_valid_to       = "2023-12-01"

      country             = "CA"
      state               = "Ontario"
      locality            = "Oakville"
      email               = "???"
      rdn_serial_number   = "1008055-1"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7f:ac:4e:21:8b:33:27:dc:2a:1d:e2:a9"
      )
}

rule MAL_Compromised_Cert_BatLoader_SSL_com_1F5F6C8F6F37E026CE572643B6BB3BBD {
   meta:
      description         = "Detects BatLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-09"
      version             = "1.0"

      hash                = "a88a61b2dab40e651798aa312d069dac8085f9e7a2e5bffb6ef42360b7f775b0"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "AJM It Services Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "1f:5f:6c:8f:6f:37:e0:26:ce:57:26:43:b6:bb:3b:bd"
      cert_thumbprint     = "269A65EB485E50A979458DDAAF64E48FF0808D57"
      cert_valid_from     = "2024-07-09"
      cert_valid_to       = "2025-07-09"

      country             = "GB"
      state               = "???"
      locality            = "Southend-On-Sea"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "1f:5f:6c:8f:6f:37:e0:26:ce:57:26:43:b6:bb:3b:bd"
      )
}

rule MAL_Compromised_Cert_BatLoader_SSL_com_24F14D582A5476DECB49D9C910F064A4 {
   meta:
      description         = "Detects BatLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-19"
      version             = "1.0"

      hash                = "97ac5e537d38415ccc56bd114e7b6f0053e894032c506eea37896779b6c68caf"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Ivosaq Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "24:f1:4d:58:2a:54:76:de:cb:49:d9:c9:10:f0:64:a4"
      cert_thumbprint     = "FBA3137257B30139FD4AEBD07FCED8584E0155FF"
      cert_valid_from     = "2023-09-19"
      cert_valid_to       = "2024-09-18"

      country             = "GB"
      state               = "???"
      locality            = "Poole"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "24:f1:4d:58:2a:54:76:de:cb:49:d9:c9:10:f0:64:a4"
      )
}

rule MAL_Compromised_Cert_BatLoader_SSL_com_3E723D32CB1BDD13DF58B0A04C675AB9 {
   meta:
      description         = "Detects BatLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-11-21"
      version             = "1.0"

      hash                = "2e65cfebde138e4dd816d3e8b8105e796c4eb38cfa27015938c0445ee5be8331"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Agilable Consulting Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3e:72:3d:32:cb:1b:dd:13:df:58:b0:a0:4c:67:5a:b9"
      cert_thumbprint     = "F74DD023E63DDCCB72CF8BF70611EEAEC2DCD381"
      cert_valid_from     = "2022-11-21"
      cert_valid_to       = "2023-09-26"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "1006944-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3e:72:3d:32:cb:1b:dd:13:df:58:b0:a0:4c:67:5a:b9"
      )
}

rule MAL_Compromised_Cert_BatLoader_SSL_com_5E00AA573FDF345515C83BF346C4EE22 {
   meta:
      description         = "Detects BatLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-08"
      version             = "1.0"

      hash                = "8d1f6fac51e8130f9b769f77220a7d142aa0458cf51677375967015c7a29f8f4"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "LMC BIOPOLYMERS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:00:aa:57:3f:df:34:55:15:c8:3b:f3:46:c4:ee:22"
      cert_thumbprint     = "715C53A149C91A977841F23441B028A59F0EDE25"
      cert_valid_from     = "2024-05-08"
      cert_valid_to       = "2024-09-17"

      country             = "GB"
      state               = "???"
      locality            = "Belfast"
      email               = "???"
      rdn_serial_number   = "NI656273"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:00:aa:57:3f:df:34:55:15:c8:3b:f3:46:c4:ee:22"
      )
}

rule MAL_Compromised_Cert_BatLoader_Sectigo_00B7F06400392000C6CF7EFAC7BD78D83B {
   meta:
      description         = "Detects BatLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-12"
      version             = "1.0"

      hash                = "2727a418f31e8c0841f8c3e79455067798a1c11c2b83b5c74d2de4fb3476b654"
      malware             = "BatLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Zhuzhou ZHUOER-TECH Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b7:f0:64:00:39:20:00:c6:cf:7e:fa:c7:bd:78:d8:3b"
      cert_thumbprint     = "04669C5DA7360361D1C0E7756E53058A659458E3"
      cert_valid_from     = "2023-04-12"
      cert_valid_to       = "2024-04-12"

      country             = "CN"
      state               = "Hunan Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91430211MA4PUDTX0T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b7:f0:64:00:39:20:00:c6:cf:7e:fa:c7:bd:78:d8:3b"
      )
}

rule MAL_Compromised_Cert_Batloader_Certum_35B49EE870AEA532E6EF0A4987105C8F {
   meta:
      description         = "Detects Batloader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-14"
      version             = "1.0"

      hash                = "e8492d0af0f44af35b753e7f75242da53c27b089bb11d44520724ae74428c48e"
      malware             = "Batloader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Kancelaria Adwokacka Adwokat Aleksandra Krzemińska"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "35:b4:9e:e8:70:ae:a5:32:e6:ef:0a:49:87:10:5c:8f"
      cert_thumbprint     = "94AEACEBF2A8A825C3B10DBC7572C38B96099AF1"
      cert_valid_from     = "2022-09-14"
      cert_valid_to       = "2023-09-14"

      country             = "PL"
      state               = "małopolskie"
      locality            = "Kraków"
      email               = "???"
      rdn_serial_number   = "383601062"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "35:b4:9e:e8:70:ae:a5:32:e6:ef:0a:49:87:10:5c:8f"
      )
}

rule MAL_Compromised_Cert_Batloader_SSL_com_5E65623207A0F5322CEDC57005E5CB41 {
   meta:
      description         = "Detects Batloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-02-09"
      version             = "1.0"

      hash                = "470a322864eb9fb96afc1eb64db7a39200df1b6f58bcdfc0138304ccd63b8963"
      malware             = "Batloader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "JM CRYPTO PTY LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:65:62:32:07:a0:f5:32:2c:ed:c5:70:05:e5:cb:41"
      cert_thumbprint     = "924D5781F34F8A9C08D8FCEC9BF563D9287FF829"
      cert_valid_from     = "2023-02-09"
      cert_valid_to       = "2024-02-09"

      country             = "AU"
      state               = "Western Australia"
      locality            = "Hilton"
      email               = "???"
      rdn_serial_number   = "623 744 801"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:65:62:32:07:a0:f5:32:2c:ed:c5:70:05:e5:cb:41"
      )
}

rule MAL_Compromised_Cert_Batloader_SSL_com_6033E9E272BCA9961C424D5AF7258E62 {
   meta:
      description         = "Detects Batloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "b1c9d857b8c56f6c1cf164e0a521e96ec1f48ddb818f6172b66223ad42829299"
      malware             = "Batloader"
      malware_type        = "Initial access tool"
      malware_notes       = "See this article to learn more about Batloader: https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html"

      signer              = "Nuotio IT Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "60:33:e9:e2:72:bc:a9:96:1c:42:4d:5a:f7:25:8e:62"
      cert_thumbprint     = "2ED62904790ED79AFB7AD84D5E9406D65F433C96"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-04"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "60:33:e9:e2:72:bc:a9:96:1c:42:4d:5a:f7:25:8e:62"
      )
}

rule MAL_Compromised_Cert_BazaLoader_DigiCert_0BAB6A2AA84B495D9E554A4C42C0126D {
   meta:
      description         = "Detects BazaLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-21"
      version             = "1.0"

      hash                = "cae79d8ceb527eb8367b1df9e916718e4329d2768ed0b7e61f7c406af9d21f31"
      malware             = "BazaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NOSOV SP Z O O"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0b:ab:6a:2a:a8:4b:49:5d:9e:55:4a:4c:42:c0:12:6d"
      cert_thumbprint     = "230614366DDAC05C9120A852058C24FA89972535"
      cert_valid_from     = "2020-08-21"
      cert_valid_to       = "2021-08-18"

      country             = "PL"
      state               = "???"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000730830"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0b:ab:6a:2a:a8:4b:49:5d:9e:55:4a:4c:42:c0:12:6d"
      )
}

rule MAL_Compromised_Cert_BazaLoader_Sectigo_00B1AEA98BF0CE789B6C952310F14EDDE0 {
   meta:
      description         = "Detects BazaLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-01"
      version             = "1.0"

      hash                = "7697108c8e032dc97dbcda51ba54a82d85973137faacd19fb306c0217d50cfa2"
      malware             = "BazaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Absolut LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b1:ae:a9:8b:f0:ce:78:9b:6c:95:23:10:f1:4e:dd:e0"
      cert_thumbprint     = "3B48DE4FB410ABDC0F7F4B0852A265221A22951E"
      cert_valid_from     = "2020-10-01"
      cert_valid_to       = "2021-10-01"

      country             = "RU"
      state               = "???"
      locality            = "Krasnoyarsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b1:ae:a9:8b:f0:ce:78:9b:6c:95:23:10:f1:4e:dd:e0"
      )
}

rule MAL_Compromised_Cert_BazaLoader_Sectigo_5A9D897077A22AFE7AD4C4A01DF6C418 {
   meta:
      description         = "Detects BazaLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-07"
      version             = "1.0"

      hash                = "e888f380a5cee9d9db4c47c84a4c78bcc2affc2fc3099038eb7e2afc66eb7863"
      malware             = "BazaLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Klarens LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "5a:9d:89:70:77:a2:2a:fe:7a:d4:c4:a0:1d:f6:c4:18"
      cert_thumbprint     = "23D00CD0BB9E7F15E2373438D87BB216A6B6132F"
      cert_valid_from     = "2020-10-07"
      cert_valid_to       = "2021-10-07"

      country             = "RU"
      state               = "???"
      locality            = "Bratsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "5a:9d:89:70:77:a2:2a:fe:7a:d4:c4:a0:1d:f6:c4:18"
      )
}

rule MAL_Compromised_Cert_Beacon_Sectigo_5FD4677799C3297F39644688F9C12D31 {
   meta:
      description         = "Detects Beacon with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-09"
      version             = "1.0"

      hash                = "213188477c61f499705b55ab01b4b3c9536cbd92d20215d73837ae28bd129a94"
      malware             = "Beacon"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Nudan Jukuang Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "5f:d4:67:77:99:c3:29:7f:39:64:46:88:f9:c1:2d:31"
      cert_thumbprint     = "A8BF7554363D27DEB374C4E2658AC05C60E3BAA7"
      cert_valid_from     = "2025-09-09"
      cert_valid_to       = "2026-09-09"

      country             = "CN"
      state               = "Anhui Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "5f:d4:67:77:99:c3:29:7f:39:64:46:88:f9:c1:2d:31"
      )
}

rule MAL_Compromised_Cert_BitRAT_DigiCert_0CED87BD70B092CB93B182FAC32655F6 {
   meta:
      description         = "Detects BitRAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-04"
      version             = "1.0"

      hash                = "083d5efb4da09432a206cb7fba5cef2c82dd6cc080015fe69c2b36e71bca6c89"
      malware             = "BitRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Creator Soft Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0c:ed:87:bd:70:b0:92:cb:93:b1:82:fa:c3:26:55:f6"
      cert_thumbprint     = "97B7602ED71480756CF6E4658A107F8278A48096"
      cert_valid_from     = "2021-03-04"
      cert_valid_to       = "2022-03-08"

      country             = "IE"
      state               = "???"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "685089"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0c:ed:87:bd:70:b0:92:cb:93:b1:82:fa:c3:26:55:f6"
      )
}

rule MAL_Compromised_Cert_BitRAT_DigiCert_0F007898AFCBA5F8AF8AE65D01803617 {
   meta:
      description         = "Detects BitRAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-14"
      version             = "1.0"

      hash                = "8c1ec43b6a766a95c0d1b94fe24418541c8a8858847dff24334eab95e9c117e0"
      malware             = "BitRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TechnoElek s.r.o."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0f:00:78:98:af:cb:a5:f8:af:8a:e6:5d:01:80:36:17"
      cert_thumbprint     = "5687481A453414E63E76E1135ED53F4BD0410B05"
      cert_valid_from     = "2021-04-14"
      cert_valid_to       = "2022-04-11"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "52 253 228"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0f:00:78:98:af:cb:a5:f8:af:8a:e6:5d:01:80:36:17"
      )
}

rule MAL_Compromised_Cert_BitRAT_Sectigo_00B97F66BB221772DC07EF1D4BED8F6085 {
   meta:
      description         = "Detects BitRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-01"
      version             = "1.0"

      hash                = "6a28f7fb457fb484c1fbcceb41b10637345b18950b62df89c0a7689dd4f20d68"
      malware             = "BitRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "S-PRO d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b9:7f:66:bb:22:17:72:dc:07:ef:1d:4b:ed:8f:60:85"
      cert_thumbprint     = "FB4EFB3BFCEF8E9A667C8657F2E3C8FB7436666E"
      cert_valid_from     = "2021-03-01"
      cert_valid_to       = "2022-03-01"

      country             = "SI"
      state               = "???"
      locality            = "Ljubljana - Črnuče"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b9:7f:66:bb:22:17:72:dc:07:ef:1d:4b:ed:8f:60:85"
      )
}

rule MAL_Compromised_Cert_BitRAT_Sectigo_00D9E834182DEC62C654E775E809AC1D1B {
   meta:
      description         = "Detects BitRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-26"
      version             = "1.0"

      hash                = "645dbb6df97018fafb4285dc18ea374c721c86349cb75494c7d63d6a6afc27e6"
      malware             = "BitRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FoodLehto Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d9:e8:34:18:2d:ec:62:c6:54:e7:75:e8:09:ac:1d:1b"
      cert_thumbprint     = "5BB983693823DBEFA292C86D93B92A49EC6F9B26"
      cert_valid_from     = "2021-02-26"
      cert_valid_to       = "2022-02-26"

      country             = "FI"
      state               = "Varsinais-Suomi"
      locality            = "Uusikaupunki"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d9:e8:34:18:2d:ec:62:c6:54:e7:75:e8:09:ac:1d:1b"
      )
}

rule MAL_Compromised_Cert_BlankGrabber_SSL_com_232FC1EDBB147B0927E13ED8D7F12C47 {
   meta:
      description         = "Detects BlankGrabber with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-19"
      version             = "1.0"

      hash                = "9203d748f205c44735ccb43f9312cc818693de205075d8c0d3a3582eca6e2e63"
      malware             = "BlankGrabber"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nguyễn Văn Tuấn"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA ECC R2"
      cert_serial         = "23:2f:c1:ed:bb:14:7b:09:27:e1:3e:d8:d7:f1:2c:47"
      cert_thumbprint     = "9AE50F22379325CC7A0AEBCD570E8BDD66F16AAD"
      cert_valid_from     = "2024-12-19"
      cert_valid_to       = "2025-12-19"

      country             = "VN"
      state               = "Thái Bình"
      locality            = "Huyện Hưng Hà"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA ECC R2" and
         sig.serial == "23:2f:c1:ed:bb:14:7b:09:27:e1:3e:d8:d7:f1:2c:47"
      )
}

rule MAL_Compromised_Cert_BrowserRAT_SSL_com_3A2844FBA53EED9F3C50390F0FB51F84 {
   meta:
      description         = "Detects BrowserRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-22"
      version             = "1.0"

      hash                = "b1ce4ebb517a44e305e22ef9221c1b66c3e7f9327f4ae007a4e18144f4f97add"
      malware             = "BrowserRAT"
      malware_type        = "Backdoor"
      malware_notes       = "Malware uses scheduled task for persistence, can download and execute AES encrypted payloads. See deeper analysis here: https://blog.lukeacha.com/2025/11/primepdfconvert-yapa-yet-another-pdf.html"

      signer              = "Beyond Ideas LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3a:28:44:fb:a5:3e:ed:9f:3c:50:39:0f:0f:b5:1f:84"
      cert_thumbprint     = "73C966E6EEC68ED95611519F97D921AEE6328624"
      cert_valid_from     = "2025-08-22"
      cert_valid_to       = "2026-07-24"

      country             = "US"
      state               = "Texas"
      locality            = "Austin"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3a:28:44:fb:a5:3e:ed:9f:3c:50:39:0f:0f:b5:1f:84"
      )
}

rule MAL_Compromised_Cert_BuerLoader_DigiCert_08D4352185317271C1CEC9D05C279AF7 {
   meta:
      description         = "Detects BuerLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-05"
      version             = "1.0"

      hash                = "4332bb07339c3096997fbb89b695afeb3b1e21632c8ecb4e144ec883d61ab066"
      malware             = "BuerLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Retalit LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "08:d4:35:21:85:31:72:71:c1:ce:c9:d0:5c:27:9a:f7"
      cert_thumbprint     = "52FE4ECD6C925E89068FEE38F1B9A669A70F8BAB"
      cert_valid_from     = "2020-08-05"
      cert_valid_to       = "2021-07-12"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1177847253540"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "08:d4:35:21:85:31:72:71:c1:ce:c9:d0:5c:27:9a:f7"
      )
}

rule MAL_Compromised_Cert_BuerLoader_Sectigo_008FE807310D98357A59382090634B93F0 {
   meta:
      description         = "Detects BuerLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-16"
      version             = "1.0"

      hash                = "045a7318a9e2e550208c0c7e9fc805068df19fa73823ac3acaa049a46c4045ee"
      malware             = "BuerLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MAVE MEDIA"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:8f:e8:07:31:0d:98:35:7a:59:38:20:90:63:4b:93:f0"
      cert_thumbprint     = "ACD6CF38D03C355DDB84B96A7365BFC1738A0EC5"
      cert_valid_from     = "2021-02-16"
      cert_valid_to       = "2022-02-16"

      country             = "BE"
      state               = "Antwerpen"
      locality            = "Ranst"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:8f:e8:07:31:0d:98:35:7a:59:38:20:90:63:4b:93:f0"
      )
}

rule MAL_Compromised_Cert_BuerLoader_Sectigo_009FAF8705A3EAEF9340800CC4FD38597C {
   meta:
      description         = "Detects BuerLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-19"
      version             = "1.0"

      hash                = "242dbfdfe2fb845ea71cf1a04637fe5c3fdfd2f931bd1265040012cd8089ac44"
      malware             = "BuerLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tekhnokod LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:9f:af:87:05:a3:ea:ef:93:40:80:0c:c4:fd:38:59:7c"
      cert_thumbprint     = "40C572CC19E7CA4C2FB89C96357EFF4C7489958E"
      cert_valid_from     = "2020-11-19"
      cert_valid_to       = "2021-11-19"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:9f:af:87:05:a3:ea:ef:93:40:80:0c:c4:fd:38:59:7c"
      )
}

rule MAL_Compromised_Cert_BumbleBee_GlobalSign_1044DC08D7A1CEAD020B97EC {
   meta:
      description         = "Detects BumbleBee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-14"
      version             = "1.0"

      hash                = "bd9767ccf80f530171bddbfccd73f25679d67a34e3290f230245270ea45f02d7"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Best Consult"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "10:44:dc:08:d7:a1:ce:ad:02:0b:97:ec"
      cert_thumbprint     = "5CD43E67385486F0022189B55D769BEE4AA5D8BF"
      cert_valid_from     = "2025-05-14"
      cert_valid_to       = "2026-05-15"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1167746280855"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "10:44:dc:08:d7:a1:ce:ad:02:0b:97:ec"
      )
}

rule MAL_Compromised_Cert_BumbleBee_GlobalSign_21CB6632DCF06D4F01CEA430 {
   meta:
      description         = "Detects BumbleBee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-16"
      version             = "1.0"

      hash                = "bd4a1d110e65697620272aa573ed4e49eb9c236ce4b90a039bcde5a9f222cb35"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Vector"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "21:cb:66:32:dc:f0:6d:4f:01:ce:a4:30"
      cert_thumbprint     = "26A54F94E1A71FE999DB163606AD4F7F270C7DA2"
      cert_valid_from     = "2025-05-16"
      cert_valid_to       = "2026-05-17"

      country             = "RU"
      state               = "Oryol Oblast"
      locality            = "Oryol"
      email               = "???"
      rdn_serial_number   = "1195749008047"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "21:cb:66:32:dc:f0:6d:4f:01:ce:a4:30"
      )
}

rule MAL_Compromised_Cert_BumbleBee_GlobalSign_2495E333DCE11D0EC448ADDB {
   meta:
      description         = "Detects BumbleBee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-29"
      version             = "1.0"

      hash                = "a67bae3dd73789e892b5114a157d992424d367aae11c5fbaa80be639d6dec798"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Dongguan Shunkaitong Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "24:95:e3:33:dc:e1:1d:0e:c4:48:ad:db"
      cert_thumbprint     = "42C99C73B698BAB9CCC531D65FB6542557AC66E0"
      cert_valid_from     = "2025-04-29"
      cert_valid_to       = "2026-04-30"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Dongguan"
      email               = "???"
      rdn_serial_number   = "91441900MA57EGAN4R"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "24:95:e3:33:dc:e1:1d:0e:c4:48:ad:db"
      )
}

rule MAL_Compromised_Cert_BumbleBee_GlobalSign_337636E3766AF9939462F2EE {
   meta:
      description         = "Detects BumbleBee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-24"
      version             = "1.0"

      hash                = "839e3f4dc441578019dc33c43bc918ad7e6022baa3770f45c6eccfe1239d79c1"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Ellada Comfort"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "33:76:36:e3:76:6a:f9:93:94:62:f2:ee"
      cert_thumbprint     = "A6EB7DD1D55FFE0B5FA1567E8AA23D279C56D832"
      cert_valid_from     = "2025-04-24"
      cert_valid_to       = "2026-04-25"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1217700501457"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "33:76:36:e3:76:6a:f9:93:94:62:f2:ee"
      )
}

rule MAL_Compromised_Cert_BumbleBee_GlobalSign_39111D565C62321E447F9B5E {
   meta:
      description         = "Detects BumbleBee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-24"
      version             = "1.0"

      hash                = "e5e8a24a628b99b2172fee5d53f003ff097739dc5c23b4374d328d72f45813cd"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Alliance"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "39:11:1d:56:5c:62:32:1e:44:7f:9b:5e"
      cert_thumbprint     = "03A20DAB66BE73F50DE63B88D455A711D72B7DFF"
      cert_valid_from     = "2025-03-24"
      cert_valid_to       = "2026-03-25"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1207700225314"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "39:11:1d:56:5c:62:32:1e:44:7f:9b:5e"
      )
}

rule MAL_Compromised_Cert_BumbleBee_GlobalSign_669F5C8918D3B19E81282765 {
   meta:
      description         = "Detects BumbleBee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-27"
      version             = "1.0"

      hash                = "281e07af77e1ff21140a7102c3cf8802dff96e670c8c3c73b8250d487a5196ed"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CanDllerWhale Electronic Studios Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "66:9f:5c:89:18:d3:b1:9e:81:28:27:65"
      cert_thumbprint     = "85D0BB733BF014A4A15550622D5EB7815BC2DB39"
      cert_valid_from     = "2025-03-27"
      cert_valid_to       = "2026-03-28"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510107MA6AFMP91G"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "66:9f:5c:89:18:d3:b1:9e:81:28:27:65"
      )
}

rule MAL_Compromised_Cert_BumbleBee_SSL_com_5143CF38D5FD26858830826632BE9FDA {
   meta:
      description         = "Detects BumbleBee with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-10-31"
      version             = "1.0"

      hash                = "cab63e05a4a6f0b825acb077ba6a1bbb3657488c584882124a31c45dfb39515d"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DIGI CORP MEDIA LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "51:43:cf:38:d5:fd:26:85:88:30:82:66:32:be:9f:da"
      cert_thumbprint     = "C482CE18FB7460B55A25C10B2583C2FA16019A5B"
      cert_valid_from     = "2022-10-31"
      cert_valid_to       = "2023-10-31"

      country             = "US"
      state               = "Nevada"
      locality            = "Henderson"
      email               = "???"
      rdn_serial_number   = "NV20222585426"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "51:43:cf:38:d5:fd:26:85:88:30:82:66:32:be:9f:da"
      )
}

rule MAL_Compromised_Cert_BumbleBee_Sectigo_65CFD8419D70CE4011D97BC79D18315E {
   meta:
      description         = "Detects BumbleBee with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-08"
      version             = "1.0"

      hash                = "35f2ec59313bbe5b78e4b043f06f8961f6f3e77b870544d15ee7cc1fca987d8c"
      malware             = "BumbleBee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FACE AESTHETICS LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "65:cf:d8:41:9d:70:ce:40:11:d9:7b:c7:9d:18:31:5e"
      cert_thumbprint     = "0AE02319FD09F729299428D15247D6843C7FBE2D"
      cert_valid_from     = "2022-07-08"
      cert_valid_to       = "2023-07-08"

      country             = "GB"
      state               = "Shropshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "65:cf:d8:41:9d:70:ce:40:11:d9:7b:c7:9d:18:31:5e"
      )
}

rule MAL_Compromised_Cert_Bumblebee_GlobalSign_073B9B32FE16B00A4268F97B {
   meta:
      description         = "Detects Bumblebee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-22"
      version             = "1.0"

      hash                = "76ea5c5bd76941aae78a9212929db83a8975260265c58dea38ddf20e3c35ce10"
      malware             = "Bumblebee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Invest Center"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "07:3b:9b:32:fe:16:b0:0a:42:68:f9:7b"
      cert_thumbprint     = "4AB277F472FB6FD4FA155BF314E2F93EE3A308FE"
      cert_valid_from     = "2025-05-22"
      cert_valid_to       = "2026-05-23"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1147746292693"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "07:3b:9b:32:fe:16:b0:0a:42:68:f9:7b"
      )
}

rule MAL_Compromised_Cert_Bumblebee_GlobalSign_3805DC7EA4CD84151C90FFAF {
   meta:
      description         = "Detects Bumblebee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-27"
      version             = "1.0"

      hash                = "cd454d80b75cbd4b23f9ec4a3e5746e53552f5a2a30c3ea1d5d3215cf41484aa"
      malware             = "Bumblebee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Resource+"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:05:dc:7e:a4:cd:84:15:1c:90:ff:af"
      cert_thumbprint     = "643F275F8E589AFCF4E2F6B4CB869066EABD2CD5"
      cert_valid_from     = "2025-05-27"
      cert_valid_to       = "2026-05-28"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1237700731806"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:05:dc:7e:a4:cd:84:15:1c:90:ff:af"
      )
}

rule MAL_Compromised_Cert_Bumblebee_GlobalSign_398A54E22351662D5BF28FA0 {
   meta:
      description         = "Detects Bumblebee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-30"
      version             = "1.0"

      hash                = "1ba85af9be3e263befdaac86084f96b014684c8d3a85d0572ca1113e52a4fa4d"
      malware             = "Bumblebee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Leighton"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "39:8a:54:e2:23:51:66:2d:5b:f2:8f:a0"
      cert_thumbprint     = "65B4E7E70DC770D59FC305E58410049228616916"
      cert_valid_from     = "2025-05-30"
      cert_valid_to       = "2026-05-31"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "5157746205690"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "39:8a:54:e2:23:51:66:2d:5b:f2:8f:a0"
      )
}

rule MAL_Compromised_Cert_Bumblebee_GlobalSign_5550E7366660417E8F144A5C {
   meta:
      description         = "Detects Bumblebee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-29"
      version             = "1.0"

      hash                = "a14506c6fb92a5af88a6a44d273edafe10d69ee3d85c8b2a7ac458a22edf68d2"
      malware             = "Bumblebee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Ugurmana"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "55:50:e7:36:66:60:41:7e:8f:14:4a:5c"
      cert_thumbprint     = "94E990D63C112B461F5FDB28D3A9B27675A64480"
      cert_valid_from     = "2025-05-29"
      cert_valid_to       = "2026-05-30"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1187847189628"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "55:50:e7:36:66:60:41:7e:8f:14:4a:5c"
      )
}

rule MAL_Compromised_Cert_Bumblebee_GlobalSign_5C37013893858BA3EFBBED44 {
   meta:
      description         = "Detects Bumblebee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-26"
      version             = "1.0"

      hash                = "29e1bc115d78c7e98e6dbc3577d24a75effda6d25f191cf32503f65922e3c281"
      malware             = "Bumblebee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Vector"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:37:01:38:93:85:8b:a3:ef:bb:ed:44"
      cert_thumbprint     = "AADEFBD3722D85713F2F0233EFE25462D3D490AB"
      cert_valid_from     = "2025-05-26"
      cert_valid_to       = "2026-05-27"

      country             = "RU"
      state               = "Lipetsk Oblast"
      locality            = "Lipetsk"
      email               = "???"
      rdn_serial_number   = "1204800012317"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:37:01:38:93:85:8b:a3:ef:bb:ed:44"
      )
}

rule MAL_Compromised_Cert_Bumblebee_GlobalSign_694485FC3754D759163719A3 {
   meta:
      description         = "Detects Bumblebee with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-29"
      version             = "1.0"

      hash                = "ad415a5fe368e89c4b00337b00baf6ed8b77c83d27d8f9e0628f1217a6082740"
      malware             = "Bumblebee"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Onixgroup"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "69:44:85:fc:37:54:d7:59:16:37:19:a3"
      cert_thumbprint     = "915B12D55360FEA1D66F54BDA021088F061116E7"
      cert_valid_from     = "2025-05-29"
      cert_valid_to       = "2026-05-30"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1227700381336"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "69:44:85:fc:37:54:d7:59:16:37:19:a3"
      )
}

rule MAL_Compromised_Cert_ByakuganStealer_Sectigo_23E40F1C26C8D36B33D2D5A026A46FCD {
   meta:
      description         = "Detects ByakuganStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-30"
      version             = "1.0"

      hash                = "3414b768b04cca4eb0a792110afa8b37186c109a47ad0290ffd46c0a0556d724"
      malware             = "ByakuganStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiyuan Jiankang Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "23:e4:0f:1c:26:c8:d3:6b:33:d2:d5:a0:26:a4:6f:cd"
      cert_thumbprint     = "150167C4D465C74D4612D1E9C3510E02D032F9EA"
      cert_valid_from     = "2025-05-30"
      cert_valid_to       = "2026-05-30"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91140106MA0M4WL26F"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "23:e4:0f:1c:26:c8:d3:6b:33:d2:d5:a0:26:a4:6f:cd"
      )
}

rule MAL_Compromised_Cert_Byakugan_Stealer_Certum_129A0D41873696FA5BCA3EAFDF6D2203 {
   meta:
      description         = "Detects Byakugan Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-28"
      version             = "1.0"

      hash                = "2aa216ed196aa8f75c21d27f64a0c78ec28a967c0fe5b5140e74295d3f316187"
      malware             = "Byakugan Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sichuan Youyixing Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "12:9a:0d:41:87:36:96:fa:5b:ca:3e:af:df:6d:22:03"
      cert_thumbprint     = "8834CB5377A3E6D4140253B5576F677D36981374"
      cert_valid_from     = "2025-10-28"
      cert_valid_to       = "2026-10-28"

      country             = "CN"
      state               = "四川省"
      locality            = "成都市"
      email               = "???"
      rdn_serial_number   = "91510100MADJ6CPP7M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "12:9a:0d:41:87:36:96:fa:5b:ca:3e:af:df:6d:22:03"
      )
}

rule MAL_Compromised_Cert_Byakugan_Stealer_Sectigo_009A4AFD672D56E011E217B49D1E94DB54 {
   meta:
      description         = "Detects Byakugan Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-26"
      version             = "1.0"

      hash                = "dc1ad7b55e0cbd21f31676a2206c66f050afd644d9b01773c7e5e64091e2db81"
      malware             = "Byakugan Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CubTiger Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:9a:4a:fd:67:2d:56:e0:11:e2:17:b4:9d:1e:94:db:54"
      cert_thumbprint     = "F52E0DAAA23CE9FD0ED952052348D14A37223A47"
      cert_valid_from     = "2025-09-26"
      cert_valid_to       = "2026-09-26"

      country             = "CN"
      state               = "Beijing Shi"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91110229MA01R14F61"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:9a:4a:fd:67:2d:56:e0:11:e2:17:b4:9d:1e:94:db:54"
      )
}

rule MAL_Compromised_Cert_Byakugan_Stealer_Sectigo_25070F0FE83DFE736FC2C895DD7B4656 {
   meta:
      description         = "Detects Byakugan Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-05"
      version             = "1.0"

      hash                = "ef62ce2ae04a2e0cbb43b6dc20081e1b6129b6e5afe9f2fb036e62f97a1113ff"
      malware             = "Byakugan Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Liutingdong Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "25:07:0f:0f:e8:3d:fe:73:6f:c2:c8:95:dd:7b:46:56"
      cert_thumbprint     = "3AEC77A9ED25D48AE368276EE691FB4424207930"
      cert_valid_from     = "2025-09-05"
      cert_valid_to       = "2026-09-05"

      country             = "CN"
      state               = "Anhui Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "25:07:0f:0f:e8:3d:fe:73:6f:c2:c8:95:dd:7b:46:56"
      )
}

rule MAL_Compromised_Cert_Carbanak_Comodo_1D275376A1DB6BFEC5179E527E1D3A6B {
   meta:
      description         = "Detects Carbanak with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2015-12-25"
      version             = "1.0"

      hash                = "8cc02b721683f8b880c8d086ed055006dcf6155a6cd19435f74dd9296b74f5fc"
      malware             = "Carbanak"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Extrusion Machinery Ltd"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Code Signing CA"
      cert_serial         = "1d:27:53:76:a1:db:6b:fe:c5:17:9e:52:7e:1d:3a:6b"
      cert_thumbprint     = "9652F7FD06E4EC13C4C04F064B58CFCDC1C605C3"
      cert_valid_from     = "2015-12-25"
      cert_valid_to       = "2016-12-24"

      country             = "GB"
      state               = "London"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Code Signing CA" and
         sig.serial == "1d:27:53:76:a1:db:6b:fe:c5:17:9e:52:7e:1d:3a:6b"
      )
}

rule MAL_Compromised_Cert_Casbaneiro_DigiCert_0C03E51062B12016402733A20D6AB2E2 {
   meta:
      description         = "Detects Casbaneiro with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-14"
      version             = "1.0"

      hash                = "c4499c88ff63a457a545b473f102ac2a8ae0b2bf673b506ba39281658b716a69"
      malware             = "Casbaneiro"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RONALDO RODRIGUES SANTANA 22670573878"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0c:03:e5:10:62:b1:20:16:40:27:33:a2:0d:6a:b2:e2"
      cert_thumbprint     = "5C84CE57008546AA49AEF5DEA5F3680247137D0D"
      cert_valid_from     = "2024-08-14"
      cert_valid_to       = "2025-08-13"

      country             = "BR"
      state               = "Sao Paulo"
      locality            = "CAMPINAS"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0c:03:e5:10:62:b1:20:16:40:27:33:a2:0d:6a:b2:e2"
      )
}

rule MAL_Compromised_Cert_CastleLoader_Certum_6FE1CA02563A3BBED8D2D0E978A09C49 {
   meta:
      description         = "Detects CastleLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-06"
      version             = "1.0"

      hash                = "c413b2e2c71ea31bc366c95b3554a36ff1d662b365c7f06768d53d44e441f7d5"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "Soft Insanity Oy"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6f:e1:ca:02:56:3a:3b:be:d8:d2:d0:e9:78:a0:9c:49"
      cert_thumbprint     = "9FFC26C90A70AF5DF2A1885E49EAB61B4EC39FA4"
      cert_valid_from     = "2025-11-06"
      cert_valid_to       = "2026-11-06"

      country             = "FI"
      state               = "Kanta-Häme"
      locality            = "HÄMEENLINNA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6f:e1:ca:02:56:3a:3b:be:d8:d2:d0:e9:78:a0:9c:49"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_0CB676A4F14B02E1FCEE433B {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-13"
      version             = "1.0"

      hash                = "9c8d22a4d79060a227f71842a2b20fa545c7b2bb87f58e3364781cf943342608"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "SURANA ENTERTAINMENT PARADISE LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:b6:76:a4:f1:4b:02:e1:fc:ee:43:3b"
      cert_thumbprint     = "758403C1786894D2AE11B159741A8D0D5530898E"
      cert_valid_from     = "2025-06-13"
      cert_valid_to       = "2026-06-14"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "vishupsc106@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:b6:76:a4:f1:4b:02:e1:fc:ee:43:3b"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_185A90B51B36D502B56E73E1 {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-27"
      version             = "1.0"

      hash                = "376856afa1fbb89426d78f35a22816dc5ad8ff78810420046076a87caf3b0691"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "MARKUS LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "18:5a:90:b5:1b:36:d5:02:b5:6e:73:e1"
      cert_thumbprint     = "86ABDC193500E33E06346F02F7A880DD895B550A"
      cert_valid_from     = "2025-09-27"
      cert_valid_to       = "2025-11-13"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "18:5a:90:b5:1b:36:d5:02:b5:6e:73:e1"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_1916747D5AC1ABEC2D20DB84 {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-27"
      version             = "1.0"

      hash                = "ce6068417aeeb4d1379e58322d8cbcc1ebbacd5c1bef7de5b3e17be725c281a6"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "STALKER LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "19:16:74:7d:5a:c1:ab:ec:2d:20:db:84"
      cert_thumbprint     = "B6E685D6EAADE42B2AC46BB9F55665A1E4C63796"
      cert_valid_from     = "2025-09-27"
      cert_valid_to       = "2025-10-23"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "19:16:74:7d:5a:c1:ab:ec:2d:20:db:84"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_2C204F0654E5D1D07E9E09B7 {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "8f3fc820def7b492876b38d021c904aafc60c379e8ad58cac81eee05bf41ee77"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "LLC Company Magnon"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2c:20:4f:06:54:e5:d1:d0:7e:9e:09:b7"
      cert_thumbprint     = "6AB349E04755799C3ACD7460645D081FF12A45BB"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2026-03-15"

      country             = "RU"
      state               = "Sverdlovsk Oblast"
      locality            = "Yekaterinburg"
      email               = "???"
      rdn_serial_number   = "1186658011264"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2c:20:4f:06:54:e5:d1:d0:7e:9e:09:b7"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_349AAC4383C298D91670D69E {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-23"
      version             = "1.0"

      hash                = "64562a0f1eabfcfb754426020021da69fe31bb551a653d143d75649252c61050"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "TENDENCE LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:9a:ac:43:83:c2:98:d9:16:70:d6:9e"
      cert_thumbprint     = "A70F01C28A27B5F78A5381F75A858C81C191756A"
      cert_valid_from     = "2025-09-23"
      cert_valid_to       = "2025-12-25"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:9a:ac:43:83:c2:98:d9:16:70:d6:9e"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_3BC6960C1395678BD09FD48A {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-02"
      version             = "1.0"

      hash                = "977d7959330af8cb27a5dba1b96cb8ecd8b6c48ec809516465d6ada057fcfcd6"
      malware             = "CastleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IMAGINATION369 CO., LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3b:c6:96:0c:13:95:67:8b:d0:9f:d4:8a"
      cert_thumbprint     = "7A863A28FF1AE9327CDC2AE901FF0361F35A28F2"
      cert_valid_from     = "2025-12-02"
      cert_valid_to       = "2026-12-03"

      country             = "TH"
      state               = "Chonburi"
      locality            = "Bang Lamung"
      email               = "???"
      rdn_serial_number   = "0205566032476"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3b:c6:96:0c:13:95:67:8b:d0:9f:d4:8a"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_5641E6878B4E49FA1E6B22F6 {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-01"
      version             = "1.0"

      hash                = "d9df71bce0b1037709a0732b7a53d4bacd0455a6abf1b7abe6fba74b6039a5a3"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "LLC Importer"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:41:e6:87:8b:4e:49:fa:1e:6b:22:f6"
      cert_thumbprint     = "E51A7393AC656E027240528C95F64568ED72D3AF"
      cert_valid_from     = "2025-05-01"
      cert_valid_to       = "2026-05-02"

      country             = "RU"
      state               = "Moscow"
      locality            = "Kommunarka"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:41:e6:87:8b:4e:49:fa:1e:6b:22:f6"
      )
}

rule MAL_Compromised_Cert_CastleLoader_GlobalSign_737C5C461D3864AC4F089E26 {
   meta:
      description         = "Detects CastleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-18"
      version             = "1.0"

      hash                = "770007f02a48fe4b445af19c07a4f3a2131fcdd53d68e20c8345eafae5843974"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "GAUAMRIT NUTRICARE PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "73:7c:5c:46:1d:38:64:ac:4f:08:9e:26"
      cert_thumbprint     = "1FDCD9EC6AF07FEBAAD53B05D12C7B415F817764"
      cert_valid_from     = "2025-06-18"
      cert_valid_to       = "2026-06-19"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "gauamrit.kanaram@gmail.com"
      rdn_serial_number   = "U01100RJ2020PTC069509"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "73:7c:5c:46:1d:38:64:ac:4f:08:9e:26"
      )
}

rule MAL_Compromised_Cert_CastleLoader_SSL_com_0F01EA3DC8215BA041F881869416788F {
   meta:
      description         = "Detects CastleLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-17"
      version             = "1.0"

      hash                = "27f24adab8c696069e22233860851dd8654a846700483f6c4a9a8aa05f1b27db"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "FORMES CONSTRUCTION LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0f:01:ea:3d:c8:21:5b:a0:41:f8:81:86:94:16:78:8f"
      cert_thumbprint     = "5000029E947762E7A72558C82A4BA814C112D724"
      cert_valid_from     = "2025-07-17"
      cert_valid_to       = "2026-06-13"

      country             = "GB"
      state               = "Oxfordshire"
      locality            = "Faringdon"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0f:01:ea:3d:c8:21:5b:a0:41:f8:81:86:94:16:78:8f"
      )
}

rule MAL_Compromised_Cert_CastleLoader_SSL_com_1AB29E886DBAF6A0942AA73DA480DD91 {
   meta:
      description         = "Detects CastleLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-13"
      version             = "1.0"

      hash                = "24fb4e14f8e2f2b663e3221132aec06f30eae68aea9ad4e927407ce6049a9ac1"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "INTYNA EXIM PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1a:b2:9e:88:6d:ba:f6:a0:94:2a:a7:3d:a4:80:dd:91"
      cert_thumbprint     = "F51F2B1D2EF5C7CE9C60E2B3914ADDCB8072355E"
      cert_valid_from     = "2025-10-13"
      cert_valid_to       = "2026-10-13"

      country             = "IN"
      state               = "Delhi"
      locality            = "Delhi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1a:b2:9e:88:6d:ba:f6:a0:94:2a:a7:3d:a4:80:dd:91"
      )
}

rule MAL_Compromised_Cert_CastleLoader_SSL_com_511CD84EA13903383B6D752F8AD73B7D {
   meta:
      description         = "Detects CastleLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-08"
      version             = "1.0"

      hash                = "169f1204aed49ec40813b0df5f39232971c74cde1f89f045ad033451710b5c9d"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "Code Staff B.V."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "51:1c:d8:4e:a1:39:03:38:3b:6d:75:2f:8a:d7:3b:7d"
      cert_thumbprint     = "3C3B922EF201699C67C3FB81563B3646AF0CB59D"
      cert_valid_from     = "2025-08-08"
      cert_valid_to       = "2026-08-08"

      country             = "NL"
      state               = "North Holland"
      locality            = "Alkmaar"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "51:1c:d8:4e:a1:39:03:38:3b:6d:75:2f:8a:d7:3b:7d"
      )
}

rule MAL_Compromised_Cert_CastleLoader_SSL_com_63F98070213489715A8D224F58E1C1D5 {
   meta:
      description         = "Detects CastleLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-27"
      version             = "1.0"

      hash                = "02a2b2af427a65e85e44575ebfbc088d5972a689fd1e7e025ee5d229f3e0ace9"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "BRACKET-SOFT SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "63:f9:80:70:21:34:89:71:5a:8d:22:4f:58:e1:c1:d5"
      cert_thumbprint     = "9FB6F13DEDFBF3E58FADEA0D0AF0D5F8223BF05E"
      cert_valid_from     = "2025-05-27"
      cert_valid_to       = "2026-05-27"

      country             = "PL"
      state               = "Kuyavian-Pomeranian Voivodeship"
      locality            = "Toruń"
      email               = "???"
      rdn_serial_number   = "0000609189"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "63:f9:80:70:21:34:89:71:5a:8d:22:4f:58:e1:c1:d5"
      )
}

rule MAL_Compromised_Cert_CastleLoader_Sectigo_00C4C826993B825CA050C82622E1D698CF {
   meta:
      description         = "Detects CastleLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-23"
      version             = "1.0"

      hash                = "aaf8b6441e239acade66d3f60fae59ef4f426dc14768ee7530ccbdcd61ef6e4e"
      malware             = "CastleLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "Flight 041 LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:c4:c8:26:99:3b:82:5c:a0:50:c8:26:22:e1:d6:98:cf"
      cert_thumbprint     = "2589C24E57D4BCF58A9B1168944826A8DE84EBA7"
      cert_valid_from     = "2025-10-23"
      cert_valid_to       = "2026-10-23"

      country             = "US"
      state               = "Arizona"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:c4:c8:26:99:3b:82:5c:a0:50:c8:26:22:e1:d6:98:cf"
      )
}

rule MAL_Compromised_Cert_CastleLoader_Sectigo_11FC7C80473F272CED037319E717F948 {
   meta:
      description         = "Detects CastleLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-13"
      version             = "1.0"

      hash                = "876a04d0f76dc14f68248e0b4498e3b710740e1447bcc6be6fd746b9c01276de"
      malware             = "CastleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chengdu Yizhifeng Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "11:fc:7c:80:47:3f:27:2c:ed:03:73:19:e7:17:f9:48"
      cert_thumbprint     = "42ECD23FBCD5CCEC5D6E914B5B5653C9D267EE3C"
      cert_valid_from     = "2025-10-13"
      cert_valid_to       = "2026-10-13"

      country             = "CN"
      state               = "Sichuan Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91510100MABP1B9J8N"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "11:fc:7c:80:47:3f:27:2c:ed:03:73:19:e7:17:f9:48"
      )
}

rule MAL_Compromised_Cert_Castleloader_GlobalSign_601EAD2413898A3EDBFE37D6 {
   meta:
      description         = "Detects Castleloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-02"
      version             = "1.0"

      hash                = "2a040d0bb9f335c12e7dd809d66b328e9114445eccfc79f5d797cc9636b6c72d"
      malware             = "Castleloader"
      malware_type        = "Initial access tool"
      malware_notes       = "This is an initial access tool that is frequenty used to load infostealers or remote access tools, sold as Malware-as-a-Service: https://www.ibm.com/think/x-force/dissecting-castlebot-maas-operation"

      signer              = "LLC KHD GROUP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:1e:ad:24:13:89:8a:3e:db:fe:37:d6"
      cert_thumbprint     = "8E5AAAF4DC669CD201DD9252E5A6465721DF816D"
      cert_valid_from     = "2025-06-02"
      cert_valid_to       = "2026-06-03"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:1e:ad:24:13:89:8a:3e:db:fe:37:d6"
      )
}

rule MAL_Compromised_Cert_Cerber_Comodo_0090212473C706F523FE84BDB9A78A01F4 {
   meta:
      description         = "Detects Cerber with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2017-07-17"
      version             = "1.0"

      hash                = "b3e1e9d97d74c416c2a30dd11858789af5554cf2de62f577c13944a19623777d"
      malware             = "Cerber"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DEMUS, OOO"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Code Signing CA"
      cert_serial         = "00:90:21:24:73:c7:06:f5:23:fe:84:bd:b9:a7:8a:01:f4"
      cert_thumbprint     = "1AA57CD87D99753381CA95C05BD22DD91B48A943"
      cert_valid_from     = "2017-07-17"
      cert_valid_to       = "2018-07-17"

      country             = "RU"
      state               = "RU"
      locality            = "Saratov"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Code Signing CA" and
         sig.serial == "00:90:21:24:73:c7:06:f5:23:fe:84:bd:b9:a7:8a:01:f4"
      )
}

rule MAL_Compromised_Cert_Cert_Only_Certum_1ABE8E730CFD09D1FC1A65D1264AAAED {
   meta:
      description         = "Detects Cert Only with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-02"
      version             = "1.0"

      hash                = "290f24edceb8eddf98e89ed3a1a8e823ab052563baa015308a6696c0d3ce79e3"
      malware             = "Cert Only"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen Xinshitong Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1a:be:8e:73:0c:fd:09:d1:fc:1a:65:d1:26:4a:aa:ed"
      cert_thumbprint     = "8F44A139359DDB9310C681526C560F207B706115"
      cert_valid_from     = "2024-10-02"
      cert_valid_to       = "2025-10-02"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "914403003426869970"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1a:be:8e:73:0c:fd:09:d1:fc:1a:65:d1:26:4a:aa:ed"
      )
}

rule MAL_Compromised_Cert_Cert_Only_GlobalSign_01F61D5311CEDD61DEE28CAA {
   meta:
      description         = "Detects Cert Only with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-11"
      version             = "1.0"

      hash                = "eec8d8dbdc517184ddfa7353ed89e4ac4d2e6c2fefef2a8c4e2c81bb4b6a9047"
      malware             = "Cert Only"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nine Rivers Sky Roar Commit Trade Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "01:f6:1d:53:11:ce:dd:61:de:e2:8c:aa"
      cert_thumbprint     = "2DAE7C97B1CE082B6FA5B6CC0786BAD87AFEF563"
      cert_valid_from     = "2024-03-11"
      cert_valid_to       = "2025-03-12"

      country             = "CN"
      state               = "Jiangxi"
      locality            = "Jiujiang"
      email               = "???"
      rdn_serial_number   = "91360402MACHADCC93"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "01:f6:1d:53:11:ce:dd:61:de:e2:8c:aa"
      )
}

rule MAL_Compromised_Cert_Cert_Only_GlobalSign_432291EE2D1F6B4F2D5E1E00 {
   meta:
      description         = "Detects Cert Only with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-25"
      version             = "1.0"

      hash                = "8ecc9c82c7d30b2bbeebcb593e8f9372e8b20554a6805abbf10368eee4782886"
      malware             = "Cert Only"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE SP Z O O"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "43:22:91:ee:2d:1f:6b:4f:2d:5e:1e:00"
      cert_thumbprint     = "83D5809E026B355EE19ADF29CF09CB6C99E624C0"
      cert_valid_from     = "2024-04-25"
      cert_valid_to       = "2025-03-08"

      country             = "PL"
      state               = "MAZOWIECKIE"
      locality            = "WARSZAWA"
      email               = "admin@softwarepoland.com"
      rdn_serial_number   = "0000682860"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "43:22:91:ee:2d:1f:6b:4f:2d:5e:1e:00"
      )
}

rule MAL_Compromised_Cert_Cert_Only_GlobalSign_5D3422FD4AFCF7D012D60C25 {
   meta:
      description         = "Detects Cert Only with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-22"
      version             = "1.0"

      hash                = "3161e2bd9012ba97b1fa22a316cf0472f70fff35b6b3ea13bdf878a385daec71"
      malware             = "Cert Only"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE BYTES LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5d:34:22:fd:4a:fc:f7:d0:12:d6:0c:25"
      cert_thumbprint     = "DC656AF416A78304F08264E379DA8AB1DF6C4432"
      cert_valid_from     = "2024-01-22"
      cert_valid_to       = "2025-01-22"

      country             = "GB"
      state               = "Wales"
      locality            = "Cardiff"
      email               = "admin@softwarebytes.uk"
      rdn_serial_number   = "12315026"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5d:34:22:fd:4a:fc:f7:d0:12:d6:0c:25"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_GlobalSign_3C22F5C916B284010CB8A481 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-22"
      version             = "1.0"

      hash                = "d158f3cfb47665928c5d304495fa99050a9e4c5b8d54332d400eec78bd7f98b6"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE ABFG LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3c:22:f5:c9:16:b2:84:01:0c:b8:a4:81"
      cert_thumbprint     = "EE81E7D510B97695351EF3F2E0C10F4D0601EDA6"
      cert_valid_from     = "2023-03-22"
      cert_valid_to       = "2024-03-22"

      country             = "GB"
      state               = "London"
      locality            = "Ruislip"
      email               = "???"
      rdn_serial_number   = "14698890"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3c:22:f5:c9:16:b2:84:01:0c:b8:a4:81"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_GlobalSign_762249DCE6ECB54903DFA0A0 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-19"
      version             = "1.0"

      hash                = "cc3c07ee3ade28f39fd20035043acd8c631449e9da5c38c03c02557348e190fa"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INNOVA MEDIA internetne storitve d.o.o."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "76:22:49:dc:e6:ec:b5:49:03:df:a0:a0"
      cert_thumbprint     = "62AFB2B59E43149CBA03B0812784D48D4A5F71F1"
      cert_valid_from     = "2024-06-19"
      cert_valid_to       = "2026-05-22"

      country             = "SI"
      state               = "Šempeter-Vrtojba"
      locality            = "Šempeter pri Gorici"
      email               = "???"
      rdn_serial_number   = "6466885000"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "76:22:49:dc:e6:ec:b5:49:03:df:a0:a0"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_GlobalSign_7ABFA692078F1AD6A4B845F9 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-30"
      version             = "1.0"

      hash                = "3c03fed6b2e374d6d4d3d8a0606a390fc010974d6d3b75be52a84663e4ba9a35"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "incredimarket LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7a:bf:a6:92:07:8f:1a:d6:a4:b8:45:f9"
      cert_thumbprint     = "E1DF5CA0CA71233D09CD19987B5C06E17F64A0AC"
      cert_valid_from     = "2023-03-30"
      cert_valid_to       = "2024-03-30"

      country             = "GE"
      state               = "Imereti"
      locality            = "Samtredia"
      email               = "???"
      rdn_serial_number   = "438736496"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7a:bf:a6:92:07:8f:1a:d6:a4:b8:45:f9"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_SSL_com_011B52CFCC142B20343D9E1DA5BCB244 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-17"
      version             = "1.0"

      hash                = "5d9ac50c89635198603cdd5276a12bad80959d8346944b9d06ef0c662f92fe6f"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SYZYX LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "01:1b:52:cf:cc:14:2b:20:34:3d:9e:1d:a5:bc:b2:44"
      cert_thumbprint     = "F768B1D2798B0264F9711891CE7980268816C349"
      cert_valid_from     = "2023-04-17"
      cert_valid_to       = "2024-04-16"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "14708389"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "01:1b:52:cf:cc:14:2b:20:34:3d:9e:1d:a5:bc:b2:44"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_SSL_com_4D2DC3C461FF097059BC7440DAC6207B {
   meta:
      description         = "Detects ChromeLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-10-12"
      version             = "1.0"

      hash                = "147e1b5a750fbfd8863449d523e3d6d110defceb74ad9cdb7c939ab75ffa2180"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LIMESTONE DIGITAL LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4d:2d:c3:c4:61:ff:09:70:59:bc:74:40:da:c6:20:7b"
      cert_thumbprint     = "2AAE66915908A703D5059DA2FCF4D5245B78BB30"
      cert_valid_from     = "2022-10-12"
      cert_valid_to       = "2023-10-12"

      country             = "GB"
      state               = "???"
      locality            = "Stoke-On-Trent"
      email               = "???"
      rdn_serial_number   = "14347919"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4d:2d:c3:c4:61:ff:09:70:59:bc:74:40:da:c6:20:7b"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_SSL_com_66A963E7EEFCA707FAA4F6C068E33F67 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-02-10"
      version             = "1.0"

      hash                = "2df3f0c50942cebf7d508364ade31de19a84a6d9377a7799b626abdf8f09a9bb"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TELIX LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "66:a9:63:e7:ee:fc:a7:07:fa:a4:f6:c0:68:e3:3f:67"
      cert_thumbprint     = "F7EAD36C07F11FE932E6BACA357F2610C550CEE3"
      cert_valid_from     = "2023-02-10"
      cert_valid_to       = "2024-02-10"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "14631498"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "66:a9:63:e7:ee:fc:a7:07:fa:a4:f6:c0:68:e3:3f:67"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_Sectigo_0082B4D836E1B37BEED11585E28E667B89 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-16"
      version             = "1.0"

      hash                = "564b8e327a13c948cea21587245b7b0005f786ea57f62bd602ef4ecec66171c6"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Invenivia"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:82:b4:d8:36:e1:b3:7b:ee:d1:15:85:e2:8e:66:7b:89"
      cert_thumbprint     = "40C8C6D3D7275ECD52A099471B5386C97F6B1B16"
      cert_valid_from     = "2023-11-16"
      cert_valid_to       = "2024-11-15"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:82:b4:d8:36:e1:b3:7b:ee:d1:15:85:e2:8e:66:7b:89"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_Sectigo_0089946D0527F676BB92AC9FDC4E279EEE {
   meta:
      description         = "Detects ChromeLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-11"
      version             = "1.0"

      hash                = "212eb5b7ac669a74dfd1a6e5fbd4f4e187453f43aa0a57b9aaeeef747e9cc10a"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Innova Media d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:89:94:6d:05:27:f6:76:bb:92:ac:9f:dc:4e:27:9e:ee"
      cert_thumbprint     = "6D8E976DD2C394244CC72BCCCD6379EBAB7A06EE"
      cert_valid_from     = "2024-12-11"
      cert_valid_to       = "2025-12-11"

      country             = "SI"
      state               = "Šempeter-Vrtojba"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:89:94:6d:05:27:f6:76:bb:92:ac:9f:dc:4e:27:9e:ee"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_Sectigo_00C1382AFD3AA99CB6A01ABA4BCB551D26 {
   meta:
      description         = "Detects ChromeLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-10"
      version             = "1.0"

      hash                = "97cce9d333dabe147055e39f98cec5c03342076e2b8aead63d3ffd0cd8d04702"
      malware             = "ChromeLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FH Manager"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:c1:38:2a:fd:3a:a9:9c:b6:a0:1a:ba:4b:cb:55:1d:26"
      cert_thumbprint     = "4E42EBA03C9C174C27B2408A5BCBEBE23CDD9BE4"
      cert_valid_from     = "2023-05-10"
      cert_valid_to       = "2025-05-09"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:c1:38:2a:fd:3a:a9:9c:b6:a0:1a:ba:4b:cb:55:1d:26"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_ext_GlobalSign_13368B2B82123AEC8A55B305 {
   meta:
      description         = "Detects ChromeLoader_ext with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-13"
      version             = "1.0"

      hash                = "fdc12cbcde6e134a66612b63f4e4209d6217b6b8efd3151af47043c28ef9c95d"
      malware             = "ChromeLoader_ext"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Adzpalace LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "13:36:8b:2b:82:12:3a:ec:8a:55:b3:05"
      cert_thumbprint     = "764B4DC54A34D9A7A8BD72860D17198331CB2E02"
      cert_valid_from     = "2023-03-13"
      cert_valid_to       = "2024-03-13"

      country             = "GE"
      state               = "Imereti"
      locality            = "Samtredia"
      email               = "inquire@adzpalace.com"
      rdn_serial_number   = "438736487"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "13:36:8b:2b:82:12:3a:ec:8a:55:b3:05"
      )
}

rule MAL_Compromised_Cert_ChromeLoader_ext_GlobalSign_33E2A5E1E0F425C3E0D76F9D {
   meta:
      description         = "Detects ChromeLoader_ext with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-14"
      version             = "1.0"

      hash                = "85781c1fdb2d0a16d540f8b2c2bb776d37de2bdf61db9160546799806876fc0d"
      malware             = "ChromeLoader_ext"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Monetize forward LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "33:e2:a5:e1:e0:f4:25:c3:e0:d7:6f:9d"
      cert_thumbprint     = "0C90F97DF6C8DA66C1BAB938B4B7A033505A689F"
      cert_valid_from     = "2023-04-14"
      cert_valid_to       = "2024-04-14"

      country             = "GE"
      state               = "Imereti"
      locality            = "Samtredia"
      email               = "Information@monetizeforward.com"
      rdn_serial_number   = "438736539"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "33:e2:a5:e1:e0:f4:25:c3:e0:d7:6f:9d"
      )
}

rule MAL_Compromised_Cert_Chromeloader_Sectigo_00F95B187AE651EEB890723146FB0747F5 {
   meta:
      description         = "Detects Chromeloader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-02"
      version             = "1.0"

      hash                = "9c8ef054cbec26be67f97fc7e17173ec6faa4e4568d724bb67d08df3f4aa8eef"
      malware             = "Chromeloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Invenivia"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:f9:5b:18:7a:e6:51:ee:b8:90:72:31:46:fb:07:47:f5"
      cert_thumbprint     = "76E635B75C879AE52D99FD759BD67BC774499028"
      cert_valid_from     = "2025-01-02"
      cert_valid_to       = "2026-01-02"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:f9:5b:18:7a:e6:51:ee:b8:90:72:31:46:fb:07:47:f5"
      )
}

rule MAL_Compromised_Cert_Cicada_RAT_GlobalSign_1F02BC9533123645610F5914 {
   meta:
      description         = "Detects Cicada RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-07"
      version             = "1.0"

      hash                = "65103ed62bf26e5bab1b56756771bc129d2c6ff6a419cab858d29d0ff233bef2"
      malware             = "Cicada RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SCANDI LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1f:02:bc:95:33:12:36:45:61:0f:59:14"
      cert_thumbprint     = "8C502B3B11E89BAA6B9F5C8BC30D248BFCD1E74E"
      cert_valid_from     = "2023-08-07"
      cert_valid_to       = "2024-08-07"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1237700488519"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1f:02:bc:95:33:12:36:45:61:0f:59:14"
      )
}

rule MAL_Compromised_Cert_CleanUpLoader_Certum_665C35A53E454E0F338AA7D63D1DFC23 {
   meta:
      description         = "Detects CleanUpLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "43f4ca1c7474c0476a42d937dc4af01c8ccfc20331baa0465ac0f3408f52b2e2"
      malware             = "CleanUpLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Fuzhou Xingmeng Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "66:5c:35:a5:3e:45:4e:0f:33:8a:a7:d6:3d:1d:fc:23"
      cert_thumbprint     = "3889079227EEDD36B4DD7604157D7F7186B5B741"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "CN"
      state               = "Fujian"
      locality            = "Fuzhou"
      email               = "???"
      rdn_serial_number   = "91350105MA353FCR11"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "66:5c:35:a5:3e:45:4e:0f:33:8a:a7:d6:3d:1d:fc:23"
      )
}

rule MAL_Compromised_Cert_CleanupLoader_Certum_665C35A53E454E0F338AA7D63D1DFC23 {
   meta:
      description         = "Detects CleanupLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "06f004d36af77e45e904ac1e23aa0e67fbe491dca950282ebdf8551ef03da16e"
      malware             = "CleanupLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Fuzhou Xingmeng Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "66:5c:35:a5:3e:45:4e:0f:33:8a:a7:d6:3d:1d:fc:23"
      cert_thumbprint     = "3889079227EEDD36B4DD7604157D7F7186B5B741"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "CN"
      state               = "Fujian"
      locality            = "Fuzhou"
      email               = "???"
      rdn_serial_number   = "91350105MA353FCR11"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "66:5c:35:a5:3e:45:4e:0f:33:8a:a7:d6:3d:1d:fc:23"
      )
}

rule MAL_Compromised_Cert_CleanupLoader_Certum_672237253A9B7EF9D02D7D1CB27A3FF4 {
   meta:
      description         = "Detects CleanupLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-03"
      version             = "1.0"

      hash                = "22dc96b3b8ee42096c66ab08e255adce45e5e09a284cbe40d64e83e812d1b910"
      malware             = "CleanupLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Foshan Yongqiheng Trading Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "67:22:37:25:3a:9b:7e:f9:d0:2d:7d:1c:b2:7a:3f:f4"
      cert_thumbprint     = "36A0F423C1FA48F172E4FECD06B8099F0EBBAEB8"
      cert_valid_from     = "2024-09-03"
      cert_valid_to       = "2025-09-03"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440605MA55WQT94L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "67:22:37:25:3a:9b:7e:f9:d0:2d:7d:1c:b2:7a:3f:f4"
      )
}

rule MAL_Compromised_Cert_CleanupLoader_GlobalSign_708737C791C878D6DD7B7C43 {
   meta:
      description         = "Detects CleanupLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-13"
      version             = "1.0"

      hash                = "92d2488e401d24a4bfc1598d813bc53af5c225769efedf0c7e5e4083623f4486"
      malware             = "CleanupLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Langfang Alkem Material Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "70:87:37:c7:91:c8:78:d6:dd:7b:7c:43"
      cert_thumbprint     = "7ED7081EE612FBF9FE0ADE46F4A2749DA20251E0"
      cert_valid_from     = "2024-09-13"
      cert_valid_to       = "2025-09-14"

      country             = "CN"
      state               = "Hebei"
      locality            = "Langfang"
      email               = "???"
      rdn_serial_number   = "9113102459540314XR"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "70:87:37:c7:91:c8:78:d6:dd:7b:7c:43"
      )
}

rule MAL_Compromised_Cert_CleanupLoader_SSL_com_2099128026318AD09C5A2411EF82F956 {
   meta:
      description         = "Detects CleanupLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-04"
      version             = "1.0"

      hash                = "7c0469e049eb1eee34dc7053d5241bbceb6e0773b43a0be813a875cebbe8857e"
      malware             = "CleanupLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanxi Yanghua HOME Furnishings Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "20:99:12:80:26:31:8a:d0:9c:5a:24:11:ef:82:f9:56"
      cert_thumbprint     = "31887A88F6A37A4620143AE13035D26E6AA4FAEB"
      cert_valid_from     = "2024-04-04"
      cert_valid_to       = "2025-04-04"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "91140100583325252X"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "20:99:12:80:26:31:8a:d0:9c:5a:24:11:ef:82:f9:56"
      )
}

rule MAL_Compromised_Cert_CleanupLoader_SSL_com_5E048E2A8E396497102F293639680F2F {
   meta:
      description         = "Detects CleanupLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-13"
      version             = "1.0"

      hash                = "776aee817254e9aafee52099d51bc45cdea3a0a7d70c88fb9445fcddb808ba3d"
      malware             = "CleanupLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INSURE AND PROTECT LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:04:8e:2a:8e:39:64:97:10:2f:29:36:39:68:0f:2f"
      cert_thumbprint     = "9898AB0AC82C256316C1E7E2735E74E29352704B"
      cert_valid_from     = "2023-09-13"
      cert_valid_to       = "2024-09-12"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "12573142"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:04:8e:2a:8e:39:64:97:10:2f:29:36:39:68:0f:2f"
      )
}

rule MAL_Compromised_Cert_CleanupLoader_SSL_com_6CBB9E360AFD58096EF69795FDB34136 {
   meta:
      description         = "Detects CleanupLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-16"
      version             = "1.0"

      hash                = "bd965b3c1b2b3c146cb12767a44646bbd17ee72257aafbcf37c58a398c2e084f"
      malware             = "CleanupLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhongyao Changye (Tangshan) Network Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6c:bb:9e:36:0a:fd:58:09:6e:f6:97:95:fd:b3:41:36"
      cert_thumbprint     = "D762B08E8FC7C6FE23F380D8A825AAD29B84C5B0"
      cert_valid_from     = "2024-05-16"
      cert_valid_to       = "2025-05-15"

      country             = "CN"
      state               = "Hebei"
      locality            = "Tangshan"
      email               = "???"
      rdn_serial_number   = "91130293MA0G03BG0Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6c:bb:9e:36:0a:fd:58:09:6e:f6:97:95:fd:b3:41:36"
      )
}

rule MAL_Compromised_Cert_ClearFake_Certum_665C35A53E454E0F338AA7D63D1DFC23 {
   meta:
      description         = "Detects ClearFake with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "2da62d1841a6763f279c481e420047a108da21cd5e16eae31661e6fd5d1b25d7"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Fuzhou Xingmeng Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "66:5c:35:a5:3e:45:4e:0f:33:8a:a7:d6:3d:1d:fc:23"
      cert_thumbprint     = "3889079227EEDD36B4DD7604157D7F7186B5B741"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "CN"
      state               = "Fujian"
      locality            = "Fuzhou"
      email               = "???"
      rdn_serial_number   = "91350105MA353FCR11"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "66:5c:35:a5:3e:45:4e:0f:33:8a:a7:d6:3d:1d:fc:23"
      )
}

rule MAL_Compromised_Cert_ClearFake_Certum_672237253A9B7EF9D02D7D1CB27A3FF4 {
   meta:
      description         = "Detects ClearFake with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-03"
      version             = "1.0"

      hash                = "a0fdc1beb7acceddb9b04bc4cff54d644cc97f53dcfc6189052484d437f6af63"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Foshan Yongqiheng Trading Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "67:22:37:25:3a:9b:7e:f9:d0:2d:7d:1c:b2:7a:3f:f4"
      cert_thumbprint     = "36A0F423C1FA48F172E4FECD06B8099F0EBBAEB8"
      cert_valid_from     = "2024-09-03"
      cert_valid_to       = "2025-09-03"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440605MA55WQT94L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "67:22:37:25:3a:9b:7e:f9:d0:2d:7d:1c:b2:7a:3f:f4"
      )
}

rule MAL_Compromised_Cert_ClearFake_GlobalSign_05B7F83D956379CDF5C31382 {
   meta:
      description         = "Detects ClearFake with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-20"
      version             = "1.0"

      hash                = "82cc0f3f4aa70a8215b62db7ee9deac1c3d4dd27cde25cf56ec2f82ca7d146a9"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CONG TY TNHH SAN XUAT VA THUONG MAI HUU BANG"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "05:b7:f8:3d:95:63:79:cd:f5:c3:13:82"
      cert_thumbprint     = "96E65313B167FF117658D4143A1B861DFAA76F7D"
      cert_valid_from     = "2024-06-20"
      cert_valid_to       = "2025-06-21"

      country             = "VN"
      state               = "Thai Binh"
      locality            = "Thai Binh"
      email               = "???"
      rdn_serial_number   = "1001266910"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "05:b7:f8:3d:95:63:79:cd:f5:c3:13:82"
      )
}

rule MAL_Compromised_Cert_ClearFake_GlobalSign_530C9FC05D0B9D497263E8F7 {
   meta:
      description         = "Detects ClearFake with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-02"
      version             = "1.0"

      hash                = "96fcae9a77f7f3d69488f487abe9358146601500523d8b43aeef10b4f658d93a"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shantou Chenghai Rongsheng Arts Company Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "53:0c:9f:c0:5d:0b:9d:49:72:63:e8:f7"
      cert_thumbprint     = "38CE22B597B49AFEEE260D294C44E2C398CF384A"
      cert_valid_from     = "2024-02-02"
      cert_valid_to       = "2025-02-02"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shantou"
      email               = "jasonwang@xiongsteng.net"
      rdn_serial_number   = "91440515324832161Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "53:0c:9f:c0:5d:0b:9d:49:72:63:e8:f7"
      )
}

rule MAL_Compromised_Cert_ClearFake_GlobalSign_708737C791C878D6DD7B7C43 {
   meta:
      description         = "Detects ClearFake with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-13"
      version             = "1.0"

      hash                = "8d911ef72bdb4ec5b99b7548c0c89ffc8639068834a5e2b684c9d78504550927"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Langfang Alkem Material Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "70:87:37:c7:91:c8:78:d6:dd:7b:7c:43"
      cert_thumbprint     = "7ED7081EE612FBF9FE0ADE46F4A2749DA20251E0"
      cert_valid_from     = "2024-09-13"
      cert_valid_to       = "2025-09-14"

      country             = "CN"
      state               = "Hebei"
      locality            = "Langfang"
      email               = "???"
      rdn_serial_number   = "9113102459540314XR"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "70:87:37:c7:91:c8:78:d6:dd:7b:7c:43"
      )
}

rule MAL_Compromised_Cert_ClearFake_GlobalSign_72E0ED06908B0BF0194F1D9E {
   meta:
      description         = "Detects ClearFake with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-11"
      version             = "1.0"

      hash                = "984c53328f4b199b884d24f41b6b97ee888ec40d16704388fac243dd76e49578"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CubTiger Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "72:e0:ed:06:90:8b:0b:f0:19:4f:1d:9e"
      cert_thumbprint     = "EDEDF98CBEF23C401CFA4D8B01C4EC3D4C770384"
      cert_valid_from     = "2024-10-11"
      cert_valid_to       = "2025-10-12"

      country             = "CN"
      state               = "Beijing"
      locality            = "Beijing"
      email               = "???"
      rdn_serial_number   = "91110229MA01R14F61"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "72:e0:ed:06:90:8b:0b:f0:19:4f:1d:9e"
      )
}

rule MAL_Compromised_Cert_ClearFake_SSL_com_56D6497C5068606EC413668FAC4F5EE3 {
   meta:
      description         = "Detects ClearFake with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-22"
      version             = "1.0"

      hash                = "a12809c76461d00760bef767c98baf5909a4aed48f2256d3c42eb1ca62835c14"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hunan Exotic Hotel Management Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "56:d6:49:7c:50:68:60:6e:c4:13:66:8f:ac:4f:5e:e3"
      cert_thumbprint     = "9AD448726590D64E247266E0B6FF1524FA094A51"
      cert_valid_from     = "2024-01-22"
      cert_valid_to       = "2025-01-21"

      country             = "CN"
      state               = "Hunan"
      locality            = "Changsha"
      email               = "???"
      rdn_serial_number   = "914301035765540498"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "56:d6:49:7c:50:68:60:6e:c4:13:66:8f:ac:4f:5e:e3"
      )
}

rule MAL_Compromised_Cert_ClearFake_SSL_com_7F71AF692330002E03E1311EB8A8B7E0 {
   meta:
      description         = "Detects ClearFake with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-04"
      version             = "1.0"

      hash                = "1486747dc29892c549c81cacdf397a8ac00b4aff52cdd5509d5aed3f8036b352"
      malware             = "ClearFake"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hebei Yingtong Pipeline Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7f:71:af:69:23:30:00:2e:03:e1:31:1e:b8:a8:b7:e0"
      cert_thumbprint     = "B8B63B45242CF37561729AA4CB601CFE67E9DBFA"
      cert_valid_from     = "2024-07-04"
      cert_valid_to       = "2025-07-04"

      country             = "CN"
      state               = "Hebei"
      locality            = "Cangzhou"
      email               = "???"
      rdn_serial_number   = "91130900335872388P"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7f:71:af:69:23:30:00:2e:03:e1:31:1e:b8:a8:b7:e0"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Certum_02DE1CC6C487954592F1BF574CA2B000 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-19"
      version             = "1.0"

      hash                = "6b9b5df993a38ebb2fa3eba4c26686b49aa57ec577902222225058a02284170e"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Orca System"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "02:de:1c:c6:c4:87:95:45:92:f1:bf:57:4c:a2:b0:00"
      cert_thumbprint     = "E35804BBF4573F492C51A7AD7A14557816FE961F"
      cert_valid_from     = "2021-02-19"
      cert_valid_to       = "2022-02-19"

      country             = "FR"
      state               = "Paris"
      locality            = "Paris"
      email               = "???"
      rdn_serial_number   = "430053835"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "02:de:1c:c6:c4:87:95:45:92:f1:bf:57:4c:a2:b0:00"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Certum_038FC745523B41B40D653B83AA381B80 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-23"
      version             = "1.0"

      hash                = "e844577efbd9d78da8849997491807f1f9d3ae7d7f010363e2c25c6de2687eba"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "OOO Optima"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "03:8f:c7:45:52:3b:41:b4:0d:65:3b:83:aa:38:1b:80"
      cert_thumbprint     = "05124A4A385B4B2D7A9B58D1C3AD7F2A84E7B0AF"
      cert_valid_from     = "2020-11-23"
      cert_valid_to       = "2021-11-23"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1167746706687"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "03:8f:c7:45:52:3b:41:b4:0d:65:3b:83:aa:38:1b:80"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Certum_20224184D3DE95E90551F97F0CB928DF {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-20"
      version             = "1.0"

      hash                = "9f0951b5bc28dcedf979692f1a2bde41d848c6dbb17d7f9482f188cdde727aa4"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Keroro Software LLC"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "20:22:41:84:d3:de:95:e9:05:51:f9:7f:0c:b9:28:df"
      cert_thumbprint     = "87985799EA81256784DD8625505EFE271231F57F"
      cert_valid_from     = "2025-01-20"
      cert_valid_to       = "2028-01-20"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5FAR1W6E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "20:22:41:84:d3:de:95:e9:05:51:f9:7f:0c:b9:28:df"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Certum_3C98B6872FBB1F4AE37A4CAA749D24C2 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-15"
      version             = "1.0"

      hash                = "a93eb70cc4152e32cd3a39fda968b2da5ade48453927410a0d520f2d13223d11"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "OOO SMART"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "3c:98:b6:87:2f:bb:1f:4a:e3:7a:4c:aa:74:9d:24:c2"
      cert_thumbprint     = "757E0FBBED8ABE068C00A1467C047D44FC4A6FE5"
      cert_valid_from     = "2021-02-15"
      cert_valid_to       = "2022-02-15"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1117746597649"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "3c:98:b6:87:2f:bb:1f:4a:e3:7a:4c:aa:74:9d:24:c2"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Certum_62670205C9738666CC0326EEF3AF3B7F {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-14"
      version             = "1.0"

      hash                = "a5442ceafa9bca74ae87bc82ab6387785f81501c5079cfc7b3d4db7003b42e89"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Shenzhen Zhixinjie Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "62:67:02:05:c9:73:86:66:cc:03:26:ee:f3:af:3b:7f"
      cert_thumbprint     = "2CF10729CFE91555F26DC0ADF7743DD9738192CA"
      cert_valid_from     = "2024-08-14"
      cert_valid_to       = "2027-08-14"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300087758593U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "62:67:02:05:c9:73:86:66:cc:03:26:ee:f3:af:3b:7f"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Certum_64C2505C7306639FC8EAE544B0305338 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-31"
      version             = "1.0"

      hash                = "7fa4ef5925f7374a93494b97a6ab43b0951c2d504972bbf43f9d29398e55481f"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "MANILA Solution as"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "64:c2:50:5c:73:06:63:9f:c8:ea:e5:44:b0:30:53:38"
      cert_thumbprint     = "0443F1D09F590989BE0C6136C7E156945CFF0F47"
      cert_valid_from     = "2020-12-31"
      cert_valid_to       = "2021-12-31"

      country             = "CZ"
      state               = "Praha"
      locality            = "Praha"
      email               = "???"
      rdn_serial_number   = "05572959"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "64:c2:50:5c:73:06:63:9f:c8:ea:e5:44:b0:30:53:38"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Comodo_00A7E4DED4BF949D15AA4201843F1AB64D {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2018-08-13"
      version             = "1.0"

      hash                = "2b083062d97753259ddd4015c806ecb06d121531e7a2807420d95df207c3154d"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "1.A Connect GmbH"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Code Signing CA"
      cert_serial         = "00:a7:e4:de:d4:bf:94:9d:15:aa:42:01:84:3f:1a:b6:4d"
      cert_thumbprint     = "FC3F6D98724178B8A5BEE724858D22573B8DB97B"
      cert_valid_from     = "2018-08-13"
      cert_valid_to       = "2022-08-13"

      country             = "DE"
      state               = "Saarland"
      locality            = "Nohfelden"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Code Signing CA" and
         sig.serial == "00:a7:e4:de:d4:bf:94:9d:15:aa:42:01:84:3f:1a:b6:4d"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_DigiCert_0400C7614F86D75FE4EE3F6192B6FEDA {
   meta:
      description         = "Detects CobaltStrike with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-16"
      version             = "1.0"

      hash                = "d3ec1a84996a4443b146bfeeaded02eafe663af47b858adc650465f808498eb4"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "StackUp ApS"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "04:00:c7:61:4f:86:d7:5f:e4:ee:3f:61:92:b6:fe:da"
      cert_thumbprint     = "60CFAD87C57BE8AA499A6E51C6127C2D6DFF77B3"
      cert_valid_from     = "2021-07-16"
      cert_valid_to       = "2022-07-19"

      country             = "DK"
      state               = "???"
      locality            = "Kastrup"
      email               = "???"
      rdn_serial_number   = "42492043"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "04:00:c7:61:4f:86:d7:5f:e4:ee:3f:61:92:b6:fe:da"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_DigiCert_09D5BD1F7C750A22CECC9A51A3487C51 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-12"
      version             = "1.0"

      hash                = "780dc4b0fb8ce1983083bdfe875629d2ee66884bf5d634b6c4ef57544f6b2ba1"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Dynamic Digital Marketing Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "09:d5:bd:1f:7c:75:0a:22:ce:cc:9a:51:a3:48:7c:51"
      cert_thumbprint     = "32B2125D6FE4F483A4315476BEE568BA705B39B8"
      cert_valid_from     = "2021-03-12"
      cert_valid_to       = "2022-03-16"

      country             = "CA"
      state               = "Ontario"
      locality            = "Gloucester"
      email               = "???"
      rdn_serial_number   = "1273056-1"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "09:d5:bd:1f:7c:75:0a:22:ce:cc:9a:51:a3:48:7c:51"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_DigiCert_0AAA488894478A674F2BF1A9BBAFB828 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-10-23"
      version             = "1.0"

      hash                = "cac1ec8f6d73f15d1e6426c45b766bf61d89cc091e83d87be52287d26481b89f"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Appeon Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert SHA2 Assured ID Code Signing CA"
      cert_serial         = "0a:aa:48:88:94:47:8a:67:4f:2b:f1:a9:bb:af:b8:28"
      cert_thumbprint     = "DB41FA48A04A4058D15F5E3B6F320D8B53F1502A"
      cert_valid_from     = "2019-10-23"
      cert_valid_to       = "2022-01-29"

      country             = "US"
      state               = "California"
      locality            = "San Francisco"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert SHA2 Assured ID Code Signing CA" and
         sig.serial == "0a:aa:48:88:94:47:8a:67:4f:2b:f1:a9:bb:af:b8:28"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_DigiCert_0FA13AE98E17AE23FCFE7AE873D0C120 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-13"
      version             = "1.0"

      hash                = "9c3b7ba8d375f19993312a6ac20418e0d107d73b30d585e9ad3646e150ff7c5a"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "KLAKSON, LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0f:a1:3a:e9:8e:17:ae:23:fc:fe:7a:e8:73:d0:c1:20"
      cert_thumbprint     = "A9EB61783FABE97AA1040103430EB8269D443B0A"
      cert_valid_from     = "2020-08-13"
      cert_valid_to       = "2021-07-14"

      country             = "RU"
      state               = "???"
      locality            = "Balashikha"
      email               = "???"
      rdn_serial_number   = "1045002450350"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0f:a1:3a:e9:8e:17:ae:23:fc:fe:7a:e8:73:d0:c1:20"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_GlobalSign_38EBC2945F2798C8FBB0FBB4 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-14"
      version             = "1.0"

      hash                = "c2cb38569e885d47deb9b3869c60ab2d978a5a244e238777d6156c0c486cc879"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "KINDATECH SOLUTIONS LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:eb:c2:94:5f:27:98:c8:fb:b0:fb:b4"
      cert_thumbprint     = "D1D88A32CF201EA8CB3F6E2A93034B8E5ACDF8A0"
      cert_valid_from     = "2025-01-14"
      cert_valid_to       = "2026-01-15"

      country             = "KE"
      state               = "Nakuru"
      locality            = "Nakuru"
      email               = "???"
      rdn_serial_number   = "CPR/2009/7526"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:eb:c2:94:5f:27:98:c8:fb:b0:fb:b4"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_GlobalSign_4123C62DFD13EF9CC0690E57 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-05"
      version             = "1.0"

      hash                = "23d331f8dafd75e487b12295f49914bb37a63df04c9f7ffda89c9bd2418ddf87"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "ANALYZER ENTERPRISES LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:23:c6:2d:fd:13:ef:9c:c0:69:0e:57"
      cert_thumbprint     = "fc247e295ce9be12a1ffd204fccb4f1e76919b3d455efe7f25b91fc2a22379fd"
      cert_valid_from     = "2024-11-05"
      cert_valid_to       = "2025-11-06"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "fvakdu@gmail.com"
      rdn_serial_number   = "AAO-5256"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:23:c6:2d:fd:13:ef:9c:c0:69:0e:57"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_GlobalSign_4668EDFA623554CF0B48F401 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-28"
      version             = "1.0"

      hash                = "ce38c96a69a8a1c6828e11742355c41b878198e08d7efbe73eefa1b5cbe623c5"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Zhengzhou 403 Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "46:68:ed:fa:62:35:54:cf:0b:48:f4:01"
      cert_thumbprint     = "B3BD6E706137ED999BFD6E51FE05FCA30C553C30"
      cert_valid_from     = "2025-03-28"
      cert_valid_to       = "2026-03-29"

      country             = "CN"
      state               = "Henan"
      locality            = "Zhengzhou"
      email               = "???"
      rdn_serial_number   = "91410100MADAKY554Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "46:68:ed:fa:62:35:54:cf:0b:48:f4:01"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_GlobalSign_5A201D817E6EE6C01B7245AB {
   meta:
      description         = "Detects CobaltStrike with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-24"
      version             = "1.0"

      hash                = "c7c33d102ee200c14c251078310316104418e743df16c2310c9afac47e313908"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "安徽哲凯网络科技有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:20:1d:81:7e:6e:e6:c0:1b:72:45:ab"
      cert_thumbprint     = "0C6EFEE2B93507E766F12B25101E90097517D3C6"
      cert_valid_from     = "2024-06-24"
      cert_valid_to       = "2025-06-25"

      country             = "CN"
      state               = "安徽"
      locality            = "合肥"
      email               = "???"
      rdn_serial_number   = "91340104MA2UHG725W"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:20:1d:81:7e:6e:e6:c0:1b:72:45:ab"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Go_Daddy_00DBC03CA7E6AE6DB6 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Go Daddy)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-23"
      version             = "1.0"

      hash                = "eb6febe456a9d3d5066cc0f746789c446f609d4df35b153760758f8b350fc3e4"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "SPIDER DEVELOPMENTS PTY LTD"
      cert_issuer_short   = "Go Daddy"
      cert_issuer         = "Go Daddy Secure Certificate Authority - G2"
      cert_serial         = "00:db:c0:3c:a7:e6:ae:6d:b6"
      cert_thumbprint     = "2F8D05E2B14B9F8C1271C92B8A2DE45C0DBADFB1"
      cert_valid_from     = "2020-09-23"
      cert_valid_to       = "2022-09-22"

      country             = "AU"
      state               = "Western Australia"
      locality            = "West Perth"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Go Daddy Secure Certificate Authority - G2" and
         sig.serial == "00:db:c0:3c:a7:e6:ae:6d:b6"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Microsoft_330002F7CCDB893ECB3CBB70F500000002F7CC {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-13"
      version             = "1.0"

      hash                = "40183652b178bbb018185d714c0d023d81ce1943183eb7f563ad58fc2925cd88"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "志超 柴"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:02:f7:cc:db:89:3e:cb:3c:bb:70:f5:00:00:00:02:f7:cc"
      cert_thumbprint     = "F0373B67387A134DED91ECEE2A3D811C6F70F7DF"
      cert_valid_from     = "2025-03-13"
      cert_valid_to       = "2025-03-16"

      country             = "CN"
      state               = "???"
      locality            = "平南"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:02:f7:cc:db:89:3e:cb:3c:bb:70:f5:00:00:00:02:f7:cc"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_SSL_com_70AACF510F5C8A893C5104B2DB315633 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-28"
      version             = "1.0"

      hash                = "12c98ce7a4c92244ae122acc5d50745ee3d2de3e02d9b1b8a7e53a7b142f652f"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Rigveda Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "70:aa:cf:51:0f:5c:8a:89:3c:51:04:b2:db:31:56:33"
      cert_thumbprint     = "754AC4AD446D76B2A788453030E6845E7A9EFC33"
      cert_valid_from     = "2023-08-28"
      cert_valid_to       = "2024-08-27"

      country             = "GB"
      state               = "???"
      locality            = "Epping"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "70:aa:cf:51:0f:5c:8a:89:3c:51:04:b2:db:31:56:33"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_009272607CFC982B782A5D36C4B78F5E7B {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-12"
      version             = "1.0"

      hash                = "3cd9b8f675d4718c4d73a9b1656836790a058b8ba46c1e0f254d46775ab06556"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Rada SP Z o o"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:92:72:60:7c:fc:98:2b:78:2a:5d:36:c4:b7:8f:5e:7b"
      cert_thumbprint     = "1ABBDA4B6BF337E98A7AE2C025F18499304E2BEB"
      cert_valid_from     = "2020-11-12"
      cert_valid_to       = "2021-11-12"

      country             = "PL"
      state               = "???"
      locality            = "Kraków"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:92:72:60:7c:fc:98:2b:78:2a:5d:36:c4:b7:8f:5e:7b"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_0099527FB7264188F90B65ED893E220638 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-09"
      version             = "1.0"

      hash                = "9b2b902f5fd53b72cabfcc0e0191c876c92c1c748bcdbb7c00f9d62d7ba76914"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "PLAYWITH Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:99:52:7f:b7:26:41:88:f9:0b:65:ed:89:3e:22:06:38"
      cert_thumbprint     = "839E615C9212B9017C93E8E9AFE50A39AFE48CD1"
      cert_valid_from     = "2021-07-09"
      cert_valid_to       = "2023-07-09"

      country             = "KR"
      state               = "Gyeonggi"
      locality            = "Seongnam"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:99:52:7f:b7:26:41:88:f9:0b:65:ed:89:3e:22:06:38"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_00AFF762E907F0644E76ED8A7485FB12A1 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-05-27"
      version             = "1.0"

      hash                = "c786e4de11e64be8d4118cf8ba6b210e3396e3bb579f3afd4bf528c35bab4a6b"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Lets Start SP Z O O"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:af:f7:62:e9:07:f0:64:4e:76:ed:8a:74:85:fb:12:a1"
      cert_thumbprint     = "2E23856699C852D258BF61EDF507C3362AE83BE3"
      cert_valid_from     = "2020-05-27"
      cert_valid_to       = "2021-05-27"

      country             = "PL"
      state               = "Warszawa"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:af:f7:62:e9:07:f0:64:4e:76:ed:8a:74:85:fb:12:a1"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_00B649A966410F62999C939384AF553919 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-05-27"
      version             = "1.0"

      hash                = "70eae6d411554b0587f9bc3e7e7cc753e81b8086310dc5fa8181c44632fe1ada"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "F.A.T. SARL"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b6:49:a9:66:41:0f:62:99:9c:93:93:84:af:55:39:19"
      cert_thumbprint     = "5968A4ED4AC1CBE7DD7F36B9A4E651CCDD47D07A"
      cert_valid_from     = "2020-05-27"
      cert_valid_to       = "2021-05-27"

      country             = "FR"
      state               = "Paris 18e Arrondissement"
      locality            = "Paris 18e Arrondissement"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b6:49:a9:66:41:0f:62:99:9c:93:93:84:af:55:39:19"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_00E4E795FD1FD25595B869CE22AA7DC49F {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-21"
      version             = "1.0"

      hash                = "b5242d61a1a04f86e7e6f3f9724796497c3391bf7adde9a171f61b02084e5bdd"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "OASIS COURT LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e4:e7:95:fd:1f:d2:55:95:b8:69:ce:22:aa:7d:c4:9f"
      cert_thumbprint     = "269F25E6B7C690AE094086BD7825D03B48D4FCB1"
      cert_valid_from     = "2020-12-21"
      cert_valid_to       = "2021-12-21"

      country             = "GB"
      state               = "Essex"
      locality            = "Colchester"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e4:e7:95:fd:1f:d2:55:95:b8:69:ce:22:aa:7d:c4:9f"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_24C1EF800F275AB2780280C595DE3464 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-03"
      version             = "1.0"

      hash                = "bf476d0296be27e3b75b2cad6330839d0f294b094a6d0d50b4cf62010fb17244"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "HOLGAN LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "24:c1:ef:80:0f:27:5a:b2:78:02:80:c5:95:de:34:64"
      cert_thumbprint     = "836B81154EB924FE741F50A21DB258DA9B264B85"
      cert_valid_from     = "2021-03-03"
      cert_valid_to       = "2022-03-03"

      country             = "GB"
      state               = "Oxfordshire"
      locality            = "Thame"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "24:c1:ef:80:0f:27:5a:b2:78:02:80:c5:95:de:34:64"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_29128A56E7B3BFB230742591AC8B4718 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-05-14"
      version             = "1.0"

      hash                = "d80026d7e9397366ff4d2eeddd01421843e4d9898df1360267c1616ea59fcc56"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Programavimo paslaugos, MB"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "29:12:8a:56:e7:b3:bf:b2:30:74:25:91:ac:8b:47:18"
      cert_thumbprint     = "18C01A6422F2679127E4974F9DD408D5CACC0428"
      cert_valid_from     = "2020-05-14"
      cert_valid_to       = "2021-05-14"

      country             = "LT"
      state               = "Vilnius"
      locality            = "Vilnius"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "29:12:8a:56:e7:b3:bf:b2:30:74:25:91:ac:8b:47:18"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_2A52ACB34BD075AC9F58771D2A4BBFBA {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-02-28"
      version             = "1.0"

      hash                = "a32e37ae08d6a723dff7313d96bc7e23fe9b7db18295e2916f3c935530329919"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Katarzyna Galganek mim e coc"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "2a:52:ac:b3:4b:d0:75:ac:9f:58:77:1d:2a:4b:bf:ba"
      cert_thumbprint     = "78063497F9FD11DB5D3DF56F137E0BA7D90F5900"
      cert_valid_from     = "2020-02-28"
      cert_valid_to       = "2021-02-27"

      country             = "PL"
      state               = "???"
      locality            = "Krakow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "2a:52:ac:b3:4b:d0:75:ac:9f:58:77:1d:2a:4b:bf:ba"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_2DCD0699DA08915DDE6D044CB474157C {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-21"
      version             = "1.0"

      hash                = "b568a4ca18fce49b465d0db8697640d556f579932db0315398a810140c66f0db"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "VENTE DE TOUT"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "2d:cd:06:99:da:08:91:5d:de:6d:04:4c:b4:74:15:7c"
      cert_thumbprint     = "3B4470D37D93CA1C15224413672349200F1A51EA"
      cert_valid_from     = "2020-09-21"
      cert_valid_to       = "2021-09-21"

      country             = "FR"
      state               = "???"
      locality            = "POISSY"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "2d:cd:06:99:da:08:91:5d:de:6d:04:4c:b4:74:15:7c"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_4152169F22454ED604D03555B7AFB175 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-27"
      version             = "1.0"

      hash                = "f3ebeeeba13c82daef9731a5f3e8dbe535e963f83e531918ba1a8904b094d3b8"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "SMACKTECH SOFTWARE LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "41:52:16:9f:22:45:4e:d6:04:d0:35:55:b7:af:b1:75"
      cert_thumbprint     = "0A05B51F64D9AB897484907BF3767CAABB1181D3"
      cert_valid_from     = "2020-07-27"
      cert_valid_to       = "2021-07-27"

      country             = "NZ"
      state               = "Auckland"
      locality            = "Auckland"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "41:52:16:9f:22:45:4e:d6:04:d0:35:55:b7:af:b1:75"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_4DEB2644A5AD1488F98F6A8D6BCA1FAB {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-10-05"
      version             = "1.0"

      hash                = "ede4978afd488eb4ab66e0270c1baadd8f7be1cd1f29bf969039c804148b0a56"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "coolschool"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "4d:eb:26:44:a5:ad:14:88:f9:8f:6a:8d:6b:ca:1f:ab"
      cert_thumbprint     = "B8818B7BB5F4E617E451F43196BFEABE6A8B9792"
      cert_valid_from     = "2022-10-05"
      cert_valid_to       = "2024-10-04"

      country             = "KR"
      state               = "Gyeonggi-do"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "4d:eb:26:44:a5:ad:14:88:f9:8f:6a:8d:6b:ca:1f:ab"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_6CFA5050C819C4ACBB8FA75979688DFF {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-02"
      version             = "1.0"

      hash                = "2561379ad92527aabb67d7649589e2a3719db5e57f2b451baf57f57258def793"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Elite Web Development Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "6c:fa:50:50:c8:19:c4:ac:bb:8f:a7:59:79:68:8d:ff"
      cert_thumbprint     = "AD300C8D9631F68DC220F7EF3ADDD40AEE86869E"
      cert_valid_from     = "2020-07-02"
      cert_valid_to       = "2021-07-02"

      country             = "CA"
      state               = "Alberta"
      locality            = "Edmonton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "6c:fa:50:50:c8:19:c4:ac:bb:8f:a7:59:79:68:8d:ff"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_70D896117E15302C7EEFECB289B3BFE0 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-28"
      version             = "1.0"

      hash                = "e1370e9afb0bd1e7fb4cb11779a39b6b2d2e0f99fc2cd6137b2c813a3cd54b70"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Quicktech.com"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "70:d8:96:11:7e:15:30:2c:7e:ef:ec:b2:89:b3:bf:e0"
      cert_thumbprint     = "697D12D05433678457FBB0534239B394E60F783B"
      cert_valid_from     = "2020-09-28"
      cert_valid_to       = "2021-09-28"

      country             = "CA"
      state               = "Alberta"
      locality            = "Calgary"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "70:d8:96:11:7e:15:30:2c:7e:ef:ec:b2:89:b3:bf:e0"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_Sectigo_7DCD19A94535F034EE36AF4676740633 {
   meta:
      description         = "Detects CobaltStrike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-29"
      version             = "1.0"

      hash                = "6220127ada00d84b58d718152748cd2c62007b1de92201701dc2968d2b00e31f"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Toko Saya ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7d:cd:19:a9:45:35:f0:34:ee:36:af:46:76:74:06:33"
      cert_thumbprint     = "F4CBAA5575E43486D773A87CFDDDB7D2929AD549"
      cert_valid_from     = "2020-12-29"
      cert_valid_to       = "2021-12-29"

      country             = "DK"
      state               = "???"
      locality            = "Odense SV"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7d:cd:19:a9:45:35:f0:34:ee:36:af:46:76:74:06:33"
      )
}

rule MAL_Compromised_Cert_CobaltStrike_TrustOcean_7A6D30A6EB2FA0C3369283725704AC4C {
   meta:
      description         = "Detects CobaltStrike with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-28"
      version             = "1.0"

      hash                = "87766b03bd60f023941fc02d8dc5c292136bc5e6e0805cac765929f45e61b90d"
      malware             = "CobaltStrike"
      malware_type        = "Remote access tool"
      malware_notes       = "A commercial red-teaming product which is weaponized by a wide range of cybercriminals: https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike"

      signer              = "Trade By International ApS"
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "7a:6d:30:a6:eb:2f:a0:c3:36:92:83:72:57:04:ac:4c"
      cert_thumbprint     = "89B2F0B71F97C9ED574409DA7DD47BCAC9083161"
      cert_valid_from     = "2021-04-28"
      cert_valid_to       = "2022-04-28"

      country             = "DK"
      state               = "???"
      locality            = "Odder"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "7a:6d:30:a6:eb:2f:a0:c3:36:92:83:72:57:04:ac:4c"
      )
}

rule MAL_Compromised_Cert_Cobalt_Strike_DigiCert_0E427DE03B671DC464DEF6C38BEE9216 {
   meta:
      description         = "Detects Cobalt Strike with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-16"
      version             = "1.0"

      hash                = "8d48d0a05d581922a4d30ba98cbf51ea981a37c95fad689e0b84b979e312f6a4"
      malware             = "Cobalt Strike"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Baizhi Network Technology Co., Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0e:42:7d:e0:3b:67:1d:c4:64:de:f6:c3:8b:ee:92:16"
      cert_thumbprint     = "4D875FFF62AFEAC46BD847CC710F5B5C8D1333A8"
      cert_valid_from     = "2023-08-16"
      cert_valid_to       = "2026-08-16"

      country             = "CN"
      state               = "上海市"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91310114MA1GWA6R46"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0e:42:7d:e0:3b:67:1d:c4:64:de:f6:c3:8b:ee:92:16"
      )
}

rule MAL_Compromised_Cert_Cobalt_Strike_Sectigo_3A3685FE73DC5C81DA594E0EE949F34B {
   meta:
      description         = "Detects Cobalt Strike with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-12-30"
      version             = "1.0"

      hash                = "4376f6c5bd63c9472dc1575b26f70cc2320682a47881e1a9283904bcdec43fd8"
      malware             = "Cobalt Strike"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LYDSEC DIGITAL TECHNOLOGY CO., LTD."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "3a:36:85:fe:73:dc:5c:81:da:59:4e:0e:e9:49:f3:4b"
      cert_thumbprint     = "361FE689890D416B5EB4E678CC38F45FA0F2BFD0"
      cert_valid_from     = "2022-12-30"
      cert_valid_to       = "2025-12-29"

      country             = "TW"
      state               = "Taipei"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "3a:36:85:fe:73:dc:5c:81:da:59:4e:0e:e9:49:f3:4b"
      )
}

rule MAL_Compromised_Cert_CoinLurker_DigiCert_08FD49B1A5ECA2283F3E0971754D2ED4 {
   meta:
      description         = "Detects CoinLurker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-07"
      version             = "1.0"

      hash                = "5b37b7655f7a623694b08101912ca14e4ef3ddd4dd22a1b45a9f92103f299097"
      malware             = "CoinLurker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "武汉薄荷科技有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "08:fd:49:b1:a5:ec:a2:28:3f:3e:09:71:75:4d:2e:d4"
      cert_thumbprint     = "8BD9791A4B75106CCBE54E4086205523EA227AEB"
      cert_valid_from     = "2023-12-07"
      cert_valid_to       = "2025-10-09"

      country             = "CN"
      state               = "湖北省"
      locality            = "武汉市"
      email               = "???"
      rdn_serial_number   = "91420106MA4L0NHE9U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "08:fd:49:b1:a5:ec:a2:28:3f:3e:09:71:75:4d:2e:d4"
      )
}

rule MAL_Compromised_Cert_CoinLurker_SSL_com_3CCAA910608E55352E5340C47D01A9D8 {
   meta:
      description         = "Detects CoinLurker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-14"
      version             = "1.0"

      hash                = "c8adb9bf6997a9fa2738a09600a60abc4fb6334aa54b24166cf042afdc5a1064"
      malware             = "CoinLurker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Domum - design s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3c:ca:a9:10:60:8e:55:35:2e:53:40:c4:7d:01:a9:d8"
      cert_thumbprint     = "78383AD96F00C6843126052D391DF597400925EA"
      cert_valid_from     = "2024-09-14"
      cert_valid_to       = "2025-09-14"

      country             = "CZ"
      state               = "Hlavní Mesto Praha"
      locality            = "Žižkov"
      email               = "???"
      rdn_serial_number   = "075 35 465"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3c:ca:a9:10:60:8e:55:35:2e:53:40:c4:7d:01:a9:d8"
      )
}

rule MAL_Compromised_Cert_CoinLurker_SSL_com_56D6497C5068606EC413668FAC4F5EE3 {
   meta:
      description         = "Detects CoinLurker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-22"
      version             = "1.0"

      hash                = "487156ae20cc6d8e7d922cebe35b197c28ae43134f7e04c5f6bd0f3e164a7120"
      malware             = "CoinLurker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hunan Exotic Hotel Management Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "56:d6:49:7c:50:68:60:6e:c4:13:66:8f:ac:4f:5e:e3"
      cert_thumbprint     = "9AD448726590D64E247266E0B6FF1524FA094A51"
      cert_valid_from     = "2024-01-22"
      cert_valid_to       = "2025-01-21"

      country             = "CN"
      state               = "Hunan"
      locality            = "Changsha"
      email               = "???"
      rdn_serial_number   = "914301035765540498"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "56:d6:49:7c:50:68:60:6e:c4:13:66:8f:ac:4f:5e:e3"
      )
}

rule MAL_Compromised_Cert_CoinLurker_SSL_com_72B3250DD8324E027D167CB349DC57D6 {
   meta:
      description         = "Detects CoinLurker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-26"
      version             = "1.0"

      hash                = "324e1bf24f13d5a8f45cc5ee25d3dfe330a7e755b19901549976f2db02ca4fa4"
      malware             = "CoinLurker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sibur International Trading (SHANGHAI) Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "72:b3:25:0d:d8:32:4e:02:7d:16:7c:b3:49:dc:57:d6"
      cert_thumbprint     = "6C2A7731614041DB857F84FE8FEFA011AE43A187"
      cert_valid_from     = "2024-02-26"
      cert_valid_to       = "2025-02-25"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "913101155574141123"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "72:b3:25:0d:d8:32:4e:02:7d:16:7c:b3:49:dc:57:d6"
      )
}

rule MAL_Compromised_Cert_Coinminer_Sectigo_009E9428089C105FE19B7EE10BC764EBF4 {
   meta:
      description         = "Detects Coinminer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "883d86b3c3ad92c957f65175acc15247b2c57be2ec50fb672cb848ec55febc37"
      malware             = "Coinminer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IntelliBreeze Software AB"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:9e:94:28:08:9c:10:5f:e1:9b:7e:e1:0b:c7:64:eb:f4"
      cert_thumbprint     = "BF126F9346924B3376AB4436D56E9BF30D13355C"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2027-01-26"

      country             = "SE"
      state               = "Stockholms län"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "559047-8920"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:9e:94:28:08:9c:10:5f:e1:9b:7e:e1:0b:c7:64:eb:f4"
      )
}

rule MAL_Compromised_Cert_ConnectWiseLoader_Sectigo_4E3DC08BA3B230C5968A4C8B6B1B3C64 {
   meta:
      description         = "Detects ConnectWiseLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-09"
      version             = "1.0"

      hash                = "88bcc4eacf3c0dd26c57dfdd42da085eeff0bcc4c1106eceeba466c0a05fc1e5"
      malware             = "ConnectWiseLoader"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware was observed being downloaded with filenames such as \"Facebook_Video20251122.mp4 Facebook.com\" \"screen_video_iphone.mp4 Drive.google.com\". This signer was also previously used with other RMM tools and similar filenames."

      signer              = "CÔNG TY TNHH XB FLOW TECHNOLOGIES"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "4e:3d:c0:8b:a3:b2:30:c5:96:8a:4c:8b:6b:1b:3c:64"
      cert_thumbprint     = "24FEB829E1A0DD9AB71B7EF485CB1F026BCBFE9F"
      cert_valid_from     = "2025-12-09"
      cert_valid_to       = "2027-01-08"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = ""

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "4e:3d:c0:8b:a3:b2:30:c5:96:8a:4c:8b:6b:1b:3c:64"
      )
}

rule MAL_Compromised_Cert_ConvertMasterBrowserHijacker_GlobalSign_5786D284BBF7E6E35C9CD11B {
   meta:
      description         = "Detects ConvertMasterBrowserHijacker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-20"
      version             = "1.0"

      hash                = "d0c7471c7950b2f80dbf92f929dfb0f10d518b551b326e56e9b2870de90196f3"
      malware             = "ConvertMasterBrowserHijacker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TECHNODENIS LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "57:86:d2:84:bb:f7:e6:e3:5c:9c:d1:1b"
      cert_thumbprint     = "D8263A1EA0C4D119C5346E1B26200377283774F4"
      cert_valid_from     = "2025-01-20"
      cert_valid_to       = "2026-04-27"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "contactus@technodenisltd.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "57:86:d2:84:bb:f7:e6:e3:5c:9c:d1:1b"
      )
}

rule MAL_Compromised_Cert_ConvertMate_FakeFileConverter_GlobalSign_77632688BC1B58D31BC7DF0D {
   meta:
      description         = "Detects ConvertMate, FakeFileConverter with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-14"
      version             = "1.0"

      hash                = "09c2af472ab86b62a702e94a39df2bef09205f4249ed871cbeece751c1e7ef4f"
      malware             = "ConvertMate, FakeFileConverter"
      malware_type        = "Backdoor"
      malware_notes       = "Malware creates a scheduled task to check in with C2 daily. Can receive and decrypt AES encoded payloads received by the C2. See  https://blog.lukeacha.com/2025/11/suspicious-converter-obfuscated-strings.html for more details."

      signer              = "AMARYLLIS SIGNAL LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "77:63:26:88:bc:1b:58:d3:1b:c7:df:0d"
      cert_thumbprint     = "02C4B0C7438F3AE718FFA47137B75151713F38EA"
      cert_valid_from     = "2025-01-14"
      cert_valid_to       = "2026-01-15"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Tel Aviv"
      email               = "support@amarylisignal.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "77:63:26:88:bc:1b:58:d3:1b:c7:df:0d"
      )
}

rule MAL_Compromised_Cert_CrazyEvilTrafferTeam_SSL_com_5DFD0E9D2EB85BE5912CCB6EFE551AB9 {
   meta:
      description         = "Detects CrazyEvilTrafferTeam with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-04"
      version             = "1.0"

      hash                = "ae111d30ea9abe210c4451982a3ea67e99e36cb37e534d133d6bc603afacbea7"
      malware             = "CrazyEvilTrafferTeam"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Richester Business Network Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5d:fd:0e:9d:2e:b8:5b:e5:91:2c:cb:6e:fe:55:1a:b9"
      cert_thumbprint     = "1A90B2BEF92A6E67D4542EBE9D0B28B550AB720D"
      cert_valid_from     = "2025-09-04"
      cert_valid_to       = "2026-09-01"

      country             = "CA"
      state               = "Alberta"
      locality            = "Calgary"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5d:fd:0e:9d:2e:b8:5b:e5:91:2c:cb:6e:fe:55:1a:b9"
      )
}

rule MAL_Compromised_Cert_CrazyEvilTraffer_GlobalSign_02229C110CF8795398A98735 {
   meta:
      description         = "Detects CrazyEvilTraffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "dce96f220fca15e105160d35cddb9022207da667c22a6607ea1f3249b0653287"
      malware             = "CrazyEvilTraffer"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Olepole LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "02:22:9c:11:0c:f8:79:53:98:a9:87:35"
      cert_thumbprint     = "4026F7A5DA6ECDA8E5A2A676C9BF82D1AF2B57E9"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2026-06-04"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "02:22:9c:11:0c:f8:79:53:98:a9:87:35"
      )
}

rule MAL_Compromised_Cert_CrazyEvilTraffer_GlobalSign_1FBFB66ADE0146F9C61C6218 {
   meta:
      description         = "Detects CrazyEvilTraffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "4a802433176d4678103090719cd052db50692b2755945e57717f28e5dc257b3d"
      malware             = "CrazyEvilTraffer"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Heze Hongwei Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1f:bf:b6:6a:de:01:46:f9:c6:1c:62:18"
      cert_thumbprint     = "88BF2C043ACE8CBC5211B5ED99DBDF9C2F24FF20"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-26"

      country             = "CN"
      state               = "Shandong"
      locality            = "Heze"
      email               = "???"
      rdn_serial_number   = "91371702MABYMG6429"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1f:bf:b6:6a:de:01:46:f9:c6:1c:62:18"
      )
}

rule MAL_Compromised_Cert_CrazyEvilTraffer_GlobalSign_3C720E116FF39685FD1BC018 {
   meta:
      description         = "Detects CrazyEvilTraffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-30"
      version             = "1.0"

      hash                = "7c5583fff213bd93237b110c274a7ceb8063dd7ee1d0b4fd38351e2975be5cee"
      malware             = "CrazyEvilTraffer"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "AASIM MEDICARE PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3c:72:0e:11:6f:f3:96:85:fd:1b:c0:18"
      cert_thumbprint     = "C51DF2A048F6E41B542A02BBC688884E4DE7011E"
      cert_valid_from     = "2025-06-30"
      cert_valid_to       = "2026-07-01"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "karansn82@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3c:72:0e:11:6f:f3:96:85:fd:1b:c0:18"
      )
}

rule MAL_Compromised_Cert_CrazyEvilTraffer_GlobalSign_5298A114ED373199B8DF7B68 {
   meta:
      description         = "Detects CrazyEvilTraffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-30"
      version             = "1.0"

      hash                = "1450b45187c0f485fad45496717be8e45dec1d4f619ee4294febeeb1d01fd66c"
      malware             = "CrazyEvilTraffer"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "SUNEX STONES PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "52:98:a1:14:ed:37:31:99:b8:df:7b:68"
      cert_thumbprint     = "DD21129EBA5097150A8D0AAEAD2BC18746FAD52F"
      cert_valid_from     = "2025-05-30"
      cert_valid_to       = "2026-05-31"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "anupsinghalrchem@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "52:98:a1:14:ed:37:31:99:b8:df:7b:68"
      )
}

rule MAL_Compromised_Cert_CrazyEvilTraffer_Sectigo_250824C25A5D2BA93002CFAEDBFAF1BA {
   meta:
      description         = "Detects CrazyEvilTraffer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-23"
      version             = "1.0"

      hash                = "c60f79c9fd9432f493256c8c5aa794dd141f9480c3d4fe187e4c48ceaf79088f"
      malware             = "CrazyEvilTraffer"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "PAPER AND COTTON LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "25:08:24:c2:5a:5d:2b:a9:30:02:cf:ae:db:fa:f1:ba"
      cert_thumbprint     = "8A8945969807D26B12DB2BF83BBBB244AEFE3DB2"
      cert_valid_from     = "2025-10-23"
      cert_valid_to       = "2026-10-23"

      country             = "GB"
      state               = "Gloucestershire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "25:08:24:c2:5a:5d:2b:a9:30:02:cf:ae:db:fa:f1:ba"
      )
}

rule MAL_Compromised_Cert_CrazyEvil_Traffer_Sectigo_009D8810BFF34A30460ABF1E5410324DA8 {
   meta:
      description         = "Detects CrazyEvil Traffer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-17"
      version             = "1.0"

      hash                = "d4b323c06ed57e99016411f0fb1ff66f3c20141c253ef46c4035281118c412a4"
      malware             = "CrazyEvil Traffer"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Gucheng County Sili Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:9d:88:10:bf:f3:4a:30:46:0a:bf:1e:54:10:32:4d:a8"
      cert_thumbprint     = "C739BEE07E4D6DFAA168854601BADC2232628826"
      cert_valid_from     = "2025-06-17"
      cert_valid_to       = "2026-06-17"

      country             = "CN"
      state               = "Hubei Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:9d:88:10:bf:f3:4a:30:46:0a:bf:1e:54:10:32:4d:a8"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_Entrust_00C25308E33EE5E814D2E3054026033F4C {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-20"
      version             = "1.0"

      hash                = "aae36559d8f600cee0f77dfa2e1bd88b58c908fb4190001d180ebb2ba1d9802c"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "NEXTGENSOFTWARE COMPANY LIMITED"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "00:c2:53:08:e3:3e:e5:e8:14:d2:e3:05:40:26:03:3f:4c"
      cert_thumbprint     = "2B301191AA9E1D2C8E3EEFD38B6EB1952B1FCE88"
      cert_valid_from     = "2025-01-20"
      cert_valid_to       = "2026-01-20"

      country             = "VN"
      state               = "???"
      locality            = "Hồ Chí Minh"
      email               = "???"
      rdn_serial_number   = "0318797820"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "00:c2:53:08:e3:3e:e5:e8:14:d2:e3:05:40:26:03:3f:4c"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_Entrust_00C4B1716739E14C2FCB35D39D49ACB971 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-05"
      version             = "1.0"

      hash                = "6130a8fda1672a1c74fd9a401324cc26eb72c0b24fff308fb9987f9e9bf3f390"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "REDSTRIKEVN COMPANY LIMITED"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "00:c4:b1:71:67:39:e1:4c:2f:cb:35:d3:9d:49:ac:b9:71"
      cert_thumbprint     = "93137F64B4E0418CC67BE7A3268851A2CF7D88B3"
      cert_valid_from     = "2025-03-05"
      cert_valid_to       = "2026-03-05"

      country             = "VN"
      state               = "???"
      locality            = "Hồ Chí Minh"
      email               = "???"
      rdn_serial_number   = "0318798119"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "00:c4:b1:71:67:39:e1:4c:2f:cb:35:d3:9d:49:ac:b9:71"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_010A8D74E727BB24A47EA7FC {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "3f666cd864799da19cda48cd1caa5148965ab3fe31ce438d2be087802c8f04e1"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Fengyan Trading Co., Ltd. In Yanhu District, Yuncheng City"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "01:0a:8d:74:e7:27:bb:24:a4:7e:a7:fc"
      cert_thumbprint     = "50A290527E46E52A550F3C07A0F134C2FD356CE2"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2026-05-10"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Yuncheng"
      email               = "???"
      rdn_serial_number   = "91140802MADALQC44B"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "01:0a:8d:74:e7:27:bb:24:a4:7e:a7:fc"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_1334C4352845314A1151AE35 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-13"
      version             = "1.0"

      hash                = "b63367bd7da5aad9afef5e7531cac4561c8a671fd2270ade14640cf03849bf52"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Shenzhen Zhongxingda Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "13:34:c4:35:28:45:31:4a:11:51:ae:35"
      cert_thumbprint     = "8F3DCF010EE15D5FFD4375F0DF31A23CD18F1944"
      cert_valid_from     = "2024-12-13"
      cert_valid_to       = "2025-12-13"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5H14K805"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "13:34:c4:35:28:45:31:4a:11:51:ae:35"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_18AC896DD6B2EA430E85F68E {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-20"
      version             = "1.0"

      hash                = "48a2c5750eb3d09f1c9b54becc1b261ce4bb659abecc38bd2bd56e5d20845c9d"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "NEXTGENSOFTWARE COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "18:ac:89:6d:d6:b2:ea:43:0e:85:f6:8e"
      cert_thumbprint     = "B105B0EAEC1588C3157DC01245ED46182EEB9BD5"
      cert_valid_from     = "2025-02-20"
      cert_valid_to       = "2026-02-21"

      country             = "VN"
      state               = "Hồ Chí Minh"
      locality            = "Hồ Chí Minh"
      email               = "???"
      rdn_serial_number   = "0318797820"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "18:ac:89:6d:d6:b2:ea:43:0e:85:f6:8e"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_252075025C25BACBAC23B4BA {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-23"
      version             = "1.0"

      hash                = "1df2c7b7ad92ae543ffb68afcd54301be97f070ed2d1a71898812dd8d8a33ae8"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Micro Hat Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "25:20:75:02:5c:25:ba:cb:ac:23:b4:ba"
      cert_thumbprint     = "589D8A29339A343EFE1DAE8E44EDE85B615BE0FA"
      cert_valid_from     = "2024-09-23"
      cert_valid_to       = "2025-09-24"

      country             = "CN"
      state               = "Anhui"
      locality            = "Hefei"
      email               = "???"
      rdn_serial_number   = "91340100083694107X"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "25:20:75:02:5c:25:ba:cb:ac:23:b4:ba"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_290D9001839754E3D50E5295 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "b678637aa881360593e3ec949a55e0536506f50f78b0bfa0909029f3548b8998"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "JSC Unicom"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "29:0d:90:01:83:97:54:e3:d5:0e:52:95"
      cert_thumbprint     = "B9F46FFC12D9D430729445D643730A6D67AFCF08"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-18"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1087746687797"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "29:0d:90:01:83:97:54:e3:d5:0e:52:95"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_2967FD8E4C50B8E2E7A19294 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-10"
      version             = "1.0"

      hash                = "6ec889fc18c8ae7a8531829afb593dc1f87539af9d67e38f3730c216c5a8746b"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "J-Golden Strive Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "29:67:fd:8e:4c:50:b8:e2:e7:a1:92:94"
      cert_thumbprint     = "A3F8CCDF7EA080E45DA1596E035187B0BE47B4A9"
      cert_valid_from     = "2025-04-10"
      cert_valid_to       = "2026-04-11"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510104MA69WBH41P"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "29:67:fd:8e:4c:50:b8:e2:e7:a1:92:94"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_36D5370B083DB9016FC1D1FE {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-15"
      version             = "1.0"

      hash                = "30e6559bc1a972a70d633d9fc00e50e0b369358664d3e41e47123d74eec59b1e"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Yongji Jiecheng Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "36:d5:37:0b:08:3d:b9:01:6f:c1:d1:fe"
      cert_thumbprint     = "9D54D7FEF240079C18A6923BE6A312B7F6D98283"
      cert_valid_from     = "2025-05-15"
      cert_valid_to       = "2026-05-16"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Yuncheng"
      email               = "???"
      rdn_serial_number   = "91140881MAD1DCC017"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "36:d5:37:0b:08:3d:b9:01:6f:c1:d1:fe"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_426CBFFCD566DBCEA4652191 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-26"
      version             = "1.0"

      hash                = "c04e7662421eac7bd7b6a4c7ee6dc114a18fa3504d204db6284fb54a60c0708b"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "REDSTRIKEVN COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "42:6c:bf:fc:d5:66:db:ce:a4:65:21:91"
      cert_thumbprint     = "8962B26B47CA584B1AFDD2734E280D7E8701F2F6"
      cert_valid_from     = "2025-02-26"
      cert_valid_to       = "2026-02-20"

      country             = "VN"
      state               = "Hồ Chí Minh"
      locality            = "Hồ Chí Minh"
      email               = "???"
      rdn_serial_number   = "0318798119"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "42:6c:bf:fc:d5:66:db:ce:a4:65:21:91"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_50A57A36055177255C77BDC6 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-12"
      version             = "1.0"

      hash                = "4e699d74a9ea31ffc96a50110ad6e9d714770b1eedb0323a61826f233161632d"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Shenzhen Zhongxingda Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:a5:7a:36:05:51:77:25:5c:77:bd:c6"
      cert_thumbprint     = "5537AF203DEC357CCD876B8005EB7B88CFF4BEBD"
      cert_valid_from     = "2024-12-12"
      cert_valid_to       = "2025-12-13"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5H14K805"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:a5:7a:36:05:51:77:25:5c:77:bd:c6"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_5BF73255E566E8DF1D295A93 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-13"
      version             = "1.0"

      hash                = "f1c2dd0c85d6605d7d61989661f785c00ff4a8ade3362ccdecf2c80a8f86de13"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Morning Leap & Cazo Electronics Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5b:f7:32:55:e5:66:e8:df:1d:29:5a:93"
      cert_thumbprint     = "DAE0D3EDDBE1F96261E1B561915BACE5B215F2ED"
      cert_valid_from     = "2025-03-13"
      cert_valid_to       = "2026-03-14"

      country             = "CN"
      state               = "Hebei"
      locality            = "Cangzhou"
      email               = "???"
      rdn_serial_number   = "91130922MA0G8AN920"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5b:f7:32:55:e5:66:e8:df:1d:29:5a:93"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_5C6DA215CE8C891D2D08B7CD {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-05"
      version             = "1.0"

      hash                = "ae16f0474664bad045b36fba8ec21a49720baff00804452adecc221153ee993e"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Hebei Duxin Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:6d:a2:15:ce:8c:89:1d:2d:08:b7:cd"
      cert_thumbprint     = "018BB49CAC595A1D1D9560AD7C58F8277FA3043F"
      cert_valid_from     = "2025-03-05"
      cert_valid_to       = "2026-03-06"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130102MA0CK7F521"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:6d:a2:15:ce:8c:89:1d:2d:08:b7:cd"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_609660FCE84EC163C3712C2B {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "356a6878a5aa3d49eff429348020a42d3baf890c3bed0296d5f284f9ba1e8ead"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Gucheng County Sili Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:96:60:fc:e8:4e:c1:63:c3:71:2c:2b"
      cert_thumbprint     = "E66197E595D07735881A7BA8AAA7BDA0F04BD8E8"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2026-06-13"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420625MAD6CQW22H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:96:60:fc:e8:4e:c1:63:c3:71:2c:2b"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_6D855F60232A59021258A63D {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-27"
      version             = "1.0"

      hash                = "8bb49036e0354865d888ee92532b5fa467667b71a2522bc2ea9bf8476be4a088"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Huethem Silicon Electronic Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6d:85:5f:60:23:2a:59:02:12:58:a6:3d"
      cert_thumbprint     = "800B68CDE8472937AA79EC95F98FF2865847C8EA"
      cert_valid_from     = "2025-02-27"
      cert_valid_to       = "2026-02-28"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5FD6WK46"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6d:85:5f:60:23:2a:59:02:12:58:a6:3d"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_GlobalSign_789F918EB4DDBC128EE26C48 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-14"
      version             = "1.0"

      hash                = "05c016653471647aabc0be3d36fe94862290afc0f41a348db031763a5d8d6f46"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Meizhou Fisherman Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "78:9f:91:8e:b4:dd:bc:12:8e:e2:6c:48"
      cert_thumbprint     = "1CDF48EA9702F84214346FD42BF4392D02199006"
      cert_valid_from     = "2025-05-14"
      cert_valid_to       = "2026-05-15"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Meizhou"
      email               = "???"
      rdn_serial_number   = "91441403MA4UNLKT9A"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "78:9f:91:8e:b4:dd:bc:12:8e:e2:6c:48"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_Microsoft_3300021FFB7A57E64367C9F45A000000021FFB {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-18"
      version             = "1.0"

      hash                = "53e16a1e81d087bd93345f55f29a0cc4fd3e665023ccc708eef696e0ecb56452"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "益林 陈"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:1f:fb:7a:57:e6:43:67:c9:f4:5a:00:00:00:02:1f:fb"
      cert_thumbprint     = "1858EDFE08C5F267DE706CB298DB26BCD57B400A"
      cert_valid_from     = "2025-03-18"
      cert_valid_to       = "2025-03-21"

      country             = "CN"
      state               = "Anhui"
      locality            = "安庆市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:1f:fb:7a:57:e6:43:67:c9:f4:5a:00:00:00:02:1f:fb"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_Microsoft_33000306F23A9C36B302A577A30000000306F2 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-19"
      version             = "1.0"

      hash                = "2240ccae318ec18f421d7b539b610abcda114edcd60e4da96e8ca7e502d9f6bd"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "红火 罗"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:03:06:f2:3a:9c:36:b3:02:a5:77:a3:00:00:00:03:06:f2"
      cert_thumbprint     = "5B916BEF4113A6922213C52AE77A96676F23FEB2"
      cert_valid_from     = "2025-03-19"
      cert_valid_to       = "2025-03-22"

      country             = "CN"
      state               = "Yunnan"
      locality            = "昭通市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:03:06:f2:3a:9c:36:b3:02:a5:77:a3:00:00:00:03:06:f2"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_15460441B271C3759342B930975B90DA {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-28"
      version             = "1.0"

      hash                = "2c7dc1696cb982fa8a08422bc8553babad118cb4e2acb9ae714cf567c7c09c67"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Federico Fiorini Digital Services Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:46:04:41:b2:71:c3:75:93:42:b9:30:97:5b:90:da"
      cert_thumbprint     = "26891379A65424914C8FD5B661BE0EA0F3CE229E"
      cert_valid_from     = "2025-04-28"
      cert_valid_to       = "2026-04-28"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "3254215-4"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:46:04:41:b2:71:c3:75:93:42:b9:30:97:5b:90:da"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_1C3FAED5780BD79FE1FE47DEA8E2FF6C {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-18"
      version             = "1.0"

      hash                = "67d9a42df044f1bec25fa3fd0f69ea6ba675c9289ff4a7e16c9fa470f1f69257"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Love IT Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1c:3f:ae:d5:78:0b:d7:9f:e1:fe:47:de:a8:e2:ff:6c"
      cert_thumbprint     = "52468B310485AC58CFE6CD717F409314884C0EF7"
      cert_valid_from     = "2025-04-18"
      cert_valid_to       = "2026-04-18"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Vantaa"
      email               = "???"
      rdn_serial_number   = "2960500-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1c:3f:ae:d5:78:0b:d7:9f:e1:fe:47:de:a8:e2:ff:6c"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_2A11B2B3582663E2EE4716C8656F5135 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-28"
      version             = "1.0"

      hash                = "ffb7bb2d46fc715cb14689b618389c818452901372e79edd905d534c9a4f6a32"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Love IT Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2a:11:b2:b3:58:26:63:e2:ee:47:16:c8:65:6f:51:35"
      cert_thumbprint     = "51B029D29CCAF3441CD99FE074743E8A2FA4EB77"
      cert_valid_from     = "2025-04-28"
      cert_valid_to       = "2026-04-18"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Vantaa"
      email               = "???"
      rdn_serial_number   = "2960500-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2a:11:b2:b3:58:26:63:e2:ee:47:16:c8:65:6f:51:35"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_56F6A688C743831312A4A80A6899DA37 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-30"
      version             = "1.0"

      hash                = "ad89d781f68ee9b76c6ec279611e27317d45815b4f93fe496f136e9f40b4dc0b"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Love IT Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "56:f6:a6:88:c7:43:83:13:12:a4:a8:0a:68:99:da:37"
      cert_thumbprint     = "04D6C33D56249BBC30CFCA153AA719793B227148"
      cert_valid_from     = "2025-04-30"
      cert_valid_to       = "2026-04-18"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Vantaa"
      email               = "???"
      rdn_serial_number   = "2960500-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "56:f6:a6:88:c7:43:83:13:12:a4:a8:0a:68:99:da:37"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_65DC74FC2995EC9FE2D2E7A616CFE915 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-12"
      version             = "1.0"

      hash                = "11c7f91ea98a308d0bedc982e2074b799ea83fdb09f3a8c4c7b5292eaeedae32"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "It Go Pro SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "65:dc:74:fc:29:95:ec:9f:e2:d2:e7:a6:16:cf:e9:15"
      cert_thumbprint     = "58DD911EBB1DF8A945590523BEB60277CEC17517"
      cert_valid_from     = "2025-05-12"
      cert_valid_to       = "2026-05-12"

      country             = "PL"
      state               = "Województwo śląskie"
      locality            = "Katowice"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "65:dc:74:fc:29:95:ec:9f:e2:d2:e7:a6:16:cf:e9:15"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_69E19C9125EEC7D62AE596F91F08D559 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-03"
      version             = "1.0"

      hash                = "dd71f68cb9ea204e3f6af6661fe23a8e3dda40fa4bf968d6f0907566eb45128a"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "NEXTGENSOFTWARE COMPANY LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "69:e1:9c:91:25:ee:c7:d6:2a:e5:96:f9:1f:08:d5:59"
      cert_thumbprint     = "F24DEE9816513680373C82FBCC8A351E14B00C7E"
      cert_valid_from     = "2025-04-03"
      cert_valid_to       = "2026-04-03"

      country             = "VN"
      state               = "???"
      locality            = "Ho Chi Minh City"
      email               = "???"
      rdn_serial_number   = "0318797820"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "69:e1:9c:91:25:ee:c7:d6:2a:e5:96:f9:1f:08:d5:59"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_SSL_com_6D8954760DB07FE5C98453EC01214054 {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "68af982a554ee0293d98e7b3bbc8bfd2d1c472a5736bd1045ce75d08554aa778"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "PBT IT LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6d:89:54:76:0d:b0:7f:e5:c9:84:53:ec:01:21:40:54"
      cert_thumbprint     = "15DF176B9F9CE31AB237F39AC625FC2B89935DF5"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2026-06-03"

      country             = "NZ"
      state               = "Auckland Region"
      locality            = "Auckland"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6d:89:54:76:0d:b0:7f:e5:c9:84:53:ec:01:21:40:54"
      )
}

rule MAL_Compromised_Cert_Crazy_Evil_Traffer_Team_Sectigo_00EF5A23A24B787CDD7A1CF590238E4DED {
   meta:
      description         = "Detects Crazy Evil Traffer Team with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-09"
      version             = "1.0"

      hash                = "992998cd7083f73bb8fa0adbeb1c2f0564a887670d8fb986943dafd3f7278d0f"
      malware             = "Crazy Evil Traffer Team"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Redstrikevn Company Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:ef:5a:23:a2:4b:78:7c:dd:7a:1c:f5:90:23:8e:4d:ed"
      cert_thumbprint     = "F4702F1327F5F19EB94C6868659765CC073192B2"
      cert_valid_from     = "2025-02-09"
      cert_valid_to       = "2026-01-16"

      country             = "VN"
      state               = "Ho Chi Minh"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "0318798119"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:ef:5a:23:a2:4b:78:7c:dd:7a:1c:f5:90:23:8e:4d:ed"
      )
}

rule MAL_Compromised_Cert_CryptoWalletChromeExtension_GlobalSign_382D0BDD4B9AB0C19F034D2C {
   meta:
      description         = "Detects CryptoWalletChromeExtension with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-13"
      version             = "1.0"

      hash                = "7a019835c112d203329039c22db86f1c6c355fdacad6e7d7525e6f475dcd0d70"
      malware             = "CryptoWalletChromeExtension"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OLAN LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:2d:0b:dd:4b:9a:b0:c1:9f:03:4d:2c"
      cert_thumbprint     = "89023183222F27A7A8D65164ED63E53ABD32E68B"
      cert_valid_from     = "2025-08-13"
      cert_valid_to       = "2026-06-24"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:2d:0b:dd:4b:9a:b0:c1:9f:03:4d:2c"
      )
}

rule MAL_Compromised_Cert_CrystalPDF_Trojan_productivity_tool_GlobalSign_032A466477D8C628044FD4B6 {
   meta:
      description         = "Detects CrystalPDF,Trojan productivity tool with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-26"
      version             = "1.0"

      hash                = "598da788600747cf3fa1f25cb4fa1e029eca1442316709c137690e645a0872bb"
      malware             = "CrystalPDF,Trojan productivity tool"
      malware_type        = "Browser Hijacker"
      malware_notes       = "This software uses obfuscated code to interact with the user's browsers and load unwanted content: https://xcancel.com/struppigel/status/1977691895250772086?s=20"

      signer              = "VAST LAKE LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "03:2a:46:64:77:d8:c6:28:04:4f:d4:b6"
      cert_thumbprint     = "6CDFE03C52808412F8EB6494C5C4DDCE4878DCC8"
      cert_valid_from     = "2025-06-26"
      cert_valid_to       = "2026-06-27"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Herzliya"
      email               = "support@gotovastlake.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "03:2a:46:64:77:d8:c6:28:04:4f:d4:b6"
      )
}

rule MAL_Compromised_Cert_CrystalPDF_Trojan_productivity_tool_GlobalSign_56ED9A94B87A7231B56F6A02 {
   meta:
      description         = "Detects CrystalPDF, Trojan productivity tool with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-19"
      version             = "1.0"

      hash                = "ac4119cfabf9d29b68ddacb0efdfe9ce555fc0569327e102094a45a6c1cf23cb"
      malware             = "CrystalPDF, Trojan productivity tool"
      malware_type        = "Browser Hijacker"
      malware_notes       = "This software uses obfuscated code to interact with the user's browsers and load unwanted content: https://xcancel.com/struppigel/status/1977691895250772086?s=20"

      signer              = "LONG SOUND LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:ed:9a:94:b8:7a:72:31:b5:6f:6a:02"
      cert_thumbprint     = "ECE7440C53C235E5E69E57EACB9250154AF20DE0"
      cert_valid_from     = "2024-09-19"
      cert_valid_to       = "2025-09-20"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "support@longsoundltd.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:ed:9a:94:b8:7a:72:31:b5:6f:6a:02"
      )
}

rule MAL_Compromised_Cert_D3F_cKLoader_SSL_com_1D84AEF0C4EF73EEC7B2794EE51BD73F {
   meta:
      description         = "Detects D3F@cKLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-16"
      version             = "1.0"

      hash                = "e05f1e1b6bdef06093a10a0f08f7f2d8569a74d3f194112a5553feddb350ef79"
      malware             = "D3F@cKLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "MAD PANDA LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1d:84:ae:f0:c4:ef:73:ee:c7:b2:79:4e:e5:1b:d7:3f"
      cert_thumbprint     = "977A8331DCC4C0B37CA7EF6DB4B5B865DE16A989"
      cert_valid_from     = "2024-07-16"
      cert_valid_to       = "2025-07-16"

      country             = "GB"
      state               = "???"
      locality            = "Cobham"
      email               = "???"
      rdn_serial_number   = "12535189"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1d:84:ae:f0:c4:ef:73:ee:c7:b2:79:4e:e5:1b:d7:3f"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_Certum_3A8AE46D9DE62F166EB621649B6A6E2E {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-19"
      version             = "1.0"

      hash                = "125b397a627f37c70e2cf2461c6a6583a975ba78617995751cacb32525a3b875"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Taelos Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "3a:8a:e4:6d:9d:e6:2f:16:6e:b6:21:64:9b:6a:6e:2e"
      cert_thumbprint     = "32A6FB73AE60BDC0287701BD75DC26881F8E2036"
      cert_valid_from     = "2024-06-19"
      cert_valid_to       = "2025-06-19"

      country             = "GB"
      state               = "???"
      locality            = "Hove"
      email               = "???"
      rdn_serial_number   = "12106360"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "3a:8a:e4:6d:9d:e6:2f:16:6e:b6:21:64:9b:6a:6e:2e"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_GlobalSign_496D920DA43B2EBA710E135F {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-23"
      version             = "1.0"

      hash                = "47470a874bcccca211f495e49db5b726f200ebd80fea3fc18b0ae7b059452fb6"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "LLC Kama lubricant company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:6d:92:0d:a4:3b:2e:ba:71:0e:13:5f"
      cert_thumbprint     = "886B9AF7AFAB9006FA8D14ACB69431372273B11F"
      cert_valid_from     = "2024-01-23"
      cert_valid_to       = "2025-01-23"

      country             = "RU"
      state               = "Republic of Tatarstan"
      locality            = "Biklyan"
      email               = "kamtranscomp@gmail.com"
      rdn_serial_number   = "1111682000176"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:6d:92:0d:a4:3b:2e:ba:71:0e:13:5f"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_GlobalSign_6EF9C1E8363D7C4C98C274C1 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-14"
      version             = "1.0"

      hash                = "3a157e439b3c4601463022f2165358ebfc9f80dd2d33c9a6afc5467c3f858567"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "LLC Laion"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6e:f9:c1:e8:36:3d:7c:4c:98:c2:74:c1"
      cert_thumbprint     = "67F7B364DB53E7B45EF28E9AD16FA16D7625EFF1"
      cert_valid_from     = "2024-06-14"
      cert_valid_to       = "2025-06-15"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1237700901569"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6e:f9:c1:e8:36:3d:7c:4c:98:c2:74:c1"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_0FF89952DE8FDAF149D86308829F12EE {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-12"
      version             = "1.0"

      hash                = "964d609b0fcf5ade742e9e6fe504bdfbe131b84f3cbab5ed59e977bd4036f405"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Ayog Tech Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0f:f8:99:52:de:8f:da:f1:49:d8:63:08:82:9f:12:ee"
      cert_thumbprint     = "FC4535994E75B0DC4820C8EB258298986FBD8945"
      cert_valid_from     = "2024-04-12"
      cert_valid_to       = "2025-04-12"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "07389721"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0f:f8:99:52:de:8f:da:f1:49:d8:63:08:82:9f:12:ee"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_12697443E6FE59C5E187059F7161B615 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-12"
      version             = "1.0"

      hash                = "7ef83d9bbc288d5140ba999cbb7f65c7c2b25c0120bc7a7a2f0fa93bf8f86b97"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Neural Code Technologies Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "12:69:74:43:e6:fe:59:c5:e1:87:05:9f:71:61:b6:15"
      cert_thumbprint     = "65DBAEEF00FC82E957E01D7B37502C0B73EADE31"
      cert_valid_from     = "2024-04-12"
      cert_valid_to       = "2025-04-12"

      country             = "CA"
      state               = "Ontario"
      locality            = "Whitby"
      email               = "???"
      rdn_serial_number   = "1011671-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "12:69:74:43:e6:fe:59:c5:e1:87:05:9f:71:61:b6:15"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_1595F609B85F702108D66F78373A8C1F {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-10"
      version             = "1.0"

      hash                = "c6bb166294257e53d0d4b9ef6fe362c8cbacef5ec2bd26f98c6d7043284dec73"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Stradgate Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:95:f6:09:b8:5f:70:21:08:d6:6f:78:37:3a:8c:1f"
      cert_thumbprint     = "3B9A5962CD3A79E3801C47D1F55785FA34DF473A"
      cert_valid_from     = "2024-09-10"
      cert_valid_to       = "2025-09-10"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "10291410"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:95:f6:09:b8:5f:70:21:08:d6:6f:78:37:3a:8c:1f"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_2C82D1E68B3333CAE38B05E128522A37 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-19"
      version             = "1.0"

      hash                = "0a27e7cbb5ed1aa3e517d4d1d3fa1974409cb3379707853cfa58be4181e24827"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Keeper Systems Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2c:82:d1:e6:8b:33:33:ca:e3:8b:05:e1:28:52:2a:37"
      cert_thumbprint     = "F0BB5D277B6396D23F53813F3D3EF127CD7B3BB9"
      cert_valid_from     = "2024-07-19"
      cert_valid_to       = "2025-07-19"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "12409387"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2c:82:d1:e6:8b:33:33:ca:e3:8b:05:e1:28:52:2a:37"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_3469F7DBCE7DB328DBB07BA35CDBA98A {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-30"
      version             = "1.0"

      hash                = "9b85aaf4d8e2945d735235615611c7bc5215dcb1358565fa2f38c75375cb81b0"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Aheli Consulting Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "34:69:f7:db:ce:7d:b3:28:db:b0:7b:a3:5c:db:a9:8a"
      cert_thumbprint     = "BF238E703FDE9EBA42A6BE99974C53A47F587F8A"
      cert_valid_from     = "2024-03-30"
      cert_valid_to       = "2025-03-30"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "1267891-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "34:69:f7:db:ce:7d:b3:28:db:b0:7b:a3:5c:db:a9:8a"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_3724A8692FD4C9C2ABE250C83FE61A0D {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-16"
      version             = "1.0"

      hash                = "69184f6861718a2d47ca10f0e7b0b9790f46c2bdc50c94ee5050dc5bebfb380f"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "DIGEN LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "37:24:a8:69:2f:d4:c9:c2:ab:e2:50:c8:3f:e6:1a:0d"
      cert_thumbprint     = "905127E4799A152D516273EE79A58DB9CCAAEC87"
      cert_valid_from     = "2024-07-16"
      cert_valid_to       = "2025-07-16"

      country             = "GB"
      state               = "???"
      locality            = "Coventry"
      email               = "???"
      rdn_serial_number   = "12765402"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "37:24:a8:69:2f:d4:c9:c2:ab:e2:50:c8:3f:e6:1a:0d"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_46D8111B3080ACFE06AB32EBB3572A44 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-25"
      version             = "1.0"

      hash                = "9e503796d957d0f00e1d4102a4b7690f679219fb609de4b3343612bb939b1c24"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Appchefs Software Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "46:d8:11:1b:30:80:ac:fe:06:ab:32:eb:b3:57:2a:44"
      cert_thumbprint     = "4D4299F14DC4EE5B58DFE20A5F73F467185A0403"
      cert_valid_from     = "2024-04-25"
      cert_valid_to       = "2025-04-25"

      country             = "CA"
      state               = "Alberta"
      locality            = "Calgary"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "46:d8:11:1b:30:80:ac:fe:06:ab:32:eb:b3:57:2a:44"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_48095E8078225651A5346BE4226D5A74 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-03"
      version             = "1.0"

      hash                = "277a9093786d4cb2dd267ea6e15eaeb22a568bdc72c4ea6d1aa9b355a190d812"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Eleventh Edition Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "48:09:5e:80:78:22:56:51:a5:34:6b:e4:22:6d:5a:74"
      cert_thumbprint     = "8DBB4A47E95F34E8E685BD4B7664D61D0863B278"
      cert_valid_from     = "2024-05-03"
      cert_valid_to       = "2025-05-03"

      country             = "GB"
      state               = "Scotland"
      locality            = "Glasgow"
      email               = "???"
      rdn_serial_number   = "SC646989"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "48:09:5e:80:78:22:56:51:a5:34:6b:e4:22:6d:5a:74"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_4DEBD035CAFE5E73D5C7E0960D450AFD {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-30"
      version             = "1.0"

      hash                = "d04530a24016d143e32bedca60b7d2b6a6ea41acd2b7e7edb29c2221cf166553"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Tenet Tech Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4d:eb:d0:35:ca:fe:5e:73:d5:c7:e0:96:0d:45:0a:fd"
      cert_thumbprint     = "DCA5A873EEE4F19E6884A304D295E969F8EBE5E4"
      cert_valid_from     = "2024-05-30"
      cert_valid_to       = "2025-05-30"

      country             = "GB"
      state               = "???"
      locality            = "Smethwick"
      email               = "???"
      rdn_serial_number   = "12986986"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4d:eb:d0:35:ca:fe:5e:73:d5:c7:e0:96:0d:45:0a:fd"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_5FC048331F8E9572BDA7ABBF8F0CAB0B {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-14"
      version             = "1.0"

      hash                = "0f4262fcff68c06c8d0be7184263135d1dce951b52af8b6010e0dd18fe7f4937"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Primalspeed Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5f:c0:48:33:1f:8e:95:72:bd:a7:ab:bf:8f:0c:ab:0b"
      cert_thumbprint     = "26CF92F790EC122CF6B38887CFDF080A923377F3"
      cert_valid_from     = "2024-03-14"
      cert_valid_to       = "2025-03-14"

      country             = "GB"
      state               = "???"
      locality            = "Hove"
      email               = "???"
      rdn_serial_number   = "07850286"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5f:c0:48:33:1f:8e:95:72:bd:a7:ab:bf:8f:0c:ab:0b"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_6065907A370AC3B27ABA472CD9F7ED3D {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-21"
      version             = "1.0"

      hash                = "30e554562e154d288bcd3eb43897507d58ac410ff47ed75b4edda651c033a64c"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Strategc Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "60:65:90:7a:37:0a:c3:b2:7a:ba:47:2c:d9:f7:ed:3d"
      cert_thumbprint     = "E098218628CF43BB0A0B14ADFD827402B403D9A3"
      cert_valid_from     = "2024-08-21"
      cert_valid_to       = "2025-08-21"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "12011673"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "60:65:90:7a:37:0a:c3:b2:7a:ba:47:2c:d9:f7:ed:3d"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_60FAC7DEA1D94581674A68276485FCC5 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-29"
      version             = "1.0"

      hash                = "ee4012f2a0dfd5a557b244c850b01484f52cda93aaed423398b2ef859d3b907d"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Binary Intellect Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "60:fa:c7:de:a1:d9:45:81:67:4a:68:27:64:85:fc:c5"
      cert_thumbprint     = "A0958D50807E1F6EC11A45A6A0332D9A12E15A25"
      cert_valid_from     = "2024-05-29"
      cert_valid_to       = "2025-05-29"

      country             = "GB"
      state               = "???"
      locality            = "Manchester"
      email               = "???"
      rdn_serial_number   = "12996464"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "60:fa:c7:de:a1:d9:45:81:67:4a:68:27:64:85:fc:c5"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_6DE3B9456FB0428164F6AA5264E8C24D {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-15"
      version             = "1.0"

      hash                = "e257cf8c1fc5332bf81f85408123762457a698709f745da15607dc594742019f"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Dawood It Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6d:e3:b9:45:6f:b0:42:81:64:f6:aa:52:64:e8:c2:4d"
      cert_thumbprint     = "CE30FAED4BB6BA0440970E7F3F341EAE3DA98806"
      cert_valid_from     = "2024-04-15"
      cert_valid_to       = "2025-04-15"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "08765659"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6d:e3:b9:45:6f:b0:42:81:64:f6:aa:52:64:e8:c2:4d"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_71F122B17613E367D58FFCD08DEA6AF4 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-20"
      version             = "1.0"

      hash                = "398b47cfbdba5e8512998a2823d6ab493b3b0ed0cec0c583d0907b9f4e86febb"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Mosak Soft Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "71:f1:22:b1:76:13:e3:67:d5:8f:fc:d0:8d:ea:6a:f4"
      cert_thumbprint     = "320ECD6F82F874CDC0CDD2EAEF8164298E9943F9"
      cert_valid_from     = "2024-08-20"
      cert_valid_to       = "2025-08-20"

      country             = "NZ"
      state               = "Auckland Region"
      locality            = "Auckland"
      email               = "???"
      rdn_serial_number   = "8177681"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "71:f1:22:b1:76:13:e3:67:d5:8f:fc:d0:8d:ea:6a:f4"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_7712F772C44D3360D635863E7414F34B {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-03"
      version             = "1.0"

      hash                = "0b5352660dd555c0ab55ab90020a36b1f34fe9debd312c4649606adab6c957cf"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Jlf Software Development ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "77:12:f7:72:c4:4d:33:60:d6:35:86:3e:74:14:f3:4b"
      cert_thumbprint     = "5662AD9653AF2C8A3FC00043F7EC150F2641C39D"
      cert_valid_from     = "2024-08-03"
      cert_valid_to       = "2025-08-01"

      country             = "DK"
      state               = "Region of Southern Denmark"
      locality            = "Fredericia"
      email               = "???"
      rdn_serial_number   = "39884720"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "77:12:f7:72:c4:4d:33:60:d6:35:86:3e:74:14:f3:4b"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_78A5FDD08C94E7D6BFF0A1B882E88087 {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-25"
      version             = "1.0"

      hash                = "b25005b4361d67a5fb56513b50f59a1995856fbb8de32d5e5dec51f26744220d"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "SEEONEE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "78:a5:fd:d0:8c:94:e7:d6:bf:f0:a1:b8:82:e8:80:87"
      cert_thumbprint     = "F3BF3DACCD411EB9A1207EA86D8B208FB894D0E1"
      cert_valid_from     = "2024-07-25"
      cert_valid_to       = "2025-07-25"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "11949474"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "78:a5:fd:d0:8c:94:e7:d6:bf:f0:a1:b8:82:e8:80:87"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_SSL_com_7A562978D709B11CAC4D6FCBA14954DB {
   meta:
      description         = "Detects D3F@ckLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-10"
      version             = "1.0"

      hash                = "e4799b54d657d4d9c64d49bc936772cdcca6329e05be972d3b1ec6ad08d8f4ea"
      malware             = "D3F@ckLoader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Paul Garner Consulting Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:56:29:78:d7:09:b1:1c:ac:4d:6f:cb:a1:49:54:db"
      cert_thumbprint     = "E019D7719F55161534BB0C37DFFEFF1EF564AC31"
      cert_valid_from     = "2024-09-10"
      cert_valid_to       = "2025-09-10"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "09714891"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:56:29:78:d7:09:b1:1c:ac:4d:6f:cb:a1:49:54:db"
      )
}

rule MAL_Compromised_Cert_D3F_ckLoader_UC_SSL_com_584C7B537ABF0DD673CC35C9CF040E91 {
   meta:
      description         = "Detects D3F@ckLoader - UC with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-03"
      version             = "1.0"

      hash                = "d42d30f58b5b3443212310c7fdebc2f611d5cecc6c1f924d7c948fb1b1c819ea"
      malware             = "D3F@ckLoader - UC"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "Creative Software Services Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "58:4c:7b:53:7a:bf:0d:d6:73:cc:35:c9:cf:04:0e:91"
      cert_thumbprint     = "FC925E894C131D85BEA5EABA92C3460D6CD54935"
      cert_valid_from     = "2024-04-03"
      cert_valid_to       = "2025-04-03"

      country             = "GB"
      state               = "England"
      locality            = "Treeton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "58:4c:7b:53:7a:bf:0d:d6:73:cc:35:c9:cf:04:0e:91"
      )
}

rule MAL_Compromised_Cert_D3F_ckloader_GlobalSign_496D920DA43B2EBA710E135F {
   meta:
      description         = "Detects D3F@ckloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-23"
      version             = "1.0"

      hash                = "844854707c2850cc3af77ab2848cabc0fa5dbb7800a12fb7f01e87d5d1fa0122"
      malware             = "D3F@ckloader"
      malware_type        = "Loader"
      malware_notes       = "This malware as sold was part of a service: it included both the loader and a code-signing certificate. See this for more details: https://www.esentire.com/blog/exploring-the-d3f-ck-malware-as-a-service-loader"

      signer              = "LLC Kama lubricant company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:6d:92:0d:a4:3b:2e:ba:71:0e:13:5f"
      cert_thumbprint     = "886B9AF7AFAB9006FA8D14ACB69431372273B11F"
      cert_valid_from     = "2024-01-23"
      cert_valid_to       = "2025-01-23"

      country             = "RU"
      state               = "Republic of Tatarstan"
      locality            = "Biklyan"
      email               = "kamtranscomp@gmail.com"
      rdn_serial_number   = "1111682000176"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:6d:92:0d:a4:3b:2e:ba:71:0e:13:5f"
      )
}

rule MAL_Compromised_Cert_DANTEMARKER_Sectigo_00DA2C6AD8E851421A755755068BBEACCB {
   meta:
      description         = "Detects DANTEMARKER with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-20"
      version             = "1.0"

      hash                = "154c223efd649b929ee914902eb5a09ff3567b12422b359af4cc02ce97556481"
      malware             = "DANTEMARKER"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kamiesha Mason"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "00:da:2c:6a:d8:e8:51:42:1a:75:57:55:06:8b:be:ac:cb"
      cert_thumbprint     = "A1E6F174D6CC5F35ABE14E2A599F14BD0BF4D203"
      cert_valid_from     = "2024-05-20"
      cert_valid_to       = "2025-05-20"

      country             = "US"
      state               = "Texas"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "00:da:2c:6a:d8:e8:51:42:1a:75:57:55:06:8b:be:ac:cb"
      )
}

rule MAL_Compromised_Cert_DPRK_Generic_Sectigo_00B7EBC31DF472A506A4234525BD51157C {
   meta:
      description         = "Detects DPRK Generic with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-09"
      version             = "1.0"

      hash                = "77877a13d22fbbdce452791f3015823a3e9b1b48b3cdeb20c118814bfd9072b9"
      malware             = "DPRK Generic"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ezhou Taihaocheng Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b7:eb:c3:1d:f4:72:a5:06:a4:23:45:25:bd:51:15:7c"
      cert_thumbprint     = "79A462C7E6ECE7714E99D600B93A2B4927C13846"
      cert_valid_from     = "2025-06-09"
      cert_valid_to       = "2026-06-09"

      country             = "CN"
      state               = "Hubei Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91420702MAD5FYH837"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b7:eb:c3:1d:f4:72:a5:06:a4:23:45:25:bd:51:15:7c"
      )
}

rule MAL_Compromised_Cert_DPRK_Sectigo_5B60980C0F26A45B97977EFDA5D2074A {
   meta:
      description         = "Detects DPRK with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-15"
      version             = "1.0"

      hash                = "e19ce3bd1cbd980082d3c55a4ac1eb3af4d9e7adf108afb1861372f9c7fe0b76"
      malware             = "DPRK"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DATASOLUTION Inc"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "5b:60:98:0c:0f:26:a4:5b:97:97:7e:fd:a5:d2:07:4a"
      cert_thumbprint     = "37CBD552AA5FE99C92CC92EFF7C8F236D48A0A45"
      cert_valid_from     = "2022-09-15"
      cert_valid_to       = "2025-10-17"

      country             = "KR"
      state               = "Seoul"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "5b:60:98:0c:0f:26:a4:5b:97:97:7e:fd:a5:d2:07:4a"
      )
}

rule MAL_Compromised_Cert_DanaBot_SSL_com_1BF89EAF5641A186BD1C6DDC522963E2 {
   meta:
      description         = "Detects DanaBot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-15"
      version             = "1.0"

      hash                = "91b170eb7a731597174b7a5baaf119534a99eb7f833b7101728967d2deb93a35"
      malware             = "DanaBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangzhou Yizhan Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1b:f8:9e:af:56:41:a1:86:bd:1c:6d:dc:52:29:63:e2"
      cert_thumbprint     = "815C03862D6F134C1742FE8F8E6776AD42CB0AEE"
      cert_valid_from     = "2024-04-15"
      cert_valid_to       = "2025-04-15"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101MA5ATCPC3N"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1b:f8:9e:af:56:41:a1:86:bd:1c:6d:dc:52:29:63:e2"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_0220F9D4796539F89430AF2A2DB6A4FE {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-16"
      version             = "1.0"

      hash                = "3a8f32e6d315e58026ef0e8b91c311cf4cfedd7f71fa1c7e7f7f54f906c45d42"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "DauLue Intention Fly Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "02:20:f9:d4:79:65:39:f8:94:30:af:2a:2d:b6:a4:fe"
      cert_thumbprint     = "8AE22A007A0103E032F4D41F6926F834AE9E1833"
      cert_valid_from     = "2024-04-16"
      cert_valid_to       = "2025-04-16"

      country             = "CN"
      state               = "Liaoning"
      locality            = "Dalian"
      email               = "???"
      rdn_serial_number   = "91210242MA0YGH36XJ"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "02:20:f9:d4:79:65:39:f8:94:30:af:2a:2d:b6:a4:fe"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_108060722A4579EEBE4C2A48FCA17948 {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-19"
      version             = "1.0"

      hash                = "108469e0649650f5d669251708a4380cb89bae61abd5a6b6c08c2168c2c5d40d"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Vieworks Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "10:80:60:72:2a:45:79:ee:be:4c:2a:48:fc:a1:79:48"
      cert_thumbprint     = "BA45CF1EAAC16E6A01B95FA7D4AC3F08D1013950"
      cert_valid_from     = "2024-06-19"
      cert_valid_to       = "2025-06-19"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "11833644"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "10:80:60:72:2a:45:79:ee:be:4c:2a:48:fc:a1:79:48"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_288DA6554EC04E31EB692BD5AA7A6A40 {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-04"
      version             = "1.0"

      hash                = "c4a985bce28d6863102acb148d3b47c6e7abb15875a27d43dcd0b06ca4c29433"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Clicksat Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "28:8d:a6:55:4e:c0:4e:31:eb:69:2b:d5:aa:7a:6a:40"
      cert_thumbprint     = "40857F0C79BA18E6F6EAE4915B4461C8122CC5C2"
      cert_valid_from     = "2024-07-04"
      cert_valid_to       = "2025-07-04"

      country             = "GB"
      state               = "???"
      locality            = "Ilfracombe"
      email               = "???"
      rdn_serial_number   = "12585567"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "28:8d:a6:55:4e:c0:4e:31:eb:69:2b:d5:aa:7a:6a:40"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_42E26C358006ABB45A254E5115B3AD7A {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-20"
      version             = "1.0"

      hash                = "1bc06334849768ebbd7afff675e4e3196984d00c495395ddb9050c8c5f780381"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "INTERREX - SP. Z O.O."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "42:e2:6c:35:80:06:ab:b4:5a:25:4e:51:15:b3:ad:7a"
      cert_thumbprint     = "AC9FD222C4CD5AB74DEE4C9F0D72B4746984F049"
      cert_valid_from     = "2023-10-20"
      cert_valid_to       = "2024-10-19"

      country             = "PL"
      state               = "mazowieckie"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000165162"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "42:e2:6c:35:80:06:ab:b4:5a:25:4e:51:15:b3:ad:7a"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_58C66807FCA8F78EB99DBCDE4AD64CF0 {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-04"
      version             = "1.0"

      hash                = "cf5ae6d4eb9b986c8178740f0948397efb11b95b1c40d8b30ebbbfe36e726e47"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Huzhou Banka Clothing Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "58:c6:68:07:fc:a8:f7:8e:b9:9d:bc:de:4a:d6:4c:f0"
      cert_thumbprint     = "1E2FA1CCE8322BCED8504CB5B5A7BB215BB7E57C"
      cert_valid_from     = "2024-06-04"
      cert_valid_to       = "2025-06-04"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Huzhou"
      email               = "???"
      rdn_serial_number   = "91330502MA2JJNRA84"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "58:c6:68:07:fc:a8:f7:8e:b9:9d:bc:de:4a:d6:4c:f0"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_6DFFAF77D8C06AF0EF1E2A88CFE4360B {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-07"
      version             = "1.0"

      hash                = "2fa83a1f4b3196a87645d4e71c3a486c7eb433ccb462c85888d5a5dee2abe2e2"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Pinchao (Shenzhen) Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6d:ff:af:77:d8:c0:6a:f0:ef:1e:2a:88:cf:e4:36:0b"
      cert_thumbprint     = "443CAD90EB0711571D60B7DF7B1DBC7F97C3DCC2"
      cert_valid_from     = "2024-10-07"
      cert_valid_to       = "2025-10-07"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300596794584L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6d:ff:af:77:d8:c0:6a:f0:ef:1e:2a:88:cf:e4:36:0b"
      )
}

rule MAL_Compromised_Cert_DarkGate_Certum_762823EF38B0B322B5DF2ABDF1A735CC {
   meta:
      description         = "Detects DarkGate with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-20"
      version             = "1.0"

      hash                = "0cfbfec5f04e23ec34ab02788af1d2cb153f8ea45e52a1a16c759ba25ed9d90a"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Shenzhen Julishun Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "76:28:23:ef:38:b0:b3:22:b5:df:2a:bd:f1:a7:35:cc"
      cert_thumbprint     = "3128120C9933BF1FF8422AE0641150E6DC070829"
      cert_valid_from     = "2024-06-20"
      cert_valid_to       = "2025-06-20"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "914403003265237255"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "76:28:23:ef:38:b0:b3:22:b5:df:2a:bd:f1:a7:35:cc"
      )
}

rule MAL_Compromised_Cert_DarkGate_GlobalSign_0AEE6C4FC643B7B43C38160B {
   meta:
      description         = "Detects DarkGate with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "633cbe5aeee1f6ca06e39ace57475ab53f5b5604fd06eb2a4d29d9c428324597"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Inoellact EloubantTech Optimization Information Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0a:ee:6c:4f:c6:43:b7:b4:3c:38:16:0b"
      cert_thumbprint     = "F76DC22EF14C926A7FE5F356C12B205DF79553A5"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2025-01-26"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440605MACRJLFMXL"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0a:ee:6c:4f:c6:43:b7:b4:3c:38:16:0b"
      )
}

rule MAL_Compromised_Cert_DarkGate_GlobalSign_0C458C8F602B5FF0A289C81A {
   meta:
      description         = "Detects DarkGate with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-15"
      version             = "1.0"

      hash                = "e92f111b8aa01289f72c66585219861e0117c9939de56741cbb234fee55536fe"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "BLVS Tech Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:45:8c:8f:60:2b:5f:f0:a2:89:c8:1a"
      cert_thumbprint     = "3A2166A51F50108084B9485FD8B47918A0519DD6"
      cert_valid_from     = "2025-01-15"
      cert_valid_to       = "2026-01-16"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "1122748-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:45:8c:8f:60:2b:5f:f0:a2:89:c8:1a"
      )
}

rule MAL_Compromised_Cert_DarkGate_GlobalSign_34F3E42F122C45100811225D {
   meta:
      description         = "Detects DarkGate with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-15"
      version             = "1.0"

      hash                = "9e4f036dd6fbb45ce414cb5d040b3255b5ccc9ecacbfaf022b631545f9a19a02"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "XUAN THANH CEMENT JOINT STOCK COMPANY"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:f3:e4:2f:12:2c:45:10:08:11:22:5d"
      cert_thumbprint     = "D2BA1F548EB15270386A9D203FCA3A0379A09913"
      cert_valid_from     = "2024-11-15"
      cert_valid_to       = "2025-11-16"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "phandinhtrinh1981@gmail.com"
      rdn_serial_number   = "0700576529"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:f3:e4:2f:12:2c:45:10:08:11:22:5d"
      )
}

rule MAL_Compromised_Cert_DarkGate_GlobalSign_4BC418BDB4B1330B041BE689 {
   meta:
      description         = "Detects DarkGate with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "1ffa8b06cb779360f8c42ccd4527ae3076d25d11b3a90976f04ea430173e9b85"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Technic AS Plus Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4b:c4:18:bd:b4:b1:33:0b:04:1b:e6:89"
      cert_thumbprint     = "F8E657AB86105C880CACACC939661F85E24769AF"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-12-25"

      country             = "CA"
      state               = "Quebec"
      locality            = "Montreal"
      email               = "???"
      rdn_serial_number   = "920816-0"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4b:c4:18:bd:b4:b1:33:0b:04:1b:e6:89"
      )
}

rule MAL_Compromised_Cert_DarkGate_GlobalSign_4FB9E224B7299E07DF40E5A7 {
   meta:
      description         = "Detects DarkGate with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-22"
      version             = "1.0"

      hash                = "0130e9d398cc202f042ac8c8712712950b5e29842993260517a79b983e8f090a"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "PFO GROUP LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4f:b9:e2:24:b7:29:9e:07:df:40:e5:a7"
      cert_thumbprint     = "0D06E3B818564114EE679A11BA15E686D3F4593F"
      cert_valid_from     = "2023-08-22"
      cert_valid_to       = "2024-06-30"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1167746512735"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4f:b9:e2:24:b7:29:9e:07:df:40:e5:a7"
      )
}

rule MAL_Compromised_Cert_DarkGate_GlobalSign_5A06606BEA00A878A7D13ED0 {
   meta:
      description         = "Detects DarkGate with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-01"
      version             = "1.0"

      hash                = "9a3990e375cc3a3a9d6c659b5b5551900dcdc1e7fc8f807f85a951517c8ae96f"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "OptiInnoMind Security Information Tech Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:06:60:6b:ea:00:a8:78:a7:d1:3e:d0"
      cert_thumbprint     = "76F702077DDE4E7C079884CEE32E5628C639509E"
      cert_valid_from     = "2024-02-01"
      cert_valid_to       = "2025-01-31"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440605MACT3UA74D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:06:60:6b:ea:00:a8:78:a7:d1:3e:d0"
      )
}

rule MAL_Compromised_Cert_DarkGate_SSL_com_1D84AEF0C4EF73EEC7B2794EE51BD73F {
   meta:
      description         = "Detects DarkGate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-16"
      version             = "1.0"

      hash                = "648b8a5cbc5ebb60b7e05f5c62c9a107e835343229743aedcf72968868b6dd93"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "MAD PANDA LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1d:84:ae:f0:c4:ef:73:ee:c7:b2:79:4e:e5:1b:d7:3f"
      cert_thumbprint     = "977A8331DCC4C0B37CA7EF6DB4B5B865DE16A989"
      cert_valid_from     = "2024-07-16"
      cert_valid_to       = "2025-07-16"

      country             = "GB"
      state               = "???"
      locality            = "Cobham"
      email               = "???"
      rdn_serial_number   = "12535189"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1d:84:ae:f0:c4:ef:73:ee:c7:b2:79:4e:e5:1b:d7:3f"
      )
}

rule MAL_Compromised_Cert_DarkGate_SSL_com_1D9D011E1B8372FF5B4ED47D1501A4AB {
   meta:
      description         = "Detects DarkGate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-15"
      version             = "1.0"

      hash                = "22f34cc0b56ea1709b3af15b41b43fc40fca2b77debb8400108d3f517ee2ed4a"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "Catapultk Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1d:9d:01:1e:1b:83:72:ff:5b:4e:d4:7d:15:01:a4:ab"
      cert_thumbprint     = "40DB4382B4FCA6706113812737D12828A0BF18D9"
      cert_valid_from     = "2024-04-15"
      cert_valid_to       = "2025-04-15"

      country             = "GB"
      state               = "???"
      locality            = "Boston Spa"
      email               = "???"
      rdn_serial_number   = "08618980"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1d:9d:01:1e:1b:83:72:ff:5b:4e:d4:7d:15:01:a4:ab"
      )
}

rule MAL_Compromised_Cert_DarkGate_SSL_com_255ED3CED2F5A11ADE08DF72BB055B9D {
   meta:
      description         = "Detects DarkGate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-05"
      version             = "1.0"

      hash                = "b79b536569c0060a834e4001289a6700692d67df58e644779fababf0df22fc75"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "AAA CLOTHING LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "25:5e:d3:ce:d2:f5:a1:1a:de:08:df:72:bb:05:5b:9d"
      cert_thumbprint     = "DF4E044C56147E7629B9C7781A5FE88996F91C5D"
      cert_valid_from     = "2023-10-05"
      cert_valid_to       = "2024-10-04"

      country             = "GB"
      state               = "England"
      locality            = "Wellingborough"
      email               = "???"
      rdn_serial_number   = "10260060"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "25:5e:d3:ce:d2:f5:a1:1a:de:08:df:72:bb:05:5b:9d"
      )
}

rule MAL_Compromised_Cert_DarkGate_SSL_com_59F296D0AF649E0962D724248D9FDCDB {
   meta:
      description         = "Detects DarkGate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-28"
      version             = "1.0"

      hash                = "080cee402e284222cef8a3ff10b94a0b364feb5b9047f2babcb6ea0d1e331932"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "MK ZN s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "59:f2:96:d0:af:64:9e:09:62:d7:24:24:8d:9f:dc:db"
      cert_thumbprint     = "0D762B095F6F2BA2DBEB00C5B8E9C93294FAD66F"
      cert_valid_from     = "2023-09-28"
      cert_valid_to       = "2024-09-27"

      country             = "CZ"
      state               = "???"
      locality            = "Brno"
      email               = "???"
      rdn_serial_number   = "049 95 287"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "59:f2:96:d0:af:64:9e:09:62:d7:24:24:8d:9f:dc:db"
      )
}

rule MAL_Compromised_Cert_DarkGate_SSL_com_69DA2EDFD996EA9573C03337EF1BBC1B {
   meta:
      description         = "Detects DarkGate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-21"
      version             = "1.0"

      hash                = "efad7bbcc8ba602d71d3c5ef68d7bcaa7c090dbfff70d3dc64e88131129ccb0a"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "KHAI SON JOINT STOCK COMPANY"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "69:da:2e:df:d9:96:ea:95:73:c0:33:37:ef:1b:bc:1b"
      cert_thumbprint     = "AF0DE6BE7F26D48A0FD62B807460C0B77E68C164"
      cert_valid_from     = "2024-08-21"
      cert_valid_to       = "2025-08-21"

      country             = "VN"
      state               = "Bắc Ninh"
      locality            = "Thuan Thanh Township"
      email               = "???"
      rdn_serial_number   = "2300149170"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "69:da:2e:df:d9:96:ea:95:73:c0:33:37:ef:1b:bc:1b"
      )
}

rule MAL_Compromised_Cert_DarkGate_SSL_com_762BE19F15589A12D79577BEB7DD421E {
   meta:
      description         = "Detects DarkGate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-12"
      version             = "1.0"

      hash                = "4fe8bbc88d7a8cc0eec24bd74951f1f00b5127e3899ae53de8dabd6ff417e6db"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "KDL CENTRAL LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "76:2b:e1:9f:15:58:9a:12:d7:95:77:be:b7:dd:42:1e"
      cert_thumbprint     = "2a279b16102e3dd8989ab8ec37c63eef6780e05b38864a427a50ca0ddeff70c1"
      cert_valid_from     = "2024-12-12"
      cert_valid_to       = "2025-12-12"

      country             = "GB"
      state               = "???"
      locality            = "Bracknell"
      email               = "???"
      rdn_serial_number   = "09105940"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "76:2b:e1:9f:15:58:9a:12:d7:95:77:be:b7:dd:42:1e"
      )
}

rule MAL_Compromised_Cert_DarkGate_Sectigo_6F3442C728DC9E9D63EB5F1EEC64C197 {
   meta:
      description         = "Detects DarkGate with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-04"
      version             = "1.0"

      hash                = "4d4f7a1cb34d5309e1c82e7110209c974a08b3e82eaaf7799d7d9a3a176132ca"
      malware             = "DarkGate"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was known to be multifunctional and evasive. Its main popularity was in 2024 during a period where there were open sales. See this for more information on its functionality: https://www.proofpoint.com/us/blog/email-and-cloud-threats/darkgate-malware"

      signer              = "KusderQounm Venitnet Futurkresl Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "6f:34:42:c7:28:dc:9e:9d:63:eb:5f:1e:ec:64:c1:97"
      cert_thumbprint     = "B52DDB58C551AFEE980F6ADD8F8162BC4E65F837"
      cert_valid_from     = "2024-03-04"
      cert_valid_to       = "2025-03-04"

      country             = "CN"
      state               = "福建省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91350205MA356BHE2L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "6f:34:42:c7:28:dc:9e:9d:63:eb:5f:1e:ec:64:c1:97"
      )
}

rule MAL_Compromised_Cert_DarkHVNC_Sectigo_49D4937BD9DFD9C8EF0DCDE761AE9F01 {
   meta:
      description         = "Detects DarkHVNC with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-22"
      version             = "1.0"

      hash                = "2cc3fa50e3701792b4a42931b452e8c0c112fd34399185d53669455d8aa4bc33"
      malware             = "DarkHVNC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Nuobao Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "49:d4:93:7b:d9:df:d9:c8:ef:0d:cd:e7:61:ae:9f:01"
      cert_thumbprint     = "8F826118157EC949C885180AA14864A8C1FE799A"
      cert_valid_from     = "2025-08-22"
      cert_valid_to       = "2026-08-22"

      country             = "CN"
      state               = "Shanghai Shi"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "49:d4:93:7b:d9:df:d9:c8:ef:0d:cd:e7:61:ae:9f:01"
      )
}

rule MAL_Compromised_Cert_DarkHVNC_Sectigo_621E69731C83FE7658A144646C8F4913 {
   meta:
      description         = "Detects DarkHVNC with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "e9315d756f6c02cf88855e08c10107fa0f2d89e7e9c2620150c20e045f9f2305"
      malware             = "DarkHVNC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuhan Ronghuixiang Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "62:1e:69:73:1c:83:fe:76:58:a1:44:64:6c:8f:49:13"
      cert_thumbprint     = "8841156E3CF719CDC97C2CF19BC4C01BDF97903B"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2026-09-10"

      country             = "CN"
      state               = "Hubei Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "62:1e:69:73:1c:83:fe:76:58:a1:44:64:6c:8f:49:13"
      )
}

rule MAL_Compromised_Cert_DeerStealer_GlobalSign_505F39515DA558182324C2CA {
   meta:
      description         = "Detects DeerStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-16"
      version             = "1.0"

      hash                = "cfb5cb22b2b882d620507a88942a4bfe66fd65082b918b1b9a6699fd56ac5a9d"
      malware             = "DeerStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xingtai Yali Intelligent Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:5f:39:51:5d:a5:58:18:23:24:c2:ca"
      cert_thumbprint     = "F3C09C8B7985B3FC4A4B4AA5789C9BD161BD5EFB"
      cert_valid_from     = "2024-12-16"
      cert_valid_to       = "2025-12-17"

      country             = "CN"
      state               = "Hebei"
      locality            = "Xingtai"
      email               = "???"
      rdn_serial_number   = "91130503MA0G685G99"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:5f:39:51:5d:a5:58:18:23:24:c2:ca"
      )
}

rule MAL_Compromised_Cert_DeerStealer_GlobalSign_5C41DC105016B9996DA5276D {
   meta:
      description         = "Detects DeerStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-08"
      version             = "1.0"

      hash                = "1bfda05df58c8323ce11b46db88f8d96b3355872785c285b0bb277afbde4baea"
      malware             = "DeerStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Qiangwei Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:41:dc:10:50:16:b9:99:6d:a5:27:6d"
      cert_thumbprint     = "58829657EDD0D6DF7A82FB2898539FCE6BD79E75"
      cert_valid_from     = "2025-07-08"
      cert_valid_to       = "2026-07-09"

      country             = "CN"
      state               = "Anhui"
      locality            = "Hefei"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:41:dc:10:50:16:b9:99:6d:a5:27:6d"
      )
}

rule MAL_Compromised_Cert_DeerStealer_Rhadamanthys_GlobalSign_604A5EA370E85C1C3D5B798C {
   meta:
      description         = "Detects DeerStealer, Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-25"
      version             = "1.0"

      hash                = "8a2590c9a17beff4632e5c888cee885f37901a664d21309b8b3b803462b160d7"
      malware             = "DeerStealer, Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "SONETEL LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:4a:5e:a3:70:e8:5c:1c:3d:5b:79:8c"
      cert_thumbprint     = "258a254e0a198ba8f40c1374729d46758c73135c033d0650f8c916ae69b15f43"
      cert_valid_from     = "2025-04-25"
      cert_valid_to       = "2026-03-20"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700047253"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:4a:5e:a3:70:e8:5c:1c:3d:5b:79:8c"
      )
}

rule MAL_Compromised_Cert_Donot_SSL_com_26CCC279DBF534B4D7B205B1A849B8EC {
   meta:
      description         = "Detects Donot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-04"
      version             = "1.0"

      hash                = "4d036e0a517774ba8bd31df522a8d9e327202548a5753e5de068190582758680"
      malware             = "Donot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ebo Sky Tech Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "26:cc:c2:79:db:f5:34:b4:d7:b2:05:b1:a8:49:b8:ec"
      cert_thumbprint     = "EC43D029AC2552E38A27421D30FBE51AE4F09DF2"
      cert_valid_from     = "2024-12-04"
      cert_valid_to       = "2025-12-04"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Vancouver"
      email               = "???"
      rdn_serial_number   = "1136715-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "26:cc:c2:79:db:f5:34:b4:d7:b2:05:b1:a8:49:b8:ec"
      )
}

rule MAL_Compromised_Cert_Donut_Certum_5F0C0D982DA361C93487CC8CC0B806AD {
   meta:
      description         = "Detects Donut with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "48633f12c726c33fee82462f8e229b2fa2c366065dae7fec977feceac97a629f"
      malware             = "Donut"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Jakub Pawłowski"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "5f:0c:0d:98:2d:a3:61:c9:34:87:cc:8c:c0:b8:06:ad"
      cert_thumbprint     = "D63B7C9BEF7075729FAA5AD86C14305A4660FA4E"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2026-07-03"

      country             = "PL"
      state               = "dolnośląskie"
      locality            = "Bogatynia"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "5f:0c:0d:98:2d:a3:61:c9:34:87:cc:8c:c0:b8:06:ad"
      )
}

rule MAL_Compromised_Cert_Donut_SSL_com_01C535271991A4DB65FD3691E04A3512 {
   meta:
      description         = "Detects Donut with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-02"
      version             = "1.0"

      hash                = "93d1f8a756ec37dea2eaabe033f3a28f9d7c7333103e507522cf6492f2ba80b6"
      malware             = "Donut"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CENTRO SOCIAL LUZ DO MUNDO"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "01:c5:35:27:19:91:a4:db:65:fd:36:91:e0:4a:35:12"
      cert_thumbprint     = "1E152A2D0218BC6FF07C379A88C1DBBD5E1F8C63"
      cert_valid_from     = "2025-10-02"
      cert_valid_to       = "2026-10-02"

      country             = "BR"
      state               = "São Paulo"
      locality            = "São Paulo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "01:c5:35:27:19:91:a4:db:65:fd:36:91:e0:4a:35:12"
      )
}

rule MAL_Compromised_Cert_Donut_Sectigo_33177F13BC3A08291AE6B9321800AED5 {
   meta:
      description         = "Detects Donut with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-19"
      version             = "1.0"

      hash                = "fa31ac5d5383a107f45c6ea47d94684517c01b78503560573af3f202524f06be"
      malware             = "Donut"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "55.604.504 Rafael Ferreira de Carvalho"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "33:17:7f:13:bc:3a:08:29:1a:e6:b9:32:18:00:ae:d5"
      cert_thumbprint     = "8DD0D57D77BB142020C571408CAFEBA394084AF0"
      cert_valid_from     = "2025-03-19"
      cert_valid_to       = "2025-10-30"

      country             = "BR"
      state               = "Distrito Federal"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "55.604.504/0001-02"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "33:17:7f:13:bc:3a:08:29:1a:e6:b9:32:18:00:ae:d5"
      )
}

rule MAL_Compromised_Cert_Donut_Sectigo_77344A8C067A2B9BB97938F227B7D39F {
   meta:
      description         = "Detects Donut with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-20"
      version             = "1.0"

      hash                = "a36c0f2d5f32bd3831ec6336820d08c2865a2be3c25a7f3bd599ec9017f19b7d"
      malware             = "Donut"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "55.604.504 Rafael Ferreira de Carvalho"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "77:34:4a:8c:06:7a:2b:9b:b9:79:38:f2:27:b7:d3:9f"
      cert_thumbprint     = "BBED9DEAE08E2CD1302C6A8D98325BC4441066AF"
      cert_valid_from     = "2025-02-20"
      cert_valid_to       = "2025-10-30"

      country             = "BR"
      state               = "Distrito Federal"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "55.604.504/0001-02"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "77:34:4a:8c:06:7a:2b:9b:b9:79:38:f2:27:b7:d3:9f"
      )
}

rule MAL_Compromised_Cert_Dridex_Sectigo_00E573D9C8B403C41BD59FFA0A8EFD4168 {
   meta:
      description         = "Detects Dridex with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-07-15"
      version             = "1.0"

      hash                = "4fccd38f504290cf5c70e7336071a90a064303c7fdf5c17f7c38001768bce115"
      malware             = "Dridex"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VERONIKA 2"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e5:73:d9:c8:b4:03:c4:1b:d5:9f:fa:0a:8e:fd:41:68"
      cert_thumbprint     = "C6B324434D24AF606214A78D9D030F313C1550CF"
      cert_valid_from     = "2019-07-15"
      cert_valid_to       = "2020-06-27"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e5:73:d9:c8:b4:03:c4:1b:d5:9f:fa:0a:8e:fd:41:68"
      )
}

rule MAL_Compromised_Cert_Dridex_Sectigo_3B777165B125BCCC181D0BAC3F5B55B3 {
   meta:
      description         = "Detects Dridex with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-07"
      version             = "1.0"

      hash                = "4a246227c6e8b90ca664792a9d6ced9f1e7c20283891bbb722623ba17aa266de"
      malware             = "Dridex"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "STAND ALONE MUSIC LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "3b:77:71:65:b1:25:bc:cc:18:1d:0b:ac:3f:5b:55:b3"
      cert_thumbprint     = "A5887C72B22F81884E714EDEC711E52FDC60EA37"
      cert_valid_from     = "2020-12-07"
      cert_valid_to       = "2021-12-07"

      country             = "GB"
      state               = "???"
      locality            = "LONDON"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "3b:77:71:65:b1:25:bc:cc:18:1d:0b:ac:3f:5b:55:b3"
      )
}

rule MAL_Compromised_Cert_DuckTail_Entrust_1B59FEA3A77A45F4EF50215669617D38 {
   meta:
      description         = "Detects DuckTail with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-06"
      version             = "1.0"

      hash                = "bc6a58eb83fbefa0d895103e36d53dc6b5178db7ce7576bdba5e5d725acbe34a"
      malware             = "DuckTail"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CONG TY TNHH THUONG MAI DICH VU HP INTERNATIONAL"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "1b:59:fe:a3:a7:7a:45:f4:ef:50:21:56:69:61:7d:38"
      cert_thumbprint     = "BAC9068C9A92697EB8252E2436D222414FDD6067"
      cert_valid_from     = "2023-11-06"
      cert_valid_to       = "2024-11-06"

      country             = "VN"
      state               = "???"
      locality            = "Ho Chi Minh"
      email               = "???"
      rdn_serial_number   = "0317716787"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "1b:59:fe:a3:a7:7a:45:f4:ef:50:21:56:69:61:7d:38"
      )
}

rule MAL_Compromised_Cert_Easy2Convert_FakePDFEditor_GlobalSign_0A6047DEA944141527D85E24 {
   meta:
      description         = "Detects Easy2Convert_FakePDFEditor with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-01"
      version             = "1.0"

      hash                = "27262f4bf8096f04e53309d4ce603cfbeb27ed10abdf1c461d3ccb14e012f61e"
      malware             = "Easy2Convert_FakePDFEditor"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BLUE TAKIN LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0a:60:47:de:a9:44:14:15:27:d8:5e:24"
      cert_thumbprint     = "A6BD7B323D3135E4F13F5C198EA23163D622B538"
      cert_valid_from     = "2025-04-01"
      cert_valid_to       = "2026-04-02"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Tel Aviv"
      email               = "support@bluetakin.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0a:60:47:de:a9:44:14:15:27:d8:5e:24"
      )
}

rule MAL_Compromised_Cert_Eclipse_Traffer_Team_SSL_com_43F983BDCA260C253FB332394352C5F6 {
   meta:
      description         = "Detects Eclipse Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "deef7b287e2b5d2cc1e22366eedee09031fca511ab0741a341f40dc82ba74453"
      malware             = "Eclipse Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DEAL STANDART SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "43:f9:83:bd:ca:26:0c:25:3f:b3:32:39:43:52:c5:f6"
      cert_thumbprint     = "F62D1202AB28201D22399F83BD0DAFC8A8D2F37B"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-07-30"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "43:f9:83:bd:ca:26:0c:25:3f:b3:32:39:43:52:c5:f6"
      )
}

rule MAL_Compromised_Cert_Eclipse_Traffer_Team_Sectigo_37096C9EEE8EDCF3BA06CC908FC70F60 {
   meta:
      description         = "Detects Eclipse Traffer Team with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "4a7d04140e18629886c596b6d558164f172ce1a01511102b956e93c799c4959a"
      malware             = "Eclipse Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Zhouzuan Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "37:09:6c:9e:ee:8e:dc:f3:ba:06:cc:90:8f:c7:0f:60"
      cert_thumbprint     = "5DC8B507DC5A29D7CE4162D77592131EE05BB404"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2026-09-10"

      country             = "CN"
      state               = "Anhui Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "37:09:6c:9e:ee:8e:dc:f3:ba:06:cc:90:8f:c7:0f:60"
      )
}

rule MAL_Compromised_Cert_ElysiumStealer_Sectigo_6AAA62208A3A78BFAC1443007D031E61 {
   meta:
      description         = "Detects ElysiumStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-17"
      version             = "1.0"

      hash                = "f1a3ae71cced897b8a70543e3c5ee2ef093c6e3e3999801889a66d3235ea8569"
      malware             = "ElysiumStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Solar LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "6a:aa:62:20:8a:3a:78:bf:ac:14:43:00:7d:03:1e:61"
      cert_thumbprint     = "AC28A02E0EA20A35F60CF431542C471C0FA48A06"
      cert_valid_from     = "2020-12-17"
      cert_valid_to       = "2021-12-17"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "6a:aa:62:20:8a:3a:78:bf:ac:14:43:00:7d:03:1e:61"
      )
}

rule MAL_Compromised_Cert_FEEDFACE_GlobalSign_319A56CABCD2B8E24FAC13F2 {
   meta:
      description         = "Detects FEEDFACE with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-11"
      version             = "1.0"

      hash                = "166aa6eb2da5e895d133391a36281a3d8b917b4a96265f7f8f9da3d76ca1f528"
      malware             = "FEEDFACE"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "湘西经开区麟尤电子商务有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "31:9a:56:ca:bc:d2:b8:e2:4f:ac:13:f2"
      cert_thumbprint     = "8D0D36292E244447A6CA5C08AFE8D5D5766A69CB"
      cert_valid_from     = "2024-06-11"
      cert_valid_to       = "2025-06-12"

      country             = "CN"
      state               = "Hunan"
      locality            = "Xiangxi"
      email               = "???"
      rdn_serial_number   = "91433101MADJXRK258"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "31:9a:56:ca:bc:d2:b8:e2:4f:ac:13:f2"
      )
}

rule MAL_Compromised_Cert_FakeAIApp_Sectigo_59794F360FE3921612C9697D5E7D0756 {
   meta:
      description         = "Detects FakeAIApp with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-08"
      version             = "1.0"

      hash                = "574f83a420f60ba9b94e03c8f1c1c3afb2de975ef181d02dcc68d3ed41a49133"
      malware             = "FakeAIApp"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Qiangwei Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "59:79:4f:36:0f:e3:92:16:12:c9:69:7d:5e:7d:07:56"
      cert_thumbprint     = "17BEFB4F12AB4138D2D7970FDC4110A047ABF701"
      cert_valid_from     = "2025-08-08"
      cert_valid_to       = "2026-08-08"

      country             = "CN"
      state               = "Anhui Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "59:79:4f:36:0f:e3:92:16:12:c9:69:7d:5e:7d:07:56"
      )
}

rule MAL_Compromised_Cert_FakeAITrading_Sectigo_009E4FD3EDA695BDECB946493D67665410 {
   meta:
      description         = "Detects FakeAITrading with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-08"
      version             = "1.0"

      hash                = "98da8634c17e724d7d457126dce1149c75c27bf08ea1bc7d34b5e77cc9f0205a"
      malware             = "FakeAITrading"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "海口市勤莱佳科技有限公司"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:9e:4f:d3:ed:a6:95:bd:ec:b9:46:49:3d:67:66:54:10"
      cert_thumbprint     = "2C13C76F10DDB1BBAA1DAA6E06EA2A977B924877"
      cert_valid_from     = "2025-04-08"
      cert_valid_to       = "2026-04-08"

      country             = "CN"
      state               = "海南省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:9e:4f:d3:ed:a6:95:bd:ec:b9:46:49:3d:67:66:54:10"
      )
}

rule MAL_Compromised_Cert_FakeAITrading_Sectigo_00E5223053369C9DECFB9E00520D2C0E11 {
   meta:
      description         = "Detects FakeAITrading with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "9bced85d047b39994ad10094d74b18322f0fd51517e3ca2d6c2a069fe46ab149"
      malware             = "FakeAITrading"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiyuan Leweiqu E-commerce Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:e5:22:30:53:36:9c:9d:ec:fb:9e:00:52:0d:2c:0e:11"
      cert_thumbprint     = "4A9BD948924E7E67AF8A268CFAA3CA36CDECD675"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2026-06-12"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = ""
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:e5:22:30:53:36:9c:9d:ec:fb:9e:00:52:0d:2c:0e:11"
      )
}

rule MAL_Compromised_Cert_FakeAcrobe_GlobalSign_0B6145FD229B0FA8229B8BB3 {
   meta:
      description         = "Detects FakeAcrobe with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-10"
      version             = "1.0"

      hash                = "e9f2e382c45d3de8228e87c2ec1254c3d71eeae82d53eec58101e9ce5e8cb088"
      malware             = "FakeAcrobe"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Lotion"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0b:61:45:fd:22:9b:0f:a8:22:9b:8b:b3"
      cert_thumbprint     = "166D6B4CDBFFF2F6F937E3C6939DAFB666AFA0BF"
      cert_valid_from     = "2025-07-10"
      cert_valid_to       = "2026-07-11"

      country             = "RU"
      state               = "Vologda Oblast"
      locality            = "Vologda"
      email               = "oleg-babin@internet.ru"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0b:61:45:fd:22:9b:0f:a8:22:9b:8b:b3"
      )
}

rule MAL_Compromised_Cert_FakeAdvContracts_SSL_com_15BD0846113B7B1724F6F88C5220BC5F {
   meta:
      description         = "Detects FakeAdvContracts with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-08"
      version             = "1.0"

      hash                = "e4df8c48cdcf1d0e02dc7c055197bb66b0f310a0a764a7d738d97815af587b05"
      malware             = "FakeAdvContracts"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SELECTVIEW DATA SOLUTIONS SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:bd:08:46:11:3b:7b:17:24:f6:f8:8c:52:20:bc:5f"
      cert_thumbprint     = "BD74EC050FBFF8A8591BC7C0A7A94B72E55EFDCA"
      cert_valid_from     = "2025-08-08"
      cert_valid_to       = "2026-08-08"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:bd:08:46:11:3b:7b:17:24:f6:f8:8c:52:20:bc:5f"
      )
}

rule MAL_Compromised_Cert_FakeAdvContracts_Sectigo_5B9B4589D3EDFA31087069675198315B {
   meta:
      description         = "Detects FakeAdvContracts with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-07"
      version             = "1.0"

      hash                = "1d8e7397fb4b7c0d1dbc075e452a8c70a27df580f53040726c20e5a0bf0ff4b9"
      malware             = "FakeAdvContracts"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CÔNG TY TNHH QISOFT"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "5b:9b:45:89:d3:ed:fa:31:08:70:69:67:51:98:31:5b"
      cert_thumbprint     = "BAE24FCC35D6332FA9E56E20B140081EC7A2F8CB"
      cert_valid_from     = "2025-06-07"
      cert_valid_to       = "2026-06-07"

      country             = "VN"
      state               = "Bắc Giang"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "5b:9b:45:89:d3:ed:fa:31:08:70:69:67:51:98:31:5b"
      )
}

rule MAL_Compromised_Cert_FakeAdvancedIPScanner_GlobalSign_23CA2FC2A588B52B7D70E96B {
   meta:
      description         = "Detects FakeAdvancedIPScanner with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "05d2d06143d363c1e41546f14c1d99b082402460ba4e8598667614de996d2fbc"
      malware             = "FakeAdvancedIPScanner"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ANVIA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "23:ca:2f:c2:a5:88:b5:2b:7d:70:e9:6b"
      cert_thumbprint     = "6CBC820B354C4712EEB55A8CD8AB6ECCB9BA4D21"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-06-24"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "23:ca:2f:c2:a5:88:b5:2b:7d:70:e9:6b"
      )
}

rule MAL_Compromised_Cert_FakeAdvancedIPScanner_GlobalSign_5C1C54F72BCC4DB6079023BA {
   meta:
      description         = "Detects FakeAdvancedIPScanner with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-20"
      version             = "1.0"

      hash                = "fb38ae3d1d24075b2bf4ec2bf94343a4c136a77ddd7758775808d134e6ec7f40"
      malware             = "FakeAdvancedIPScanner"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NOMAC LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:1c:54:f7:2b:cc:4d:b6:07:90:23:ba"
      cert_thumbprint     = "2C28CC8AFC87E5B059623D8F655DFAA5D1E0274B"
      cert_valid_from     = "2025-08-20"
      cert_valid_to       = "2026-05-20"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:1c:54:f7:2b:cc:4d:b6:07:90:23:ba"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_03FC0BBCD0A7F34E9FD5A4DBCCF9C7F5 {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-30"
      version             = "1.0"

      hash                = "43cc21310beb59713919f022c2e04bb3818de06f069afc24abad47424d1c0b85"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "RRVN Soft Technologies Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "03:fc:0b:bc:d0:a7:f3:4e:9f:d5:a4:db:cc:f9:c7:f5"
      cert_thumbprint     = "B4F05F1D350989E65666340113F7001C94BD11E9"
      cert_valid_from     = "2024-05-30"
      cert_valid_to       = "2025-05-30"

      country             = "GB"
      state               = "England"
      locality            = "Ilford"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "03:fc:0b:bc:d0:a7:f3:4e:9f:d5:a4:db:cc:f9:c7:f5"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_465DC834C3185EF4F0ECF74031134D21 {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "068e030b5144e2e3ec7d6531dc852a20396f9bea66bf0636ac9b9b8406c518a0"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Revington Creative Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "46:5d:c8:34:c3:18:5e:f4:f0:ec:f7:40:31:13:4d:21"
      cert_thumbprint     = "30ECFA55AFA1BE2A3F67B13F16BE98A9C8C86879"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "GB"
      state               = "England"
      locality            = "Folkestone"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "46:5d:c8:34:c3:18:5e:f4:f0:ec:f7:40:31:13:4d:21"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_47EC895C33BBE4A80A3EB1BCBBF6128B {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-18"
      version             = "1.0"

      hash                = "d4c9ee556fda527e59a0431bfa7f4324318ca384001fa0856635c39bae337431"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Emk Consulting Engineers Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "47:ec:89:5c:33:bb:e4:a8:0a:3e:b1:bc:bb:f6:12:8b"
      cert_thumbprint     = "C78EC5CF3C77D1432911A72D9CD017139BF4BA47"
      cert_valid_from     = "2024-05-18"
      cert_valid_to       = "2025-05-18"

      country             = "GB"
      state               = "Northern Ireland"
      locality            = "Londonderry"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "47:ec:89:5c:33:bb:e4:a8:0a:3e:b1:bc:bb:f6:12:8b"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_4AB8356851C98B0F4EE96B813A738AD1 {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "b9cfc08d3e1d8eae9ba814107b196a55c842d43fa27031278e7463ef05d0aef1"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Asper Research Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4a:b8:35:68:51:c9:8b:0f:4e:e9:6b:81:3a:73:8a:d1"
      cert_thumbprint     = "F9EF8652D7AAB03E9FBD929CE8C961A200F91662"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "GB"
      state               = "Scotland"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4a:b8:35:68:51:c9:8b:0f:4e:e9:6b:81:3a:73:8a:d1"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_6F243A754279474D61BC06CA813DC62F {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-30"
      version             = "1.0"

      hash                = "1af98d338a6193914a73a656797d05803b968cee3048176a30abe5b77b1b2362"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Xalibu Consultation Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "6f:24:3a:75:42:79:47:4d:61:bc:06:ca:81:3d:c6:2f"
      cert_thumbprint     = "1DD356A251076D5F1AFEC33531A00F659A025037"
      cert_valid_from     = "2024-05-30"
      cert_valid_to       = "2025-05-30"

      country             = "CA"
      state               = "Quebec"
      locality            = "Saint-Lambert"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "6f:24:3a:75:42:79:47:4d:61:bc:06:ca:81:3d:c6:2f"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_7DBC9D5DE3181ADE787B91C1F6E57E48 {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "89756b6cff919b03e88c1251a46d132723a79866227785a835d7e67ad4123032"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Cloudava Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "7d:bc:9d:5d:e3:18:1a:de:78:7b:91:c1:f6:e5:7e:48"
      cert_thumbprint     = "3DF175D0E8E90DA439BA0D6B790FF41C787AEAFC"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "GB"
      state               = "Middlesex"
      locality            = "Harrow On The Hill"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "7d:bc:9d:5d:e3:18:1a:de:78:7b:91:c1:f6:e5:7e:48"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certificate_SSL_com_7F499BDE31B8E09D7A7395BC8335DCC3 {
   meta:
      description         = "Detects FakeBat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "ef5870488f255bf29b3c25cfa010e543119f2cf417eed6ada09d7e40b69dd52e"
      malware             = "FakeBat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Creative Bees Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "7f:49:9b:de:31:b8:e0:9d:7a:73:95:bc:83:35:dc:c3"
      cert_thumbprint     = "DA677B43EA753A482835C11337DE2F223CE16C18"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "CA"
      state               = "Ontario"
      locality            = "Maple"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "7f:49:9b:de:31:b8:e0:9d:7a:73:95:bc:83:35:dc:c3"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certum_0B4003DD1778E77C7B3230A4962E5558 {
   meta:
      description         = "Detects FakeBat with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-13"
      version             = "1.0"

      hash                = "68b904897bf6a9124c75dec50fc8cb292069491357785f05f667f91096736960"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "ExpoWave Technology OÜ"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "0b:40:03:dd:17:78:e7:7c:7b:32:30:a4:96:2e:55:58"
      cert_thumbprint     = "2FE6D426B391CC9DE6CB57EB9C9E9AC0B61CE857"
      cert_valid_from     = "2023-09-13"
      cert_valid_to       = "2024-09-12"

      country             = "EE"
      state               = "Harju County"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "16812266"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "0b:40:03:dd:17:78:e7:7c:7b:32:30:a4:96:2e:55:58"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certum_22B49BC752F530388C00E5A68FA4A344 {
   meta:
      description         = "Detects FakeBat with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-22"
      version             = "1.0"

      hash                = "e3ad2367d6e1e15a2f937310c4fa798fc33ef3300dd1c4c00785d914fb5bfb80"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Hangzhou Laisi Intelligent Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "22:b4:9b:c7:52:f5:30:38:8c:00:e5:a6:8f:a4:a3:44"
      cert_thumbprint     = "B7962BCBF0953078C35FD5D811CF255018EB26BF"
      cert_valid_from     = "2024-04-22"
      cert_valid_to       = "2025-04-22"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "91330108MA2B16Q83M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "22:b4:9b:c7:52:f5:30:38:8c:00:e5:a6:8f:a4:a3:44"
      )
}

rule MAL_Compromised_Cert_FakeBat_Certum_4A29544A73CF3715B71E1482033FA811 {
   meta:
      description         = "Detects FakeBat with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-25"
      version             = "1.0"

      hash                = "d43aca5bbb482c44ab63300aee957ec5614da9bb82a537edd4805932b1b82b13"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "JJK Software Oy"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "4a:29:54:4a:73:cf:37:15:b7:1e:14:82:03:3f:a8:11"
      cert_thumbprint     = ""
      cert_valid_from     = "2024-11-25"
      cert_valid_to       = "2025-11-25"

      country             = "FI"
      state               = "???"
      locality            = "Espoo"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "4a:29:54:4a:73:cf:37:15:b7:1e:14:82:03:3f:a8:11"
      )
}

rule MAL_Compromised_Cert_FakeBat_GlobalSign_38042383FA6B3AF5B6B1821F {
   meta:
      description         = "Detects FakeBat with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-22"
      version             = "1.0"

      hash                = "2020038974f763287b465795b52cba40e6ed533e8d1b67e690a2c88248e99d34"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "KENSO SOFTWARE sp. z o.o."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:04:23:83:fa:6b:3a:f5:b6:b1:82:1f"
      cert_thumbprint     = "CDFA577CE2EC5E0117967D8F65566030B96349A1"
      cert_valid_from     = "2024-04-22"
      cert_valid_to       = "2025-04-23"

      country             = "PL"
      state               = "Województwo podkarpackie"
      locality            = "Rzeszów"
      email               = "admin@kensosoftware.com"
      rdn_serial_number   = "0000897125"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:04:23:83:fa:6b:3a:f5:b6:b1:82:1f"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_04F9E61FE8FCAFD921A56B23AB262A34 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-05"
      version             = "1.0"

      hash                = "e9aab10f7244a4efdc8946ae994a1155f21412590ba30b5abc9e5a9a69a8542e"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Alto Verde Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "04:f9:e6:1f:e8:fc:af:d9:21:a5:6b:23:ab:26:2a:34"
      cert_thumbprint     = "7A67E5E2027644FA1F74D40711A124B752FA66A6"
      cert_valid_from     = "2023-10-05"
      cert_valid_to       = "2024-10-04"

      country             = "GB"
      state               = "???"
      locality            = "Leicester"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "04:f9:e6:1f:e8:fc:af:d9:21:a5:6b:23:ab:26:2a:34"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_08D1567946272BF2CF666885FAB99E03 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-20"
      version             = "1.0"

      hash                = "eb986a5ea4c7068fadcecc429c133fd501215d422448f95c9b7b1cf158b2f8a6"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Rapport Creative Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "08:d1:56:79:46:27:2b:f2:cf:66:68:85:fa:b9:9e:03"
      cert_thumbprint     = "44A3056EE75B31799D9C74B1956AA3038FA63785"
      cert_valid_from     = "2023-12-20"
      cert_valid_to       = "2024-12-19"

      country             = "GB"
      state               = "???"
      locality            = "Luton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "08:d1:56:79:46:27:2b:f2:cf:66:68:85:fa:b9:9e:03"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_09A5770FFD6135C238D95E7D5B32F034 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "8dc74a08a67d2dd84f2c676b14cc2c6e83f97b87e2a668d9cc3321f7b9a29601"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Apogee Creative Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "09:a5:77:0f:fd:61:35:c2:38:d9:5e:7d:5b:32:f0:34"
      cert_thumbprint     = "2AE6EC4FE575314C176D15B29CBE50DD946D3E9F"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "09:a5:77:0f:fd:61:35:c2:38:d9:5e:7d:5b:32:f0:34"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_0B3C5F51042466CBB5A00EE692614668 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-01"
      version             = "1.0"

      hash                = "aed717381cc8b42276cbbf2d702be4395cebcbecb3b823b3f7ac98dd92bf68dc"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Ordinal Soft Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "0b:3c:5f:51:04:24:66:cb:b5:a0:0e:e6:92:61:46:68"
      cert_thumbprint     = "72BBB1470BDD449901E2A2FD109337B21756C45B"
      cert_valid_from     = "2024-06-01"
      cert_valid_to       = "2025-06-01"

      country             = "GB"
      state               = "???"
      locality            = "West Drayton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "0b:3c:5f:51:04:24:66:cb:b5:a0:0e:e6:92:61:46:68"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_1E1B78894C8C355B5EFAF81B6B3CB051 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-17"
      version             = "1.0"

      hash                = "a2768e6bb920bc9224662c08c7da7d0c09fb2101662a8265a20a27b90140122d"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Futurewest Creative Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "1e:1b:78:89:4c:8c:35:5b:5e:fa:f8:1b:6b:3c:b0:51"
      cert_thumbprint     = "91332F61C65CE008BA9E992003310C0DE175DA15"
      cert_valid_from     = "2024-06-17"
      cert_valid_to       = "2025-06-17"

      country             = "GB"
      state               = "London Borough of Hounslow"
      locality            = "Chiswick"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "1e:1b:78:89:4c:8c:35:5b:5e:fa:f8:1b:6b:3c:b0:51"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_22D2367F46F93A3893E608768BB8F79A {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "5663eb21e88082bedc1545e21cdb25ad17b44bdeca5ca28c359b191d048efc94"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Bealearts Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "22:d2:36:7f:46:f9:3a:38:93:e6:08:76:8b:b8:f7:9a"
      cert_thumbprint     = "5F2F1060CBB416F8DAEA275A2DBB6A8C6877C6F0"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "22:d2:36:7f:46:f9:3a:38:93:e6:08:76:8b:b8:f7:9a"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_24F1C528ACBA226708DC92F692431A2C {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-26"
      version             = "1.0"

      hash                = "c1b0fe35669f425304e005f5839440356276cc20eb1cd6ceb8d0b5e6b1f96f7f"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Greenlight Softwares Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "24:f1:c5:28:ac:ba:22:67:08:dc:92:f6:92:43:1a:2c"
      cert_thumbprint     = "BC442B6500814DBC2BA2120C33409D303189AB82"
      cert_valid_from     = "2024-04-26"
      cert_valid_to       = "2025-04-26"

      country             = "GB"
      state               = "England"
      locality            = "Stanmore"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "24:f1:c5:28:ac:ba:22:67:08:dc:92:f6:92:43:1a:2c"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_2BBB9B7FE942FB6EA60F86D578A64EAD {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-12"
      version             = "1.0"

      hash                = "647012c5141844a860ba474ef3b239a845170e8c4f5631e8cbdc7781dfe468a2"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Dinomike Design Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "2b:bb:9b:7f:e9:42:fb:6e:a6:0f:86:d5:78:a6:4e:ad"
      cert_thumbprint     = "3DEFCB7054AD6C39664013ACE33DAF675DEEB9AB"
      cert_valid_from     = "2024-05-12"
      cert_valid_to       = "2025-05-12"

      country             = "GB"
      state               = "???"
      locality            = "Kettering"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "2b:bb:9b:7f:e9:42:fb:6e:a6:0f:86:d5:78:a6:4e:ad"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_3094CA76D0BF4D5CA3E6F9A29C147E95 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-21"
      version             = "1.0"

      hash                = "df400f2ae6ce76db40d1ed46cd648965658a2417b4b577116b89a9293ba8e385"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Futurity Designs Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "30:94:ca:76:d0:bf:4d:5c:a3:e6:f9:a2:9c:14:7e:95"
      cert_thumbprint     = "D30FAAE824902AB96EA412D28B7D2058E0A607FD"
      cert_valid_from     = "2023-09-21"
      cert_valid_to       = "2024-09-20"

      country             = "GB"
      state               = "???"
      locality            = "Somerton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "30:94:ca:76:d0:bf:4d:5c:a3:e6:f9:a2:9c:14:7e:95"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_31486FA17304A15BD3EF5ABC58FF3D9D {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-21"
      version             = "1.0"

      hash                = "9ed7717cfd1d386e9179d259246e82914406c4481cb116fc24d3c22d5fc0a161"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Survi Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "31:48:6f:a1:73:04:a1:5b:d3:ef:5a:bc:58:ff:3d:9d"
      cert_thumbprint     = "30194B95D2E4F240B40AFD57F7A5AC2EB8DC11EF"
      cert_valid_from     = "2023-09-21"
      cert_valid_to       = "2024-09-20"

      country             = "GB"
      state               = "???"
      locality            = "Newcastle"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "31:48:6f:a1:73:04:a1:5b:d3:ef:5a:bc:58:ff:3d:9d"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_33BDE5F92AC49B0711BA6187CEE1359B {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-14"
      version             = "1.0"

      hash                = "93a005a078dc412b1e24cb5ed30639bb15ca0e8f7d7ce9a3b608b763bdbbc030"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Bloom Develop Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "33:bd:e5:f9:2a:c4:9b:07:11:ba:61:87:ce:e1:35:9b"
      cert_thumbprint     = "D7A5FC29265E7447A27134127AA009C2C6D171B3"
      cert_valid_from     = "2024-05-14"
      cert_valid_to       = "2025-05-14"

      country             = "CA"
      state               = "Ontario"
      locality            = "Richmond Hill"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "33:bd:e5:f9:2a:c4:9b:07:11:ba:61:87:ce:e1:35:9b"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_34A3D0B1D2F8BA5101F9B47B1BCC4B1E {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "e8de3d58f329400152c70f395d4bea2991841a91c3a35a3bec5dfc08a2057078"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Rfrsh Creative Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "34:a3:d0:b1:d2:f8:ba:51:01:f9:b4:7b:1b:cc:4b:1e"
      cert_thumbprint     = "201CD26069D568B0647206AADFBD3793F0C84918"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "CA"
      state               = "Quebec"
      locality            = "Dollard-Des Ormeaux"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "34:a3:d0:b1:d2:f8:ba:51:01:f9:b4:7b:1b:cc:4b:1e"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_383BB880E7ACBA2928D2CBC6AB7BBE5C {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-03"
      version             = "1.0"

      hash                = "900cc09fcdd78ee16eacc91459abf31c088dc0434907390c7329469129dc917e"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Galbreath Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "38:3b:b8:80:e7:ac:ba:29:28:d2:cb:c6:ab:7b:be:5c"
      cert_thumbprint     = "B00982260BAABDBA964EA131411684DDF43DEB1C"
      cert_valid_from     = "2024-05-03"
      cert_valid_to       = "2025-05-03"

      country             = "GB"
      state               = "Scotland"
      locality            = "Linlithgow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "38:3b:b8:80:e7:ac:ba:29:28:d2:cb:c6:ab:7b:be:5c"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_3CCAA910608E55352E5340C47D01A9D8 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-14"
      version             = "1.0"

      hash                = "a236dd959abe6e818b494ebb9559d1e3909d828d32ebc7104bdb47a81982cfa2"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Domum - design s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3c:ca:a9:10:60:8e:55:35:2e:53:40:c4:7d:01:a9:d8"
      cert_thumbprint     = "78383AD96F00C6843126052D391DF597400925EA"
      cert_valid_from     = "2024-09-14"
      cert_valid_to       = "2025-09-14"

      country             = "CZ"
      state               = "Hlavní Mesto Praha"
      locality            = "Žižkov"
      email               = "???"
      rdn_serial_number   = "075 35 465"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3c:ca:a9:10:60:8e:55:35:2e:53:40:c4:7d:01:a9:d8"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_43098196E3855161C52769A0FEEFDBAC {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-18"
      version             = "1.0"

      hash                = "96c4b76ad445db36e273d4bfa23b3e9cb1a30db836d0b0c940d6f8c41b9d81c5"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Fodere Titanium Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "43:09:81:96:e3:85:51:61:c5:27:69:a0:fe:ef:db:ac"
      cert_thumbprint     = "16AFD0940C8FC1A3E0367CAFDFDEADE273AF46D4"
      cert_valid_from     = "2023-09-18"
      cert_valid_to       = "2024-09-17"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "43:09:81:96:e3:85:51:61:c5:27:69:a0:fe:ef:db:ac"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_48A839BE7BEB80384479084EE640DC54 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-13"
      version             = "1.0"

      hash                = "42836bce8422d4faa74f52ff3515c73996a7b8f635d8848242988be677e2c556"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Canis Software Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "48:a8:39:be:7b:eb:80:38:44:79:08:4e:e6:40:dc:54"
      cert_thumbprint     = "44B038A4EFD755EF6B88832D19DFAB2BBBD9237B"
      cert_valid_from     = "2024-05-13"
      cert_valid_to       = "2025-05-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Oakville"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "48:a8:39:be:7b:eb:80:38:44:79:08:4e:e6:40:dc:54"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_4BE22CD193252962EB5F342E7C5F533F {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-20"
      version             = "1.0"

      hash                = "bbc1dd5ce5d7079b77927b72918810e5effe54cdeab042c848b0b20624119f75"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Pehotav Engineering Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4b:e2:2c:d1:93:25:29:62:eb:5f:34:2e:7c:5f:53:3f"
      cert_thumbprint     = "124C66197CBC4DE925E6CC86240F0CD3B74D2F4D"
      cert_valid_from     = "2023-12-20"
      cert_valid_to       = "2024-12-19"

      country             = "GB"
      state               = "???"
      locality            = "Harrow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4b:e2:2c:d1:93:25:29:62:eb:5f:34:2e:7c:5f:53:3f"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_4CFE79222ADA3FEA60BA98EFBE6E44A5 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-03"
      version             = "1.0"

      hash                = "0c2997d95062a86ef9845f7bfd595d476e578db07def8e89ae26614c78a4e025"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Forth View Designs Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4c:fe:79:22:2a:da:3f:ea:60:ba:98:ef:be:6e:44:a5"
      cert_thumbprint     = "A5540F1A24B23406A5B7B98357FFEFCB3B269F44"
      cert_valid_from     = "2024-05-03"
      cert_valid_to       = "2025-05-03"

      country             = "GB"
      state               = "Scotland"
      locality            = "Glasgow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4c:fe:79:22:2a:da:3f:ea:60:ba:98:ef:be:6e:44:a5"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_4D0E13F913C4C8BB5753B53DB46110F0 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-01"
      version             = "1.0"

      hash                = "1f3f3fb0afe19c7c8ce7918c5d1c82be07b17ac346677c84cb5aa5bc9090171b"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Manas Softwares Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4d:0e:13:f9:13:c4:c8:bb:57:53:b5:3d:b4:61:10:f0"
      cert_thumbprint     = "8AB0BE341C5E80501E70775A5CFD24D945595568"
      cert_valid_from     = "2024-05-01"
      cert_valid_to       = "2025-05-01"

      country             = "GB"
      state               = "England"
      locality            = "Slough"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4d:0e:13:f9:13:c4:c8:bb:57:53:b5:3d:b4:61:10:f0"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_54153343A319758492C3771B8717FBFB {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-01"
      version             = "1.0"

      hash                = "d22ef24a4e943d5fb36260ea2e46b046d2d6ce29f725e52167c00bfce0d94bdb"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Beyond Softwares And Consultancy Services Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "54:15:33:43:a3:19:75:84:92:c3:77:1b:87:17:fb:fb"
      cert_thumbprint     = "7E8865A242D35BAF812A5E39851B4497102CBF09"
      cert_valid_from     = "2024-05-01"
      cert_valid_to       = "2025-05-01"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "54:15:33:43:a3:19:75:84:92:c3:77:1b:87:17:fb:fb"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_5499FE809B614A77BA2436132C56B91F {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-11"
      version             = "1.0"

      hash                = "356299531dd96ee5a3567a8a303f0104979f355bbabb50c0cddc6aa18f564b07"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Clachan Design Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "54:99:fe:80:9b:61:4a:77:ba:24:36:13:2c:56:b9:1f"
      cert_thumbprint     = "7D5E2E3C2D29FC941438187AC34567FE1210968A"
      cert_valid_from     = "2024-05-11"
      cert_valid_to       = "2025-05-11"

      country             = "GB"
      state               = "London Borough of Merton"
      locality            = "New Malden"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "54:99:fe:80:9b:61:4a:77:ba:24:36:13:2c:56:b9:1f"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_5556D68E17AD6356D0B6DBEFC087FDE2 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "6ba4231e13c7ca51dbf672e477e633f83ba59e1392b9755c301c14abe35cdf61"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "QRC Holdings Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "55:56:d6:8e:17:ad:63:56:d0:b6:db:ef:c0:87:fd:e2"
      cert_thumbprint     = "F721E4E6A432929134F137AF2727CFA76FDC6826"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2025-01-25"

      country             = "GB"
      state               = "???"
      locality            = "Royston"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "55:56:d6:8e:17:ad:63:56:d0:b6:db:ef:c0:87:fd:e2"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_579B9E221C8CC22FCF33CE826CF3737F {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-09"
      version             = "1.0"

      hash                = "5660d461a24e9a15ecb60891bd725a464f8d9a5d20d07852838604f58ba8ff77"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Lencall Technical Services Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "57:9b:9e:22:1c:8c:c2:2f:cf:33:ce:82:6c:f3:73:7f"
      cert_thumbprint     = "0ECBC9F0E2714A5520621C33781A7EC65805B669"
      cert_valid_from     = "2024-05-09"
      cert_valid_to       = "2025-05-09"

      country             = "GB"
      state               = "Scotland"
      locality            = "Nairn"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "57:9b:9e:22:1c:8c:c2:2f:cf:33:ce:82:6c:f3:73:7f"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_57B80004869FA005EA8D294906B0A37E {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-12"
      version             = "1.0"

      hash                = "924f4ff9847cf14599576551370779a2f3ca1163100b4f71b94f18d9e1446ab9"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Draco Software Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "57:b8:00:04:86:9f:a0:05:ea:8d:29:49:06:b0:a3:7e"
      cert_thumbprint     = "C8212E991BCAF313DF45F1C14C8AAD5EAF27746B"
      cert_valid_from     = "2024-07-12"
      cert_valid_to       = "2025-07-12"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "57:b8:00:04:86:9f:a0:05:ea:8d:29:49:06:b0:a3:7e"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_5AA4B480B9EDB666AE374175B0D70A82 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-07"
      version             = "1.0"

      hash                = "ce33a8aabc0095ee679cb0cbf6e7fb69b50611abfa85533d1daa18d7dcadb2b5"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Fabled Creative Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "5a:a4:b4:80:b9:ed:b6:66:ae:37:41:75:b0:d7:0a:82"
      cert_thumbprint     = "6056787F07F92C123A775057A9F7EB9C8905E1EA"
      cert_valid_from     = "2024-05-07"
      cert_valid_to       = "2025-05-07"

      country             = "GB"
      state               = "Scotland"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "5a:a4:b4:80:b9:ed:b6:66:ae:37:41:75:b0:d7:0a:82"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_5B94F53D8844A4FBB20A82957B117588 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-25"
      version             = "1.0"

      hash                = "12001dd924c265a33f33e33f29ed1bdc05aef8dbbabaa234b5695353649c8b4b"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Black Stone Softwares And Solutions Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "5b:94:f5:3d:88:44:a4:fb:b2:0a:82:95:7b:11:75:88"
      cert_thumbprint     = "23C2F06803C6B4301ADACFD87C99D898C0BB463F"
      cert_valid_from     = "2024-04-25"
      cert_valid_to       = "2025-04-25"

      country             = "GB"
      state               = "England"
      locality            = "Leicester"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "5b:94:f5:3d:88:44:a4:fb:b2:0a:82:95:7b:11:75:88"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_5BEA962268D7A85542AADBA4A9B7FF2D {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "a1464bece4aa329bb639d2d3ff6c7d5d4d349289cd477c86c669975db4824443"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "JMN Rope Access Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "5b:ea:96:22:68:d7:a8:55:42:aa:db:a4:a9:b7:ff:2d"
      cert_thumbprint     = "C4232291AD05DB6C435CD8A727F4DAF0BF6507D4"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2025-01-25"

      country             = "GB"
      state               = "???"
      locality            = "Alnwick"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "5b:ea:96:22:68:d7:a8:55:42:aa:db:a4:a9:b7:ff:2d"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_6BDB08B7DDB773720764005D7E7DED8B {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "5f9557f616ab8c007422a7bf034b75548c73d818fdac84f82ef48b7f26662de6"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Creative Ustawi Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "6b:db:08:b7:dd:b7:73:72:07:64:00:5d:7e:7d:ed:8b"
      cert_thumbprint     = "F65D1315C9B5DABF3BE1CE4F17F5D85E88484013"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "6b:db:08:b7:dd:b7:73:72:07:64:00:5d:7e:7d:ed:8b"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_754F9989D8A8E889539B29BF502FA74B {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-15"
      version             = "1.0"

      hash                = "ad6bcffb161cb9fb0eca2905ca8c4c0365aa4febab6f47acabcbf8b4b75d478c"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Consoneai Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "75:4f:99:89:d8:a8:e8:89:53:9b:29:bf:50:2f:a7:4b"
      cert_thumbprint     = "57AC3537F14B3059FA016FEAA5825FE72704AF2B"
      cert_valid_from     = "2023-12-15"
      cert_valid_to       = "2024-12-13"

      country             = "GB"
      state               = "England"
      locality            = "Wetherby"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "75:4f:99:89:d8:a8:e8:89:53:9b:29:bf:50:2f:a7:4b"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_7BC5EBCE60E231C20CE56703FE461C0C {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-20"
      version             = "1.0"

      hash                = "5d84ec3475fac25a1691b3bc831737b5b3d02454613ccb492de4972432494cf5"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Nja Engineering Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "7b:c5:eb:ce:60:e2:31:c2:0c:e5:67:03:fe:46:1c:0c"
      cert_thumbprint     = "1B2B17BADBFE11858FD56243105EC9429724B6F6"
      cert_valid_from     = "2023-12-20"
      cert_valid_to       = "2024-12-19"

      country             = "GB"
      state               = "???"
      locality            = "Stockport"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "7b:c5:eb:ce:60:e2:31:c2:0c:e5:67:03:fe:46:1c:0c"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_7CE6D17250E006C15A67A0D108B63DA2 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-11"
      version             = "1.0"

      hash                = "fc1060dbded7cacfa2edd46b7c894c4e6757f5a28f096e64392aac85ebbcf8d0"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Datamanage Software Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "7c:e6:d1:72:50:e0:06:c1:5a:67:a0:d1:08:b6:3d:a2"
      cert_thumbprint     = "893C93A879EE8B4F75C01255AC95EADFA17079DB"
      cert_valid_from     = "2024-07-11"
      cert_valid_to       = "2025-07-11"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "7c:e6:d1:72:50:e0:06:c1:5a:67:a0:d1:08:b6:3d:a2"
      )
}

rule MAL_Compromised_Cert_FakeBat_SSL_com_7DBC9D5DE3181ADE787B91C1F6E57E48 {
   meta:
      description         = "Detects FakeBat with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "3e0498a8df55565fb9451043162e844b592e4ee2820b931e878fc07c58222439"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Cloudava Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "7d:bc:9d:5d:e3:18:1a:de:78:7b:91:c1:f6:e5:7e:48"
      cert_thumbprint     = "3DF175D0E8E90DA439BA0D6B790FF41C787AEAFC"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-17"

      country             = "GB"
      state               = "Middlesex"
      locality            = "Harrow On The Hill"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "7d:bc:9d:5d:e3:18:1a:de:78:7b:91:c1:f6:e5:7e:48"
      )
}

rule MAL_Compromised_Cert_FakeBat_Sectigo_5537908F151E7077149B1954A28632B4 {
   meta:
      description         = "Detects FakeBat with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-02-15"
      version             = "1.0"

      hash                = "b0804a60d9992f6af63e247258fae4715816c19a76341f1cd2245fd1385a66f3"
      malware             = "FakeBat"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "ASHANA GLOBAL LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "55:37:90:8f:15:1e:70:77:14:9b:19:54:a2:86:32:b4"
      cert_thumbprint     = "00208976D65AF03024D301306F19C74C3F9EDB22"
      cert_valid_from     = "2023-02-15"
      cert_valid_to       = "2024-02-16"

      country             = "GB"
      state               = "Buckinghamshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "55:37:90:8f:15:1e:70:77:14:9b:19:54:a2:86:32:b4"
      )
}

rule MAL_Compromised_Cert_FakeChromeExtension_GlobalSign_627C9A310E788378C67B53FA {
   meta:
      description         = "Detects FakeChromeExtension with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-08"
      version             = "1.0"

      hash                = "a46036073cb4634c35b928aac84e1b82abc59e7d5f92f552c42ae8217e16508d"
      malware             = "FakeChromeExtension"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC A G M"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "62:7c:9a:31:0e:78:83:78:c6:7b:53:fa"
      cert_thumbprint     = "1F789E01043C7D50986581FE769B0EA8EC95CA53"
      cert_valid_from     = "2025-07-08"
      cert_valid_to       = "2026-07-09"

      country             = "RU"
      state               = "Astrakhan Oblast"
      locality            = "Astrakhan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "62:7c:9a:31:0e:78:83:78:c6:7b:53:fa"
      )
}

rule MAL_Compromised_Cert_FakeChromeUpdate_SSL_com_6C96E1E122F63716AE8C4AD0DC65A6C4 {
   meta:
      description         = "Detects FakeChromeUpdate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-11"
      version             = "1.0"

      hash                = "8ba73ef5cf6267c37326e6565bf457b0fc44e5fa018caad102ae42a420db14e1"
      malware             = "FakeChromeUpdate"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JS IT-konsultointi Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6c:96:e1:e1:22:f6:37:16:ae:8c:4a:d0:dc:65:a6:c4"
      cert_thumbprint     = "52D22621327B99E85755CBC0B4F8B06132057C5F"
      cert_valid_from     = "2025-06-11"
      cert_valid_to       = "2026-06-11"

      country             = "FI"
      state               = "Pirkanmaa"
      locality            = "TAMPERE"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6c:96:e1:e1:22:f6:37:16:ae:8c:4a:d0:dc:65:a6:c4"
      )
}

rule MAL_Compromised_Cert_FakeComplaint_Certum_3E20454C06263BFEC01DB89A30420456 {
   meta:
      description         = "Detects FakeComplaint with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-09"
      version             = "1.0"

      hash                = "ba8dddf8a49390232d39ff8fba7a24d7ec04ec3a44fb205a50c764d691cdcbf5"
      malware             = "FakeComplaint"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuhan Ronghuixiang Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "3e:20:45:4c:06:26:3b:fe:c0:1d:b8:9a:30:42:04:56"
      cert_thumbprint     = "A7E3C8C3BC37AB63B7605BEFB93FC9B22B811684"
      cert_valid_from     = "2025-10-09"
      cert_valid_to       = "2026-10-09"

      country             = "CN"
      state               = "湖北省"
      locality            = "武汉市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "3e:20:45:4c:06:26:3b:fe:c0:1d:b8:9a:30:42:04:56"
      )
}

rule MAL_Compromised_Cert_FakeCursorAI_GlobalSign_6F4DC3F942D3C01E6DE63ED4 {
   meta:
      description         = "Detects FakeCursorAI with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-07"
      version             = "1.0"

      hash                = "653bf569911aeb4ce07dda01aa9402a3df4060487b4e7a040d72e20462a938e1"
      malware             = "FakeCursorAI"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Tekhnicheskoe Snabzhenie"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6f:4d:c3:f9:42:d3:c0:1e:6d:e6:3e:d4"
      cert_thumbprint     = "3C9DDCB42EA7FB6BAA438E9A5CC4723B0FF4C90F"
      cert_valid_from     = "2025-12-07"
      cert_valid_to       = "2026-07-08"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1197746521345"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6f:4d:c3:f9:42:d3:c0:1e:6d:e6:3e:d4"
      )
}

rule MAL_Compromised_Cert_FakeCursorAI_SSL_com_39E13CD290AD5B121B45BAE4C5677380 {
   meta:
      description         = "Detects FakeCursorAI with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "3a040f157773370101bbd9cc9ef296ff28432d9b8611cf640c5726657a9bd606"
      malware             = "FakeCursorAI"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CODE FASHION SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "39:e1:3c:d2:90:ad:5b:12:1b:45:ba:e4:c5:67:73:80"
      cert_thumbprint     = "1DEEBE5AADAF629E65FBE7DAFB39830B0A009BE9"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2026-09-10"

      country             = "PL"
      state               = "Łódź Voivodeship"
      locality            = "Ksawerów"
      email               = "???"
      rdn_serial_number   = "0000848972"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "39:e1:3c:d2:90:ad:5b:12:1b:45:ba:e4:c5:67:73:80"
      )
}

rule MAL_Compromised_Cert_FakeCursorAI_SSL_com_640E69BE1ED44E910A37FFCE16911CE8 {
   meta:
      description         = "Detects FakeCursorAI with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-11"
      version             = "1.0"

      hash                = "d1e661844e46ea11ac9169f7e71253a02db279b6bef4c6ffe144d298ca8db917"
      malware             = "FakeCursorAI"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SUNDAR PARIWAR NIDHI LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "64:0e:69:be:1e:d4:4e:91:0a:37:ff:ce:16:91:1c:e8"
      cert_thumbprint     = "176313C81309D12631E74FE697243F07D0A9C440"
      cert_valid_from     = "2025-09-11"
      cert_valid_to       = "2026-09-10"

      country             = "IN"
      state               = "Bihar"
      locality            = "Begusarai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "64:0e:69:be:1e:d4:4e:91:0a:37:ff:ce:16:91:1c:e8"
      )
}

rule MAL_Compromised_Cert_FakeDocument_Certum_64065DA5F28814E1470536854F7D0162 {
   meta:
      description         = "Detects FakeDocument with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-25"
      version             = "1.0"

      hash                = "d57ad188853f4cee282adcb3672d23906dd42a0e4c3e0cde734c128235644ede"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ionik Software Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "64:06:5d:a5:f2:88:14:e1:47:05:36:85:4f:7d:01:62"
      cert_thumbprint     = "2127820DAF3405488BA2E6330A918EBAD6DE3720"
      cert_valid_from     = "2024-10-25"
      cert_valid_to       = "2025-10-25"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "64:06:5d:a5:f2:88:14:e1:47:05:36:85:4f:7d:01:62"
      )
}

rule MAL_Compromised_Cert_FakeDocument_GlobalSign_2EE2D41E4BD4CD3C3A3CC9B8 {
   meta:
      description         = "Detects FakeDocument with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-17"
      version             = "1.0"

      hash                = "4442e1b545f0a571af113b0cc7455ecba1a603c81bbf84a52b9e61d332f97233"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ALVES JUNIOR MAQUINAS E EQUIPAMENTOS LTDA"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2e:e2:d4:1e:4b:d4:cd:3c:3a:3c:c9:b8"
      cert_thumbprint     = "DC9E774181A736B0437483521835009CAB4E4198"
      cert_valid_from     = "2025-10-17"
      cert_valid_to       = "2026-10-18"

      country             = "BR"
      state               = "GOIAS"
      locality            = "GOIANIA"
      email               = "alvesconstrutorajuridico@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2e:e2:d4:1e:4b:d4:cd:3c:3a:3c:c9:b8"
      )
}

rule MAL_Compromised_Cert_FakeDocument_GlobalSign_33B6764D0B6C7479AEC99456 {
   meta:
      description         = "Detects FakeDocument with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-14"
      version             = "1.0"

      hash                = "0f5de795b2a1453dd87d64e4c683177c1ac98d559b4c9c255bbe8493ea10fabb"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MOKOPANE SHERIFF (PTY) LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "33:b6:76:4d:0b:6c:74:79:ae:c9:94:56"
      cert_thumbprint     = "AE1D65CC18597A6AAC6C6A45A63B3D47B7CE1A8B"
      cert_valid_from     = "2025-10-14"
      cert_valid_to       = "2026-10-15"

      country             = "ZA"
      state               = "Limpopo"
      locality            = "Mokopane"
      email               = "admin@mokopanesheriff.com"
      rdn_serial_number   = "K2022681231"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "33:b6:76:4d:0b:6c:74:79:ae:c9:94:56"
      )
}

rule MAL_Compromised_Cert_FakeDocument_GlobalSign_3D0483EEC50371CB79AE3F64 {
   meta:
      description         = "Detects FakeDocument with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-24"
      version             = "1.0"

      hash                = "974f987b80129596083b764db7d64291790e176bb56c3de6412b27018264e45f"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VEDAPRIME BIO CARE LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3d:04:83:ee:c5:03:71:cb:79:ae:3f:64"
      cert_thumbprint     = "0A0639315552778DE838C7238ABD909B6BDAB9DE"
      cert_valid_from     = "2025-06-24"
      cert_valid_to       = "2026-06-25"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "shankarvedabio@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3d:04:83:ee:c5:03:71:cb:79:ae:3f:64"
      )
}

rule MAL_Compromised_Cert_FakeDocument_Microsoft_330002FA98E55C122556D6766A00000002FA98 {
   meta:
      description         = "Detects FakeDocument with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "558e5d48cc2ae8e2daf2027e3edd09c3417a621d435bee086807df61570e6d3d"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:fa:98:e5:5c:12:25:56:d6:76:6a:00:00:00:02:fa:98"
      cert_thumbprint     = "E50D86E7DB8CB8F184BC59297CD59D6E8B8FC465"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2025-05-24"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:fa:98:e5:5c:12:25:56:d6:76:6a:00:00:00:02:fa:98"
      )
}

rule MAL_Compromised_Cert_FakeDocument_Microsoft_33000340DBFB2DC0F2DB04363C0000000340DB {
   meta:
      description         = "Detects FakeDocument with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-11"
      version             = "1.0"

      hash                = "38536fb62f74274cf1ddd77ea40b4187a590235099936cf6d0504727c34cd796"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:40:db:fb:2d:c0:f2:db:04:36:3c:00:00:00:03:40:db"
      cert_thumbprint     = "CAD67D0A64477FDC31BDEB80F8714E2686F547D1"
      cert_valid_from     = "2025-06-11"
      cert_valid_to       = "2025-06-14"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:40:db:fb:2d:c0:f2:db:04:36:3c:00:00:00:03:40:db"
      )
}

rule MAL_Compromised_Cert_FakeDocument_SSL_com_456BD03DD2043B977A2C7894BEC2BBC2 {
   meta:
      description         = "Detects FakeDocument with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-29"
      version             = "1.0"

      hash                = "8ffdc7d783f87eab110921b33c74867a5eed7566d67d943f8d7deb5659d60c27"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Digital Sun Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "45:6b:d0:3d:d2:04:3b:97:7a:2c:78:94:be:c2:bb:c2"
      cert_thumbprint     = "B0BECCBCF6F99E8DE68D29C6624156EBE850F9DC"
      cert_valid_from     = "2025-08-29"
      cert_valid_to       = "2026-08-29"

      country             = "PL"
      state               = "Greater Poland Voivodeship"
      locality            = "Poznań"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "45:6b:d0:3d:d2:04:3b:97:7a:2c:78:94:be:c2:bb:c2"
      )
}

rule MAL_Compromised_Cert_FakeDocument_SSL_com_485E6AA133467657E1559D15D9B43395 {
   meta:
      description         = "Detects FakeDocument with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-18"
      version             = "1.0"

      hash                = "457ac982abd3d09b639b21b7ebf4f702e39aab3de4b61aac6e28cd962404846f"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "West Software Pty Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "48:5e:6a:a1:33:46:76:57:e1:55:9d:15:d9:b4:33:95"
      cert_thumbprint     = "FA3ED8E49FB853CBB172AE16B9C3B296394821CC"
      cert_valid_from     = "2025-09-18"
      cert_valid_to       = "2026-09-18"

      country             = "AU"
      state               = "Western Australia"
      locality            = "Kenwick"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "48:5e:6a:a1:33:46:76:57:e1:55:9d:15:d9:b4:33:95"
      )
}

rule MAL_Compromised_Cert_FakeDocument_SSL_com_685779616B1D4A00F3A825E2365B3945 {
   meta:
      description         = "Detects FakeDocument with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-15"
      version             = "1.0"

      hash                = "200769e30e583f97dd8163427cbdcffe3d4ed040e566455996c6c231426f5b5a"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sahlmén Software AB"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "68:57:79:61:6b:1d:4a:00:f3:a8:25:e2:36:5b:39:45"
      cert_thumbprint     = "3F6DAA2E5E9C3EFD5281B6C2BBA80F2004F7A709"
      cert_valid_from     = "2025-10-15"
      cert_valid_to       = "2026-10-15"

      country             = "SE"
      state               = "Halland County"
      locality            = "Kungsbacka"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "68:57:79:61:6b:1d:4a:00:f3:a8:25:e2:36:5b:39:45"
      )
}

rule MAL_Compromised_Cert_FakeDocument_SSL_com_700B215E33D4D6E0613324E8DCEFE4FF {
   meta:
      description         = "Detects FakeDocument with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-10"
      version             = "1.0"

      hash                = "04cc94bf0c8c0e815f1fd4203db8ea040c46c006bc2e25a26144e69cc9cbc8a8"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DECISION CONSULTANT SOLUTIONS LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "70:0b:21:5e:33:d4:d6:e0:61:33:24:e8:dc:ef:e4:ff"
      cert_thumbprint     = "E28CE0005497D24BB9FCFDD622AD2A5C6838FE9D"
      cert_valid_from     = "2025-03-10"
      cert_valid_to       = "2026-03-10"

      country             = "GB"
      state               = "???"
      locality            = "Hull"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "70:0b:21:5e:33:d4:d6:e0:61:33:24:e8:dc:ef:e4:ff"
      )
}

rule MAL_Compromised_Cert_FakeDocument_Sectigo_75F97FA8095F9167F552859E01DBFF77 {
   meta:
      description         = "Detects FakeDocument with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-16"
      version             = "1.0"

      hash                = "1d37ba51451af1501ad98ec080bcdd3bcd7ccacb62c73bfea5a2521422a10702"
      malware             = "FakeDocument"
      malware_type        = "Unknown"
      malware_notes       = "This malicious build is involved in a malware campaign, disguised as a PDF document under a fake Candidate Assignment package - ea2c061b2f5710ed43c303269a56de67820509f3b3c58972ae59daf576a30c8a"

      signer              = "BonJoe Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "75:f9:7f:a8:09:5f:91:67:f5:52:85:9e:01:db:ff:77"
      cert_thumbprint     = "0C36AFC555CEF188364A54091DC9B70E124495C3"
      cert_valid_from     = "2025-10-16"
      cert_valid_to       = "2026-10-16"

      country             = "CN"
      state               = "Jiangsu Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91320115MA1WKJMU43"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "75:f9:7f:a8:09:5f:91:67:f5:52:85:9e:01:db:ff:77"
      )
}

rule MAL_Compromised_Cert_FakeDocusign_Certum_43E52B941AEE7FB8A1966D39F26A4844 {
   meta:
      description         = "Detects FakeDocusign with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-31"
      version             = "1.0"

      hash                = "f788cb3d8e4196bb14c0519514e4bcf8a6a7a927a9bde076fb37f7791f81c786"
      malware             = "FakeDocusign"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiyuan Jiankang Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "43:e5:2b:94:1a:ee:7f:b8:a1:96:6d:39:f2:6a:48:44"
      cert_thumbprint     = "2BD0C974AAD9F5151E31C715381592769D608C7B"
      cert_valid_from     = "2025-07-31"
      cert_valid_to       = "2026-07-31"

      country             = "CN"
      state               = "山西省"
      locality            = "太原市"
      email               = "???"
      rdn_serial_number   = "91140106MA0M4WL26F"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "43:e5:2b:94:1a:ee:7f:b8:a1:96:6d:39:f2:6a:48:44"
      )
}

rule MAL_Compromised_Cert_FakeDocusign_GlobalSign_5B7190D2FEB24B40EC00A1DE {
   meta:
      description         = "Detects FakeDocusign with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-22"
      version             = "1.0"

      hash                = "7c63a1520ce81dc43d2170ef1570b49627655d33e4987be2cccf8e99d9d4c99f"
      malware             = "FakeDocusign"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ACROATIC EDU-SOLUTIONS PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5b:71:90:d2:fe:b2:4b:40:ec:00:a1:de"
      cert_thumbprint     = "7935586577A2068FC2CF9CDD526DA9121093B8A6"
      cert_valid_from     = "2025-07-22"
      cert_valid_to       = "2026-07-23"

      country             = "IN"
      state               = "Bihar"
      locality            = "Muzaffarpur"
      email               = "bharat.acroaticsolutions@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5b:71:90:d2:fe:b2:4b:40:ec:00:a1:de"
      )
}

rule MAL_Compromised_Cert_FakeDocusign_SSL_com_63B13BB7320117B3A722735ECB578BB5 {
   meta:
      description         = "Detects FakeDocusign with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-21"
      version             = "1.0"

      hash                = "10d664e9f7eca0bf6c9c58b81d0c564256ef90b09a8d02549b3342b598a7a6d1"
      malware             = "FakeDocusign"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kuopio Trade Park Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "63:b1:3b:b7:32:01:17:b3:a7:22:73:5e:cb:57:8b:b5"
      cert_thumbprint     = "CE7B5DB515209591AE13FBED5881E2D0AA9F193F"
      cert_valid_from     = "2025-08-21"
      cert_valid_to       = "2026-08-21"

      country             = "FI"
      state               = "North Karelia"
      locality            = "Joensuu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "63:b1:3b:b7:32:01:17:b3:a7:22:73:5e:cb:57:8b:b5"
      )
}

rule MAL_Compromised_Cert_FakeDropboxDocSend_GlobalSign_5869602DD339F533AF17A0FD {
   meta:
      description         = "Detects FakeDropboxDocSend with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-29"
      version             = "1.0"

      hash                = "9d26e35e6d36a867c6343b4f6d1d8c3c5550ea12eb0fc14427aa8d7ae6ca0a49"
      malware             = "FakeDropboxDocSend"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Richester Business Network Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "58:69:60:2d:d3:39:f5:33:af:17:a0:fd"
      cert_thumbprint     = "22DAF715850473FDC2CAB59A12B8AEACDA66CA83"
      cert_valid_from     = "2025-08-29"
      cert_valid_to       = "2026-08-30"

      country             = "CA"
      state               = "Alberta"
      locality            = "Calgary"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "58:69:60:2d:d3:39:f5:33:af:17:a0:fd"
      )
}

rule MAL_Compromised_Cert_FakeDropboxDocSend_Sectigo_00CD308B846B1CA4CF08F6DF76FD16D9C6 {
   meta:
      description         = "Detects FakeDropboxDocSend with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-20"
      version             = "1.0"

      hash                = "430747fe54f7c3eb81ae356b87137bd610f194ce5bd546f9f68d1db7b7013750"
      malware             = "FakeDropboxDocSend"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Songyuan Wangqing Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:cd:30:8b:84:6b:1c:a4:cf:08:f6:df:76:fd:16:d9:c6"
      cert_thumbprint     = "CDCE9B7374D187C213AA7ACE50C2A6D88A9146DD"
      cert_valid_from     = "2025-08-20"
      cert_valid_to       = "2026-08-20"

      country             = "CN"
      state               = "吉林省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:cd:30:8b:84:6b:1c:a4:cf:08:f6:df:76:fd:16:d9:c6"
      )
}

rule MAL_Compromised_Cert_FakeIncident_SSL_com_3AEB4EDA7679266BA856153C6D438080 {
   meta:
      description         = "Detects FakeIncident with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-27"
      version             = "1.0"

      hash                = "6750134b7a676616fb461db84df4e0b3915203176cea64c256029f1df2b946ec"
      malware             = "FakeIncident"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GeoTech-IT Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3a:eb:4e:da:76:79:26:6b:a8:56:15:3c:6d:43:80:80"
      cert_thumbprint     = "B59E051A14321FBC632A343C8695E45295868881"
      cert_valid_from     = "2025-06-27"
      cert_valid_to       = "2026-06-26"

      country             = "FI"
      state               = "Varsinais-Suomi"
      locality            = "Raisio"
      email               = "???"
      rdn_serial_number   = "2678225-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3a:eb:4e:da:76:79:26:6b:a8:56:15:3c:6d:43:80:80"
      )
}

rule MAL_Compromised_Cert_FakeIncident_SSL_com_7834A48F9495BA062E921F5368BDE613 {
   meta:
      description         = "Detects FakeIncident with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-18"
      version             = "1.0"

      hash                = "0058a199029f28cec3dbd33f13b066d0029bedb89be7515bcf2b17d88b76cf58"
      malware             = "FakeIncident"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Medi-Info Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "78:34:a4:8f:94:95:ba:06:2e:92:1f:53:68:bd:e6:13"
      cert_thumbprint     = "6C9413D810D528001EB356AD473A29AB9E94FAE2"
      cert_valid_from     = "2025-07-18"
      cert_valid_to       = "2026-07-18"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "78:34:a4:8f:94:95:ba:06:2e:92:1f:53:68:bd:e6:13"
      )
}

rule MAL_Compromised_Cert_FakeInstallers_GlobalSign_3C919D9B67D86C82709BAEBE {
   meta:
      description         = "Detects FakeInstallers with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-05"
      version             = "1.0"

      hash                = "e4ee1aa6bdaec43ef4cf3b600dacde96af124b999c32d84db6d7241f8bd2ea07"
      malware             = "FakeInstallers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THINH HA TRADE & TRANSPORT COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3c:91:9d:9b:67:d8:6c:82:70:9b:ae:be"
      cert_thumbprint     = "AB24D90088721235EB94968B7ED7FDCAD118D5AA"
      cert_valid_from     = "2025-05-05"
      cert_valid_to       = "2026-04-02"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3c:91:9d:9b:67:d8:6c:82:70:9b:ae:be"
      )
}

rule MAL_Compromised_Cert_FakeInstallers_Microsoft_33000433BFEE42F197AB1D147C0000000433BF {
   meta:
      description         = "Detects FakeInstallers with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-02"
      version             = "1.0"

      hash                = "07d6152464eb5b290ddbc590496fe22028bcf2bc4c669b7311d416db322b384d"
      malware             = "FakeInstallers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "56 SQUARED PARTNERS LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:33:bf:ee:42:f1:97:ab:1d:14:7c:00:00:00:04:33:bf"
      cert_thumbprint     = "B8149FE5681089DF2F244114E0448B4A70AECDDA"
      cert_valid_from     = "2025-09-02"
      cert_valid_to       = "2025-09-05"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:33:bf:ee:42:f1:97:ab:1d:14:7c:00:00:00:04:33:bf"
      )
}

rule MAL_Compromised_Cert_FakeInstallers_Microsoft_3300054F9C3717716DE22D5858000000054F9C {
   meta:
      description         = "Detects FakeInstallers with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-15"
      version             = "1.0"

      hash                = "1d10e0aae7b14c6ebd609d88f9ef4cc4e812ca25d9fd43d075ae4e7c7bd5eb79"
      malware             = "FakeInstallers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "56 SQUARED PARTNERS LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:4f:9c:37:17:71:6d:e2:2d:58:58:00:00:00:05:4f:9c"
      cert_thumbprint     = "F8478A9A952EE947BE1A1032F60A0D85FE3CF646"
      cert_valid_from     = "2025-09-15"
      cert_valid_to       = "2025-09-18"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:4f:9c:37:17:71:6d:e2:2d:58:58:00:00:00:05:4f:9c"
      )
}

rule MAL_Compromised_Cert_FakeInstallers_Microsoft_3300055C80AFCFC210CF3436B7000000055C80 {
   meta:
      description         = "Detects FakeInstallers with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-09"
      version             = "1.0"

      hash                = "ba347d3e163372f5b036a44dac79b50df5f878c4c4f62319a190ce27dccc2f57"
      malware             = "FakeInstallers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "56 SQUARED PARTNERS LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:5c:80:af:cf:c2:10:cf:34:36:b7:00:00:00:05:5c:80"
      cert_thumbprint     = "2111E7A8412531B96ACE76E1ED73B238D759779B"
      cert_valid_from     = "2025-09-09"
      cert_valid_to       = "2025-09-12"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:5c:80:af:cf:c2:10:cf:34:36:b7:00:00:00:05:5c:80"
      )
}

rule MAL_Compromised_Cert_FakeInstallers_Microsoft_33000567A86F51BDCBBB38F1130000000567A8 {
   meta:
      description         = "Detects FakeInstallers with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-11"
      version             = "1.0"

      hash                = "b2d07515d7e1134c413b31babb4d7f3a1c93293fd4a35f02d45dbfce3e210010"
      malware             = "FakeInstallers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "56 SQUARED PARTNERS LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:67:a8:6f:51:bd:cb:bb:38:f1:13:00:00:00:05:67:a8"
      cert_thumbprint     = "B000F3F7EE582CD023F4E13FEB79A03E666434AC"
      cert_valid_from     = "2025-09-11"
      cert_valid_to       = "2025-09-14"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:67:a8:6f:51:bd:cb:bb:38:f1:13:00:00:00:05:67:a8"
      )
}

rule MAL_Compromised_Cert_FakeInstallers_SSL_com_1B42110974AE87F4CD4639E29C4C14C4 {
   meta:
      description         = "Detects FakeInstallers with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-01"
      version             = "1.0"

      hash                = "45e50aaff3991801924650d05d84750ae94f0900c6238eaed4fc79fd2fb9cdc3"
      malware             = "FakeInstallers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ESPRESSO EDUTECH DIGI PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1b:42:11:09:74:ae:87:f4:cd:46:39:e2:9c:4c:14:c4"
      cert_thumbprint     = "2F9FAEA49C640DB8F4D22D01C1D85D62AB5F50F8"
      cert_valid_from     = "2025-09-01"
      cert_valid_to       = "2026-09-01"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Kota"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1b:42:11:09:74:ae:87:f4:cd:46:39:e2:9c:4c:14:c4"
      )
}

rule MAL_Compromised_Cert_FakeIvanti_Certum_03DA155639347FBB8241450243F3818E {
   meta:
      description         = "Detects FakeIvanti with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-11"
      version             = "1.0"

      hash                = "40d77718fbb05123f17e5aea3e65f937eda0f9f8866d866158d4ec3d69ab867e"
      malware             = "FakeIvanti"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Qiangwei Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "03:da:15:56:39:34:7f:bb:82:41:45:02:43:f3:81:8e"
      cert_thumbprint     = "EC443DE3ED3D17515CE137FE271C885B4F09F03E"
      cert_valid_from     = "2025-09-11"
      cert_valid_to       = "2026-09-11"

      country             = "CN"
      state               = "安徽省"
      locality            = "合肥市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "03:da:15:56:39:34:7f:bb:82:41:45:02:43:f3:81:8e"
      )
}

rule MAL_Compromised_Cert_FakeKeePass_DigiCert_05C1F7DD747B1AF79AC427A15A8B64AE {
   meta:
      description         = "Detects FakeKeePass with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-31"
      version             = "1.0"

      hash                = "b51dc9ca6f6029a799491bd9b8da18c9d9775116142cedabe958c8bcec96a0f0"
      malware             = "FakeKeePass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "S.R.L. INT-MCOM"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:c1:f7:dd:74:7b:1a:f7:9a:c4:27:a1:5a:8b:64:ae"
      cert_thumbprint     = "467C6C43E6FBB17FCAEFB46FC41A6B2B829E0EFA"
      cert_valid_from     = "2025-01-31"
      cert_valid_to       = "2026-01-30"

      country             = "MD"
      state               = "???"
      locality            = "Chişinău"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:c1:f7:dd:74:7b:1a:f7:9a:c4:27:a1:5a:8b:64:ae"
      )
}

rule MAL_Compromised_Cert_FakeKeePass_GlobalSign_3ACEAA7BDFAB12376A840610 {
   meta:
      description         = "Detects FakeKeePass with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-02"
      version             = "1.0"

      hash                = "9fa3042b3f6ae325c56e9180705f29a614b99c5005ef7acf671413422b20836f"
      malware             = "FakeKeePass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Paster"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3a:ce:aa:7b:df:ab:12:37:6a:84:06:10"
      cert_thumbprint     = "A810A1D6C82871D12BD27297EA28A0330F4D7AD6"
      cert_valid_from     = "2025-07-02"
      cert_valid_to       = "2026-07-03"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3a:ce:aa:7b:df:ab:12:37:6a:84:06:10"
      )
}

rule MAL_Compromised_Cert_FakeKeePass_SSL_com_5B8DF56CABA88183160D579EF83A3741 {
   meta:
      description         = "Detects FakeKeePass with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-01"
      version             = "1.0"

      hash                = "a5404e3f9d5358065d99c8175d60157600587a1103bd8a5461012eb42d4e9ef8"
      malware             = "FakeKeePass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "POPSHINE MEDIA LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5b:8d:f5:6c:ab:a8:81:83:16:0d:57:9e:f8:3a:37:41"
      cert_thumbprint     = "CE06E8CCE961C70F3F414FFE66FDB96FBBEA4E71"
      cert_valid_from     = "2025-08-01"
      cert_valid_to       = "2026-08-01"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5b:8d:f5:6c:ab:a8:81:83:16:0d:57:9e:f8:3a:37:41"
      )
}

rule MAL_Compromised_Cert_FakeKeePass_Sectigo_00E1D5029BF74F42040BB14B402FC3B9D0 {
   meta:
      description         = "Detects FakeKeePass with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-20"
      version             = "1.0"

      hash                = "f56f014405aeda11b474c9c9628dcce6633df33f8ca493b6caae9e072860e308"
      malware             = "FakeKeePass"
      malware_type        = "Unknown"
      malware_notes       = "https://app.any.run/tasks/d6916baa-68ac-4eaf-b098-43fb0cafcf43"

      signer              = "Jinan Lu'an Information Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:e1:d5:02:9b:f7:4f:42:04:0b:b1:4b:40:2f:c3:b9:d0"
      cert_thumbprint     = "8B12A0E1D6E2A0CBBFCDD5EC073E3217684105A7"
      cert_valid_from     = "2025-10-20"
      cert_valid_to       = "2026-10-20"

      country             = "CN"
      state               = "Shandong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91370100MA94FUXT8E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:e1:d5:02:9b:f7:4f:42:04:0b:b1:4b:40:2f:c3:b9:d0"
      )
}

rule MAL_Compromised_Cert_FakeKeepKey_SSL_com_7909E8804C626353E5D35FEA25892A72 {
   meta:
      description         = "Detects FakeKeepKey with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-25"
      version             = "1.0"

      hash                = "4592d64935081ae03564054fe64de80310dc44ae3e1e7899a004c6d6f6b1ef23"
      malware             = "FakeKeepKey"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "A-deal Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "79:09:e8:80:4c:62:63:53:e5:d3:5f:ea:25:89:2a:72"
      cert_thumbprint     = "C2781F59C5F18B4E5A4BCBC55CB429FDDE276091"
      cert_valid_from     = "2025-07-25"
      cert_valid_to       = "2026-07-25"

      country             = "FI"
      state               = "Varsinais-Suomi"
      locality            = "KARINAINEN"
      email               = "???"
      rdn_serial_number   = "3296686-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "79:09:e8:80:4c:62:63:53:e5:d3:5f:ea:25:89:2a:72"
      )
}

rule MAL_Compromised_Cert_FakeKeepass_SSL_com_0E012F33DC0BF0BA22432B79611B3238 {
   meta:
      description         = "Detects FakeKeepass with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-20"
      version             = "1.0"

      hash                = "cee5e1fa0175698800cb7832460e877fbe9c76965615ca5dbcbeac55e643fb45"
      malware             = "FakeKeepass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Queenie Francisco"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "0e:01:2f:33:dc:0b:f0:ba:22:43:2b:79:61:1b:32:38"
      cert_thumbprint     = "729E83DFB329F3237905CE0A779C4A914FB06DE4"
      cert_valid_from     = "2025-01-20"
      cert_valid_to       = "2026-01-20"

      country             = "PH"
      state               = "Metro Manila"
      locality            = "Quezon City"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "0e:01:2f:33:dc:0b:f0:ba:22:43:2b:79:61:1b:32:38"
      )
}

rule MAL_Compromised_Cert_FakeKeypass_Certum_52B05A2A3AD5CAE2946C80F5B621E382 {
   meta:
      description         = "Detects FakeKeypass with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-07"
      version             = "1.0"

      hash                = "2c510f9ae4472342faafb7f2a1f278160f3581ead8ccd5b7ba7951863dcba2f5"
      malware             = "FakeKeypass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen Kantianxia Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "52:b0:5a:2a:3a:d5:ca:e2:94:6c:80:f5:b6:21:e3:82"
      cert_thumbprint     = "2CF75DAE1A87CA7962CAF67E7310420BBBC30588"
      cert_valid_from     = "2024-10-07"
      cert_valid_to       = "2025-10-07"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "52:b0:5a:2a:3a:d5:ca:e2:94:6c:80:f5:b6:21:e3:82"
      )
}

rule MAL_Compromised_Cert_FakeKeypass_GlobalSign_26A6819AC81B7A25BCE7D354 {
   meta:
      description         = "Detects FakeKeypass with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-22"
      version             = "1.0"

      hash                = "128a68a714f2f6002f5e8e8cfe0bbae10cd2ffe63d30c8acc00255b9659ce121"
      malware             = "FakeKeypass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MekoGuard Bytemin Information Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "26:a6:81:9a:c8:1b:7a:25:bc:e7:d3:54"
      cert_thumbprint     = "A53E2045C456BC5879E1159245884740FF0BE11D"
      cert_valid_from     = "2024-02-22"
      cert_valid_to       = "2025-02-06"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "26:a6:81:9a:c8:1b:7a:25:bc:e7:d3:54"
      )
}

rule MAL_Compromised_Cert_FakeMSTeams_SSL_com_10B773CE74FFA557CA5820731EE44E9E {
   meta:
      description         = "Detects FakeMSTeams with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-14"
      version             = "1.0"

      hash                = "6b1251fb7b4f9458922c94f0abd0584fd891860ec12fee5da428b7b6dc1136f0"
      malware             = "FakeMSTeams"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sichuan Agromax Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "10:b7:73:ce:74:ff:a5:57:ca:58:20:73:1e:e4:4e:9e"
      cert_thumbprint     = "4B26BDE45CD7225B4B2924F1230F47E46714725F"
      cert_valid_from     = "2025-06-14"
      cert_valid_to       = "2026-06-13"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA6DEAE88D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "10:b7:73:ce:74:ff:a5:57:ca:58:20:73:1e:e4:4e:9e"
      )
}

rule MAL_Compromised_Cert_FakeNSFW_SSL_com_1084709258B748EC1FF4713256826408 {
   meta:
      description         = "Detects FakeNSFW with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "b1b89efac3f6f9bbde0abc10ae8b8ff2c966854f40893d5b17cc29c58b4ce8cd"
      malware             = "FakeNSFW"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Lis Elewacje Spółka Z Ograniczoną Odpowiedzialnością"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "10:84:70:92:58:b7:48:ec:1f:f4:71:32:56:82:64:08"
      cert_thumbprint     = "F03E1737D59C16188D889CBCC48193D3A7DD9253"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-07-30"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "10:84:70:92:58:b7:48:ec:1f:f4:71:32:56:82:64:08"
      )
}

rule MAL_Compromised_Cert_FakeNSFW_SSL_com_12916017A8B479FCBB9562F07097BE52 {
   meta:
      description         = "Detects FakeNSFW with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-13"
      version             = "1.0"

      hash                = "579400d97efabfc565ea1b11e85149767cd69f98f9b0072a25559fb076ed479c"
      malware             = "FakeNSFW"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "M BIT SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "12:91:60:17:a8:b4:79:fc:bb:95:62:f0:70:97:be:52"
      cert_thumbprint     = "C3E157B3168C6893B4B94CA64DEDE002AACFAB34"
      cert_valid_from     = "2025-06-13"
      cert_valid_to       = "2026-06-13"

      country             = "PL"
      state               = "Malopolskie"
      locality            = "Nowy Sacz"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "12:91:60:17:a8:b4:79:fc:bb:95:62:f0:70:97:be:52"
      )
}

rule MAL_Compromised_Cert_FakeNSFW_SSL_com_5ECDA0686C2632163BC7F9F342366FF4 {
   meta:
      description         = "Detects FakeNSFW with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-26"
      version             = "1.0"

      hash                = "a776fd03c3fc1596d24f78cce144cb83f1fba242c6c158290294c36f0e845829"
      malware             = "FakeNSFW"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "PITTORE S.R.L."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:cd:a0:68:6c:26:32:16:3b:c7:f9:f3:42:36:6f:f4"
      cert_thumbprint     = "86800EEDB60DE91568AE3BA0E3D5963F6AEE7CAD"
      cert_valid_from     = "2025-06-26"
      cert_valid_to       = "2026-06-26"

      country             = "AR"
      state               = "Buenos Aires Province"
      locality            = "Buenos Aires"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:cd:a0:68:6c:26:32:16:3b:c7:f9:f3:42:36:6f:f4"
      )
}

rule MAL_Compromised_Cert_FakeNSFW_SSL_com_65FFFEAE74DC9167F03FEDA42B624764 {
   meta:
      description         = "Detects FakeNSFW with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-27"
      version             = "1.0"

      hash                = "459f3e4e77b3b5c3d24a39a8c219442a12f41a2528f15702520ec19c69dea43a"
      malware             = "FakeNSFW"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Future Trade Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "65:ff:fe:ae:74:dc:91:67:f0:3f:ed:a4:2b:62:47:64"
      cert_thumbprint     = "5671CC35C02EF1AAB3D2B1B921B71BEFC551A7F3"
      cert_valid_from     = "2025-06-27"
      cert_valid_to       = "2026-06-27"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "65:ff:fe:ae:74:dc:91:67:f0:3f:ed:a4:2b:62:47:64"
      )
}

rule MAL_Compromised_Cert_FakeNSFW_SSL_com_6C4689B65D5CCF9975C0FAC8B7050FAA {
   meta:
      description         = "Detects FakeNSFW with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-13"
      version             = "1.0"

      hash                = "31e5b56e90d12bbfe6d05028043c16bc999817d077ae2a53ebb64bff576d1586"
      malware             = "FakeNSFW"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "ZAKS SOLUTIONS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6c:46:89:b6:5d:5c:cf:99:75:c0:fa:c8:b7:05:0f:aa"
      cert_thumbprint     = "7BDFDBE77C69FF61DCFB85A3CEDAE9431BE6699D"
      cert_valid_from     = "2025-08-13"
      cert_valid_to       = "2026-08-13"

      country             = "GB"
      state               = "???"
      locality            = "Bolton"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6c:46:89:b6:5d:5c:cf:99:75:c0:fa:c8:b7:05:0f:aa"
      )
}

rule MAL_Compromised_Cert_FakeNordVPN_GlobalSign_28A32C8C6B5D437DE2F42E54 {
   meta:
      description         = "Detects FakeNordVPN with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-19"
      version             = "1.0"

      hash                = "d17a330bb7c929efffb8a42d6ca224f839548560603f88e432043735d392bc85"
      malware             = "FakeNordVPN"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Plan B"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "28:a3:2c:8c:6b:5d:43:7d:e2:f4:2e:54"
      cert_thumbprint     = "5C681ECB281491AC7411949AA1E54E12ED92DF2A"
      cert_valid_from     = "2025-06-19"
      cert_valid_to       = "2026-06-20"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "28:a3:2c:8c:6b:5d:43:7d:e2:f4:2e:54"
      )
}

rule MAL_Compromised_Cert_FakeNordpass_GlobalSign_193FA09306CB8B5D056F975B {
   meta:
      description         = "Detects FakeNordpass with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-18"
      version             = "1.0"

      hash                = "177eaa6c42960cc6fcff3726f13fba1eb5576fa47415c505cd49909e69812b1a"
      malware             = "FakeNordpass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Vector LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "19:3f:a0:93:06:cb:8b:5d:05:6f:97:5b"
      cert_thumbprint     = "C683252101A7099D9AC5B37C54275A6E766516D4"
      cert_valid_from     = "2025-04-18"
      cert_valid_to       = "2026-04-19"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1227800144923"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "19:3f:a0:93:06:cb:8b:5d:05:6f:97:5b"
      )
}

rule MAL_Compromised_Cert_FakeNordpass_GlobalSign_299E1965E5ADBF80AD8D73D9 {
   meta:
      description         = "Detects FakeNordpass with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-23"
      version             = "1.0"

      hash                = "23ab0bc5d42e1311a672c4b3a4cf1ea8acd673efad132857fee254fdc80d32e6"
      malware             = "FakeNordpass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Razvitie LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "29:9e:19:65:e5:ad:bf:80:ad:8d:73:d9"
      cert_thumbprint     = "EE219612AB96F1A19CCED0D8897567276493D84D"
      cert_valid_from     = "2025-04-23"
      cert_valid_to       = "2026-04-24"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1157847087012"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "29:9e:19:65:e5:ad:bf:80:ad:8d:73:d9"
      )
}

rule MAL_Compromised_Cert_FakeNordpass_GlobalSign_5D354EA7A507F853740B5E84 {
   meta:
      description         = "Detects FakeNordpass with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-13"
      version             = "1.0"

      hash                = "88b77a6ddc88be7a2ccfc6a518c06457656c3fdb60c9445c32aba4d24211a969"
      malware             = "FakeNordpass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shijiazhuang SUNRISE Carpet Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5d:35:4e:a7:a5:07:f8:53:74:0b:5e:84"
      cert_thumbprint     = "478CF418040D3AC581ED12EDA481AB39792CA73C"
      cert_valid_from     = "2025-03-13"
      cert_valid_to       = "2026-03-14"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130105774415592W"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5d:35:4e:a7:a5:07:f8:53:74:0b:5e:84"
      )
}

rule MAL_Compromised_Cert_FakeNordpass_GlobalSign_6562890A00BB9C7A0A80695A {
   meta:
      description         = "Detects FakeNordpass with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-31"
      version             = "1.0"

      hash                = "10de1e14a9a64af2d06fff3741cb870d21bcd7508e6b645a7e98f11d05b811be"
      malware             = "FakeNordpass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yurisk LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:62:89:0a:00:bb:9c:7a:0a:80:69:5a"
      cert_thumbprint     = "50FA33EBD90F7FEB9FF4C1F89BCD5BDA3BD0D928"
      cert_valid_from     = "2025-03-31"
      cert_valid_to       = "2026-04-01"

      country             = "RU"
      state               = "Tula Oblast"
      locality            = "Tula"
      email               = "???"
      rdn_serial_number   = "1217100007222"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:62:89:0a:00:bb:9c:7a:0a:80:69:5a"
      )
}

rule MAL_Compromised_Cert_FakeNordpass_Microsoft_33000376BA37F7CE9C7653D0880000000376BA {
   meta:
      description         = "Detects FakeNordpass with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-23"
      version             = "1.0"

      hash                = "f85a155d3f75cab12843688f02cec2774cb952c8e020cf764be181c81973e59b"
      malware             = "FakeNordpass"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BLUESTEM PIPE & METAL, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:03:76:ba:37:f7:ce:9c:76:53:d0:88:00:00:00:03:76:ba"
      cert_thumbprint     = "278A075F957D76FDC6100AB93CD75FE59DB9F19C"
      cert_valid_from     = "2025-04-23"
      cert_valid_to       = "2025-04-26"

      country             = "US"
      state               = "Oklahoma"
      locality            = "Oklahoma City"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:03:76:ba:37:f7:ce:9c:76:53:d0:88:00:00:00:03:76:ba"
      )
}

rule MAL_Compromised_Cert_FakePDFBrowserHijacker_DigiCert_037FAF39D5EFECFEEDC2950F625EAB0E {
   meta:
      description         = "Detects FakePDFBrowserHijacker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-07"
      version             = "1.0"

      hash                = "7c5004c9d3ed4325c547ec0127d59205529f4574444a9e74dc108b0783d6e392"
      malware             = "FakePDFBrowserHijacker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Flooencia Media LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "03:7f:af:39:d5:ef:ec:fe:ed:c2:95:0f:62:5e:ab:0e"
      cert_thumbprint     = "BC3815D8174DDBCAD1C44DA0CD818BB4E1698D21"
      cert_valid_from     = "2025-07-07"
      cert_valid_to       = "2028-07-06"

      country             = "US"
      state               = "Wyoming"
      locality            = "Sheridan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "03:7f:af:39:d5:ef:ec:fe:ed:c2:95:0f:62:5e:ab:0e"
      )
}

rule MAL_Compromised_Cert_FakePutty_Sectigo_00FD7B8FA580A5360A2D82E905D75915F8 {
   meta:
      description         = "Detects FakePutty with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-22"
      version             = "1.0"

      hash                = "0e1f3368fff264dc342d985981f8e15aac7f39b866aae21a74e868409ca720bc"
      malware             = "FakePutty"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Songyuan Shashu Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:fd:7b:8f:a5:80:a5:36:0a:2d:82:e9:05:d7:59:15:f8"
      cert_thumbprint     = "281A0F64D467B653DF2D46258E6E769B04629AE5"
      cert_valid_from     = "2025-07-22"
      cert_valid_to       = "2026-10-20"

      country             = "CN"
      state               = "Jilin Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91220702MABP4WUC8L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:fd:7b:8f:a5:80:a5:36:0a:2d:82:e9:05:d7:59:15:f8"
      )
}

rule MAL_Compromised_Cert_FakeRVTools_GlobalSign_5A076B593C5E7DCA24430353 {
   meta:
      description         = "Detects FakeRVTools with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-02"
      version             = "1.0"

      hash                = "75485847e431dddea1d9aee4cbc49066defc4fa8347cda67835009ca7d95b799"
      malware             = "FakeRVTools"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "WEGUN (THAILAND) CO., LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:07:6b:59:3c:5e:7d:ca:24:43:03:53"
      cert_thumbprint     = "81162039094342A54A726E98C4DECB147152D193"
      cert_valid_from     = "2025-12-02"
      cert_valid_to       = "2026-11-21"

      country             = "TH"
      state               = "Chonburi"
      locality            = "Bang Lamung"
      email               = "???"
      rdn_serial_number   = "0205567025431"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:07:6b:59:3c:5e:7d:ca:24:43:03:53"
      )
}

rule MAL_Compromised_Cert_FakeSAPConcur_Sectigo_00E399C110BDA97BA3C2635A886F55BA45 {
   meta:
      description         = "Detects FakeSAPConcur with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-22"
      version             = "1.0"

      hash                = "ca3e4995ffe857412e84c650dea38f6243174e49559b48936dc2cbc08fdd0f28"
      malware             = "FakeSAPConcur"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiyuan Linma Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:e3:99:c1:10:bd:a9:7b:a3:c2:63:5a:88:6f:55:ba:45"
      cert_thumbprint     = "52D949B1CC58F2AABECD3847DFFFE9F9D9764269"
      cert_valid_from     = "2025-07-22"
      cert_valid_to       = "2026-10-20"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:e3:99:c1:10:bd:a9:7b:a3:c2:63:5a:88:6f:55:ba:45"
      )
}

rule MAL_Compromised_Cert_FakeStatement_SSL_com_45DF3961393196E00E5F001A73DF9964 {
   meta:
      description         = "Detects FakeStatement with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-04"
      version             = "1.0"

      hash                = "7347b09c6e10e203ec36c39dfc8d711af0beedfd9af3b85970ad60529579d5f6"
      malware             = "FakeStatement"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Automyynti Last Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "45:df:39:61:39:31:96:e0:0e:5f:00:1a:73:df:99:64"
      cert_thumbprint     = "CF49802079B7856E88B5B62F5F01B761403AB41A"
      cert_valid_from     = "2025-08-04"
      cert_valid_to       = "2026-08-04"

      country             = "FI"
      state               = "Etelä-Pohjanmaa"
      locality            = "SEINÄJOKI"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "45:df:39:61:39:31:96:e0:0e:5f:00:1a:73:df:99:64"
      )
}

rule MAL_Compromised_Cert_FakeUpwork_Sectigo_64A01FE7A8119B436BAE518AD1D5670E {
   meta:
      description         = "Detects FakeUpwork with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-12"
      version             = "1.0"

      hash                = "1b4f9d724e345ca57ec443deca90e167d2ce1117d56ecf01831faa9104517b9d"
      malware             = "FakeUpwork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "StarServicing LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "64:a0:1f:e7:a8:11:9b:43:6b:ae:51:8a:d1:d5:67:0e"
      cert_thumbprint     = "3A3827F0D9440B87EE0D9921F213FE931C1D1B9D"
      cert_valid_from     = "2025-11-12"
      cert_valid_to       = "2026-11-12"

      country             = "US"
      state               = "Wyoming"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "2025-001805705"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "64:a0:1f:e7:a8:11:9b:43:6b:ae:51:8a:d1:d5:67:0e"
      )
}

rule MAL_Compromised_Cert_FakeWallet_GlobalSign_02D7C777AE05BFD426232467 {
   meta:
      description         = "Detects FakeWallet with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "879b1e4a67af31ad11e210d03d43ccd5f0a6b981fb6a4d87e1ee360a7ad845f0"
      malware             = "FakeWallet"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ENRRICHONE WELL-BEING PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "02:d7:c7:77:ae:05:bf:d4:26:23:24:67"
      cert_thumbprint     = "B0727D22C094A131381D32FE93416C562D5208F4"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2026-06-04"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "mahaveerenrrichone2@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "02:d7:c7:77:ae:05:bf:d4:26:23:24:67"
      )
}

rule MAL_Compromised_Cert_FakeWallet_GlobalSign_194675A325FE355EA306B8AA {
   meta:
      description         = "Detects FakeWallet with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-05"
      version             = "1.0"

      hash                = "fc858ad30e1607f8d08f0d470b6f29d02b478651128b0ef9e6a5c91519e04862"
      malware             = "FakeWallet"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MALA ENGICON PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "19:46:75:a3:25:fe:35:5e:a3:06:b8:aa"
      cert_thumbprint     = "F58533B6EA727C1D81E7CD473B4E207D481732DC"
      cert_valid_from     = "2025-06-05"
      cert_valid_to       = "2026-06-06"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "souravkumarmengicon@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "19:46:75:a3:25:fe:35:5e:a3:06:b8:aa"
      )
}

rule MAL_Compromised_Cert_FakeWallet_GlobalSign_27FC70B33EC97FD3661423D9 {
   meta:
      description         = "Detects FakeWallet with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-07"
      version             = "1.0"

      hash                = "12b178ea9534a3a36a4fbd7646995eec715a6566ab2cc20dfe37996435d6d09d"
      malware             = "FakeWallet"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RICHFUN MINERAL COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "27:fc:70:b3:3e:c9:7f:d3:66:14:23:d9"
      cert_thumbprint     = "6808BDB984164944F5D63966A9429EA89655098C"
      cert_valid_from     = "2025-05-07"
      cert_valid_to       = "2026-05-08"

      country             = "VN"
      state               = "Hà Nam"
      locality            = "Hà Nam"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "27:fc:70:b3:3e:c9:7f:d3:66:14:23:d9"
      )
}

rule MAL_Compromised_Cert_FakeWallet_GlobalSign_4345DF897AA6792193B2F67A {
   meta:
      description         = "Detects FakeWallet with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-27"
      version             = "1.0"

      hash                = "f0a637405491bfa9f50cd5bcb568ec7c6e0b03244a634cad80ad5b0c150f3128"
      malware             = "FakeWallet"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shijiazhuang Jinghang Laser Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "43:45:df:89:7a:a6:79:21:93:b2:f6:7a"
      cert_thumbprint     = "6BFBD2ED9D6C207CEE8E488B7916968F69030748"
      cert_valid_from     = "2025-03-27"
      cert_valid_to       = "2026-03-28"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "43:45:df:89:7a:a6:79:21:93:b2:f6:7a"
      )
}

rule MAL_Compromised_Cert_FakeWallet_SSL_com_74CC097BCA0EBAE54EC126E526AC20DC {
   meta:
      description         = "Detects FakeWallet with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-18"
      version             = "1.0"

      hash                = "876538da922976743c40a8d49723cda325463c6f1a6baf1c28027a383ff14c6b"
      malware             = "FakeWallet"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SPOTLESS SQUAD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "74:cc:09:7b:ca:0e:ba:e5:4e:c1:26:e5:26:ac:20:dc"
      cert_thumbprint     = "D96E7380003C5BDE455FC44FEBE5566ED46F0191"
      cert_valid_from     = "2025-09-18"
      cert_valid_to       = "2026-09-18"

      country             = "KE"
      state               = "Rift Valley"
      locality            = "Eldoret"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "74:cc:09:7b:ca:0e:ba:e5:4e:c1:26:e5:26:ac:20:dc"
      )
}

rule MAL_Compromised_Cert_Fakebat_Certificate_SSL_com_6CD23039DFDA4B9363F3666113C2CBC8 {
   meta:
      description         = "Detects Fakebat_Certificate with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-18"
      version             = "1.0"

      hash                = "d0db968846f45699ee000f88f208b290be4ce116126164c3644dd413859b08fd"
      malware             = "Fakebat_Certificate"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Fta Engineers Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "6c:d2:30:39:df:da:4b:93:63:f3:66:61:13:c2:cb:c8"
      cert_thumbprint     = "ED6EBDA8E7450F2F6C5181FA27EA5A7865080696"
      cert_valid_from     = "2024-05-18"
      cert_valid_to       = "2025-05-18"

      country             = "GB"
      state               = "England"
      locality            = "Brentford"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "6c:d2:30:39:df:da:4b:93:63:f3:66:61:13:c2:cb:c8"
      )
}

rule MAL_Compromised_Cert_FatalRAT_Certum_6C162B47BDE6ABB337796A32ACEAEB3A {
   meta:
      description         = "Detects FatalRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-11"
      version             = "1.0"

      hash                = "789bfb11d716ca32514829b125c056395ce3b6234d56a831570c624f8a684e24"
      malware             = "FatalRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Beijing Jianguang Trading Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6c:16:2b:47:bd:e6:ab:b3:37:79:6a:32:ac:ea:eb:3a"
      cert_thumbprint     = "664CB4E2695B7C17337CB5D7C9E2D38BEB274EF2"
      cert_valid_from     = "2024-07-11"
      cert_valid_to       = "2025-07-11"

      country             = "CN"
      state               = "Beijing"
      locality            = "Beijing"
      email               = "???"
      rdn_serial_number   = "91110106MA00BTU826"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6c:16:2b:47:bd:e6:ab:b3:37:79:6a:32:ac:ea:eb:3a"
      )
}

rule MAL_Compromised_Cert_FlawedAmmyy_GlobalSign_4484F1C5B6A72DFEC0E1CA55 {
   meta:
      description         = "Detects FlawedAmmyy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-13"
      version             = "1.0"

      hash                = "5be959722d8cd4bfd6f88a4901f44f9a43aa875f55ec90e6a91a36a7186cd4a5"
      malware             = "FlawedAmmyy"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TAIM LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "44:84:f1:c5:b6:a7:2d:fe:c0:e1:ca:55"
      cert_thumbprint     = "4CB87577FA5B91346CCE30FB9FF3139D46DE3361"
      cert_valid_from     = "2023-06-13"
      cert_valid_to       = "2024-06-13"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1237700338303"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "44:84:f1:c5:b6:a7:2d:fe:c0:e1:ca:55"
      )
}

rule MAL_Compromised_Cert_Formbook_Sectigo_009AE5B177AC3A7CE2AADF1C891B574924 {
   meta:
      description         = "Detects Formbook with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-16"
      version             = "1.0"

      hash                = "3bfe5c5cfe153699f3627845f5f9b44c7ccc09b9cc8e34203d73c993439510a9"
      malware             = "Formbook"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO Kolorit"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:9a:e5:b1:77:ac:3a:7c:e2:aa:df:1c:89:1b:57:49:24"
      cert_thumbprint     = "13EF12700D995A3527EABE0D9BAC3E96332FAF1E"
      cert_valid_from     = "2020-12-16"
      cert_valid_to       = "2021-12-16"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:9a:e5:b1:77:ac:3a:7c:e2:aa:df:1c:89:1b:57:49:24"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_Certum_49628D191450A16A85249183C7533D7F {
   meta:
      description         = "Detects FriendsCompany with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-07"
      version             = "1.0"

      hash                = "f83d5515a1f2cc04b486a30e87a00050f91a5d92c9a8db054113583c2d7c653f"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Chongqing Qirui Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "49:62:8d:19:14:50:a1:6a:85:24:91:83:c7:53:3d:7f"
      cert_thumbprint     = "31A8FE02E6873472379C292681CF698AF73BDE36"
      cert_valid_from     = "2025-03-07"
      cert_valid_to       = "2026-03-07"

      country             = "CN"
      state               = "Chongqing"
      locality            = "Chongqing"
      email               = "???"
      rdn_serial_number   = "91500107MA7FMGBN5F"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "49:62:8d:19:14:50:a1:6a:85:24:91:83:c7:53:3d:7f"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_085983378E4F015ACCF56A49 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-03"
      version             = "1.0"

      hash                = "518d779f9ebed493a6dde8c0e90098b888976b6785809a30e60ddf106b0289c8"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "VALEMO GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "08:59:83:37:8e:4f:01:5a:cc:f5:6a:49"
      cert_thumbprint     = "209B0B67CE472D957E0CBFA51D3B6B131E22FBD5"
      cert_valid_from     = "2025-02-03"
      cert_valid_to       = "2026-02-04"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "admin@valemogmbh.com"
      rdn_serial_number   = "633901h"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "08:59:83:37:8e:4f:01:5a:cc:f5:6a:49"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_0A824CC64D7CA10842746047 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-13"
      version             = "1.0"

      hash                = "7200d36264736d7fc359ad02b0ee625d964b71e058b034f9e014f13925138065"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "NATIONAL CLOUD COMPUTING Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0a:82:4c:c6:4d:7c:a1:08:42:74:60:47"
      cert_thumbprint     = "44C1D4B9671CD0A75DE19877FE906231D880F5D4"
      cert_valid_from     = "2024-12-13"
      cert_valid_to       = "2025-12-14"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "923966-9"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0a:82:4c:c6:4d:7c:a1:08:42:74:60:47"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_0D299A61BDA4BEAECBB27DC2 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-07"
      version             = "1.0"

      hash                = "79881ec9356ca56c03ade331a2f8d08840c9fc4ef793edbf5d51ba1f2be89dd4"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "CODE IN THE CONTEXT LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0d:29:9a:61:bd:a4:be:ae:cb:b2:7d:c2"
      cert_thumbprint     = "D15225AFE5B409150D3F9B6D5FDB31F0CA7F8446"
      cert_valid_from     = "2025-02-07"
      cert_valid_to       = "2026-02-08"

      country             = "GB"
      state               = "Hampshire"
      locality            = "Winchester"
      email               = "???"
      rdn_serial_number   = "13628009"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0d:29:9a:61:bd:a4:be:ae:cb:b2:7d:c2"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_0FC2C668F342CB47C00F3FB7 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-12"
      version             = "1.0"

      hash                = "3beccc3a7df1ede9c5a0f5228b5028f719eab04d65321d7063f90e7c7d47e7f9"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "AMPlus Power Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0f:c2:c6:68:f3:42:cb:47:c0:0f:3f:b7"
      cert_thumbprint     = "3EDBEB26B8C38172A6BF87CCD625D40B946E31B1"
      cert_valid_from     = "2025-02-12"
      cert_valid_to       = "2026-02-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Kingston"
      email               = "???"
      rdn_serial_number   = "10322601"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0f:c2:c6:68:f3:42:cb:47:c0:0f:3f:b7"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_14663FA82097F6160161778D {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-07"
      version             = "1.0"

      hash                = "302c964d52de43ce0c11cbf2b90c277b159e8365233c732c675c0e16e748b39f"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "PAT sp. z o. o."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "14:66:3f:a8:20:97:f6:16:01:61:77:8d"
      cert_thumbprint     = "F798FCA1BA2FD09E5B85B112D38C1F1ABD05E978"
      cert_valid_from     = "2025-02-07"
      cert_valid_to       = "2026-02-08"

      country             = "PL"
      state               = "Śląskie"
      locality            = "Gliwice"
      email               = "admin@patgliwice.com"
      rdn_serial_number   = "0000682928"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "14:66:3f:a8:20:97:f6:16:01:61:77:8d"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_26B8EECF4BE99FCCDC8835C5 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "2c8cf7233fd4c75bfb19cbf6b573607e6cdf684cb010288e49bcbda6941202a8"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "SHEEN & PROSPECTS INFOTECH PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "26:b8:ee:cf:4b:e9:9f:cc:dc:88:35:c5"
      cert_thumbprint     = "C2ADF7CD38EB1446B210E97FEF3F89D95C9F7E84"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-11"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "sheenandprospectsinfotech@gmail.com"
      rdn_serial_number   = "U74999BR2016PTC032005"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "26:b8:ee:cf:4b:e9:9f:cc:dc:88:35:c5"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_35E8BF21507DC6EE53E024BB {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-28"
      version             = "1.0"

      hash                = "dcdaeb418cf49503d788d9471a8d1f1f6124209aeb86cfe4d17631b1e1a92d73"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "OOO WLD GROUPP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "35:e8:bf:21:50:7d:c6:ee:53:e0:24:bb"
      cert_thumbprint     = "829FDFBCCFC4AAF1E25B2A3229B17ED793DAFD4B"
      cert_valid_from     = "2025-03-28"
      cert_valid_to       = "2026-03-29"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "wldgroupp@rambler.ru"
      rdn_serial_number   = "1167847423446"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "35:e8:bf:21:50:7d:c6:ee:53:e0:24:bb"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_41F26F261D5FE0453BCB27DD {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-05"
      version             = "1.0"

      hash                = "b6fb38d6d17d1bafe423677ed9372e8caebb7237d6d4cf1ec25c0990ed2b7a2a"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Concept LDL Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:f2:6f:26:1d:5f:e0:45:3b:cb:27:dd"
      cert_thumbprint     = "7337ACC592D8725767DED2E94C579C120A531EB5"
      cert_valid_from     = "2025-02-05"
      cert_valid_to       = "2026-02-06"

      country             = "CA"
      state               = "Quebec"
      locality            = "Varennes"
      email               = "???"
      rdn_serial_number   = "954346-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:f2:6f:26:1d:5f:e0:45:3b:cb:27:dd"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_465457B019B7198ED0FCEE1B {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-16"
      version             = "1.0"

      hash                = "39308d995d17f7a91a766e9da0c925c021a005006f879f6d68b85aa1a333e90d"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Spparts Tech Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "46:54:57:b0:19:b7:19:8e:d0:fc:ee:1b"
      cert_thumbprint     = "56395970d37aa8d7f2e9fc81390e52d133281ebab65d0e4b5bb8a5a531fdc1c5"
      cert_valid_from     = "2025-01-16"
      cert_valid_to       = "2026-01-17"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Delta"
      email               = "???"
      rdn_serial_number   = "1450347-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "46:54:57:b0:19:b7:19:8e:d0:fc:ee:1b"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_46CB25253979CA375FBDE978 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-25"
      version             = "1.0"

      hash                = "d2a76bb92897eb6d0ec5d29661b07e3614390bca529b4f0542c1a260e5f94676"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "CHANGE AGITATORS LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "46:cb:25:25:39:79:ca:37:5f:bd:e9:78"
      cert_thumbprint     = "167D3E3399C69CD324B650AC3B0C095C8E54507E"
      cert_valid_from     = "2025-02-25"
      cert_valid_to       = "2026-02-26"

      country             = "GB"
      state               = "Surrey"
      locality            = "Egham"
      email               = "???"
      rdn_serial_number   = "10684411"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "46:cb:25:25:39:79:ca:37:5f:bd:e9:78"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_4DBE694470C2449C1B460474 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "3333052fc4327ff35d8f6fbb74a7956e1f2586fe8c344d3b914eba0fd9e9cab0"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Jiangyin Fengyuan Electronics Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4d:be:69:44:70:c2:44:9c:1b:46:04:74"
      cert_thumbprint     = "383293AA310249D98C6781F0749C873A7BA86B40"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2026-03-15"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4d:be:69:44:70:c2:44:9c:1b:46:04:74"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_54B4E44F221DC66A7154AB37 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-18"
      version             = "1.0"

      hash                = "5cacb3149b25c9a6cc625ef37fafd4c9a4f0c40d3f09b702dcdf194d130475bc"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "SAULE FARMACJA sp. z o. o."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "54:b4:e4:4f:22:1d:c6:6a:71:54:ab:37"
      cert_thumbprint     = "4A4571719FEAEE7B9F375FAA9795EBF8FEEA4B0B"
      cert_valid_from     = "2025-02-18"
      cert_valid_to       = "2026-02-19"

      country             = "PL"
      state               = "Wielkopolskie"
      locality            = "Skórzewo"
      email               = "admin@saulefarmacja.com"
      rdn_serial_number   = "0000678403"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "54:b4:e4:4f:22:1d:c6:6a:71:54:ab:37"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_5781E1DF1C57601541DC6FC9 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-03"
      version             = "1.0"

      hash                = "bc71f58b2438a89e2cd189b8896a97b2436f091ab240861b84435afcdc3db746"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "DRSSOFT INC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "57:81:e1:df:1c:57:60:15:41:dc:6f:c9"
      cert_thumbprint     = "d4ac34a8c9b1385bd3b6da3f8151dbca851209823ed329fa26c419e8d86d1cd7"
      cert_valid_from     = "2024-10-03"
      cert_valid_to       = "2025-10-04"

      country             = "US"
      state               = "Alabama"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "000-224-897"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "57:81:e1:df:1c:57:60:15:41:dc:6f:c9"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_5E6E10ECD4AE2EDCFE85605C {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-21"
      version             = "1.0"

      hash                = "8c997741843c505e816705b7d6e7db178c5bc8325892a1687506b59fb2ab2534"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "GAME CHANGERS EXECUTIVE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5e:6e:10:ec:d4:ae:2e:dc:fe:85:60:5c"
      cert_thumbprint     = "9B36F7F59239008A07CDC70480A66753EFFC93FF"
      cert_valid_from     = "2025-02-21"
      cert_valid_to       = "2026-02-22"

      country             = "GB"
      state               = "London"
      locality            = "London"
      email               = "admin@gamechangersexecutive.com"
      rdn_serial_number   = "10976088"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5e:6e:10:ec:d4:ae:2e:dc:fe:85:60:5c"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_5E7E1B37C1C2D1CC7F884FF1 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-27"
      version             = "1.0"

      hash                = "2e33f42df7869fe19967ae9839d9346a976b13213e68e80a8611d71c864d8ba9"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Novadawn Technology Corporation"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5e:7e:1b:37:c1:c2:d1:cc:7f:88:4f:f1"
      cert_thumbprint     = "212709cd8b881e416b395f4af827f60a491f15dc28781dadef543f711e27aeed"
      cert_valid_from     = "2025-01-27"
      cert_valid_to       = "2026-01-28"

      country             = "CA"
      state               = "Alberta"
      locality            = "Edmonton"
      email               = "???"
      rdn_serial_number   = "1261432-4"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5e:7e:1b:37:c1:c2:d1:cc:7f:88:4f:f1"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_655AC2D30E23DED740DE4BDF {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-12"
      version             = "1.0"

      hash                = "a967506f4c91acb14978840b188eeacee9e8a3643340a9c89e246114f4e9c608"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Wuxi Ruisidi Precision Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:5a:c2:d3:0e:23:de:d7:40:de:4b:df"
      cert_thumbprint     = "BF146510C8354EF90E62724556566ABCB4085FE2"
      cert_valid_from     = "2025-02-12"
      cert_valid_to       = "2026-02-13"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "91320282MA266XCM5B"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:5a:c2:d3:0e:23:de:d7:40:de:4b:df"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_6610E8BAB06EBBA740ACA06A {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-18"
      version             = "1.0"

      hash                = "4bfd8b426224f863d39d8aba44920b2f93487d1de91d17b007df25195ebead6d"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "MaKsimal GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "66:10:e8:ba:b0:6e:bb:a7:40:ac:a0:6a"
      cert_thumbprint     = "314EDC70D9CDA96D783DC80AC823A6014E70FA71"
      cert_valid_from     = "2025-02-18"
      cert_valid_to       = "2027-02-19"

      country             = "AT"
      state               = "Oberoesterreich"
      locality            = "Gunskirchen"
      email               = "admin@maksimalgmbh.com"
      rdn_serial_number   = "624953z"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "66:10:e8:ba:b0:6e:bb:a7:40:ac:a0:6a"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_6AE0A20A8E7B84C607E91D16 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-10"
      version             = "1.0"

      hash                = "b557531bcb94bb8208d688c9f791f9aa265de97ce7c8e74f7a72a9313069dd47"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "DJ Webb Investments LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6a:e0:a2:0a:8e:7b:84:c6:07:e9:1d:16"
      cert_thumbprint     = "7E5D13F73C5F23B8996CAD0EBEAFFC248C9FDE74"
      cert_valid_from     = "2025-02-10"
      cert_valid_to       = "2026-02-11"

      country             = "US"
      state               = "Alaska"
      locality            = "Anchorage"
      email               = "???"
      rdn_serial_number   = "10155897"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6a:e0:a2:0a:8e:7b:84:c6:07:e9:1d:16"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_GlobalSign_74703A08797E5F2DD4C6C7B8 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-30"
      version             = "1.0"

      hash                = "b4b18e51c1a1545a9ab869db2ca12782aae89d835220295cd45acd287f02ab93"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "RMB SYSTEM sp. z o. o."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "74:70:3a:08:79:7e:5f:2d:d4:c6:c7:b8"
      cert_thumbprint     = "2251345B20556D9E796DF3E042A1219F94CF5CF3"
      cert_valid_from     = "2025-01-30"
      cert_valid_to       = "2028-01-31"

      country             = "PL"
      state               = "Lubelskie"
      locality            = "Lublin"
      email               = "admin@rmb-system.com"
      rdn_serial_number   = "0000850938"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "74:70:3a:08:79:7e:5f:2d:d4:c6:c7:b8"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_SSL_com_0316079DD29661DAE8A6747BD391F4D6 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "7adc2e2f2e7e0fac1c063009781343794c7a607943c5d9978d4c8d30ff5cfa01"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Hiveonline ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "03:16:07:9d:d2:96:61:da:e8:a6:74:7b:d3:91:f4:d6"
      cert_thumbprint     = "550251328C671A8B43C56ABE00ACA22A072520EB"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2026-06-12"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Copenhagen"
      email               = "???"
      rdn_serial_number   = "38250302"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "03:16:07:9d:d2:96:61:da:e8:a6:74:7b:d3:91:f4:d6"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_SSL_com_151F088C6A9ADEF03457543A7C33BCD3 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "469734a8acf5f8adf7869abaf1958ba12373aa4434a9aae7b4232e497ba845a2"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "JMD Event-Ticketing GmbH"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:1f:08:8c:6a:9a:de:f0:34:57:54:3a:7c:33:bc:d3"
      cert_thumbprint     = "016BE5A7939FBD817616404D12764A9235594737"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-10"

      country             = "AT"
      state               = "Vienna"
      locality            = "Vienna"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:1f:08:8c:6a:9a:de:f0:34:57:54:3a:7c:33:bc:d3"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_SSL_com_39AB793FFA01B5F68E1FA1E1E6F2403D {
   meta:
      description         = "Detects FriendsCompany with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-24"
      version             = "1.0"

      hash                = "f03b5fe265e1e5d85c521a57b6adf89f243b754b96ebf0caccfa48e51d683c5d"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Kdv Software Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "39:ab:79:3f:fa:01:b5:f6:8e:1f:a1:e1:e6:f2:40:3d"
      cert_thumbprint     = "3C92E18C7BDA3BDF158AFDDE6E3616E2135B8E52"
      cert_valid_from     = "2025-01-24"
      cert_valid_to       = "2026-01-24"

      country             = "PL"
      state               = "Mazowieckie"
      locality            = "Zielonka"
      email               = "???"
      rdn_serial_number   = "0000702209"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "39:ab:79:3f:fa:01:b5:f6:8e:1f:a1:e1:e6:f2:40:3d"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_SSL_com_42B4948D594C0966989B324AC0F8015A {
   meta:
      description         = "Detects FriendsCompany with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-26"
      version             = "1.0"

      hash                = "791f3cb7b0f04be9491ee0aef75d9365bfc4242d0d630b86c6b57cf098a758af"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "FarmWarp ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "42:b4:94:8d:59:4c:09:66:98:9b:32:4a:c0:f8:01:5a"
      cert_thumbprint     = "F23D9571080AF674C1D31DEBE81D270A58908034"
      cert_valid_from     = "2025-02-26"
      cert_valid_to       = "2026-02-26"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Nivå"
      email               = "???"
      rdn_serial_number   = "42530425"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "42:b4:94:8d:59:4c:09:66:98:9b:32:4a:c0:f8:01:5a"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_SSL_com_62E3877BFA8C43A2E626461AB7C59E54 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "0d7191500b429e6d258dc09807e52b59dd739c6636ce01ae945caf3170d49325"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Al-Base Trading Corp."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "62:e3:87:7b:fa:8c:43:a2:e6:26:46:1a:b7:c5:9e:54"
      cert_thumbprint     = "6CC45AD704EDDC34CCD008ED7D016E289AD25B0E"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-21"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Surrey"
      email               = "???"
      rdn_serial_number   = "1119742-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "62:e3:87:7b:fa:8c:43:a2:e6:26:46:1a:b7:c5:9e:54"
      )
}

rule MAL_Compromised_Cert_FriendsCompany_SSL_com_7A2A5D0296453B1D8FFF99EB0E59D344 {
   meta:
      description         = "Detects FriendsCompany with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-12"
      version             = "1.0"

      hash                = "eb53a94b153191bc14904748a21134aba8eab77701f04afdf178a5b83c57c3af"
      malware             = "FriendsCompany"
      malware_type        = "Loader"
      malware_notes       = "This malware is sold as a service. Frequently used with infostealers. See the following for more details: https://trac-labs.com/the-wagmi-manual-copy-paste-and-profit-2803a15bf540"

      signer              = "Pinkou (SH) Culture Communication Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:2a:5d:02:96:45:3b:1d:8f:ff:99:eb:0e:59:d3:44"
      cert_thumbprint     = "A918B378A3559D19C9D9400FF8441EB86990D309"
      cert_valid_from     = "2024-03-12"
      cert_valid_to       = "2025-03-11"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:2a:5d:02:96:45:3b:1d:8f:ff:99:eb:0e:59:d3:44"
      )
}

rule MAL_Compromised_Cert_GCleaner_stage2_GlobalSign_7DBFA4CF4ABCDCD02F7F703E {
   meta:
      description         = "Detects GCleaner_stage2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-03"
      version             = "1.0"

      hash                = "f35ebf7bb19f45a1eeff06c63713510730a80bbc9ff395f21185d0e0ffb833c1"
      malware             = "GCleaner_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Longshang Inc"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7d:bf:a4:cf:4a:bc:dc:d0:2f:7f:70:3e"
      cert_thumbprint     = "26DFD16A2C5140A44DC33D6A8C973E137D867078"
      cert_valid_from     = "2025-11-03"
      cert_valid_to       = "2026-11-04"

      country             = "US"
      state               = "Colorado"
      locality            = "Denver"
      email               = "???"
      rdn_serial_number   = "20258080311"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7d:bf:a4:cf:4a:bc:dc:d0:2f:7f:70:3e"
      )
}

rule MAL_Compromised_Cert_Gh0stRAT_Certum_5F737E82330734C32297EF89B72FB607 {
   meta:
      description         = "Detects Gh0stRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-22"
      version             = "1.0"

      hash                = "349b54f136e63904ed5a1b3921d8744d3815592690f9167aedd3ead075ced9a4"
      malware             = "Gh0stRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Keroro Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5f:73:7e:82:33:07:34:c3:22:97:ef:89:b7:2f:b6:07"
      cert_thumbprint     = "4CE7B99C56D5EFE4FCE93D71010D53941C3A635A"
      cert_valid_from     = "2025-02-22"
      cert_valid_to       = "2026-02-22"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5FAR1W6E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5f:73:7e:82:33:07:34:c3:22:97:ef:89:b7:2f:b6:07"
      )
}

rule MAL_Compromised_Cert_Gh0stRAT_Certum_7ABFE16530E58B737042EE3B6BFB1801 {
   meta:
      description         = "Detects Gh0stRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-01"
      version             = "1.0"

      hash                = "e60b7e51420c59d34acd455907654dd2fdf9fc13d303f33e642b5da499fa7fb7"
      malware             = "Gh0stRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "烟台卡姆云信息科技有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "7a:bf:e1:65:30:e5:8b:73:70:42:ee:3b:6b:fb:18:01"
      cert_thumbprint     = "2B6BF84DED571DEF739F3E3AD7A8081AB380546C"
      cert_valid_from     = "2025-07-01"
      cert_valid_to       = "2026-07-01"

      country             = "CN"
      state               = "山东省"
      locality            = "烟台市"
      email               = "???"
      rdn_serial_number   = "91370613MACP97G01D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "7a:bf:e1:65:30:e5:8b:73:70:42:ee:3b:6b:fb:18:01"
      )
}

rule MAL_Compromised_Cert_Gh0stRAT_GlobalSign_56AEB8269A0FE8ADF9D1BBD8 {
   meta:
      description         = "Detects Gh0stRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-24"
      version             = "1.0"

      hash                = "d8655cb920dff79d3fc2006247925cf66c198595ed3e496218a5b24c2bb1080f"
      malware             = "Gh0stRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UCon Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:ae:b8:26:9a:0f:e8:ad:f9:d1:bb:d8"
      cert_thumbprint     = "064F423FCB68FCF5246A5F379F2405D1CEB789C0"
      cert_valid_from     = "2025-04-24"
      cert_valid_to       = "2026-04-25"

      country             = "CN"
      state               = "GUANGDONG"
      locality            = "SHENZHEN"
      email               = "???"
      rdn_serial_number   = "914403003350884898"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:ae:b8:26:9a:0f:e8:ad:f9:d1:bb:d8"
      )
}

rule MAL_Compromised_Cert_Gh0stRAT_Sectigo_2F38DE4CED0B070973B9E9B9B1DCFA7F {
   meta:
      description         = "Detects Gh0stRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-17"
      version             = "1.0"

      hash                = "dfa35440cfd1f31f25414561d49989f7e92d87275f2451c0132fc8398ff8e4c9"
      malware             = "Gh0stRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Fahad Malik"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "2f:38:de:4c:ed:0b:07:09:73:b9:e9:b9:b1:dc:fa:7f"
      cert_thumbprint     = "D62345CDB71AB6462FE87E9644036DCB2C022B98"
      cert_valid_from     = "2021-05-17"
      cert_valid_to       = "2022-05-17"

      country             = "PK"
      state               = "???"
      locality            = "Multan"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "2f:38:de:4c:ed:0b:07:09:73:b9:e9:b9:b1:dc:fa:7f"
      )
}

rule MAL_Compromised_Cert_Gh0st_RAT_Sectigo_00FEF386AC9C1D8636CB370C8C247F44FA {
   meta:
      description         = "Detects Gh0st RAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-08"
      version             = "1.0"

      hash                = "8071c7b74e7ca2769f3746ec8cc007caee65474bb77808b7a84c84f877452605"
      malware             = "Gh0st RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DAVINCI VISION LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:fe:f3:86:ac:9c:1d:86:36:cb:37:0c:8c:24:7f:44:fa"
      cert_thumbprint     = "81458929D258DB62735B3A6D56577FED725C2A02"
      cert_valid_from     = "2024-05-08"
      cert_valid_to       = "2025-05-08"

      country             = "CN"
      state               = "香港特别行政区"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "73087152"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:fe:f3:86:ac:9c:1d:86:36:cb:37:0c:8c:24:7f:44:fa"
      )
}

rule MAL_Compromised_Cert_GhostRAT_Certum_46C6C62207C137E628861568419977EE {
   meta:
      description         = "Detects GhostRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-30"
      version             = "1.0"

      hash                = "968e5b0abc123f1f2097b5064637a1ab5779205682988880910e3c2d11d51f31"
      malware             = "GhostRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This sample was delivered via phishing, disguised as a image file. This malware is known to be used by a wide range of actors."

      signer              = "北京谷云达吉商贸有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "46:c6:c6:22:07:c1:37:e6:28:86:15:68:41:99:77:ee"
      cert_thumbprint     = "1F75E580CA564F630214EAEF027A426BA2408715"
      cert_valid_from     = "2025-10-30"
      cert_valid_to       = "2026-10-30"

      country             = "CN"
      state               = "北京市"
      locality            = "北京市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "46:c6:c6:22:07:c1:37:e6:28:86:15:68:41:99:77:ee"
      )
}

rule MAL_Compromised_Cert_GhostSocks_Certum_1905352485295F24C0DB0A61AE7EFC68 {
   meta:
      description         = "Detects GhostSocks with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-21"
      version             = "1.0"

      hash                = "4d1efd06b57f610e1ac066543d08176eb48dacd932eeda5735dfcaf6bf493573"
      malware             = "GhostSocks"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TeraShift GmbH"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "19:05:35:24:85:29:5f:24:c0:db:0a:61:ae:7e:fc:68"
      cert_thumbprint     = "9721B8E9C4B029ACD781ED07B5C5C50979A8C8E9"
      cert_valid_from     = "2024-11-21"
      cert_valid_to       = "2027-11-21"

      country             = "CH"
      state               = "Appenzell Innerrhoden"
      locality            = "Appenzell"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "19:05:35:24:85:29:5f:24:c0:db:0a:61:ae:7e:fc:68"
      )
}

rule MAL_Compromised_Cert_Github_Loader_GlobalSign_616B166E814736AA88A96A53 {
   meta:
      description         = "Detects Github Loader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "0e5b342033b68fd3f79404fd90356f48e6473a025d5f74a8d1ba6754f1fbfa99"
      malware             = "Github Loader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RAJLAXMI PVT LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "61:6b:16:6e:81:47:36:aa:88:a9:6a:53"
      cert_thumbprint     = "7018B57F4947E57388E24F2D27D2D262252F52CB"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-11"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "sunilgautamjpr90@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "61:6b:16:6e:81:47:36:aa:88:a9:6a:53"
      )
}

rule MAL_Compromised_Cert_GoStealer_GlobalSign_280443BBAEBC15C57CA54492 {
   meta:
      description         = "Detects GoStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "dff89c7a8376baa37c9085a5c20c0a9bd5af6ecce66d6a2ff4f5b6c190d6b562"
      malware             = "GoStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THINK ELLIPSE PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "28:04:43:bb:ae:bc:15:c5:7c:a5:44:92"
      cert_thumbprint     = "EA007932C2326F256A0C63F0A95BCFA86C8DC544"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-11"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "ceothinkellips@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "28:04:43:bb:ae:bc:15:c5:7c:a5:44:92"
      )
}

rule MAL_Compromised_Cert_GoblinLoader_SSL_com_01F9C8D6A864B87722B7EDDB621BD1EB {
   meta:
      description         = "Detects GoblinLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-17"
      version             = "1.0"

      hash                = "a5077a730f5f178416d797f96942d2fc3b632ae449495a4be8525a4289a97274"
      malware             = "GoblinLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VE Development sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "01:f9:c8:d6:a8:64:b8:77:22:b7:ed:db:62:1b:d1:eb"
      cert_thumbprint     = "63b3e89bf11421670f8de04312fd248ad122149bdac5c4501d84e7f71cc389f7"
      cert_valid_from     = "2025-02-17"
      cert_valid_to       = "2026-02-17"

      country             = "PL"
      state               = "???"
      locality            = "Łódź"
      email               = "???"
      rdn_serial_number   = "0000946525"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "01:f9:c8:d6:a8:64:b8:77:22:b7:ed:db:62:1b:d1:eb"
      )
}

rule MAL_Compromised_Cert_GoblinLoader_SSL_com_19A65FD06F2F1433306F3968848F40CE {
   meta:
      description         = "Detects GoblinLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-13"
      version             = "1.0"

      hash                = "28da14b5f7e5f0bc5a075525d13eb4260ee3f5f592f16846dffa8d8e9724ca80"
      malware             = "GoblinLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cascade Tech-Trek Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "19:a6:5f:d0:6f:2f:14:33:30:6f:39:68:84:8f:40:ce"
      cert_thumbprint     = "04DF18CF4F6AC1E42B6F6D0487D2F1461314F99D"
      cert_valid_from     = "2024-12-13"
      cert_valid_to       = "2025-12-13"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Burnaby"
      email               = "???"
      rdn_serial_number   = "771956-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "19:a6:5f:d0:6f:2f:14:33:30:6f:39:68:84:8f:40:ce"
      )
}

rule MAL_Compromised_Cert_GodRAT_GlobalSign_476687EF336E88504E5ECE57 {
   meta:
      description         = "Detects GodRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-13"
      version             = "1.0"

      hash                = "db8614ad49b98d8d13d86c1ba74b248c56aead687f9815840e2141e3f6da4450"
      malware             = "GodRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is a never malware with similar developer as Gh0stRAT per Kaspersky: https://securelist.com/godrat/117119/"

      signer              = "金润方舟科技股份有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:66:87:ef:33:6e:88:50:4e:5e:ce:57"
      cert_thumbprint     = "CA3603C36C93AAE2B0EAC87E69DC0F37EB3835E1"
      cert_valid_from     = "2025-08-13"
      cert_valid_to       = "2028-08-13"

      country             = "CN"
      state               = "西藏"
      locality            = "拉萨"
      email               = "???"
      rdn_serial_number   = "91110108753322186R"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:66:87:ef:33:6e:88:50:4e:5e:ce:57"
      )
}

rule MAL_Compromised_Cert_GoreloRMM_GlobalSign_7CEF117D5B3C634C182E1479 {
   meta:
      description         = "Detects GoreloRMM with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-12"
      version             = "1.0"

      hash                = "704772da03060dcc4e2b65817fa2d0baea31ae45984d2b3e0e32bea0a28552c5"
      malware             = "GoreloRMM"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PrimeSnap Technologies Network Company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7c:ef:11:7d:5b:3c:63:4c:18:2e:14:79"
      cert_thumbprint     = "9D600FDE1827AE6D6403B905EBAFE2C8633A610E"
      cert_valid_from     = "2024-11-12"
      cert_valid_to       = "2025-11-12"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7c:ef:11:7d:5b:3c:63:4c:18:2e:14:79"
      )
}

rule MAL_Compromised_Cert_Gozi_Comodo_00C1A1DB95D7BF80290AA6E82D8F8F996A {
   meta:
      description         = "Detects Gozi with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-10"
      version             = "1.0"

      hash                = "8f6b3ca7b7afd249f3fc68f7ff2ce5ca5a206c2a1d123b5ac3aa28bf7f1eabd8"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Software Two Pty Ltd"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Extended Validation Code Signing CA"
      cert_serial         = "00:c1:a1:db:95:d7:bf:80:29:0a:a6:e8:2d:8f:8f:99:6a"
      cert_thumbprint     = "C1313E87F7D9586016A32F6EDFCA281D1A3D2D29"
      cert_valid_from     = "2021-03-10"
      cert_valid_to       = "2022-03-10"

      country             = "AU"
      state               = "New South Wales"
      locality            = "Newtown"
      email               = "???"
      rdn_serial_number   = "86 609 945 191"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Extended Validation Code Signing CA" and
         sig.serial == "00:c1:a1:db:95:d7:bf:80:29:0a:a6:e8:2d:8f:8f:99:6a"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_00B06BC166FC765DACD2F7448C8CDD9205 {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-12"
      version             = "1.0"

      hash                = "31b94c5a94aa8ce7e187360b0dc702b473d1c5d498d4de26f137b272ccbadaed"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GAS Avto, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b0:6b:c1:66:fc:76:5d:ac:d2:f7:44:8c:8c:dd:92:05"
      cert_thumbprint     = "BB3BADBF68C50BA24DBF66D17799857D7D1BAFF1"
      cert_valid_from     = "2021-03-12"
      cert_valid_to       = "2022-03-12"

      country             = "SI"
      state               = "???"
      locality            = "Ljubljana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b0:6b:c1:66:fc:76:5d:ac:d2:f7:44:8c:8c:dd:92:05"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_00B383658885E271129A43D19DE40C1FC6 {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-05-27"
      version             = "1.0"

      hash                = "2e0b219c5ac3285a08e126f11c07ea3ac60bc96d16d37c2dc24dd8f68c492a74"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Elekon"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b3:83:65:88:85:e2:71:12:9a:43:d1:9d:e4:0c:1f:c6"
      cert_thumbprint     = "5C706ED4C41F196294C078F9B122BABFFA15DAE4"
      cert_valid_from     = "2020-05-27"
      cert_valid_to       = "2021-05-27"

      country             = "RU"
      state               = "Irkutskaya Obl"
      locality            = "Irkutsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b3:83:65:88:85:e2:71:12:9a:43:d1:9d:e4:0c:1f:c6"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_00B4F42E2C153C904FDA64C957ED7E1028 {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-20"
      version             = "1.0"

      hash                = "9e0cfd00991a3d387a78770a7748418b4d0ab978717f84a399d766b19a971df0"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NONO spol. s r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b4:f4:2e:2c:15:3c:90:4f:da:64:c9:57:ed:7e:10:28"
      cert_thumbprint     = "ED4C50AB4F173CF46386A73226FA4DAC9CADC1C4"
      cert_valid_from     = "2020-10-20"
      cert_valid_to       = "2021-10-20"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b4:f4:2e:2c:15:3c:90:4f:da:64:c9:57:ed:7e:10:28"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_00D9D419C9095A79B1F764297ADDB935DA {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-25"
      version             = "1.0"

      hash                = "7b8ef3f064d0de0c27d56ff4df7d360f0d546d32aabbdf96a746bab5c84277ec"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO Nova soft"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d9:d4:19:c9:09:5a:79:b1:f7:64:29:7a:dd:b9:35:da"
      cert_thumbprint     = "7D45EC21C0D6FD0EB84E4271655EB0E005949614"
      cert_valid_from     = "2020-10-25"
      cert_valid_to       = "2021-10-25"

      country             = "RU"
      state               = "???"
      locality            = "Belgorod"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d9:d4:19:c9:09:5a:79:b1:f7:64:29:7a:dd:b9:35:da"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_00DF683D46D8C3832489672CC4E82D3D5D {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-12"
      version             = "1.0"

      hash                = "7a5e4fd35a1a636ef1beb7e62cc647d7e63f5c7aadd2aa1a49d49c81183aca93"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Osatokio Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:df:68:3d:46:d8:c3:83:24:89:67:2c:c4:e8:2d:3d:5d"
      cert_thumbprint     = "2119AB338EC2589199A36B0F1793D17A74B7CF2E"
      cert_valid_from     = "2020-11-12"
      cert_valid_to       = "2021-11-12"

      country             = "FI"
      state               = "???"
      locality            = "Vantaa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:df:68:3d:46:d8:c3:83:24:89:67:2c:c4:e8:2d:3d:5d"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_2F96A89BFEC6E44DD224E8FD7E72D9BB {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-06"
      version             = "1.0"

      hash                = "54de1f2c26a63a8f6b7f8d5de99f8ebd4093959ab07f027db1985d0652258736"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NAILS UNLIMITED LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "2f:96:a8:9b:fe:c6:e4:4d:d2:24:e8:fd:7e:72:d9:bb"
      cert_thumbprint     = "CA69087AAAA087346202AD16228337130511C4C5"
      cert_valid_from     = "2021-07-06"
      cert_valid_to       = "2022-07-06"

      country             = "GB"
      state               = "Dorset"
      locality            = "DORCHESTER"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "2f:96:a8:9b:fe:c6:e4:4d:d2:24:e8:fd:7e:72:d9:bb"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_37A67CF754EE5AE284B4CF8B9D651604 {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-02"
      version             = "1.0"

      hash                = "da5edd26691ace1af31cfc1e1ae61de36e1c82f02aba24835ca566fe0c9b71a0"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FORTH PROPERTY LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "37:a6:7c:f7:54:ee:5a:e2:84:b4:cf:8b:9d:65:16:04"
      cert_thumbprint     = "7589B73A1B9A28A5AE18586D7C496D9B3971C727"
      cert_valid_from     = "2021-04-02"
      cert_valid_to       = "2022-04-02"

      country             = "GB"
      state               = "Midlothian"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "37:a6:7c:f7:54:ee:5a:e2:84:b4:cf:8b:9d:65:16:04"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_3D3FC30099D6C7AEB806D4181992AF90 {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-02"
      version             = "1.0"

      hash                = "04595c3111276f02b6dc2ece0778cb5829c086484aeafa24e0aac3d8479deb4b"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Baltic Auto SIA"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "3d:3f:c3:00:99:d6:c7:ae:b8:06:d4:18:19:92:af:90"
      cert_thumbprint     = "30576D884D8311D503D9CB030FD547DC26D1AB6B"
      cert_valid_from     = "2021-09-02"
      cert_valid_to       = "2022-09-02"

      country             = "LV"
      state               = "Rīga"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "40103318287"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "3d:3f:c3:00:99:d6:c7:ae:b8:06:d4:18:19:92:af:90"
      )
}

rule MAL_Compromised_Cert_Gozi_Sectigo_54A6D33F73129E0EF059CCF51BE0C35E {
   meta:
      description         = "Detects Gozi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-13"
      version             = "1.0"

      hash                = "5bd267095b25bea0d5a95b4d6c22b871056ca7b8dc137351850d6a577ba62b80"
      malware             = "Gozi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "STAFFORD MEAT COMPANY, INC."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "54:a6:d3:3f:73:12:9e:0e:f0:59:cc:f5:1b:e0:c3:5e"
      cert_thumbprint     = "8ADA307AB3A8983857D122C4CB48BF3B77B49C63"
      cert_valid_from     = "2020-11-13"
      cert_valid_to       = "2021-11-13"

      country             = "US"
      state               = "California"
      locality            = "Rio Linda"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "54:a6:d3:3f:73:12:9e:0e:f0:59:cc:f5:1b:e0:c3:5e"
      )
}

rule MAL_Compromised_Cert_Grandoreiro_GlobalSign_22AC324C723DA451B10246B7 {
   meta:
      description         = "Detects Grandoreiro with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-02"
      version             = "1.0"

      hash                = "34b7a7b91cc32dc8e86224c6d97bf50417d929e715288779ccdaa7375d6c4bb2"
      malware             = "Grandoreiro"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AGE AND EXPERIENCE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "22:ac:32:4c:72:3d:a4:51:b1:02:46:b7"
      cert_thumbprint     = "3327CC4AB5D1CF7AF8B2BFD22A6AA4B7C57CEE84"
      cert_valid_from     = "2024-02-02"
      cert_valid_to       = "2025-02-02"

      country             = "GB"
      state               = "North Yorkshire"
      locality            = "Harrogate"
      email               = "director@ageandexperiencelimited.com"
      rdn_serial_number   = "13772305"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "22:ac:32:4c:72:3d:a4:51:b1:02:46:b7"
      )
}

rule MAL_Compromised_Cert_Grandoreiro_GlobalSign_44743C2FA8445886B47A8D6A {
   meta:
      description         = "Detects Grandoreiro with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-13"
      version             = "1.0"

      hash                = "ed7b784eac6d49f7978cc30183a053d3224bc90a53708351c184dedf17dd25b2"
      malware             = "Grandoreiro"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MR Software GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "44:74:3c:2f:a8:44:58:86:b4:7a:8d:6a"
      cert_thumbprint     = "DA0253D911E76828A744E2F712BA7F20C6DE4511"
      cert_valid_from     = "2024-05-13"
      cert_valid_to       = "2025-05-14"

      country             = "AT"
      state               = "Steiermark"
      locality            = "Kalsdorf bei Graz"
      email               = "admin@mrsoftwareltd.com"
      rdn_serial_number   = "616318a"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "44:74:3c:2f:a8:44:58:86:b4:7a:8d:6a"
      )
}

rule MAL_Compromised_Cert_Grandoreiro_GlobalSign_498987CF459C6B2ACC0A647E {
   meta:
      description         = "Detects Grandoreiro with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-24"
      version             = "1.0"

      hash                = "1464ab9f175dd1a88139a9fe2fcd596e580fad5764ecc75251ca4cd7e3b6ec30"
      malware             = "Grandoreiro"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ROASTED BEANS PTY LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:89:87:cf:45:9c:6b:2a:cc:0a:64:7e"
      cert_thumbprint     = "85af78df310a96c1822cea98688ae07b459c3ec830e4aaf3df34540655fd83e3"
      cert_valid_from     = "2024-06-24"
      cert_valid_to       = "2025-06-01"

      country             = "AU"
      state               = "QUEENSLAND"
      locality            = "ROBINA"
      email               = "admin@roasted-beans.co"
      rdn_serial_number   = "087 245 243"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:89:87:cf:45:9c:6b:2a:cc:0a:64:7e"
      )
}

rule MAL_Compromised_Cert_Grandoreiro_GlobalSign_6A7918CC51CDC1F029F82A82 {
   meta:
      description         = "Detects Grandoreiro with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-05"
      version             = "1.0"

      hash                = "305e220e1f1cb506c32bb509f246515e3cba7ec1dabae95298f358d26654bfa6"
      malware             = "Grandoreiro"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Defz Software Solutions GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6a:79:18:cc:51:cd:c1:f0:29:f8:2a:82"
      cert_thumbprint     = "a8909525c86ca94940682746830598d7b763cbefb0d8e61a2763f60fba52077f"
      cert_valid_from     = "2023-12-05"
      cert_valid_to       = "2024-12-05"

      country             = "AT"
      state               = "Steiermark"
      locality            = "Ludersdorf-Wilfersdorf"
      email               = "admin@defzsoftwaresolutions.com"
      rdn_serial_number   = "597406p"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6a:79:18:cc:51:cd:c1:f0:29:f8:2a:82"
      )
}

rule MAL_Compromised_Cert_Hancitor_Sectigo_1E5EFA53A14599CC82F56F0790E20B17 {
   meta:
      description         = "Detects Hancitor with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-06-09"
      version             = "1.0"

      hash                = "73b8c566d8cdf3200daa0b698b9d32a49b1ea8284a1e6aa6408eb9c9daaacb71"
      malware             = "Hancitor"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Storeks LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "1e:5e:fa:53:a1:45:99:cc:82:f5:6f:07:90:e2:0b:17"
      cert_thumbprint     = "91319E6A55BF0EF68DB8AFB31845AB961356175F"
      cert_valid_from     = "2021-06-09"
      cert_valid_to       = "2022-06-09"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "1e:5e:fa:53:a1:45:99:cc:82:f5:6f:07:90:e2:0b:17"
      )
}

rule MAL_Compromised_Cert_Havoc_SSL_com_1966BC76BDA1A708334792DA9A336F69 {
   meta:
      description         = "Detects Havoc with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-19"
      version             = "1.0"

      hash                = "ee4820ed792f7e6a07b33f041b855b330a8c968a214f5e475f539b4cfdcd65c1"
      malware             = "Havoc"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SYNTHETIC LABS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "19:66:bc:76:bd:a1:a7:08:33:47:92:da:9a:33:6f:69"
      cert_thumbprint     = "29FEC27C36EFC6809C7269F76CF86EE18CC6ED87"
      cert_valid_from     = "2023-05-19"
      cert_valid_to       = "2024-05-16"

      country             = "GB"
      state               = "???"
      locality            = "St. Albans"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "19:66:bc:76:bd:a1:a7:08:33:47:92:da:9a:33:6f:69"
      )
}

rule MAL_Compromised_Cert_Havoc_SSL_com_34C68B013B1CFBDC4B9A686B51F8CE28 {
   meta:
      description         = "Detects Havoc with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-12"
      version             = "1.0"

      hash                = "3e3c562b6558026031a976a88347638eddcb97b9380da8a4453d96eb1ceda807"
      malware             = "Havoc"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TST ENGINEERING JOINT STOCK COMPANY"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "34:c6:8b:01:3b:1c:fb:dc:4b:9a:68:6b:51:f8:ce:28"
      cert_thumbprint     = "250D57689E956AE3C3E5A9A95A869E251123BFCB"
      cert_valid_from     = "2024-09-12"
      cert_valid_to       = "2025-09-12"

      country             = "VN"
      state               = "???"
      locality            = "Ha Noi"
      email               = "???"
      rdn_serial_number   = "0101802137"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "34:c6:8b:01:3b:1c:fb:dc:4b:9a:68:6b:51:f8:ce:28"
      )
}

rule MAL_Compromised_Cert_HermeticWiper_DigiCert_0C48732873AC8CCEBAF8F0E1E8329CEC {
   meta:
      description         = "Detects HermeticWiper with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-13"
      version             = "1.0"

      hash                = "2d29f9ca1d9089ba0399661bb34ba2fd8aba117f04678cd71856d5894aa7150b"
      malware             = "HermeticWiper"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hermetica Digital Ltd"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0c:48:73:28:73:ac:8c:ce:ba:f8:f0:e1:e8:32:9c:ec"
      cert_thumbprint     = "1AE7556DFACD47D9EFBE79BE974661A5A6D6D923"
      cert_valid_from     = "2021-04-13"
      cert_valid_to       = "2022-04-14"

      country             = "CY"
      state               = "???"
      locality            = "Nicosia"
      email               = "???"
      rdn_serial_number   = "HE 419469"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0c:48:73:28:73:ac:8c:ce:ba:f8:f0:e1:e8:32:9c:ec"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Certum_05660A5AE889E93F13960E5E51792C90 {
   meta:
      description         = "Detects HijackLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-10"
      version             = "1.0"

      hash                = "104f8ddf10d61108a7815aa33690eff037ac6fcd7528c4c4a45a202b71d91093"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen Wanzhong Yunfu Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "05:66:0a:5a:e8:89:e9:3f:13:96:0e:5e:51:79:2c:90"
      cert_thumbprint     = "400C13D6F6BFB18A4645B79067ED3580A847E2AC"
      cert_valid_from     = "2024-09-10"
      cert_valid_to       = "2025-09-10"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5DNQ4T71"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "05:66:0a:5a:e8:89:e9:3f:13:96:0e:5e:51:79:2c:90"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Certum_1616F14FBA9C87AB97AD25861EE7A9DC {
   meta:
      description         = "Detects HijackLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-27"
      version             = "1.0"

      hash                = "c20e98a4190f9063f9181d8d9fc01bb89e4e56cb888d4d8883c593586ff52a09"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hangzhou Rongyi Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "16:16:f1:4f:ba:9c:87:ab:97:ad:25:86:1e:e7:a9:dc"
      cert_thumbprint     = "DCC865C6DD9EA2318439F207ACBC2AC0797FB51B"
      cert_valid_from     = "2024-09-27"
      cert_valid_to       = "2025-09-27"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "91330185MA280YDY16"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "16:16:f1:4f:ba:9c:87:ab:97:ad:25:86:1e:e7:a9:dc"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Certum_1F880EA0C7617F15B8550E78C3350A29 {
   meta:
      description         = "Detects HijackLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-23"
      version             = "1.0"

      hash                = "ede6d11f1c8e2613674de05d20ec52a9931d33dfc04d8b5c0f1ff0243fc982a8"
      malware             = "HijackLoader"
      malware_type        = "Initial access tool"
      malware_notes       = ""

      signer              = "Jinan Lu'an Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1f:88:0e:a0:c7:61:7f:15:b8:55:0e:78:c3:35:0a:29"
      cert_thumbprint     = "192BDD3C9045E3181CF844E3C8DF1B59283525AE"
      cert_valid_from     = "2025-10-23"
      cert_valid_to       = "2026-10-23"

      country             = "CN"
      state               = "山东省"
      locality            = "济南市"
      email               = "???"
      rdn_serial_number   = "91370100MA94FUXT8E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1f:88:0e:a0:c7:61:7f:15:b8:55:0e:78:c3:35:0a:29"
      )
}

rule MAL_Compromised_Cert_HijackLoader_DigiCert_03CF154AD4C34EDBA581854D9F750F2D {
   meta:
      description         = "Detects HijackLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-12-16"
      version             = "1.0"

      hash                = "26a24d3b0206c6808615c7049859c2fe62c4dcd87e7858be40ae8112b0482616"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chengdu XiaoShanHu Information Technology Co.,Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "03:cf:15:4a:d4:c3:4e:db:a5:81:85:4d:9f:75:0f:2d"
      cert_thumbprint     = "D5758D83EC0BE571F521EBD825FBB4FE8D4C6FD6"
      cert_valid_from     = "2022-12-16"
      cert_valid_to       = "2026-01-09"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "03:cf:15:4a:d4:c3:4e:db:a5:81:85:4d:9f:75:0f:2d"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Entrust_0089C86B25CF2C8C026201599CD211F002 {
   meta:
      description         = "Detects HijackLoader with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-08"
      version             = "1.0"

      hash                = "5c1917c63fc09983d5f31cb7278122405f28364b93956a96cf635e52f7381f2a"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Software Support ApS"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "00:89:c8:6b:25:cf:2c:8c:02:62:01:59:9c:d2:11:f0:02"
      cert_thumbprint     = "88331C66A0AEBECE198DDB48E57931AC8047A53A"
      cert_valid_from     = "2024-11-08"
      cert_valid_to       = "2025-11-08"

      country             = "DK"
      state               = "???"
      locality            = "København N"
      email               = "???"
      rdn_serial_number   = "37790672"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "00:89:c8:6b:25:cf:2c:8c:02:62:01:59:9c:d2:11:f0:02"
      )
}

rule MAL_Compromised_Cert_HijackLoader_GlobalSign_0632BF3A5F5E1456FECBA3F3 {
   meta:
      description         = "Detects HijackLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-20"
      version             = "1.0"

      hash                = "60972229523eb137860bae114a667ace6d6109ebeec4f219628cdfe00e88d145"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Stroy-Klining"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "06:32:bf:3a:5f:5e:14:56:fe:cb:a3:f3"
      cert_thumbprint     = "DE1C9D957BAEF17EC47BB9AD236E9049E0DE9ED8"
      cert_valid_from     = "2025-05-20"
      cert_valid_to       = "2026-05-21"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1207700373583"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "06:32:bf:3a:5f:5e:14:56:fe:cb:a3:f3"
      )
}

rule MAL_Compromised_Cert_HijackLoader_GlobalSign_16607BC50DD6E4871BEEE868 {
   meta:
      description         = "Detects HijackLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-13"
      version             = "1.0"

      hash                = "cd592cf511b18181bbc9b6cde8dc12c153e8382200ff3194f2ece1bbb328b3ab"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO SID"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "16:60:7b:c5:0d:d6:e4:87:1b:ee:e8:68"
      cert_thumbprint     = "BA6BEDE1291C76388B55A5084A73A2CBBAA3404C"
      cert_valid_from     = "2025-08-13"
      cert_valid_to       = "2026-08-14"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "16:60:7b:c5:0d:d6:e4:87:1b:ee:e8:68"
      )
}

rule MAL_Compromised_Cert_HijackLoader_GlobalSign_536A9BBEAB40AAF25024CD8B {
   meta:
      description         = "Detects HijackLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "7dc2ddaac0f6c54d774f6b336fa15a249fd0d5e74a903e7ada07cc00772c8341"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC GrandStroy"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "53:6a:9b:be:ab:40:aa:f2:50:24:cd:8b"
      cert_thumbprint     = "29EB40C0EFE05D01210D6F3197F854E214CB5A3B"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2026-06-04"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1091103000922"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "53:6a:9b:be:ab:40:aa:f2:50:24:cd:8b"
      )
}

rule MAL_Compromised_Cert_HijackLoader_GlobalSign_5B5D9C65E0953B3F15D0D5DE {
   meta:
      description         = "Detects HijackLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-21"
      version             = "1.0"

      hash                = "fa63d50848b4f806abafe637f931f20bcf625366051ec148e3f5e030dd30d1fa"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RiskGuard WinArk Software Tech Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5b:5d:9c:65:e0:95:3b:3f:15:d0:d5:de"
      cert_thumbprint     = "6903647A479A0D8B48F6BC0D73320896B0377736"
      cert_valid_from     = "2023-12-21"
      cert_valid_to       = "2024-12-21"

      country             = "CN"
      state               = "Liaoning"
      locality            = "Dalian"
      email               = "???"
      rdn_serial_number   = "91210242MA0YGH36XJ"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5b:5d:9c:65:e0:95:3b:3f:15:d0:d5:de"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Microsoft_330003033B96D04AB9ED3A8D9F00000003033B {
   meta:
      description         = "Detects HijackLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-26"
      version             = "1.0"

      hash                = "1da6fb17f4c9d8b5e5fa54cc2f17ef038cd2be1fae73d16b6805567f952d0312"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NIGHT OWL CREATIVE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:03:3b:96:d0:4a:b9:ed:3a:8d:9f:00:00:00:03:03:3b"
      cert_thumbprint     = "26C9637E1FAE5348AA58121C7AB3D2487F399B7E"
      cert_valid_from     = "2025-05-26"
      cert_valid_to       = "2025-05-29"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:03:3b:96:d0:4a:b9:ed:3a:8d:9f:00:00:00:03:03:3b"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Microsoft_3300045DC9932C64B8919CD25C000000045DC9 {
   meta:
      description         = "Detects HijackLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-16"
      version             = "1.0"

      hash                = "38c60fd0e51b21b580552430f1ef55b7a41a1c6894ee61edc0707644d6c0b977"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MRDUFORT VENTES/SERVICE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:5d:c9:93:2c:64:b8:91:9c:d2:5c:00:00:00:04:5d:c9"
      cert_thumbprint     = "A6F7C691297D6D9C3FC5E835E160A460E301B99E"
      cert_valid_from     = "2025-09-16"
      cert_valid_to       = "2025-09-19"

      country             = "CA"
      state               = "Québec"
      locality            = "NUN'S ISLAND"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:5d:c9:93:2c:64:b8:91:9c:d2:5c:00:00:00:04:5d:c9"
      )
}

rule MAL_Compromised_Cert_HijackLoader_Microsoft_3300050B6DF0AE2F05DF3E2D8F000000050B6D {
   meta:
      description         = "Detects HijackLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-26"
      version             = "1.0"

      hash                = "a442eb87e36814f33635c971290576586980f77523d223174da0719ca35aa2e9"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THROGGS NECK PETS INCORPORATED"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:0b:6d:f0:ae:2f:05:df:3e:2d:8f:00:00:00:05:0b:6d"
      cert_thumbprint     = "8F771C60AD411E4061EB893609A49A6AFF392314"
      cert_valid_from     = "2025-10-26"
      cert_valid_to       = "2025-10-29"

      country             = "US"
      state               = "New York"
      locality            = "BRONX"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:0b:6d:f0:ae:2f:05:df:3e:2d:8f:00:00:00:05:0b:6d"
      )
}

rule MAL_Compromised_Cert_HijackLoader_SSL_com_33D83CD7A2AC80605D8A8CA249E95BAB {
   meta:
      description         = "Detects HijackLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-18"
      version             = "1.0"

      hash                = "1f79a38a04ecad2c2c27b92754f12764ea445e9c6f5346e52212cb105ce4bcbd"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BVH CAPITAL LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "33:d8:3c:d7:a2:ac:80:60:5d:8a:8c:a2:49:e9:5b:ab"
      cert_thumbprint     = "3CFB19D488672DA12A9F81F55E290C2967403EFA"
      cert_valid_from     = "2024-11-18"
      cert_valid_to       = "2025-11-23"

      country             = "CY"
      state               = "???"
      locality            = "Limassol"
      email               = "???"
      rdn_serial_number   = "HE 349945"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "33:d8:3c:d7:a2:ac:80:60:5d:8a:8c:a2:49:e9:5b:ab"
      )
}

rule MAL_Compromised_Cert_HijackLoader_SSL_com_5BF5E37EE4A4884DE448DD9927225FD5 {
   meta:
      description         = "Detects HijackLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-25"
      version             = "1.0"

      hash                = "7e490768afc996d5735cc98b502896aface074564f81b3dc450665c4cf72446d"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ebire Software Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5b:f5:e3:7e:e4:a4:88:4d:e4:48:dd:99:27:22:5f:d5"
      cert_thumbprint     = "E685831781E35ED0B9CA48DEAE938A7DD8006546"
      cert_valid_from     = "2025-09-25"
      cert_valid_to       = "2026-09-25"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5b:f5:e3:7e:e4:a4:88:4d:e4:48:dd:99:27:22:5f:d5"
      )
}

rule MAL_Compromised_Cert_HijackLoader_SSL_com_66487A11872274ACEFADD8098C1CC383 {
   meta:
      description         = "Detects HijackLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-25"
      version             = "1.0"

      hash                = "ea73818d5c96294381ea56af0bdda98a987704ee478d8ab374e53e2bafec892b"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AR DIGITAL SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "66:48:7a:11:87:22:74:ac:ef:ad:d8:09:8c:1c:c3:83"
      cert_thumbprint     = "66368BDD4E4E52DA17107DE96E1EF57E9DAEF7B6"
      cert_valid_from     = "2025-04-25"
      cert_valid_to       = "2026-04-25"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "0000771777"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "66:48:7a:11:87:22:74:ac:ef:ad:d8:09:8c:1c:c3:83"
      )
}

rule MAL_Compromised_Cert_HijackLoader_SSL_com_73E6959668279CF575807965749DCCED {
   meta:
      description         = "Detects HijackLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-04"
      version             = "1.0"

      hash                = "230f4de7b92166c695ad4f8bc469e2a39a31d0640ceb994d4f46f1afdabea90b"
      malware             = "HijackLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BNY Holding Aps"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "73:e6:95:96:68:27:9c:f5:75:80:79:65:74:9d:cc:ed"
      cert_thumbprint     = "7f6e28324e79521078ab3a06e3b7a6d8be8df4fcb21fabbb3549a9a18f31d4ea"
      cert_valid_from     = "2025-06-04"
      cert_valid_to       = "2026-06-04"

      country             = "DK"
      state               = "Region of Southern Denmark"
      locality            = "Odense"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "73:e6:95:96:68:27:9c:f5:75:80:79:65:74:9d:cc:ed"
      )
}

rule MAL_Compromised_Cert_Hijackloader_GlobalSign_3DE729C7BD3B36B013DC7AF1 {
   meta:
      description         = "Detects Hijackloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-30"
      version             = "1.0"

      hash                = "42840d9af32e3fa50208aed35792195d2094d7c9126b90152df2cb76e296f272"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Exit"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3d:e7:29:c7:bd:3b:36:b0:13:dc:7a:f1"
      cert_thumbprint     = "468FCFCD44141432A60927AAC4ABEFBB4312C6A6"
      cert_valid_from     = "2025-05-30"
      cert_valid_to       = "2026-05-31"

      country             = "RU"
      state               = "Novosibirsk Oblast"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "1185476007133"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3d:e7:29:c7:bd:3b:36:b0:13:dc:7a:f1"
      )
}

rule MAL_Compromised_Cert_Hijackloader_GlobalSign_47AA6CB664D14C17D3BC67D8 {
   meta:
      description         = "Detects Hijackloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-25"
      version             = "1.0"

      hash                = "7b108d249f03bbe74315c10f6bfe9332ede6d21d4e8814385a35a57a9118c888"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "C.E. Holding ApS"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:aa:6c:b6:64:d1:4c:17:d3:bc:67:d8"
      cert_thumbprint     = "13E3C8CAF22AABBAD0A370F4B87E3AF1FB0F916A"
      cert_valid_from     = "2025-09-25"
      cert_valid_to       = "2026-09-26"

      country             = "DK"
      state               = "Skanderborg"
      locality            = "Skanderborg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:aa:6c:b6:64:d1:4c:17:d3:bc:67:d8"
      )
}

rule MAL_Compromised_Cert_Hijackloader_SSL_com_3B5B4773444AC9CBF876FEA36838CE6F {
   meta:
      description         = "Detects Hijackloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-23"
      version             = "1.0"

      hash                = "a153dd1ca451bdb9c83ed29aba2582195b42dae721aac78515eea97b7e4fe267"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "A.I.D. Advanced Internet Design Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3b:5b:47:73:44:4a:c9:cb:f8:76:fe:a3:68:38:ce:6f"
      cert_thumbprint     = "50124B91181735FBC49E728CA9AD127EE32A17BD"
      cert_valid_from     = "2025-07-23"
      cert_valid_to       = "2026-07-23"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Kerava"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3b:5b:47:73:44:4a:c9:cb:f8:76:fe:a3:68:38:ce:6f"
      )
}

rule MAL_Compromised_Cert_Hijackloader_SSL_com_583EBAB435BEF414F9EE16A193F0BC50 {
   meta:
      description         = "Detects Hijackloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-07"
      version             = "1.0"

      hash                = "7154f4838553869cdddb4938ee6953284439b6d98e7285f573a35ea36982ed09"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VERIDAN"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "58:3e:ba:b4:35:be:f4:14:f9:ee:16:a1:93:f0:bc:50"
      cert_thumbprint     = "5C9397B60D94CC8BA9ACA936B09760EC1D4AC719"
      cert_valid_from     = "2025-10-07"
      cert_valid_to       = "2026-10-07"

      country             = "FR"
      state               = "Île-de-France"
      locality            = "Paris"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "58:3e:ba:b4:35:be:f4:14:f9:ee:16:a1:93:f0:bc:50"
      )
}

rule MAL_Compromised_Cert_Hijackloader_SSL_com_5AC8CC211D70D37748630D6F214E61D6 {
   meta:
      description         = "Detects Hijackloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-07"
      version             = "1.0"

      hash                = "d7e5be8aa67b33d9cd681c126c5523c919692ef44af69b470def0863d2f28120"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KTNF Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5a:c8:cc:21:1d:70:d3:77:48:63:0d:6f:21:4e:61:d6"
      cert_thumbprint     = "6193FB8FE7540E0C3BF341B76B0A834A83A03A57"
      cert_valid_from     = "2025-05-07"
      cert_valid_to       = "2026-05-07"

      country             = "KR"
      state               = "???"
      locality            = "Seoul"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5a:c8:cc:21:1d:70:d3:77:48:63:0d:6f:21:4e:61:d6"
      )
}

rule MAL_Compromised_Cert_Hijackloader_SSL_com_7E24C27599D0BCEBA3CC12B9347A86D1 {
   meta:
      description         = "Detects Hijackloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-28"
      version             = "1.0"

      hash                = "5fe9e516f35fff47564762f9bcb9804f73df817ebe12f8fc4d85e586f4542b6b"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Raastuff Holding ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7e:24:c2:75:99:d0:bc:eb:a3:cc:12:b9:34:7a:86:d1"
      cert_thumbprint     = "48BD9CC83CBB844CDBC911C14A3C6D2C2BF9DA6A"
      cert_valid_from     = "2025-06-28"
      cert_valid_to       = "2026-06-28"

      country             = "DK"
      state               = "Region of Southern Denmark"
      locality            = "Odense"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7e:24:c2:75:99:d0:bc:eb:a3:cc:12:b9:34:7a:86:d1"
      )
}

rule MAL_Compromised_Cert_Hijackloader_Sectigo_1C994A9835179192411AA84E612605E2 {
   meta:
      description         = "Detects Hijackloader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "0ebeaff5e5d71ca949825a421d8a0c4f1459548a17c27ab0698a6393939b4f64"
      malware             = "Hijackloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Taiyuan Jingqu Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "1c:99:4a:98:35:17:91:92:41:1a:a8:4e:61:26:05:e2"
      cert_thumbprint     = "F0C31342637ABC28D0C4621F6D9C7884B2B10C67"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2026-09-10"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "1c:99:4a:98:35:17:91:92:41:1a:a8:4e:61:26:05:e2"
      )
}

rule MAL_Compromised_Cert_Hive_DigiCert_06DF5C318759D6EA9D090BFB2FAF1D94 {
   meta:
      description         = "Detects Hive with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-10-18"
      version             = "1.0"

      hash                = "47dbb2594cd5eb7015ef08b7fb803cd5adc1a1fbe4849dc847c0940f1ccace35"
      malware             = "Hive"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SpiffyTech Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:df:5c:31:87:59:d6:ea:9d:09:0b:fb:2f:af:1d:94"
      cert_thumbprint     = "4418E9A7AAB0909FA611985804416B1AAF41E175"
      cert_valid_from     = "2021-10-18"
      cert_valid_to       = "2022-10-05"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Vancouver"
      email               = "???"
      rdn_serial_number   = "1000712-9"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:df:5c:31:87:59:d6:ea:9d:09:0b:fb:2f:af:1d:94"
      )
}

rule MAL_Compromised_Cert_Hive_Sectigo_00E9268ED63A7D7E9DFD40A664DDFBAF18 {
   meta:
      description         = "Detects Hive with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-15"
      version             = "1.0"

      hash                = "f4a39820dbff47fa1b68f83f575bc98ed33858b02341c5c0464a49be4e6c76d3"
      malware             = "Hive"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Casta, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:e9:26:8e:d6:3a:7d:7e:9d:fd:40:a6:64:dd:fb:af:18"
      cert_thumbprint     = "6D798B3C3A0A85E16F98B05D6E51B66838A56DFF"
      cert_valid_from     = "2022-03-15"
      cert_valid_to       = "2023-03-15"

      country             = "SK"
      state               = "Bratislavský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:e9:26:8e:d6:3a:7d:7e:9d:fd:40:a6:64:dd:fb:af:18"
      )
}

rule MAL_Compromised_Cert_IcedID_Certum_2A2F270535C2D5E7630720FB229B5D1C {
   meta:
      description         = "Detects IcedID with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-18"
      version             = "1.0"

      hash                = "3f38ae75758c8afb75b0660a7c927ccb2bce73f572a9e105ea2288f1288f682b"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "KOZUZ SP. Z O.O."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "2a:2f:27:05:35:c2:d5:e7:63:07:20:fb:22:9b:5d:1c"
      cert_thumbprint     = "BA0B1AB0AE84B9DB98D679D13BC905C39CBE55F6"
      cert_valid_from     = "2023-05-18"
      cert_valid_to       = "2024-05-17"

      country             = "PL"
      state               = "świętokrzyskie"
      locality            = "Starachowice"
      email               = "???"
      rdn_serial_number   = "0001028448"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "2a:2f:27:05:35:c2:d5:e7:63:07:20:fb:22:9b:5d:1c"
      )
}

rule MAL_Compromised_Cert_IcedID_Certum_4A2E337FFF23E5B2A1321FFDE56D1759 {
   meta:
      description         = "Detects IcedID with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-08-12"
      version             = "1.0"

      hash                = "3fb07a2e084bdb1180626b3ba7e667951a3bf7a1bea3514b81057e6294cc25e2"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "Karolina Klimowska"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "4a:2e:33:7f:ff:23:e5:b2:a1:32:1f:fd:e5:6d:17:59"
      cert_thumbprint     = "B6DB1A48BF8780E1205060BDE207B3FFFA663C04"
      cert_valid_from     = "2022-08-12"
      cert_valid_to       = "2023-08-12"

      country             = "PL"
      state               = "pomorskie"
      locality            = "Gdańsk"
      email               = "???"
      rdn_serial_number   = "389419950"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "4a:2e:33:7f:ff:23:e5:b2:a1:32:1f:fd:e5:6d:17:59"
      )
}

rule MAL_Compromised_Cert_IcedID_Certum_6E44FCEDD49F22F7A28CECC99104F61A {
   meta:
      description         = "Detects IcedID with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-05"
      version             = "1.0"

      hash                = "f9fa964ae4dfbf4ecc518fc37985fa5e12bb1059687110d24fb035497940cda3"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "M-Trans Maciej Caban"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6e:44:fc:ed:d4:9f:22:f7:a2:8c:ec:c9:91:04:f6:1a"
      cert_thumbprint     = "C678DCC9D7DA9BDCB75236CB9FA84346AE42704A"
      cert_valid_from     = "2023-01-05"
      cert_valid_to       = "2024-01-05"

      country             = "PL"
      state               = "???"
      locality            = "Skierniewice"
      email               = "???"
      rdn_serial_number   = "389470690"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6e:44:fc:ed:d4:9f:22:f7:a2:8c:ec:c9:91:04:f6:1a"
      )
}

rule MAL_Compromised_Cert_IcedID_DigiCert_0406C4A1521A38C8D0C4AA214388E4DC {
   meta:
      description         = "Detects IcedID with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-01-11"
      version             = "1.0"

      hash                = "4de5453891027cc3a82f3e72a71c774ae95e6b6d4587197056cf4fdc85947e14"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "Venezia Design SRL"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "04:06:c4:a1:52:1a:38:c8:d0:c4:aa:21:43:88:e4:dc"
      cert_thumbprint     = "097B93B2E0520A2D686B4A6595220DE12C66AE0C"
      cert_valid_from     = "2022-01-11"
      cert_valid_to       = "2023-01-11"

      country             = "RO"
      state               = "???"
      locality            = "Bucuresti"
      email               = "???"
      rdn_serial_number   = "J40/12053/2015"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "04:06:c4:a1:52:1a:38:c8:d0:c4:aa:21:43:88:e4:dc"
      )
}

rule MAL_Compromised_Cert_IcedID_DigiCert_06BCB74291D96096577BDB1E165DCE85 {
   meta:
      description         = "Detects IcedID with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-27"
      version             = "1.0"

      hash                = "074cef597dc028b08dc2fe927ea60f09cfd5e19f928f2e4071860b9a159b365d"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "Revo Security SRL"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:bc:b7:42:91:d9:60:96:57:7b:db:1e:16:5d:ce:85"
      cert_thumbprint     = "D1BDE6303266977F7540221543D3F2625DA24AC4"
      cert_valid_from     = "2021-11-27"
      cert_valid_to       = "2022-11-24"

      country             = "RO"
      state               = "???"
      locality            = "Videle"
      email               = "???"
      rdn_serial_number   = "J34/641/2017"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:bc:b7:42:91:d9:60:96:57:7b:db:1e:16:5d:ce:85"
      )
}

rule MAL_Compromised_Cert_IcedID_DigiCert_0772B4D1D63233D2B8771997BC8DA5C4 {
   meta:
      description         = "Detects IcedID with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-27"
      version             = "1.0"

      hash                = "600a21358e2cc2d5d50b014c4a4df03435b136bec0ee7903eb88d4368fe37647"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "Maya logistika d.o.o."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "07:72:b4:d1:d6:32:33:d2:b8:77:19:97:bc:8d:a5:c4"
      cert_thumbprint     = "D80719A0FCDE24A6C277CE9187B48D1978F862C2"
      cert_valid_from     = "2021-11-27"
      cert_valid_to       = "2022-10-15"

      country             = "SI"
      state               = "???"
      locality            = "Velenje"
      email               = "???"
      rdn_serial_number   = "6362338000"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "07:72:b4:d1:d6:32:33:d2:b8:77:19:97:bc:8d:a5:c4"
      )
}

rule MAL_Compromised_Cert_IcedID_SSL_com_40E27B7404AA9B485F8A2FC0C8E53AF3 {
   meta:
      description         = "Detects IcedID with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-27"
      version             = "1.0"

      hash                = "d033105288280266f0336365245e18984c5fc684577beed5ad7430775ecd7c02"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "Southern Wall Systems, LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "40:e2:7b:74:04:aa:9b:48:5f:8a:2f:c0:c8:e5:3a:f3"
      cert_thumbprint     = "CA468FF8403A8416042705E79DBC499A5EA9BE85"
      cert_valid_from     = "2023-03-27"
      cert_valid_to       = "2024-03-26"

      country             = "US"
      state               = "Alabama"
      locality            = "Dothan"
      email               = "???"
      rdn_serial_number   = "000 - 426 - 269"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "40:e2:7b:74:04:aa:9b:48:5f:8a:2f:c0:c8:e5:3a:f3"
      )
}

rule MAL_Compromised_Cert_IcedID_SSL_com_67936A84BED66EF021DBE771DE331772 {
   meta:
      description         = "Detects IcedID with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-01"
      version             = "1.0"

      hash                = "130360ea85121a0af3f7ea729b9026c911e5d543ba61ebdd637ebbe23df1c2c8"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "APEX SOFTWARE DESIGN, LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "67:93:6a:84:be:d6:6e:f0:21:db:e7:71:de:33:17:72"
      cert_thumbprint     = "A9F42777E0C9B35CC058C68B1788F2D74DEE6DED"
      cert_valid_from     = "2023-05-01"
      cert_valid_to       = "2024-04-30"

      country             = "US"
      state               = "Louisiana"
      locality            = "Baton Rouge"
      email               = "???"
      rdn_serial_number   = "43646041K"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "67:93:6a:84:be:d6:6e:f0:21:db:e7:71:de:33:17:72"
      )
}

rule MAL_Compromised_Cert_IcedID_SSL_com_698FF388ADB50B88AFB832E76B0A0AD1 {
   meta:
      description         = "Detects IcedID with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-30"
      version             = "1.0"

      hash                = "244e55adeb71ae1cbd57af87dd4fa0c2f1143233ffddf254da27a721c61a63c4"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "BELLAP LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "69:8f:f3:88:ad:b5:0b:88:af:b8:32:e7:6b:0a:0a:d1"
      cert_thumbprint     = "D1DE8B155C9D45ADB47BA96BDC8670C84BB4390A"
      cert_valid_from     = "2023-01-30"
      cert_valid_to       = "2023-12-18"

      country             = "GB"
      state               = "England"
      locality            = "Sandhurst"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "69:8f:f3:88:ad:b5:0b:88:af:b8:32:e7:6b:0a:0a:d1"
      )
}

rule MAL_Compromised_Cert_IcedID_Sectigo_00A73B6D821F84DB4451D6EEDD62C42848 {
   meta:
      description         = "Detects IcedID with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-14"
      version             = "1.0"

      hash                = "15b65ccfeced9c5ae3359db9d3a0e68ad0201912b65a0578d5dd7a0f7f7b387d"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "Mht Holding Vinderup ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:a7:3b:6d:82:1f:84:db:44:51:d6:ee:dd:62:c4:28:48"
      cert_thumbprint     = "ECA61AD880741629967004BFC40BF8DF6C9F0794"
      cert_valid_from     = "2021-01-14"
      cert_valid_to       = "2022-01-14"

      country             = "DK"
      state               = "???"
      locality            = "Vinderup"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:a7:3b:6d:82:1f:84:db:44:51:d6:ee:dd:62:c4:28:48"
      )
}

rule MAL_Compromised_Cert_IcedID_Sectigo_00CA7D54577243934F665FD1D443855A3D {
   meta:
      description         = "Detects IcedID with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-12"
      version             = "1.0"

      hash                = "f56ea10521a52f78bedbf51c0bbdf9c894e473a73f1da8d388afc85b4c95f727"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "FABO SP Z O O"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ca:7d:54:57:72:43:93:4f:66:5f:d1:d4:43:85:5a:3d"
      cert_thumbprint     = "BB1B413CC8678C2FB2AF345A53DA186BACE5850F"
      cert_valid_from     = "2020-10-12"
      cert_valid_to       = "2021-10-12"

      country             = "PL"
      state               = "MAZOWIECKIE"
      locality            = "Radom"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ca:7d:54:57:72:43:93:4f:66:5f:d1:d4:43:85:5a:3d"
      )
}

rule MAL_Compromised_Cert_IcedID_Sectigo_00DF2547B2CAB5689A81D61DE80EAAA3A2 {
   meta:
      description         = "Detects IcedID with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-14"
      version             = "1.0"

      hash                = "943aa6d0267127142cd9d191c32b138559d67df2b9a352eacd4b86620336ac2e"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "FORWARD MUSIC AGENCY SRL"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:df:25:47:b2:ca:b5:68:9a:81:d6:1d:e8:0e:aa:a3:a2"
      cert_thumbprint     = "8E816DEB45E8298DAA2598459C9E9CC3B157B369"
      cert_valid_from     = "2022-07-14"
      cert_valid_to       = "2023-07-14"

      country             = "RO"
      state               = "București"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:df:25:47:b2:ca:b5:68:9a:81:d6:1d:e8:0e:aa:a3:a2"
      )
}

rule MAL_Compromised_Cert_IcedID_Sectigo_00F2D693AAD63E6920782A0027DFC97D91 {
   meta:
      description         = "Detects IcedID with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-12"
      version             = "1.0"

      hash                = "65ce2081be589354f2b1354ce17e624b18dab29d377190fdc1e88bb5ab8e59a3"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "EKO-KHIM TOV"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f2:d6:93:aa:d6:3e:69:20:78:2a:00:27:df:c9:7d:91"
      cert_thumbprint     = "EC70B38E0EE831F4D532162A9578AE67D462EE3A"
      cert_valid_from     = "2020-08-12"
      cert_valid_to       = "2021-08-12"

      country             = "UA"
      state               = "???"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f2:d6:93:aa:d6:3e:69:20:78:2a:00:27:df:c9:7d:91"
      )
}

rule MAL_Compromised_Cert_IcedID_Sectigo_101D6A5A29D9A77807553CEAC669D853 {
   meta:
      description         = "Detects IcedID with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-04"
      version             = "1.0"

      hash                = "e70c965ae03c89538c94cc65ada5194c0b129a67e4c5f0eca728965ff4f831ae"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "BIC GROUP LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "10:1d:6a:5a:29:d9:a7:78:07:55:3c:ea:c6:69:d8:53"
      cert_thumbprint     = "BCAF8B48FD451035B0B9307B61FA737F7907E5B2"
      cert_valid_from     = "2022-03-04"
      cert_valid_to       = "2023-03-04"

      country             = "GB"
      state               = "London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "10:1d:6a:5a:29:d9:a7:78:07:55:3c:ea:c6:69:d8:53"
      )
}

rule MAL_Compromised_Cert_IcedID_Sectigo_3FD3661533EEF209153C9AFEC3BA4D8A {
   meta:
      description         = "Detects IcedID with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-04"
      version             = "1.0"

      hash                = "3fca3f2d46add510a32d81b2ba8b4a5f30fc8ec25eca34175405bf5580a1bec3"
      malware             = "IcedID"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "SFB Regnskabsservice ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "3f:d3:66:15:33:ee:f2:09:15:3c:9a:fe:c3:ba:4d:8a"
      cert_thumbprint     = "20DDD23F53E1AC49926335EC3E685A515AB49252"
      cert_valid_from     = "2021-03-04"
      cert_valid_to       = "2022-03-04"

      country             = "DK"
      state               = "Nordjylland"
      locality            = "Skørping"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "3f:d3:66:15:33:ee:f2:09:15:3c:9a:fe:c3:ba:4d:8a"
      )
}

rule MAL_Compromised_Cert_IcedId_Certum_6E44FCEDD49F22F7A28CECC99104F61A {
   meta:
      description         = "Detects IcedId with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-05"
      version             = "1.0"

      hash                = "0221bf1e1bd171c17527a863531518a95bcc025c87888e66b9512a5651073d16"
      malware             = "IcedId"
      malware_type        = "Initial access tool"
      malware_notes       = "A malware initially created as a banking trojan but then transitioned to initial access tool used by ransomware gangs: https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid and https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware"

      signer              = "M-Trans Maciej Caban"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6e:44:fc:ed:d4:9f:22:f7:a2:8c:ec:c9:91:04:f6:1a"
      cert_thumbprint     = "C678DCC9D7DA9BDCB75236CB9FA84346AE42704A"
      cert_valid_from     = "2023-01-05"
      cert_valid_to       = "2024-01-05"

      country             = "PL"
      state               = "???"
      locality            = "Skierniewice"
      email               = "???"
      rdn_serial_number   = "389470690"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6e:44:fc:ed:d4:9f:22:f7:a2:8c:ec:c9:91:04:f6:1a"
      )
}

rule MAL_Compromised_Cert_Investigating_Certum_622693C63F4274A602F102826119011E {
   meta:
      description         = "Detects Investigating with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-27"
      version             = "1.0"

      hash                = "03e9d7d08d45b44e92052a76ad963a587e5d451173347000e1a68eb304a340f6"
      malware             = "Investigating"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UAB MN Technologijos"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "62:26:93:c6:3f:42:74:a6:02:f1:02:82:61:19:01:1e"
      cert_thumbprint     = "229A8D21E09426907D1B0A6AE80B2534A89CC580"
      cert_valid_from     = "2023-07-27"
      cert_valid_to       = "2024-07-26"

      country             = "LT"
      state               = "???"
      locality            = "Vilnius"
      email               = "???"
      rdn_serial_number   = "304869871"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "62:26:93:c6:3f:42:74:a6:02:f1:02:82:61:19:01:1e"
      )
}

rule MAL_Compromised_Cert_JadeSleet_Sectigo_00EAAABEC88619D26FAC06484DC7EF4426 {
   meta:
      description         = "Detects JadeSleet with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-08"
      version             = "1.0"

      hash                = "3da0dcf392d3d71b340e6005806c27f588c7f9a8cc00b6b03a9ac2cd808fe107"
      malware             = "JadeSleet"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Dmitry Raykhman"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:ea:aa:be:c8:86:19:d2:6f:ac:06:48:4d:c7:ef:44:26"
      cert_thumbprint     = "AB4CE4CFA68E8DA30AB0213991C1241BC96C6FC6"
      cert_valid_from     = "2022-09-08"
      cert_valid_to       = "2023-09-08"

      country             = "US"
      state               = "New York"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:ea:aa:be:c8:86:19:d2:6f:ac:06:48:4d:c7:ef:44:26"
      )
}

rule MAL_Compromised_Cert_JohnWalkerTexasLoader_SSL_com_05FC8578CBD9BCBA95A3E3FEC8D1B492 {
   meta:
      description         = "Detects JohnWalkerTexasLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-16"
      version             = "1.0"

      hash                = "44d770ca66fbf194a8f1448dbebc5b5679fd2ac4912ceafbb0fac21eac28eccd"
      malware             = "JohnWalkerTexasLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "H PLUS CARE LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "05:fc:85:78:cb:d9:bc:ba:95:a3:e3:fe:c8:d1:b4:92"
      cert_thumbprint     = "54DD7092F9307D4F8E2F4D965C7E0085C430BAB2"
      cert_valid_from     = "2024-10-16"
      cert_valid_to       = "2025-10-16"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "05736767"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "05:fc:85:78:cb:d9:bc:ba:95:a3:e3:fe:c8:d1:b4:92"
      )
}

rule MAL_Compromised_Cert_JuiceLedger_Certum_1C897216E58E83CBE74AD03284E1FB82 {
   meta:
      description         = "Detects JuiceLedger with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-10"
      version             = "1.0"

      hash                = "a50bcbf0ef744f6b7780685cfd2f41a13be4c921d4b401384efd85c6109d7c00"
      malware             = "JuiceLedger"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "M-Trans Maciej Caban"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1c:89:72:16:e5:8e:83:cb:e7:4a:d0:32:84:e1:fb:82"
      cert_thumbprint     = "13CFDF20DFA846C94358DBAC6A3802DC0671EAB2"
      cert_valid_from     = "2021-12-10"
      cert_valid_to       = "2022-12-10"

      country             = "PL"
      state               = "łódzkie"
      locality            = "Skierniewice"
      email               = "???"
      rdn_serial_number   = "389470690"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1c:89:72:16:e5:8e:83:cb:e7:4a:d0:32:84:e1:fb:82"
      )
}

rule MAL_Compromised_Cert_JustAskJackyVariant_Sectigo_1CBC7A3706640FA0CFDA497C1FD4D6CD {
   meta:
      description         = "Detects JustAskJackyVariant with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "c10d362378d3f9c3f26389165730a30a1cc299b4e06460460d39ad5213713811"
      malware             = "JustAskJackyVariant"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Method Marketing Media LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "1c:bc:7a:37:06:64:0f:a0:cf:da:49:7c:1f:d4:d6:cd"
      cert_thumbprint     = "5B036DAD04DB22E8560716DEABC59A5E524B6BE2"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-25"

      country             = "US"
      state               = "Wyoming"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "1c:bc:7a:37:06:64:0f:a0:cf:da:49:7c:1f:d4:d6:cd"
      )
}

rule MAL_Compromised_Cert_KTCrypt_Loader_SSL_com_6524ECD66BD22BCD244151EA1C992E84 {
   meta:
      description         = "Detects KTCrypt Loader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-13"
      version             = "1.0"

      hash                = "97375c3d25d07f8e68c990a3043787f3354fb7cec1fc6be4c8a23c3abb977845"
      malware             = "KTCrypt Loader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Holy Prime Electronic Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "65:24:ec:d6:6b:d2:2b:cd:24:41:51:ea:1c:99:2e:84"
      cert_thumbprint     = "825230639CA4BA809BD882668CC462A8B3A42480"
      cert_valid_from     = "2025-05-13"
      cert_valid_to       = "2026-05-12"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "65:24:ec:d6:6b:d2:2b:cd:24:41:51:ea:1c:99:2e:84"
      )
}

rule MAL_Compromised_Cert_Karma_Sectigo_34D42E871DDB1C92FA20B55B384E1259 {
   meta:
      description         = "Detects Karma with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-08-31"
      version             = "1.0"

      hash                = "4dec9a9044631caef283c7f39a576e4e5c1cc1e6a97ce5c60936a3a3d0097818"
      malware             = "Karma"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VENS CORP"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "34:d4:2e:87:1d:db:1c:92:fa:20:b5:5b:38:4e:12:59"
      cert_thumbprint     = "B8C6E51400B10B718DB1D622E247007195356E9F"
      cert_valid_from     = "2021-08-31"
      cert_valid_to       = "2022-08-31"

      country             = "FR"
      state               = "Île-de-France"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "34:d4:2e:87:1d:db:1c:92:fa:20:b5:5b:38:4e:12:59"
      )
}

rule MAL_Compromised_Cert_Known_Malware_SSL_com_026DB70F749DC993EDB96BD0D65BC394 {
   meta:
      description         = "Detects Known Malware with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-09"
      version             = "1.0"

      hash                = "b2fb823ad1fefa922a699e200cdab1ea3cd587843496c77598e44f138f359c74"
      malware             = "Known Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GreenLine Software Corp."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "02:6d:b7:0f:74:9d:c9:93:ed:b9:6b:d0:d6:5b:c3:94"
      cert_thumbprint     = "448172A55C7A9F547613944C9E34D1C3299EA46F"
      cert_valid_from     = "2024-08-09"
      cert_valid_to       = "2025-08-09"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "02:6d:b7:0f:74:9d:c9:93:ed:b9:6b:d0:d6:5b:c3:94"
      )
}

rule MAL_Compromised_Cert_Known_Malware_SSL_com_3BDB5C709D953CBE45FFEC02D8A4D7A5 {
   meta:
      description         = "Detects Known Malware with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-28"
      version             = "1.0"

      hash                = "c634dc35f7527cf2695537c4b043e172d93d66da846bb0ca2d4dd34d8d5bc52a"
      malware             = "Known Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Dupa Innovation Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "3b:db:5c:70:9d:95:3c:be:45:ff:ec:02:d8:a4:d7:a5"
      cert_thumbprint     = "52977AEDE5D3054EEEAB2CD53B08E5E920C84217"
      cert_valid_from     = "2024-03-28"
      cert_valid_to       = "2025-03-28"

      country             = "GB"
      state               = "Wales"
      locality            = "Penarth"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "3b:db:5c:70:9d:95:3c:be:45:ff:ec:02:d8:a4:d7:a5"
      )
}

rule MAL_Compromised_Cert_Koiloader_Certum_04EBDA42BF9235AECF2E07587EC4623F {
   meta:
      description         = "Detects Koiloader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-21"
      version             = "1.0"

      hash                = "e29d2bd946212328bcdf783eb434e1b384445f4c466c5231f91a07a315484819"
      malware             = "Koiloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhengzhou Lichang Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "04:eb:da:42:bf:92:35:ae:cf:2e:07:58:7e:c4:62:3f"
      cert_thumbprint     = "B78EDD5FFE3A45F2993E98F9CCE5F0187EE880BD"
      cert_valid_from     = "2024-11-21"
      cert_valid_to       = "2025-11-21"

      country             = "CN"
      state               = "Henan"
      locality            = "Zhengzhou"
      email               = "???"
      rdn_serial_number   = "91410122MA40Y0N9XP"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "04:eb:da:42:bf:92:35:ae:cf:2e:07:58:7e:c4:62:3f"
      )
}

rule MAL_Compromised_Cert_KorPlug_GlobalSign_06FA9DF25D522FB355CC41E8 {
   meta:
      description         = "Detects KorPlug with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-07"
      version             = "1.0"

      hash                = "2cd4fb94268ba063b1a5eea7fe87e794fecf46c0f56c2aaa81e8c9052bb4f5f2"
      malware             = "KorPlug"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xuaony Plantain E-Commerce Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "06:fa:9d:f2:5d:52:2f:b3:55:cc:41:e8"
      cert_thumbprint     = "DFCDB964C7C596DBA245A066F08989C9AC1AD4B0"
      cert_valid_from     = "2024-04-07"
      cert_valid_to       = "2025-03-30"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420600MACLU7R889"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "06:fa:9d:f2:5d:52:2f:b3:55:cc:41:e8"
      )
}

rule MAL_Compromised_Cert_LOBSHOT_Certum_417B3A9C446891F15B00CAEB70D95CB6 {
   meta:
      description         = "Detects LOBSHOT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-26"
      version             = "1.0"

      hash                = "0ecd43dcef4461181a7601af1b85859e252b5e6556bebce5661e81a92a3c6537"
      malware             = "LOBSHOT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Quanzhou Chunsheng Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "41:7b:3a:9c:44:68:91:f1:5b:00:ca:eb:70:d9:5c:b6"
      cert_thumbprint     = "56856FF8ADE9DD49FD006C6DCF413A4C103DD079"
      cert_valid_from     = "2024-07-26"
      cert_valid_to       = "2025-07-26"

      country             = "CN"
      state               = "Fujian"
      locality            = "Quanzhou"
      email               = "???"
      rdn_serial_number   = "91350582MA8TM0LA3E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "41:7b:3a:9c:44:68:91:f1:5b:00:ca:eb:70:d9:5c:b6"
      )
}

rule MAL_Compromised_Cert_Latam_Banker_DigiCert_013FCA504BE9FC4FA8BC83F48E3588CB {
   meta:
      description         = "Detects Latam Banker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-06"
      version             = "1.0"

      hash                = "1accf8d0d6a0d99b624236f815c3344e9d0509fb136a47b455b35694ebb4e3ea"
      malware             = "Latam Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PROTECNOLOGY SOFT LTDA"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "01:3f:ca:50:4b:e9:fc:4f:a8:bc:83:f4:8e:35:88:cb"
      cert_thumbprint     = "D16A464CE42F1C7A679A63C33D5D3BD8D507C73A"
      cert_valid_from     = "2025-02-06"
      cert_valid_to       = "2026-02-05"

      country             = "BR"
      state               = "Maranhao"
      locality            = "SAO LUIS"
      email               = "???"
      rdn_serial_number   = "17.205.193/0001-10"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "01:3f:ca:50:4b:e9:fc:4f:a8:bc:83:f4:8e:35:88:cb"
      )
}

rule MAL_Compromised_Cert_Latam_Banker_GlobalSign_11D212117C7C5ACC5954C910 {
   meta:
      description         = "Detects Latam Banker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-29"
      version             = "1.0"

      hash                = "98a23d306c5169bc4b5772c7b946d61f2c9f552d63be7d88dd404b87e21d7626"
      malware             = "Latam Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE AFFAIR LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "11:d2:12:11:7c:7c:5a:cc:59:54:c9:10"
      cert_thumbprint     = "A872BE45D9552120C06E79D2A6532079AC89FD72"
      cert_valid_from     = "2024-07-29"
      cert_valid_to       = "2025-07-26"

      country             = "GB"
      state               = "Romney Marsh"
      locality            = "Dymchurch"
      email               = "admin@softwareaffairlimited.com"
      rdn_serial_number   = "09764500"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "11:d2:12:11:7c:7c:5a:cc:59:54:c9:10"
      )
}

rule MAL_Compromised_Cert_Latam_Trojan_Banker_GlobalSign_48F3DBC38B46B3E29CD6CC7F {
   meta:
      description         = "Detects Latam Trojan Banker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-01"
      version             = "1.0"

      hash                = "0146d30830cb03b405c7ebbb36e8c8747cdaed1d6b92f07d1cbc7101d229bfa6"
      malware             = "Latam Trojan Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Defz Software Solutions GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "48:f3:db:c3:8b:46:b3:e2:9c:d6:cc:7f"
      cert_thumbprint     = "6B355DEA3DDA10D178AB4164EABF60A00A9DCB70"
      cert_valid_from     = "2024-04-01"
      cert_valid_to       = "2024-12-05"

      country             = "AT"
      state               = "Steiermark"
      locality            = "Ludersdorf-Wilfersdorf"
      email               = "admin@defzsoftwaresolutions.com"
      rdn_serial_number   = "597406p"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "48:f3:db:c3:8b:46:b3:e2:9c:d6:cc:7f"
      )
}

rule MAL_Compromised_Cert_Latam_Trojan_Banker_SSL_com_3FE13C520C9758C4A4A7084862E2C191 {
   meta:
      description         = "Detects Latam Trojan Banker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-03"
      version             = "1.0"

      hash                = "6c3d977bfeccd287c82f6f1693b12cf5f2732397342d8831e27cfab4023852d3"
      malware             = "Latam Trojan Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SIA GSM design"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3f:e1:3c:52:0c:97:58:c4:a4:a7:08:48:62:e2:c1:91"
      cert_thumbprint     = "3CC34712BC3881634197D75216B99B99FBFE567A"
      cert_valid_from     = "2023-11-03"
      cert_valid_to       = "2024-11-02"

      country             = "LV"
      state               = "Ādažu pagasts"
      locality            = "Ādaži"
      email               = "???"
      rdn_serial_number   = "40203258355"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3f:e1:3c:52:0c:97:58:c4:a4:a7:08:48:62:e2:c1:91"
      )
}

rule MAL_Compromised_Cert_LatentBot_GlobalSign_0C800473CA8670527339B6DE {
   meta:
      description         = "Detects LatentBot with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-26"
      version             = "1.0"

      hash                = "4f964a67f2487c39f0f7a69468ae00f8a2d8b04d5c17904e2f40aa99602ca2ae"
      malware             = "LatentBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ChasingFire Dream Technologies Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:80:04:73:ca:86:70:52:73:39:b6:de"
      cert_thumbprint     = "8733550C4D5DEB2F055420E049353B93F724D5F7"
      cert_valid_from     = "2024-09-26"
      cert_valid_to       = "2025-09-27"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "91420115MA4L020L06"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:80:04:73:ca:86:70:52:73:39:b6:de"
      )
}

rule MAL_Compromised_Cert_Latrodectus_BruteRatel_GlobalSign_36D6440198EDAC10747598CD {
   meta:
      description         = "Detects Latrodectus,BruteRatel with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-06"
      version             = "1.0"

      hash                = "83859acdf4ac22927fa88f715666653807501db6f1865a3657599b4c5d130bb2"
      malware             = "Latrodectus,BruteRatel"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC LOFT"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "36:d6:44:01:98:ed:ac:10:74:75:98:cd"
      cert_thumbprint     = "02346AF23A5ED2E4C67A8D4E5EF4094E9540C4FF"
      cert_valid_from     = "2024-06-06"
      cert_valid_to       = "2025-06-07"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700070595"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "36:d6:44:01:98:ed:ac:10:74:75:98:cd"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_093938A8E006C4720D4F1B06 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-18"
      version             = "1.0"

      hash                = "dea85c1e75be9db2c7c96007283389ddf28a21d79a05f3e6396a0c7f780b7b9f"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LINDHOLM SOLUTIONS L.P."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "09:39:38:a8:e0:06:c4:72:0d:4f:1b:06"
      cert_thumbprint     = "7CBAA1A3646AD7244167AC210FCF481BF74B24CD"
      cert_valid_from     = "2025-08-18"
      cert_valid_to       = "2026-08-19"

      country             = "GB"
      state               = "Scotland"
      locality            = "Glasgow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "09:39:38:a8:e0:06:c4:72:0d:4f:1b:06"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_0C878AD728291DEAB4309E15 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-03"
      version             = "1.0"

      hash                = "94479572d99e07c50d39c46c8a96843e1c8ae80ce126ae3ba4c4fd223e3d731a"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tim Instruments Limited Liability Company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:87:8a:d7:28:29:1d:ea:b4:30:9e:15"
      cert_thumbprint     = "039C2AD6862683DEFE39B84D12D9FDC0FBB37EA3"
      cert_valid_from     = "2025-04-03"
      cert_valid_to       = "2026-04-04"

      country             = "KG"
      state               = "Bishkek"
      locality            = "Bishkek"
      email               = "info@techintrum.com"
      rdn_serial_number   = "204348-3300-OOO"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:87:8a:d7:28:29:1d:ea:b4:30:9e:15"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_1842364451D5932004E163C7 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-31"
      version             = "1.0"

      hash                = "ec3ca0877e599ae9c40cbcec51a9a4718114e33d9e2d9d8c72f5f24d7cebdcbf"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC CESARIA"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "18:42:36:44:51:d5:93:20:04:e1:63:c7"
      cert_thumbprint     = "239E18C2FF083DAB3546B83BE3CC00756442047D"
      cert_valid_from     = "2024-05-31"
      cert_valid_to       = "2025-06-01"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700263821"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "18:42:36:44:51:d5:93:20:04:e1:63:c7"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_2280F29DDAA0C67F38BC8FF4 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-08"
      version             = "1.0"

      hash                = "aef5c150cfe8154ed290b293e30d552cfb9b40b3552369345c7c2f135b63aac4"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC KancEra"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "22:80:f2:9d:da:a0:c6:7f:38:bc:8f:f4"
      cert_thumbprint     = "DD818690D1F922E87EE35500434BD7A2D1E9CCBA"
      cert_valid_from     = "2025-04-08"
      cert_valid_to       = "2026-04-09"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1127746384810"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "22:80:f2:9d:da:a0:c6:7f:38:bc:8f:f4"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_28F072020D6F9826725E8D8B {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-14"
      version             = "1.0"

      hash                = "631f88a97cd1f096d9d923538e299b12e1f441895e31ada5b522e80c8da84777"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Gruzoperevozchik"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "28:f0:72:02:0d:6f:98:26:72:5e:8d:8b"
      cert_thumbprint     = "AA3914223892DCD1F1C4318E92672597484CABCF"
      cert_valid_from     = "2025-07-14"
      cert_valid_to       = "2026-07-15"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "28:f0:72:02:0d:6f:98:26:72:5e:8d:8b"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_3132DC9FE29B88E0BC37DC1B {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-31"
      version             = "1.0"

      hash                = "5f84809a778841f1dc64bc43d6bb1a822d6aa04a3ae65c5f9ad31a7fcb2cbca9"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuhan Yichuang Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "31:32:dc:9f:e2:9b:88:e0:bc:37:dc:1b"
      cert_thumbprint     = "D238EE4E135C39D2996CBB81FAD409BEE9A1F582"
      cert_valid_from     = "2025-03-31"
      cert_valid_to       = "2026-04-01"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "91420100MA49NX8T6M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "31:32:dc:9f:e2:9b:88:e0:bc:37:dc:1b"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_3E6D934EFBD609FA602FEED8 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-26"
      version             = "1.0"

      hash                = "378127a840393f72bc2e98a1a3f54a57d05c08650dd485183a5554f0658632a8"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GRAND E ApS"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3e:6d:93:4e:fb:d6:09:fa:60:2f:ee:d8"
      cert_thumbprint     = "04390F6114AD5E0F1A79EB7B5A618EF99E338E46"
      cert_valid_from     = "2025-08-26"
      cert_valid_to       = "2026-08-27"

      country             = "DK"
      state               = "Region Zealand"
      locality            = "Sandved"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3e:6d:93:4e:fb:d6:09:fa:60:2f:ee:d8"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_4994AC1FB0662DADE0F5759A {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-04"
      version             = "1.0"

      hash                = "b97cd404ceab09bdd92003599566d946cead1d5d5dba528327821fe4f18108ec"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Jupiter"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:94:ac:1f:b0:66:2d:ad:e0:f5:75:9a"
      cert_thumbprint     = "94E8399C43C6F0D9DF5DCF205872D575825F7B92"
      cert_valid_from     = "2025-07-04"
      cert_valid_to       = "2026-07-05"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "5167746260369"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:94:ac:1f:b0:66:2d:ad:e0:f5:75:9a"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_5631DCB283EC62ED3B96E8BE {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-16"
      version             = "1.0"

      hash                = "a66f6e35103338c25ee143c98a6f722c87a663610f147564f99b87468315a1f7"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Xenit"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:31:dc:b2:83:ec:62:ed:3b:96:e8:be"
      cert_thumbprint     = "C519277F61B1BE886D187A0C2E7909D694933250"
      cert_valid_from     = "2025-05-16"
      cert_valid_to       = "2026-05-17"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1197746744183"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:31:dc:b2:83:ec:62:ed:3b:96:e8:be"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_5AE7F3327E5B41A9948647E8 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-24"
      version             = "1.0"

      hash                = "3af32eeede84d9ab70ce15ef51fa2bd7da42224537551410f565d1ec3b22b005"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "APPEX FINVEST PVT LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:e7:f3:32:7e:5b:41:a9:94:86:47:e8"
      cert_thumbprint     = "B2EC5F5CDD0FC121EA93A4724A5957B7F7997129"
      cert_valid_from     = "2025-07-24"
      cert_valid_to       = "2026-07-25"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "navneetmalpani95@gmail.com"
      rdn_serial_number   = "U65910RJ1995PTC009975"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:e7:f3:32:7e:5b:41:a9:94:86:47:e8"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_5F36FF3EFCF0620ED7D1FD6C {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-21"
      version             = "1.0"

      hash                = "69af1d10dd1dacae362ab8fd4e5bcc97ddb363cdeb06a4bf1bc3db4dfc68b1e1"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuxi Weitai Nano Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5f:36:ff:3e:fc:f0:62:0e:d7:d1:fd:6c"
      cert_thumbprint     = "DAD62095A80EEA1E6DECF91F957E59BA562B27A1"
      cert_valid_from     = "2025-04-21"
      cert_valid_to       = "2026-04-22"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "91320214MA1YY96J3H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5f:36:ff:3e:fc:f0:62:0e:d7:d1:fd:6c"
      )
}

rule MAL_Compromised_Cert_Latrodectus_GlobalSign_79E97FA4E98323F95F2625C7 {
   meta:
      description         = "Detects Latrodectus with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-28"
      version             = "1.0"

      hash                = "987bfdf18e0b3dac53bcc8cc906ef6c907c3e23d9ff23eb703e196782ae00b00"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "EVEREST REMIT SEWA LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "79:e9:7f:a4:e9:83:23:f9:5f:26:25:c7"
      cert_thumbprint     = "19F9CEBDFD773033B1A0A949AA87D793ADB463DB"
      cert_valid_from     = "2025-07-28"
      cert_valid_to       = "2026-07-29"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "officeeverestremit@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "79:e9:7f:a4:e9:83:23:f9:5f:26:25:c7"
      )
}

rule MAL_Compromised_Cert_Latrodectus_Microsoft_33000468D113BB359F22A815FB0000000468D1 {
   meta:
      description         = "Detects Latrodectus with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-19"
      version             = "1.0"

      hash                = "c92081585c525afba5abcb773c7ca9532fba6ce5e7aca340a226e2b05ff3b0d2"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IMMEUBLES DAVECLO INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:68:d1:13:bb:35:9f:22:a8:15:fb:00:00:00:04:68:d1"
      cert_thumbprint     = "F8036C868223F58E927422BF459A362DC57B645C"
      cert_valid_from     = "2025-09-19"
      cert_valid_to       = "2025-09-22"

      country             = "CA"
      state               = "Québec"
      locality            = "Chambly"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:68:d1:13:bb:35:9f:22:a8:15:fb:00:00:00:04:68:d1"
      )
}

rule MAL_Compromised_Cert_Latrodectus_Microsoft_330004D9923711B01863EF675A00000004D992 {
   meta:
      description         = "Detects Latrodectus with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-16"
      version             = "1.0"

      hash                = "60e0a433c0114a628856f671e42d21f2e573b1b9b06ba545d77b8e2e12685a2f"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chidiac Entreprises Commerciales Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:d9:92:37:11:b0:18:63:ef:67:5a:00:00:00:04:d9:92"
      cert_thumbprint     = "55CD33E0B48D8D16B1635DA4E02F9501133A2B40"
      cert_valid_from     = "2025-10-16"
      cert_valid_to       = "2025-10-19"

      country             = "CA"
      state               = "Québec"
      locality            = "MONTREAL"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:d9:92:37:11:b0:18:63:ef:67:5a:00:00:00:04:d9:92"
      )
}

rule MAL_Compromised_Cert_Latrodectus_Microsoft_330005DEB3C1E7F9D2006A0C0900000005DEB3 {
   meta:
      description         = "Detects Latrodectus with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-20"
      version             = "1.0"

      hash                = "8113fc3b4f82fb49f8dd853ca8e1275e0dfb06e48f39830708e4437fe8afbdfb"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chidiac Entreprises Commerciales Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:de:b3:c1:e7:f9:d2:00:6a:0c:09:00:00:00:05:de:b3"
      cert_thumbprint     = "3F8DED465BAE2CA72B177076098DA487E0072523"
      cert_valid_from     = "2025-10-20"
      cert_valid_to       = "2025-10-23"

      country             = "CA"
      state               = "Québec"
      locality            = "MONTREAL"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:de:b3:c1:e7:f9:d2:00:6a:0c:09:00:00:00:05:de:b3"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_1FA07CAB58D34DCB6E231FB57F179C7A {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-15"
      version             = "1.0"

      hash                = "f1b27d88bdb6b4d2019191b539f130edceb6b7ec16bd4131159256b4c872a8fd"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TEAM PLAYER SOLUTION LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1f:a0:7c:ab:58:d3:4d:cb:6e:23:1f:b5:7f:17:9c:7a"
      cert_thumbprint     = "1DD29CCAD6E21A5E15BE6DD722D5D2805B28BA83"
      cert_valid_from     = "2025-08-15"
      cert_valid_to       = "2026-08-15"

      country             = "GB"
      state               = "England"
      locality            = "Huntingdon"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1f:a0:7c:ab:58:d3:4d:cb:6e:23:1f:b5:7f:17:9c:7a"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_24271B6A45C3D95B6C5BC15C98A84B83 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "49c20938fbd31a92a359147b539de76d59be71abf7560801ecc497ca9c8ae809"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ballbusters Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "24:27:1b:6a:45:c3:d9:5b:6c:5b:c1:5c:98:a8:4b:83"
      cert_thumbprint     = "563402AE6879F655A0CA3581F8DE7F8174A6E1F8"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-17"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "24:27:1b:6a:45:c3:d9:5b:6c:5b:c1:5c:98:a8:4b:83"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_30B2FD81E0057F656E7CDA84DDB2A2DD {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-01"
      version             = "1.0"

      hash                = "be5bcdfc0dbe204001b071e8270bd6856ce6841c43338d8db914e045147b0e77"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Lion Code Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "30:b2:fd:81:e0:05:7f:65:6e:7c:da:84:dd:b2:a2:dd"
      cert_thumbprint     = "E4E13418BCA7E3C1AE6E05812831592E2DE922AF"
      cert_valid_from     = "2025-09-01"
      cert_valid_to       = "2026-09-01"

      country             = "FI"
      state               = "Päijänne Tavastia"
      locality            = "Lahti"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "30:b2:fd:81:e0:05:7f:65:6e:7c:da:84:dd:b2:a2:dd"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_35769C2B094E3469AEF8193D6188F341 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-15"
      version             = "1.0"

      hash                = "88e9c1f5026834ebcdaed98f56d52b5f23547ac2c03aa43c5e50e7d8e1b82b3a"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Art en Code B.V."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "35:76:9c:2b:09:4e:34:69:ae:f8:19:3d:61:88:f3:41"
      cert_thumbprint     = "E01B1C0B5488998AA7BE21464C67A45D873C8B3D"
      cert_valid_from     = "2025-09-15"
      cert_valid_to       = "2026-09-07"

      country             = "NL"
      state               = "Noord-Holland"
      locality            = "Zwanenburg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "35:76:9c:2b:09:4e:34:69:ae:f8:19:3d:61:88:f3:41"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_3714AD18963039C5B9D931E9B7D1C705 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-05"
      version             = "1.0"

      hash                = "2fe0bd27009fc17f5150257cf84a74429005f101744ca20a4ad599ed6e6869c1"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kerinthe Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "37:14:ad:18:96:30:39:c5:b9:d9:31:e9:b7:d1:c7:05"
      cert_thumbprint     = "EF1C0C7BE50F9FDA0666CEA043DB4818060A7478"
      cert_valid_from     = "2025-09-05"
      cert_valid_to       = "2026-09-05"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "37:14:ad:18:96:30:39:c5:b9:d9:31:e9:b7:d1:c7:05"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_3B3A78F49AD75CC43846F465E30B67F1 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-14"
      version             = "1.0"

      hash                = "dd62428e997903e9d2b8e8319fe3a7a57d4e87599d46894b1f9f6f31f7872701"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tietotekniikkapalvelu Risto Kaukua Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3b:3a:78:f4:9a:d7:5c:c4:38:46:f4:65:e3:0b:67:f1"
      cert_thumbprint     = "646B3C129E9A85D332FC8F7D3D3E181C6BD74181"
      cert_valid_from     = "2025-04-14"
      cert_valid_to       = "2026-04-14"

      country             = "FI"
      state               = "Lappi"
      locality            = "Saarenkylä"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3b:3a:78:f4:9a:d7:5c:c4:38:46:f4:65:e3:0b:67:f1"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_4131E58C49BF75E22C521546A2190F13 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-28"
      version             = "1.0"

      hash                = "d22c96565d2640d993f7280731112287986c24cb1636126da391634ed478ed1e"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Digital Tags Finland Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "41:31:e5:8c:49:bf:75:e2:2c:52:15:46:a2:19:0f:13"
      cert_thumbprint     = "8A72BD6ADD0E597504C52AAEA9B87790FF5FDAF4"
      cert_valid_from     = "2025-04-28"
      cert_valid_to       = "2026-04-28"

      country             = "FI"
      state               = "Pirkanmaa"
      locality            = "Tampere"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "41:31:e5:8c:49:bf:75:e2:2c:52:15:46:a2:19:0f:13"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_454F322BF582E886A1763ADD21036BEE {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-15"
      version             = "1.0"

      hash                = "dcd82f7f01855769e9a2dad934be7231d6a7c50254077c094f4c3324daeed715"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SAFSTA ENTERPRISE LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "45:4f:32:2b:f5:82:e8:86:a1:76:3a:dd:21:03:6b:ee"
      cert_thumbprint     = "5FD2E525DF8767B559CA02B7C363A0FC5210657A"
      cert_valid_from     = "2025-09-15"
      cert_valid_to       = "2026-09-15"

      country             = "GB"
      state               = "???"
      locality            = "LEICESTER"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "45:4f:32:2b:f5:82:e8:86:a1:76:3a:dd:21:03:6b:ee"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_4BC686E2CD8CBD3B83A75FC82D509D91 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-03"
      version             = "1.0"

      hash                = "328a8fb3ff41093c3b3352a6b3771e1d3351a04861ee73c7260ecb0e84aa51ff"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GENERAL PLASTICS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4b:c6:86:e2:cd:8c:bd:3b:83:a7:5f:c8:2d:50:9d:91"
      cert_thumbprint     = "77EA92F19B867DFFA05AEF22190BF261B1423A68"
      cert_valid_from     = "2025-10-03"
      cert_valid_to       = "2026-10-03"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4b:c6:86:e2:cd:8c:bd:3b:83:a7:5f:c8:2d:50:9d:91"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_4DA45F056206178D7AE829F93EFEDF22 {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "3ebab9121aef087c075e8f79e67473c39331943e650f55dc11da764bf1cd1b23"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MAKEN LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4d:a4:5f:05:62:06:17:8d:7a:e8:29:f9:3e:fe:df:22"
      cert_thumbprint     = "97B800AC050F8C90AFB3271EBCA0CF31AD8FC9BA"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2026-03-14"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2012/88104"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4d:a4:5f:05:62:06:17:8d:7a:e8:29:f9:3e:fe:df:22"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_611E5DC57B210DC08205140F6D57063F {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-11"
      version             = "1.0"

      hash                = "f7dea7d5f87f19c73def52f3b40ca9f0c903a82d49fccb65d3acc1c4f12ad17c"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ASTRA PROPERTY MANAGEMENT, SRL"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "61:1e:5d:c5:7b:21:0d:c0:82:05:14:0f:6d:57:06:3f"
      cert_thumbprint     = "63FE755BD074ADE6D50DECEF81004F9FE8BA8CA7"
      cert_valid_from     = "2025-08-11"
      cert_valid_to       = "2026-08-11"

      country             = "MD"
      state               = "Bălți Municipality"
      locality            = "Bălţi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "61:1e:5d:c5:7b:21:0d:c0:82:05:14:0f:6d:57:06:3f"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_63A1D220486892587186887E3B99011E {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "050d979457c9adfd500f480d8ea216fdc0c0b0781c59fa623e0d6ce832f5d13e"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ECO BUILD HOUSE SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "63:a1:d2:20:48:68:92:58:71:86:88:7e:3b:99:01:1e"
      cert_thumbprint     = "1D30351CB18AE8DF3F3D8DCEF0AE4D7948FFA067"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-17"

      country             = "PL"
      state               = "Podlaskie Voivodeship"
      locality            = "Białystok"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "63:a1:d2:20:48:68:92:58:71:86:88:7e:3b:99:01:1e"
      )
}

rule MAL_Compromised_Cert_Latrodectus_SSL_com_767762D952D581A77D277D74A02485EC {
   meta:
      description         = "Detects Latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-04"
      version             = "1.0"

      hash                = "32f886142de76f09b1e7229a79e66eb46889251ebf871e4df3b6de7fd5cef749"
      malware             = "Latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Soft Design B.V."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "76:77:62:d9:52:d5:81:a7:7d:27:7d:74:a0:24:85:ec"
      cert_thumbprint     = "C2562BC3BC0640A556E285409F2EC88EBF6D799E"
      cert_valid_from     = "2025-09-04"
      cert_valid_to       = "2026-09-04"

      country             = "NL"
      state               = "South Holland"
      locality            = "Bergschenhoek"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "76:77:62:d9:52:d5:81:a7:7d:27:7d:74:a0:24:85:ec"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_GlobalSign_5FC7AB8E0CCD4838C82C1B61 {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-21"
      version             = "1.0"

      hash                = "765816c6e2c600c379014b4923f3d05eff5e91f46712da0fb21de99a6ca68021"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SKY SPACE TECHNO SOLUTIONS LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5f:c7:ab:8e:0c:cd:48:38:c8:2c:1b:61"
      cert_thumbprint     = "F6DABE713EBA4A23A91BA440CFAE5732A23FCEA7"
      cert_valid_from     = "2025-07-21"
      cert_valid_to       = "2026-07-22"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "teamskyspace@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5f:c7:ab:8e:0c:cd:48:38:c8:2c:1b:61"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_Microsoft_330004548B9E721CB582F3D4A400000004548B {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-14"
      version             = "1.0"

      hash                = "18b680773fb2b58e34166c7694dd9f533e66936d6effa2430d7c7fbaa57e8722"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "QUANT QUEST ACADEMY INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:54:8b:9e:72:1c:b5:82:f3:d4:a4:00:00:00:04:54:8b"
      cert_thumbprint     = "07EEE4B654C49F29131DA4B747E7786E35ED9496"
      cert_valid_from     = "2025-09-14"
      cert_valid_to       = "2025-09-17"

      country             = "CA"
      state               = "Ontario"
      locality            = "VAUGHAN"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:54:8b:9e:72:1c:b5:82:f3:d4:a4:00:00:00:04:54:8b"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_Microsoft_33000462E2BD9A0ADBEEA1F0290000000462E2 {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-18"
      version             = "1.0"

      hash                = "08c3ea261d7849bb91506dc111c348a6dde3bc6f35a95470e4d650bd3513c7c5"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IMMEUBLES DAVECLO INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:62:e2:bd:9a:0a:db:ee:a1:f0:29:00:00:00:04:62:e2"
      cert_thumbprint     = "27ABDE65ADE5BDA2A1EA31B33A683B25CB62CDF9"
      cert_valid_from     = "2025-09-18"
      cert_valid_to       = "2025-09-21"

      country             = "CA"
      state               = "Québec"
      locality            = "Chambly"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:62:e2:bd:9a:0a:db:ee:a1:f0:29:00:00:00:04:62:e2"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_Microsoft_33000562AFE8C9483AB03F0ECD0000000562AF {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "c08d5d2647f298c493475fe5ad22b6e6e71f9cd5ee24ed0e62acf98eee119271"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "QUANT QUEST ACADEMY INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:62:af:e8:c9:48:3a:b0:3f:0e:cd:00:00:00:05:62:af"
      cert_thumbprint     = "8041637040E1526CDA4B60EE3C606A22F6B97F4B"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2025-09-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "VAUGHAN"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:62:af:e8:c9:48:3a:b0:3f:0e:cd:00:00:00:05:62:af"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_Microsoft_33000569DCC148A15583BC04790000000569DC {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-11"
      version             = "1.0"

      hash                = "2528df60e55f210a6396dd7740d76afe30d5e9e8684a5b8a02a63bdcb5041bfc"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "QUANT QUEST ACADEMY INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:69:dc:c1:48:a1:55:83:bc:04:79:00:00:00:05:69:dc"
      cert_thumbprint     = "AE97AE942C0E27D52CB45A91DDC785B9EF69E3CB"
      cert_valid_from     = "2025-09-11"
      cert_valid_to       = "2025-09-14"

      country             = "CA"
      state               = "Ontario"
      locality            = "VAUGHAN"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:69:dc:c1:48:a1:55:83:bc:04:79:00:00:00:05:69:dc"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_Microsoft_3300059787288DB895763F8523000000059787 {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-22"
      version             = "1.0"

      hash                = "44a26915bfe1a0f2823d81c08e9d9a96aab65ca73fa9186d09781b2a447e77b6"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IMMEUBLES DAVECLO INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:97:87:28:8d:b8:95:76:3f:85:23:00:00:00:05:97:87"
      cert_thumbprint     = "BA71DD785DF6EBA93AD7E456B6888560B8F1D280"
      cert_valid_from     = "2025-09-22"
      cert_valid_to       = "2025-09-25"

      country             = "CA"
      state               = "Québec"
      locality            = "Chambly"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:97:87:28:8d:b8:95:76:3f:85:23:00:00:00:05:97:87"
      )
}

rule MAL_Compromised_Cert_Latrodectus_stage2_Microsoft_330005A96D055159B905B6967600000005A96D {
   meta:
      description         = "Detects Latrodectus_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-28"
      version             = "1.0"

      hash                = "9ce7fa41d8088472dcda120012d025f16c638c57511ac4b337f16893c4580105"
      malware             = "Latrodectus_stage2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Assurance Property Management L.L.C."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:a9:6d:05:51:59:b9:05:b6:96:76:00:00:00:05:a9:6d"
      cert_thumbprint     = "AC1127E674EF33B623576595AAB7788ABFF420F4"
      cert_valid_from     = "2025-09-28"
      cert_valid_to       = "2025-10-01"

      country             = "US"
      state               = "Colorado"
      locality            = "Denver"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:a9:6d:05:51:59:b9:05:b6:96:76:00:00:00:05:a9:6d"
      )
}

rule MAL_Compromised_Cert_Lazarus_Comodo_009A73550B8376863BD9430FAA8B5A2987 {
   meta:
      description         = "Detects Lazarus with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2018-05-21"
      version             = "1.0"

      hash                = "bdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb"
      malware             = "Lazarus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CELAS LLC"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Code Signing CA"
      cert_serial         = "00:9a:73:55:0b:83:76:86:3b:d9:43:0f:aa:8b:5a:29:87"
      cert_thumbprint     = "A2C8AD6352D333BB13E6FA3F1EAD87820A962CB7"
      cert_valid_from     = "2018-05-21"
      cert_valid_to       = "2019-05-21"

      country             = "US"
      state               = "Michigan"
      locality            = "Cedar Springs"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Code Signing CA" and
         sig.serial == "00:9a:73:55:0b:83:76:86:3b:d9:43:0f:aa:8b:5a:29:87"
      )
}

rule MAL_Compromised_Cert_Lazarus_Sectigo_00913BA16962CD7EEE25965A6D0EEFFA10 {
   meta:
      description         = "Detects Lazarus with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-07-12"
      version             = "1.0"

      hash                = "081d1739422bf050755e6af269a717681274821cea8becb0962d4db61869c5d6"
      malware             = "Lazarus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JMT TRADING GROUP INC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:91:3b:a1:69:62:cd:7e:ee:25:96:5a:6d:0e:ef:fa:10"
      cert_thumbprint     = "079AEB295C8E27AC8D9BE79C8B0AAF66A0EF15DE"
      cert_valid_from     = "2019-07-12"
      cert_valid_to       = "2020-07-11"

      country             = "US"
      state               = "CALIFORNIA"
      locality            = "ROWLAND HEIGHTS"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:91:3b:a1:69:62:cd:7e:ee:25:96:5a:6d:0e:ef:fa:10"
      )
}

rule MAL_Compromised_Cert_Lazarus_Sectigo_029BF7E1CB09FE277564BD27C267DE5A {
   meta:
      description         = "Detects Lazarus with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-24"
      version             = "1.0"

      hash                = "829eceee720b0a3e505efbd3262c387b92abdf46183d51a50489e2b157dac3b1"
      malware             = "Lazarus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SAMOYAJ LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "02:9b:f7:e1:cb:09:fe:27:75:64:bd:27:c2:67:de:5a"
      cert_thumbprint     = "F916A11E205B1D456FC9B1004B997378EAD71C58"
      cert_valid_from     = "2021-11-24"
      cert_valid_to       = "2022-11-24"

      country             = "GB"
      state               = "West Yorkshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "02:9b:f7:e1:cb:09:fe:27:75:64:bd:27:c2:67:de:5a"
      )
}

rule MAL_Compromised_Cert_LegionLoader_Sectigo_269FB93CCBAFAFE2B5F144B5BEFE93F3 {
   meta:
      description         = "Detects LegionLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-17"
      version             = "1.0"

      hash                = "fa60e517ee864bed74a9cdf0dc41efe86190a442df1ffda8b4f59f9890f0c22a"
      malware             = "LegionLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GALAKTIKA, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "26:9f:b9:3c:cb:af:af:e2:b5:f1:44:b5:be:fe:93:f3"
      cert_thumbprint     = "107A38A1D2DE225F43927B20016FDD7046B84524"
      cert_valid_from     = "2020-11-17"
      cert_valid_to       = "2021-11-17"

      country             = "RU"
      state               = "???"
      locality            = "St petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "26:9f:b9:3c:cb:af:af:e2:b5:f1:44:b5:be:fe:93:f3"
      )
}

rule MAL_Compromised_Cert_Loader_SSL_com_1AB6D723421A346BD8FF04DCF86EE2A5 {
   meta:
      description         = "Detects Loader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-10"
      version             = "1.0"

      hash                = "54f4be3601111cb57393d22318fc401bbb4a2098bab28d61f96119c7f9f53df2"
      malware             = "Loader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cult of the North AB"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1a:b6:d7:23:42:1a:34:6b:d8:ff:04:dc:f8:6e:e2:a5"
      cert_thumbprint     = "ED087A063012813B615029727B164A9611FCE135"
      cert_valid_from     = "2025-02-10"
      cert_valid_to       = "2026-03-18"

      country             = "SE"
      state               = "Stockholm County"
      locality            = "Stockholm"
      email               = "???"
      rdn_serial_number   = "559360-1908"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1a:b6:d7:23:42:1a:34:6b:d8:ff:04:dc:f8:6e:e2:a5"
      )
}

rule MAL_Compromised_Cert_LockerGoga_Sectigo_5DA173EB1AC76340AC058E1FF4BF5E1B {
   meta:
      description         = "Detects LockerGoga with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-02-22"
      version             = "1.0"

      hash                = "eda26a1cd80aac1c42cdbba9af813d9c4bc81f6052080bc33435d1e076e75aa0"
      malware             = "LockerGoga"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ALISA LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "5d:a1:73:eb:1a:c7:63:40:ac:05:8e:1f:f4:bf:5e:1b"
      cert_thumbprint     = "ACB38D45108C4F0C8894040646137C95E9BB39D8"
      cert_valid_from     = "2019-02-22"
      cert_valid_to       = "2020-02-21"

      country             = "GB"
      state               = "LONDON"
      locality            = "LONDON"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "5d:a1:73:eb:1a:c7:63:40:ac:05:8e:1f:f4:bf:5e:1b"
      )
}

rule MAL_Compromised_Cert_LumiStealer_SSL_com_2D168D5FD32D40F5BC8A058DB98520EC {
   meta:
      description         = "Detects LumiStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-21"
      version             = "1.0"

      hash                = "c9d8c91666f3b7c1c1e4c3f1ebfef5a26d6c7cbcbed21d70dcd830cf718f4518"
      malware             = "LumiStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RAFAEL RIBEIRO GONÇALVES"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "2d:16:8d:5f:d3:2d:40:f5:bc:8a:05:8d:b9:85:20:ec"
      cert_thumbprint     = "5CEF79491CE85B150098532E0FC46543820CF38F"
      cert_valid_from     = "2025-07-21"
      cert_valid_to       = "2026-07-21"

      country             = "BR"
      state               = "São Paulo"
      locality            = "São Paulo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "2d:16:8d:5f:d3:2d:40:f5:bc:8a:05:8d:b9:85:20:ec"
      )
}

rule MAL_Compromised_Cert_LummaStealer_Certum_6EA1C1F413D70D7FCCA1C13D2BD6A8B5 {
   meta:
      description         = "Detects LummaStealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-16"
      version             = "1.0"

      hash                = "50d898c0f480f38d47991dd617e2255e1ed332a973360014e2a047c85381a752"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Software Box Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6e:a1:c1:f4:13:d7:0d:7f:cc:a1:c1:3d:2b:d6:a8:b5"
      cert_thumbprint     = "5ED0201362CAEDF3B418409B0E3270B4F24F69FA"
      cert_valid_from     = "2025-02-16"
      cert_valid_to       = "2026-02-16"

      country             = "GB"
      state               = "England"
      locality            = "York"
      email               = "???"
      rdn_serial_number   = "12567696"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6e:a1:c1:f4:13:d7:0d:7f:cc:a1:c1:3d:2b:d6:a8:b5"
      )
}

rule MAL_Compromised_Cert_LummaStealer_GlobalSign_0C785890CB7CF34C41D06B6C {
   meta:
      description         = "Detects LummaStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-15"
      version             = "1.0"

      hash                = "9fcdb3db8b8a300150dad2d92e24601ec1f052bdbca08e611489f2fdb814305b"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Maibond Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:78:58:90:cb:7c:f3:4c:41:d0:6b:6c"
      cert_thumbprint     = "785eef75d9aa8b8be3d677fd8502447cf675f7becf4198c1570aedf0b70d622c"
      cert_valid_from     = "2024-10-15"
      cert_valid_to       = "2025-10-16"

      country             = "CN"
      state               = "Fujian"
      locality            = "Fuzhou"
      email               = "???"
      rdn_serial_number   = "91350104MA2Y639F25"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:78:58:90:cb:7c:f3:4c:41:d0:6b:6c"
      )
}

rule MAL_Compromised_Cert_LummaStealer_GlobalSign_21C9D35D23114F71494A3FEA {
   meta:
      description         = "Detects LummaStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-12"
      version             = "1.0"

      hash                = "c6e3855f6893092020a2dce35e30869d96a7922f2b805bbdf081eec97cbba62b"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "S.R.L. CONSTUDIO GRUP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "21:c9:d3:5d:23:11:4f:71:49:4a:3f:ea"
      cert_thumbprint     = "346EA81E7E518EC2BF5DE0AF8A63A0558A39CC1D"
      cert_valid_from     = "2025-03-12"
      cert_valid_to       = "2026-03-13"

      country             = "MD"
      state               = "Chișinău"
      locality            = "Chișinău"
      email               = "???"
      rdn_serial_number   = "1010600029333"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "21:c9:d3:5d:23:11:4f:71:49:4a:3f:ea"
      )
}

rule MAL_Compromised_Cert_LummaStealer_GlobalSign_49EF8191E6CFB0F25A125B62 {
   meta:
      description         = "Detects LummaStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-03"
      version             = "1.0"

      hash                = "11eec5d71c7fadae9d7176448d8fff3de44ec8d3b4df86f0eca59e06adf202d3"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "ООО Мб-Сигма"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:ef:81:91:e6:cf:b0:f2:5a:12:5b:62"
      cert_thumbprint     = "0702BA0245DF74C814F328A076E8D4D1504E17F0"
      cert_valid_from     = "2025-02-03"
      cert_valid_to       = "2026-02-04"

      country             = "RU"
      state               = "Санкт-Петербург"
      locality            = "Санкт-Петербург"
      email               = "mb.sigma@mail.ru"
      rdn_serial_number   = "1207800050622"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:ef:81:91:e6:cf:b0:f2:5a:12:5b:62"
      )
}

rule MAL_Compromised_Cert_LummaStealer_SSL_com_39FCEC85A551B9F9302D7D6B5ACA8E88 {
   meta:
      description         = "Detects LummaStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-12"
      version             = "1.0"

      hash                = "c98d70e7d8a6f73c9fd2015a147c230073c75b533894951fd9ed20007eff9ba8"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "PLUS PAY SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "39:fc:ec:85:a5:51:b9:f9:30:2d:7d:6b:5a:ca:8e:88"
      cert_thumbprint     = "EB841B06EB0E6E1EB729E0879C3C913F6305FA6A"
      cert_valid_from     = "2024-01-12"
      cert_valid_to       = "2025-01-11"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000818204"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "39:fc:ec:85:a5:51:b9:f9:30:2d:7d:6b:5a:ca:8e:88"
      )
}

rule MAL_Compromised_Cert_LummaStealer_SSL_com_48909C7C626AB37268C151E2FA82D923 {
   meta:
      description         = "Detects LummaStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-04"
      version             = "1.0"

      hash                = "324e1c80d9accb9ef7f96006122b41d3af33cbd74c47a5240537a17fe20110f1"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "SOLVED BY AI LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "48:90:9c:7c:62:6a:b3:72:68:c1:51:e2:fa:82:d9:23"
      cert_thumbprint     = "B6D2B4459D1F8E3F3351761CF1B244FD50430DAA"
      cert_valid_from     = "2025-03-04"
      cert_valid_to       = "2026-03-04"

      country             = "GB"
      state               = "???"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "SC653985"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "48:90:9c:7c:62:6a:b3:72:68:c1:51:e2:fa:82:d9:23"
      )
}

rule MAL_Compromised_Cert_LummaStealer_SSL_com_4F12A0A5569392FC0B41C3D077E6586D {
   meta:
      description         = "Detects LummaStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-06"
      version             = "1.0"

      hash                = "1626516aad9026976a6eaa4e637e8de95cb9d1203e99f50e94f25ea7a06c34f9"
      malware             = "LummaStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "SIFA ESTATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4f:12:a0:a5:56:93:92:fc:0b:41:c3:d0:77:e6:58:6d"
      cert_thumbprint     = "3CF0E45215994AE97A21B5C487369592EA24B1D2"
      cert_valid_from     = "2025-03-06"
      cert_valid_to       = "2026-03-06"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2010/81740"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4f:12:a0:a5:56:93:92:fc:0b:41:c3:d0:77:e6:58:6d"
      )
}

rule MAL_Compromised_Cert_Lumma_GlobalSign_3D786B0FC4B4DA7F82AD49FD {
   meta:
      description         = "Detects Lumma with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-06"
      version             = "1.0"

      hash                = "c6a9478bc78e96f2eb72543c98d00ec3c06ee00cffe98423f93e0a7016d468e2"
      malware             = "Lumma"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "THIRTY THREE (SHANGHAI)LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3d:78:6b:0f:c4:b4:da:7f:82:ad:49:fd"
      cert_thumbprint     = ""
      cert_valid_from     = "2025-05-06"
      cert_valid_to       = "2026-05-07"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3d:78:6b:0f:c4:b4:da:7f:82:ad:49:fd"
      )
}

rule MAL_Compromised_Cert_Lumma_GlobalSign_7FB638E71C5F4A5DB43DAC97 {
   meta:
      description         = "Detects Lumma with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-28"
      version             = "1.0"

      hash                = "1d881f83f82d4393e96d206145f35ccaf695380dc05d99a8eae9b2a001e04b13"
      malware             = "Lumma"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "SLS Immobilien und Beteiligungs GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7f:b6:38:e7:1c:5f:4a:5d:b4:3d:ac:97"
      cert_thumbprint     = "05AE3873EC1B92235BB7A99A04CD2D06E2C8B815"
      cert_valid_from     = "2025-03-28"
      cert_valid_to       = "2026-03-29"

      country             = "AT"
      state               = "Niederoesterreich"
      locality            = "Ebreichsdorf"
      email               = "???"
      rdn_serial_number   = "632119m"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7f:b6:38:e7:1c:5f:4a:5d:b4:3d:ac:97"
      )
}

rule MAL_Compromised_Cert_Lumma_Microsoft_330002F4DBCF4797B76D49B43800000002F4DB {
   meta:
      description         = "Detects Lumma with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-11"
      version             = "1.0"

      hash                = "708c39e1249e5d40a9a33017d3d3f7cf8f3e6054adb2c2415cd1e4b686e9373e"
      malware             = "Lumma"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "超 王"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:02:f4:db:cf:47:97:b7:6d:49:b4:38:00:00:00:02:f4:db"
      cert_thumbprint     = "4D04E81739EA845B47BAFD05EBB6F1A16A293D6C"
      cert_valid_from     = "2025-03-11"
      cert_valid_to       = "2025-03-14"

      country             = "CN"
      state               = "Shanxi"
      locality            = "万荣"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:02:f4:db:cf:47:97:b7:6d:49:b4:38:00:00:00:02:f4:db"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_1020DA14FC50142721B9BF18CD851EE9 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-02"
      version             = "1.0"

      hash                = "fdacb443e59ed1b368f6d975ffd282b10fdbecb03950daac380a6864be25f2f8"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Weifang Bodu Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "10:20:da:14:fc:50:14:27:21:b9:bf:18:cd:85:1e:e9"
      cert_thumbprint     = "2B39470E15C59FB01F154A341709D3393CA0CD10"
      cert_valid_from     = "2024-10-02"
      cert_valid_to       = "2025-10-02"

      country             = "CN"
      state               = "Shandong"
      locality            = "Weifang"
      email               = "???"
      rdn_serial_number   = "91370725MA3DJ7DJ51"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "10:20:da:14:fc:50:14:27:21:b9:bf:18:cd:85:1e:e9"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_1ABE8E730CFD09D1FC1A65D1264AAAED {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-02"
      version             = "1.0"

      hash                = "dd5566e9a9d1cf5dc37c88cb33c1324dbc3de0c4af22d2f00cadaf7d07f1b4c8"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Shenzhen Xinshitong Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1a:be:8e:73:0c:fd:09:d1:fc:1a:65:d1:26:4a:aa:ed"
      cert_thumbprint     = "8F44A139359DDB9310C681526C560F207B706115"
      cert_valid_from     = "2024-10-02"
      cert_valid_to       = "2025-10-02"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "914403003426869970"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1a:be:8e:73:0c:fd:09:d1:fc:1a:65:d1:26:4a:aa:ed"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_1BA2065DF99EA0431ED75D07B5F01EE3 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-27"
      version             = "1.0"

      hash                = "59cbdbc57cfd1a2b8014a0572001ee5583856c7479539305110dd5ee09d77d7f"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Guangzhou Wenlong Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1b:a2:06:5d:f9:9e:a0:43:1e:d7:5d:07:b5:f0:1e:e3"
      cert_thumbprint     = "3C2B0899E92BC1235B554F3171DF124CF9B5F829"
      cert_valid_from     = "2024-09-27"
      cert_valid_to       = "2025-09-27"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101072117953U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1b:a2:06:5d:f9:9e:a0:43:1e:d7:5d:07:b5:f0:1e:e3"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_2681C857CF3337AF1954175038198DF4 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-13"
      version             = "1.0"

      hash                = "397a2d0a1f7c975eaf2724a411a1cfbe63a64e20520a8e9ea78d0c7b60ae6b8c"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Chengdu Daodaotong Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "26:81:c8:57:cf:33:37:af:19:54:17:50:38:19:8d:f4"
      cert_thumbprint     = "9E743FCBDDF9AB9134BD0ED157D4FBA99606F54F"
      cert_valid_from     = "2024-09-13"
      cert_valid_to       = "2025-09-13"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510107394612965F"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "26:81:c8:57:cf:33:37:af:19:54:17:50:38:19:8d:f4"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_332576FE101609502C23F70055B4A3BE {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-09"
      version             = "1.0"

      hash                = "193f942ae9f7d2f75324b7b9fc27b98dfb3df1b7802ffcd4aa8ce2c248ae09e4"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Guizhou Sixuanda Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "33:25:76:fe:10:16:09:50:2c:23:f7:00:55:b4:a3:be"
      cert_thumbprint     = "A3AFF46C5F8E2A1F750C570698B864E75553E61F"
      cert_valid_from     = "2024-09-09"
      cert_valid_to       = "2025-09-09"

      country             = "CN"
      state               = "Guizhou"
      locality            = "Guiyang"
      email               = "???"
      rdn_serial_number   = "91520100MA6DNNXK11"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "33:25:76:fe:10:16:09:50:2c:23:f7:00:55:b4:a3:be"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_468FFDEA6B0AAC7709BC66E3E5A9CE1A {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-28"
      version             = "1.0"

      hash                = "4f986320f90db5e745bcc343080a6aa371c6d6c067501a1c898920ca50ba24d1"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Anhui Wansanshi Internet of Things Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "46:8f:fd:ea:6b:0a:ac:77:09:bc:66:e3:e5:a9:ce:1a"
      cert_thumbprint     = "8A63640C6C4902126CBBC41F1C221679E40D3F28"
      cert_valid_from     = "2024-05-28"
      cert_valid_to       = "2025-05-28"

      country             = "CN"
      state               = "Anhui"
      locality            = "Wuhu"
      email               = "???"
      rdn_serial_number   = "91340222MA2MXM3F23"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "46:8f:fd:ea:6b:0a:ac:77:09:bc:66:e3:e5:a9:ce:1a"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Certum_6EA1C1F413D70D7FCCA1C13D2BD6A8B5 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-16"
      version             = "1.0"

      hash                = "8259a493729abd201b33851f56817f812ffd8ac75bfd3abc100e04c022f5ce59"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Software Box Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6e:a1:c1:f4:13:d7:0d:7f:cc:a1:c1:3d:2b:d6:a8:b5"
      cert_thumbprint     = "5ED0201362CAEDF3B418409B0E3270B4F24F69FA"
      cert_valid_from     = "2025-02-16"
      cert_valid_to       = "2026-02-16"

      country             = "GB"
      state               = "England"
      locality            = "York"
      email               = "???"
      rdn_serial_number   = "12567696"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6e:a1:c1:f4:13:d7:0d:7f:cc:a1:c1:3d:2b:d6:a8:b5"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_DigiCert_0C84D1A66AA31C56A7627A7B2CA71E32 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-31"
      version             = "1.0"

      hash                = "692159db6232a1a7e791ba171b5ff9f18b7e3c85f0a86dc1d71af04fbaad1000"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "REC EXPERT LTD"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0c:84:d1:a6:6a:a3:1c:56:a7:62:7a:7b:2c:a7:1e:32"
      cert_thumbprint     = "6DDF35C8300B5203E0ABF930947AB86FA7844128"
      cert_valid_from     = "2024-10-31"
      cert_valid_to       = "2025-10-30"

      country             = "GB"
      state               = "???"
      locality            = "Uxbridge"
      email               = "???"
      rdn_serial_number   = "11926625"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0c:84:d1:a6:6a:a3:1c:56:a7:62:7a:7b:2c:a7:1e:32"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Entrust_0B64E71114288245604A4474A5B9374D {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-31"
      version             = "1.0"

      hash                = "ec3ec6568b2f15f13b7316416fc6354c33bb02f253cb91d507fab4bd6e743f71"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Software Support ApS"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "0b:64:e7:11:14:28:82:45:60:4a:44:74:a5:b9:37:4d"
      cert_thumbprint     = "3D97A8146CF34E2FC8AD8418B16C4B4B68E3C526"
      cert_valid_from     = "2024-07-31"
      cert_valid_to       = "2025-07-31"

      country             = "DK"
      state               = "???"
      locality            = "København N"
      email               = "???"
      rdn_serial_number   = "37790672"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "0b:64:e7:11:14:28:82:45:60:4a:44:74:a5:b9:37:4d"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Entrust_26A21D788DA6866A10FB635FE03CEB53 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-19"
      version             = "1.0"

      hash                = "9bd25e01ae96fb8c0e3672f32bbe8f39db4099133ddceaaa87c7d74258d8ed1f"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Software Support ApS"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "26:a2:1d:78:8d:a6:86:6a:10:fb:63:5f:e0:3c:eb:53"
      cert_thumbprint     = "765B61077F49F2D2F275D942203B67A8AAC76D2C"
      cert_valid_from     = "2024-10-19"
      cert_valid_to       = "2025-10-19"

      country             = "DK"
      state               = "???"
      locality            = "København N"
      email               = "???"
      rdn_serial_number   = "37790672"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "26:a2:1d:78:8d:a6:86:6a:10:fb:63:5f:e0:3c:eb:53"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_01F2C6C363767056ABD80E9C {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-12"
      version             = "1.0"

      hash                = "dc8e5cae55181833fa9f3dd0f9af37a2112620fd47b22e2fd9b4a1b05c68620f"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "TVAIS LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "01:f2:c6:c3:63:76:70:56:ab:d8:0e:9c"
      cert_thumbprint     = "74DF2582AF3780D81A8071E260C2B04259EFC35A"
      cert_valid_from     = "2024-12-12"
      cert_valid_to       = "2025-12-03"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700738383"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "01:f2:c6:c3:63:76:70:56:ab:d8:0e:9c"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_0252BD23F462EFE212A000DF {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-03"
      version             = "1.0"

      hash                = "d5558bb4f7db0aab0c709068a9561cd79eafaf035038d42f321620c94883762a"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "INNOFLOW VINA COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "02:52:bd:23:f4:62:ef:e2:12:a0:00:df"
      cert_thumbprint     = "7E47A51679B2CB0F01C6560D662BFC0D2FDBD685"
      cert_valid_from     = "2024-06-03"
      cert_valid_to       = "2025-06-04"

      country             = "VN"
      state               = "Thai Binh"
      locality            = "Thai Binh"
      email               = "???"
      rdn_serial_number   = "1001152550"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "02:52:bd:23:f4:62:ef:e2:12:a0:00:df"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_14B3795118B8D9CCD6132BFE {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-11"
      version             = "1.0"

      hash                = "caec63022360e651cc8fae04138cf9e789e7d872369b18e62ed364d49d0de16d"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "RAMAPURA MINERALS PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "14:b3:79:51:18:b8:d9:cc:d6:13:2b:fe"
      cert_thumbprint     = "B743DA976C2834F0E45D7778CE7C6D04DE659BF8"
      cert_valid_from     = "2025-02-11"
      cert_valid_to       = "2026-02-12"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "aloapcorensouy967u@gmail.com"
      rdn_serial_number   = "U14219RJ2006PTC023446"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "14:b3:79:51:18:b8:d9:cc:d6:13:2b:fe"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_15363337CE1FDC16444D8DF3 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-30"
      version             = "1.0"

      hash                = "c36338fbc2b1913fd79443706dedbc9f58adcfaf5af1dab06a592446e8f6dec6"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "MIKA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "15:36:33:37:ce:1f:dc:16:44:4d:8d:f3"
      cert_thumbprint     = "59eaada4c4f218ed6a0c32fa15d463a3638d972e"
      cert_valid_from     = "2024-12-30"
      cert_valid_to       = "2025-12-31"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700784583"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "15:36:33:37:ce:1f:dc:16:44:4d:8d:f3"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_1B1339DC9E5B26B1DD81255A {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-11"
      version             = "1.0"

      hash                = "2f01809f78d096e770544c434b5bb63b3a0461559f7dd98a25a04bf66c8784f4"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "P2Soft Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1b:13:39:dc:9e:5b:26:b1:dd:81:25:5a"
      cert_thumbprint     = "63D85A92367C766320FA038F4A9D474E0DE83119"
      cert_valid_from     = "2024-09-11"
      cert_valid_to       = "2025-09-12"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "13224384"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1b:13:39:dc:9e:5b:26:b1:dd:81:25:5a"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_26A6819AC81B7A25BCE7D354 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-22"
      version             = "1.0"

      hash                = "97a586f21b94fe85d47179d0b6b55b86253754037274d37fad682a12bd8ef02c"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "MekoGuard Bytemin Information Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "26:a6:81:9a:c8:1b:7a:25:bc:e7:d3:54"
      cert_thumbprint     = "A53E2045C456BC5879E1159245884740FF0BE11D"
      cert_valid_from     = "2024-02-22"
      cert_valid_to       = "2025-02-06"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440605MACR7QA22Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "26:a6:81:9a:c8:1b:7a:25:bc:e7:d3:54"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_2B8D90A5626F4D697A670DF5 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-06"
      version             = "1.0"

      hash                = "b7526c45705bcb8b469178f868e1112d972010b48402da4b0396a2824db52049"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "ForSun COWS BlackCoin Handel Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2b:8d:90:a5:62:6f:4d:69:7a:67:0d:f5"
      cert_thumbprint     = "58E3746459129080B60C90D4965E40FCA1D9996A"
      cert_valid_from     = "2024-05-06"
      cert_valid_to       = "2025-04-27"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440604MACKU2FD81"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2b:8d:90:a5:62:6f:4d:69:7a:67:0d:f5"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_389FFFD8DB6CD11B662DA89B {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-25"
      version             = "1.0"

      hash                = "3b04fb9046116e28e410d1ee850bcf2a466dd487ba0103cfaa2a023519465518"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "LeYao Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:9f:ff:d8:db:6c:d1:1b:66:2d:a8:9b"
      cert_thumbprint     = "EE8747ECD7706F8D40BCC11CC30B833771EB29F0"
      cert_valid_from     = "2024-11-25"
      cert_valid_to       = "2025-11-26"

      country             = "CN"
      state               = "Hebei"
      locality            = "Qinhuangdao"
      email               = "???"
      rdn_serial_number   = "91130302MA0G33CQ5Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:9f:ff:d8:db:6c:d1:1b:66:2d:a8:9b"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_45156CCC49AFCA8C8C7B23DF {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-25"
      version             = "1.0"

      hash                = "0b8c1d7a910b0d9e747ebccc74b8bff20d33525bbdfc42a9b6044f6d4cf3815e"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Pincoo Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "45:15:6c:cc:49:af:ca:8c:8c:7b:23:df"
      cert_thumbprint     = "416C21AF73942D925A5DAC5B932BF480902B89BE"
      cert_valid_from     = "2024-10-25"
      cert_valid_to       = "2025-10-26"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300596794584L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "45:15:6c:cc:49:af:ca:8c:8c:7b:23:df"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_50CA05DEA06F5A744D4D12B8 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-06"
      version             = "1.0"

      hash                = "5c879ad7c6b5670812c5f79dffb4e4822c13d84dd35a29fe8bc4ae82f62834cb"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Burnoris Niraver Hirtuden Technolog Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:ca:05:de:a0:6f:5a:74:4d:4d:12:b8"
      cert_thumbprint     = "CAF837D41630E1371BFE97F14C61A3BF1F7B20D2"
      cert_valid_from     = "2024-03-06"
      cert_valid_to       = "2025-03-07"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "91330103MA28W1DR98"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:ca:05:de:a0:6f:5a:74:4d:4d:12:b8"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_5AD07FAD99F6CF7510AECACC {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-11"
      version             = "1.0"

      hash                = "1e37fad328fe34aa991f28ab5654e2732b0886e65ccb45a4dcd81a36bddbb2a8"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Chengdu Legou Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:d0:7f:ad:99:f6:cf:75:10:ae:ca:cc"
      cert_thumbprint     = "F9BF3B25C198F70DCF459F6608E1F01630AB359A"
      cert_valid_from     = "2023-08-11"
      cert_valid_to       = "2025-10-21"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA62PN8777"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:d0:7f:ad:99:f6:cf:75:10:ae:ca:cc"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_5D00264A6B804AE6B28D9B16 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-10"
      version             = "1.0"

      hash                = "9d5c551f076449af0dbd7e05e1c2e439d6f6335b3dd07a8fa1b819c250327f39"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "LLC YUSAL"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5d:00:26:4a:6b:80:4a:e6:b2:8d:9b:16"
      cert_thumbprint     = "7a6de7caed669a318bb7507755d5b4685a8f89ff94ee5cb6ea4d77e18a1fc1c9"
      cert_valid_from     = "2025-01-10"
      cert_valid_to       = "2026-01-11"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1196313074726"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5d:00:26:4a:6b:80:4a:e6:b2:8d:9b:16"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_5D04BDA411B4EA77878626B9 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-29"
      version             = "1.0"

      hash                = "61b21e5b87e0bd0df0fd822c94a8628355708db6681a46bb7907410152e91dd5"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Dongguan Weibang New Material Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5d:04:bd:a4:11:b4:ea:77:87:86:26:b9"
      cert_thumbprint     = "DBAD42AA98D85A51DD159FB3D3D66A90FB80C8C3"
      cert_valid_from     = "2024-10-29"
      cert_valid_to       = "2025-10-30"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Dongguan"
      email               = "cmengqiu@wbxclkj.com"
      rdn_serial_number   = "91441900MA51LEMH93"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5d:04:bd:a4:11:b4:ea:77:87:86:26:b9"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_60DF15A19828C2A85197F022 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-14"
      version             = "1.0"

      hash                = "9e39a555ccb79b2460d9808578ddd17e74754df03d216578202112c8e9506e0a"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Taigu Fulong Electronic Tech Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:df:15:a1:98:28:c2:a8:51:97:f0:22"
      cert_thumbprint     = "BBF98655F4D4ED396FBCA95F4AF8ED4EB01950A9"
      cert_valid_from     = "2024-08-14"
      cert_valid_to       = "2025-08-15"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Jinzhong"
      email               = "???"
      rdn_serial_number   = "911407265733564691"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:df:15:a1:98:28:c2:a8:51:97:f0:22"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_61E7E3D7542011F66192F1B6 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-27"
      version             = "1.0"

      hash                = "e239b11ecd605504a33038398cee8cb28bb2b4efff19401e7f5b954035a1cfa3"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "PTXGROUP VIETNAM COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "61:e7:e3:d7:54:20:11:f6:61:92:f1:b6"
      cert_thumbprint     = "2069BFF0AC884C2D7EAC0FD6E9BB06F0649FF32A"
      cert_valid_from     = "2024-06-27"
      cert_valid_to       = "2025-06-28"

      country             = "VN"
      state               = "Ho Chi Minh"
      locality            = "Ho Chi Minh"
      email               = "???"
      rdn_serial_number   = "0313953441"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "61:e7:e3:d7:54:20:11:f6:61:92:f1:b6"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_70093AF339876742820D7941 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-04"
      version             = "1.0"

      hash                = "cd207b81505f13d46d94b08fb5130ddae52bd1748856e6b474688e590933a718"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "AZALEA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "70:09:3a:f3:39:87:67:42:82:0d:79:41"
      cert_thumbprint     = "686B7EBBA606303B5085633FCAA0685272B4D9B9"
      cert_valid_from     = "2024-12-04"
      cert_valid_to       = "2025-12-05"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700738108"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "70:09:3a:f3:39:87:67:42:82:0d:79:41"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_75A53237CE3E3E24188BE0EB {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-30"
      version             = "1.0"

      hash                = "6ce21227a90c06234469aef5fa7173d5428ce0a69283a1dcd5c72168e4f7eda7"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Nanning Fumei Electronic Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "75:a5:32:37:ce:3e:3e:24:18:8b:e0:eb"
      cert_thumbprint     = "CD8A623B3A7BCA36FB52C24F0CA4BC9DF5FDE685"
      cert_valid_from     = "2024-05-30"
      cert_valid_to       = "2025-05-31"

      country             = "CN"
      state               = "Guangxi"
      locality            = "Nanning"
      email               = "???"
      rdn_serial_number   = "91450100672491172H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "75:a5:32:37:ce:3e:3e:24:18:8b:e0:eb"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_79994F42444B6F824EDA28D4 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-13"
      version             = "1.0"

      hash                = "9167c1b308c3e03a03189f9746e29c8812850c417543a51a250775232b692317"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Chengdu Nuoxin Times Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "79:99:4f:42:44:4b:6f:82:4e:da:28:d4"
      cert_thumbprint     = "EB0D7F2D8B94EE902F73F8BB9D9EC2B1A9CC5546"
      cert_valid_from     = "2023-06-13"
      cert_valid_to       = "2024-06-13"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA65214R21"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "79:99:4f:42:44:4b:6f:82:4e:da:28:d4"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_GlobalSign_7EAF9EB4886EDA7C48DC8EA4 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-05"
      version             = "1.0"

      hash                = "09044fb8f9d83cc008e3b937057f4c54995b26865bd9d7bcfec7aef54231d2b5"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Xuaony Lucid Dotaku Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:af:9e:b4:88:6e:da:7c:48:dc:8e:a4"
      cert_thumbprint     = "59CED3057E88B69EDD38587ACEE2BAEF92D32852"
      cert_valid_from     = "2024-07-05"
      cert_valid_to       = "2025-07-06"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420600MA488H2M4C"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:af:9e:b4:88:6e:da:7c:48:dc:8e:a4"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_0B09C88C0C8D15BED51A9EB4440F4BB0 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-03"
      version             = "1.0"

      hash                = "de6fcdf58b22a51d26eacb0e2c992d9a894c1894b3c8d70f4db80044dacb7430"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "VERANDAH GREEN LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0b:09:c8:8c:0c:8d:15:be:d5:1a:9e:b4:44:0f:4b:b0"
      cert_thumbprint     = "561620A3F0BF4FB96898A99252B85B00C468E5AF"
      cert_valid_from     = "2024-12-03"
      cert_valid_to       = "2025-11-29"

      country             = "GB"
      state               = "???"
      locality            = "Hook"
      email               = "???"
      rdn_serial_number   = "12979554"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0b:09:c8:8c:0c:8d:15:be:d5:1a:9e:b4:44:0f:4b:b0"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_0DDEA7910254F34E89DAC4F76D578F0F {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-20"
      version             = "1.0"

      hash                = "fe407790dad4c2b82a80548e5717a25994a35249209b94a2b13df894dca0a28a"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "BOTANICS BIOTECH LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0d:de:a7:91:02:54:f3:4e:89:da:c4:f7:6d:57:8f:0f"
      cert_thumbprint     = "E588858D7C0B31955E9CD3E250A6D6274EAF895A"
      cert_valid_from     = "2024-11-20"
      cert_valid_to       = "2025-11-20"

      country             = "GB"
      state               = "???"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "SC194382"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0d:de:a7:91:02:54:f3:4e:89:da:c4:f7:6d:57:8f:0f"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_10299E37FC5500D96E41D4E48D171E12 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-01"
      version             = "1.0"

      hash                = "9f21f2f2e295f1b9fef40d70e0f762f508a840a0f9f61928be39628da7dbca11"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "WAGON TRANSPORT LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "10:29:9e:37:fc:55:00:d9:6e:41:d4:e4:8d:17:1e:12"
      cert_thumbprint     = "C25F9BC1E738BBB5D331FA22738B4DFE4B6C6BE2"
      cert_valid_from     = "2024-10-01"
      cert_valid_to       = "2025-10-01"

      country             = "GB"
      state               = "England"
      locality            = "Leicester"
      email               = "???"
      rdn_serial_number   = "06794310"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "10:29:9e:37:fc:55:00:d9:6e:41:d4:e4:8d:17:1e:12"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_15CC014B62D4FF93ED255802B62EB4B5 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-18"
      version             = "1.0"

      hash                = "3d5768d3ee28635799dc2140011a9ef70c95e76fce2ab09d953c93a3c3db8d9c"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Business Account Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:cc:01:4b:62:d4:ff:93:ed:25:58:02:b6:2e:b4:b5"
      cert_thumbprint     = "A04B08220EF5B92A5A76F4A85B38BBE8893F2A73"
      cert_valid_from     = "2024-03-18"
      cert_valid_to       = "2025-02-26"

      country             = "GB"
      state               = "England"
      locality            = "Ipswich"
      email               = "???"
      rdn_serial_number   = "14748270"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:cc:01:4b:62:d4:ff:93:ed:25:58:02:b6:2e:b4:b5"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_19941067ECDF1AEE6337ABA743515E41 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-02"
      version             = "1.0"

      hash                = "1eacc8604c24976d62cb1af56a1e9bcac70d738fa8fcbe1067364ad7ff90546b"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Kslugidea Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "19:94:10:67:ec:df:1a:ee:63:37:ab:a7:43:51:5e:41"
      cert_thumbprint     = "3F9B93E7C83302442D72733A5A4B97124308EFFF"
      cert_valid_from     = "2024-08-02"
      cert_valid_to       = "2025-08-02"

      country             = "GB"
      state               = "???"
      locality            = "Wembley"
      email               = "???"
      rdn_serial_number   = "12378927"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "19:94:10:67:ec:df:1a:ee:63:37:ab:a7:43:51:5e:41"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_1A65841A68D2E417B8564838F13223C2 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-06"
      version             = "1.0"

      hash                = "1a833452a5cdde9002e4b25adfc3a46247fb8c578acb47a25eca5fe89570d748"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Shanghai Songling Group Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1a:65:84:1a:68:d2:e4:17:b8:56:48:38:f1:32:23:c2"
      cert_thumbprint     = "D3015AF4E20EDC894B6F23079959CF7B64D135A2"
      cert_valid_from     = "2024-08-06"
      cert_valid_to       = "2025-08-06"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "9131010706253653XP"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1a:65:84:1a:68:d2:e4:17:b8:56:48:38:f1:32:23:c2"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_1FE254EF22259130A919943BBE001865 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-07"
      version             = "1.0"

      hash                = "33d80d826bcc36c44603e065547e1038e94478d4053c31eb472d4f159d2964f4"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Scarcroft Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1f:e2:54:ef:22:25:91:30:a9:19:94:3b:be:00:18:65"
      cert_thumbprint     = "59B94F68B14AA494529030F07130CBBB12892720"
      cert_valid_from     = "2024-08-07"
      cert_valid_to       = "2025-08-07"

      country             = "GB"
      state               = "???"
      locality            = "York"
      email               = "???"
      rdn_serial_number   = "12005238"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1f:e2:54:ef:22:25:91:30:a9:19:94:3b:be:00:18:65"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_2351DDAF31CAFC1F6263F6E433B54E43 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-25"
      version             = "1.0"

      hash                = "a4bb60772446f2cd2f7629574bbf5702c35ce2afcf6e4b3a3d157281cecc7234"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Sichuan WCHX Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "23:51:dd:af:31:ca:fc:1f:62:63:f6:e4:33:b5:4e:43"
      cert_thumbprint     = "E29087AE930AC9BE77E22904EFE6416FE006F931"
      cert_valid_from     = "2024-08-25"
      cert_valid_to       = "2025-08-24"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100332110126P"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "23:51:dd:af:31:ca:fc:1f:62:63:f6:e4:33:b5:4e:43"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_3037431F9B5302DE05794B798F813D47 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-29"
      version             = "1.0"

      hash                = "b4629a833620ed96e6a15518ea9c5a22291255cc32e149c5b500e4b9ad7049ac"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Allanson Consulting Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "30:37:43:1f:9b:53:02:de:05:79:4b:79:8f:81:3d:47"
      cert_thumbprint     = "D90410465A569F2A537C9851049413CD08FB33AB"
      cert_valid_from     = "2024-07-29"
      cert_valid_to       = "2025-07-29"

      country             = "GB"
      state               = "England"
      locality            = "Manchester"
      email               = "???"
      rdn_serial_number   = "09418564"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "30:37:43:1f:9b:53:02:de:05:79:4b:79:8f:81:3d:47"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_30D6C83A715BDDB32E7956FE52D6B352 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-03"
      version             = "1.0"

      hash                = "afdc1a1e1e934f18be28465315704a12b2cd43c186fbee94f7464392849a5ad0"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "ConsolHQ LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "30:d6:c8:3a:71:5b:dd:b3:2e:79:56:fe:52:d6:b3:52"
      cert_thumbprint     = "07728484B1BB8702A87C6E5A154E0D690AF2FF38"
      cert_valid_from     = "2024-12-03"
      cert_valid_to       = "2025-08-30"

      country             = "GB"
      state               = "???"
      locality            = "Erith"
      email               = "???"
      rdn_serial_number   = "12800651"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "30:d6:c8:3a:71:5b:dd:b3:2e:79:56:fe:52:d6:b3:52"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_39FCEC85A551B9F9302D7D6B5ACA8E88 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-12"
      version             = "1.0"

      hash                = "b9cea251e74bcf2d7bb7d3d587ad9ac548178a35ec1479e3c60936c914f6d5c3"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "PLUS PAY SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "39:fc:ec:85:a5:51:b9:f9:30:2d:7d:6b:5a:ca:8e:88"
      cert_thumbprint     = "EB841B06EB0E6E1EB729E0879C3C913F6305FA6A"
      cert_valid_from     = "2024-01-12"
      cert_valid_to       = "2025-01-11"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000818204"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "39:fc:ec:85:a5:51:b9:f9:30:2d:7d:6b:5a:ca:8e:88"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_3A9C76F8304F77BD271921D9982F1AB6 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-09"
      version             = "1.0"

      hash                = "87200e8b43a6707cd66fc240d2c9e9da7f3ed03c8507adf7c1cfe56ba1a9c57d"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "SUMMIT RECRUITMENT LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3a:9c:76:f8:30:4f:77:bd:27:19:21:d9:98:2f:1a:b6"
      cert_thumbprint     = "94C21E6384F2FFB72BD856C1C40B788F314B5298"
      cert_valid_from     = "2024-12-09"
      cert_valid_to       = "2025-12-09"

      country             = "GB"
      state               = "???"
      locality            = "Southampton"
      email               = "???"
      rdn_serial_number   = "09304744"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3a:9c:76:f8:30:4f:77:bd:27:19:21:d9:98:2f:1a:b6"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_3E73B59FA6DD7A627A3911F893B75460 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-04"
      version             = "1.0"

      hash                = "2406de4418048f119679d91f3e168ed8a0bf3e77c706295bb69598b220c173d2"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "It Best Management Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3e:73:b5:9f:a6:dd:7a:62:7a:39:11:f8:93:b7:54:60"
      cert_thumbprint     = "89BE52E6CA45C95023D0000554438A7671E63B0D"
      cert_valid_from     = "2024-04-04"
      cert_valid_to       = "2025-04-04"

      country             = "GB"
      state               = "???"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "08158198"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3e:73:b5:9f:a6:dd:7a:62:7a:39:11:f8:93:b7:54:60"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_56320A23B51B8CD05F9A5A6E279CA136 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-10"
      version             = "1.0"

      hash                = "f1ad63f121b6228bbf88b7b933fbdb4a32ebd7311ea732d4eab38c2d627bfbfe"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "ACCU Technical s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "56:32:0a:23:b5:1b:8c:d0:5f:9a:5a:6e:27:9c:a1:36"
      cert_thumbprint     = "66327EDA391A6F1D2DAECEB204AA533C80604756"
      cert_valid_from     = "2024-01-10"
      cert_valid_to       = "2025-01-09"

      country             = "SK"
      state               = "Trnava Region"
      locality            = "Galanta"
      email               = "???"
      rdn_serial_number   = "51 078 104"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "56:32:0a:23:b5:1b:8c:d0:5f:9a:5a:6e:27:9c:a1:36"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_565361D19E299FC4E2FAFED79766780D {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "1577ac7107e3034ca42af1f9549c15103c51b019e883c6967247d403a42cd0df"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Atgor Investment Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "56:53:61:d1:9e:29:9f:c4:e2:fa:fe:d7:97:66:78:0d"
      cert_thumbprint     = "0A217E59F0C11473E187249F337B58A03F5B95DF"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-05"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "08979969"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "56:53:61:d1:9e:29:9f:c4:e2:fa:fe:d7:97:66:78:0d"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_57E3731944D81CDFEC16096B86556F3A {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-09"
      version             = "1.0"

      hash                = "3a571ea16c1d311ca9b2c914a85726a8cd0bb4f7b0b64d8c1692df59468907ce"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "ETC XD TM DV JOINT STOCK COMPANY"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "57:e3:73:19:44:d8:1c:df:ec:16:09:6b:86:55:6f:3a"
      cert_thumbprint     = "47C8D25B1588303318BBB57ADD579875A4C987DF"
      cert_valid_from     = "2024-11-09"
      cert_valid_to       = "2025-11-08"

      country             = "VN"
      state               = "Hồ Chí Minh City"
      locality            = "Thủ Đức"
      email               = "???"
      rdn_serial_number   = "0317361975"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "57:e3:73:19:44:d8:1c:df:ec:16:09:6b:86:55:6f:3a"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_5E30321D07AF5E232743E58822959BC6 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "2ada202f6854b6721d931b369736816e809742748dae1d1f26b25a1ff0492464"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "MAGNATE VENTURES LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:30:32:1d:07:af:5e:23:27:43:e5:88:22:95:9b:c6"
      cert_thumbprint     = "8DD688DCB76262393C27E4C5D44D3134E27CEA07"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-05"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "C.72799"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:30:32:1d:07:af:5e:23:27:43:e5:88:22:95:9b:c6"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_6481CA2D1627F94864F836EFDB3B0078 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-20"
      version             = "1.0"

      hash                = "7a14e9ee7829dd5c32012637c58963eb07ba78bbc8896ed4e965211e6c7c3034"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "AM MISBAH Tech Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "64:81:ca:2d:16:27:f9:48:64:f8:36:ef:db:3b:00:78"
      cert_thumbprint     = "9DA4300B4923D643659B254B8237352C521C1B23"
      cert_valid_from     = "2024-11-20"
      cert_valid_to       = "2025-11-20"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Surrey"
      email               = "???"
      rdn_serial_number   = "1335546-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "64:81:ca:2d:16:27:f9:48:64:f8:36:ef:db:3b:00:78"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_691C410E33DDF644086FA241107B646E {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-19"
      version             = "1.0"

      hash                = "f4350182d9a117138e47ce4622b3aa1ac9ebf2583f4932a6da78ea2ed7511a7f"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Shanghai Yungpu Chemical Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "69:1c:41:0e:33:dd:f6:44:08:6f:a2:41:10:7b:64:6e"
      cert_thumbprint     = "FDD829D3B46933EF8015B70B6C3FCE6BA9675578"
      cert_valid_from     = "2024-09-19"
      cert_valid_to       = "2025-09-19"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310000570832845E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "69:1c:41:0e:33:dd:f6:44:08:6f:a2:41:10:7b:64:6e"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_6DB3F3A5B1ACAAD423CF9C97DFBD614F {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "9100672d5ec3631ff800ae7017f74b085b651a6027dcbe77bbfab67ef0e63c48"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Macpaw Labs LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6d:b3:f3:a5:b1:ac:aa:d4:23:cf:9c:97:df:bd:61:4f"
      cert_thumbprint     = "45A0D462D05753C864CD011C7C022262A23CF169"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-05"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "09221780"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6d:b3:f3:a5:b1:ac:aa:d4:23:cf:9c:97:df:bd:61:4f"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_SSL_com_748A88467D46DF98B5246AFC4F5EEC64 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-15"
      version             = "1.0"

      hash                = "649ec4858e572e0145e35a9faa712708949b7bb1bce1594154cda580d80a0ca9"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Acira Consulting Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "74:8a:88:46:7d:46:df:98:b5:24:6a:fc:4f:5e:ec:64"
      cert_thumbprint     = "A70AB688FF0A7C3A22B030FBFFA8B56DC31F650A"
      cert_valid_from     = "2024-01-15"
      cert_valid_to       = "2025-01-14"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "987024-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "74:8a:88:46:7d:46:df:98:b5:24:6a:fc:4f:5e:ec:64"
      )
}

rule MAL_Compromised_Cert_Lumma_Stealer_Sectigo_334A8DC7BE701421BB5A00FEFCB26F50 {
   meta:
      description         = "Detects Lumma Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-23"
      version             = "1.0"

      hash                = "1a0b974102462f42d51ae78898fa59bcb9e399c9c3207d26ce0a503a1262f1e6"
      malware             = "Lumma Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "袁州区创新探索网络工作室（个体工商户）"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "33:4a:8d:c7:be:70:14:21:bb:5a:00:fe:fc:b2:6f:50"
      cert_thumbprint     = "CBF33B2C384509341A4D74C25B332DF2DF82B494"
      cert_valid_from     = "2024-10-23"
      cert_valid_to       = "2025-10-23"

      country             = "CN"
      state               = "江西省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "92360902MADYXP3F14"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "33:4a:8d:c7:be:70:14:21:bb:5a:00:fe:fc:b2:6f:50"
      )
}

rule MAL_Compromised_Cert_MATA_Sectigo_009B5DE04D685E6F6D77A4874A9D2253AD {
   meta:
      description         = "Detects MATA with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-26"
      version             = "1.0"

      hash                = "07d272b607f082305ce7b1987bfa17dc967ab45c8cd89699bcdced34ea94e126"
      malware             = "MATA"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nguyen thi minh"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:9b:5d:e0:4d:68:5e:6f:6d:77:a4:87:4a:9d:22:53:ad"
      cert_thumbprint     = "640A1EC65578C0920EB6B87B0E7705D6ED19A8D7"
      cert_valid_from     = "2022-05-26"
      cert_valid_to       = "2025-05-25"

      country             = "VN"
      state               = "Ninh Bình"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:9b:5d:e0:4d:68:5e:6f:6d:77:a4:87:4a:9d:22:53:ad"
      )
}

rule MAL_Compromised_Cert_MATA_Sectigo_00D8F7700C8C150FDFFBDE8AF629D3600F {
   meta:
      description         = "Detects MATA with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-08-22"
      version             = "1.0"

      hash                = "81cd6e1c6e1f9400e31b122dfa2c7acf274192ec560a9d29190a70abd04b20e2"
      malware             = "MATA"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kamiesha Mason"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:d8:f7:70:0c:8c:15:0f:df:fb:de:8a:f6:29:d3:60:0f"
      cert_thumbprint     = "E9F886EDC250A8F1C4BD991544B329E6AFFAE9E0"
      cert_valid_from     = "2022-08-22"
      cert_valid_to       = "2023-08-22"

      country             = "US"
      state               = "Texas"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:d8:f7:70:0c:8c:15:0f:df:fb:de:8a:f6:29:d3:60:0f"
      )
}

rule MAL_Compromised_Cert_Malware_DigiCert_07CEF66A71C35BC3AED6D100C6493863 {
   meta:
      description         = "Detects Malware with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-21"
      version             = "1.0"

      hash                = "d2ddb3b216a6f13aec2537f159784b8aa971abbe24f79646e867123eb630ef14"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Fubon Technologies Ltd"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "07:ce:f6:6a:71:c3:5b:c3:ae:d6:d1:00:c6:49:38:63"
      cert_thumbprint     = "9F65B1F0BED6E58ECDCC30B81B08B350FCC966A1"
      cert_valid_from     = "2020-09-21"
      cert_valid_to       = "2021-09-29"

      country             = "GB"
      state               = "???"
      locality            = "Romford"
      email               = "???"
      rdn_serial_number   = "12334940"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "07:ce:f6:6a:71:c3:5b:c3:ae:d6:d1:00:c6:49:38:63"
      )
}

rule MAL_Compromised_Cert_Malware_Go_Daddy_008538A6C5018F50FC {
   meta:
      description         = "Detects Malware with compromised cert (Go Daddy)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-31"
      version             = "1.0"

      hash                = "aa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Trading Technologies International, Inc."
      cert_issuer_short   = "Go Daddy"
      cert_issuer         = "Go Daddy Secure Certificate Authority - G2"
      cert_serial         = "00:85:38:a6:c5:01:8f:50:fc"
      cert_thumbprint     = "871E0CB589CF1CAFD6A163A2AB4DE78D9CA82685"
      cert_valid_from     = "2020-10-31"
      cert_valid_to       = "2022-10-27"

      country             = "US"
      state               = "Illinois"
      locality            = "Chicago"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Go Daddy Secure Certificate Authority - G2" and
         sig.serial == "00:85:38:a6:c5:01:8f:50:fc"
      )
}

rule MAL_Compromised_Cert_Malware_SSL_com_537AA4F1BAE48F052C3E57C3E2E1EE61 {
   meta:
      description         = "Detects Malware with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-25"
      version             = "1.0"

      hash                = "e431d81e245dd47b376162b55b07a341789498cbc19dba9271b98cd048002e01"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ALPHA AME LIMITED LLP"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "GoGetSSL RSA Codesigning CA"
      cert_serial         = "53:7a:a4:f1:ba:e4:8f:05:2c:3e:57:c3:e2:e1:ee:61"
      cert_thumbprint     = "15355505A242C44D6C36ABAB6267CC99219A931C"
      cert_valid_from     = "2021-01-25"
      cert_valid_to       = "2022-01-25"

      country             = "GB"
      state               = "???"
      locality            = "Swanley"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GoGetSSL RSA Codesigning CA" and
         sig.serial == "53:7a:a4:f1:ba:e4:8f:05:2c:3e:57:c3:e2:e1:ee:61"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_008CECE6DF54CF6AD63596546D77BA3581 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-12"
      version             = "1.0"

      hash                = "f9ff42037f02b6a2eedf7a6fb7aedb4b5d1f0eb460069f4e923fb60b5ad0841a"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mikael LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:8c:ec:e6:df:54:cf:6a:d6:35:96:54:6d:77:ba:35:81"
      cert_thumbprint     = "21B4BC08E73690F17B4E798F4A4AC1686AE7EEB1"
      cert_valid_from     = "2021-02-12"
      cert_valid_to       = "2022-02-12"

      country             = "RU"
      state               = "???"
      locality            = "Krasnoyarsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:8c:ec:e6:df:54:cf:6a:d6:35:96:54:6d:77:ba:35:81"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_00C01E41FF29078E6626A640C5A19A8D80 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-10-01"
      version             = "1.0"

      hash                = "3f92929879f642470b73488aa719ae8c044a302969d14e70ea1ec2a1fda59bd3"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BurnAware"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c0:1e:41:ff:29:07:8e:66:26:a6:40:c5:a1:9a:8d:80"
      cert_thumbprint     = "59639F74336E979D8436731C92ECF0AE63D5D192"
      cert_valid_from     = "2019-10-01"
      cert_valid_to       = "2022-09-30"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c0:1e:41:ff:29:07:8e:66:26:a6:40:c5:a1:9a:8d:80"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_00C79F817F082986BEF3209F6723C8DA97 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-22"
      version             = "1.0"

      hash                = "dd49651e325b04ea14733bcd676c0a1cb58ab36bf79162868ade02b396ec3ab0"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Al-Faris group d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c7:9f:81:7f:08:29:86:be:f3:20:9f:67:23:c8:da:97"
      cert_thumbprint     = "E2BF86DC46FCA1C35F98FF84D8976BE8AA0668BC"
      cert_valid_from     = "2021-03-22"
      cert_valid_to       = "2022-03-22"

      country             = "SI"
      state               = "???"
      locality            = "Ljubljana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c7:9f:81:7f:08:29:86:be:f3:20:9f:67:23:c8:da:97"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_00EF9D0CF071D463CD63D13083046A7B8D {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-23"
      version             = "1.0"

      hash                = "c780621863404ca2f2ff204c25a652a6e0a1be1a47393701ee7dfc336661dcec"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Rubin LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ef:9d:0c:f0:71:d4:63:cd:63:d1:30:83:04:6a:7b:8d"
      cert_thumbprint     = "346849DFDEB9BB1A97D98C62D70C578DACBCF30C"
      cert_valid_from     = "2020-09-23"
      cert_valid_to       = "2021-09-23"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ef:9d:0c:f0:71:d4:63:cd:63:d1:30:83:04:6a:7b:8d"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_047801D5B55C800B48411FD8C320CA5B {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-26"
      version             = "1.0"

      hash                = "b6fbcfc55f0124980a29986006323c37504b13e09e45d5c949c448f4f339ec56"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LICHFIELD STUDIO GLASS LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "04:78:01:d5:b5:5c:80:0b:48:41:1f:d8:c3:20:ca:5b"
      cert_thumbprint     = "00C49B8D6FD7D2AA26FAAD8E5A31F93A15D66D09"
      cert_valid_from     = "2021-02-26"
      cert_valid_to       = "2022-02-26"

      country             = "GB"
      state               = "???"
      locality            = "Widnes"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "04:78:01:d5:b5:5c:80:0b:48:41:1f:d8:c3:20:ca:5b"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_289051A83F350A2C600187C99B6C0A73 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-26"
      version             = "1.0"

      hash                = "df1be1b4ebc10d7a9228aa7778050ce6e51d827553a4d78f1008458ea32905f6"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HALL HAULAGE LTD LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "28:90:51:a8:3f:35:0a:2c:60:01:87:c9:9b:6c:0a:73"
      cert_thumbprint     = "4E075ADEA8C1BCB9D10904203AB81965F4912FF0"
      cert_valid_from     = "2021-03-26"
      cert_valid_to       = "2022-03-26"

      country             = "GB"
      state               = "???"
      locality            = "Shepshed"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "28:90:51:a8:3f:35:0a:2c:60:01:87:c9:9b:6c:0a:73"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_3628B93BCD902B6B3E1FFDF2E13DFCF5 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-27"
      version             = "1.0"

      hash                = "9a58dd63b51866541d91a5bae6260c27aeec7a4135cd67a6fb686f549d3646a6"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AMCERT,LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "36:28:b9:3b:cd:90:2b:6b:3e:1f:fd:f2:e1:3d:fc:f5"
      cert_thumbprint     = "C64C2F211DFF5137FC81D29B7FC8C655C61D1121"
      cert_valid_from     = "2023-01-27"
      cert_valid_to       = "2024-01-25"

      country             = "AM"
      state               = "Erevan"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "36:28:b9:3b:cd:90:2b:6b:3e:1f:fd:f2:e1:3d:fc:f5"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_61B11EF9726AB2E78132E01BD791B336 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-31"
      version             = "1.0"

      hash                = "d62baef7ed4c7b348f6a7a3c372b97f21ef89150539cc654d92daa9596dd41c1"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO Skalari"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "61:b1:1e:f9:72:6a:b2:e7:81:32:e0:1b:d7:91:b3:36"
      cert_thumbprint     = "9F7FCFD7E70DD7CD723AC20E5E7CB7AAD1BA976B"
      cert_valid_from     = "2020-12-31"
      cert_valid_to       = "2021-12-31"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "61:b1:1e:f9:72:6a:b2:e7:81:32:e0:1b:d7:91:b3:36"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_670C3494206B9F0C18714FDCFFAAA42F {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-28"
      version             = "1.0"

      hash                = "0565f4db2fcd614df0fffbc577a4a7f4fa9827997b533b12f77c0d252955c785"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ADRIATIK PORT SERVIS, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "67:0c:34:94:20:6b:9f:0c:18:71:4f:dc:ff:aa:a4:2f"
      cert_thumbprint     = "59612473A9E23DC770F3A33B1EF83C02E3CFD4B6"
      cert_valid_from     = "2021-05-28"
      cert_valid_to       = "2022-05-28"

      country             = "SI"
      state               = "???"
      locality            = "Koper"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "67:0c:34:94:20:6b:9f:0c:18:71:4f:dc:ff:aa:a4:2f"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_69AD1E8B5941C93D5017B7C3FDB8E7B6 {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-08"
      version             = "1.0"

      hash                = "1030bda293aeae714404311987aa4f2bf39577f1b589755ea2b4d681570c26b5"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Afia Wave Enterprises Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "69:ad:1e:8b:59:41:c9:3d:50:17:b7:c3:fd:b8:e7:b6"
      cert_thumbprint     = "9B6F3B3CD33AE938FBC5C95B8C9239BAC9F9F7BF"
      cert_valid_from     = "2021-07-08"
      cert_valid_to       = "2022-07-08"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "69:ad:1e:8b:59:41:c9:3d:50:17:b7:c3:fd:b8:e7:b6"
      )
}

rule MAL_Compromised_Cert_Malware_Sectigo_7D36CBB64BC9ADD17BA71737D3ECCECA {
   meta:
      description         = "Detects Malware with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-18"
      version             = "1.0"

      hash                = "ea0623979d7a7a03dfda901509f8b17cd7fd9347d463e08737ea5f412dcc0464"
      malware             = "Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LTD SERVICES LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7d:36:cb:b6:4b:c9:ad:d1:7b:a7:17:37:d3:ec:ce:ca"
      cert_thumbprint     = "A7287460DCF02E38484937B121CE8548191D4E64"
      cert_valid_from     = "2021-03-18"
      cert_valid_to       = "2022-03-18"

      country             = "GB"
      state               = "Essex"
      locality            = "Clacton-On-Sea"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7d:36:cb:b6:4b:c9:ad:d1:7b:a7:17:37:d3:ec:ce:ca"
      )
}

rule MAL_Compromised_Cert_Matanbuchus_CastleRAT_NetSupportRAT_GlobalSign_79DDB9193004396236ECA038 {
   meta:
      description         = "Detects Matanbuchus,CastleRAT,NetSupportRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-11"
      version             = "1.0"

      hash                = "ed748bfb18ebd9e83b0b694894f34fdd47a8e615dadd54cf922f350085d1a7e0"
      malware             = "Matanbuchus,CastleRAT,NetSupportRAT"
      malware_type        = "Initial access tool"
      malware_notes       = "In this instance of the malware, it was used to drop both CastleRAT malware and NetSupport."

      signer              = "NAVRNGE RECOVERY SERVICES PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "79:dd:b9:19:30:04:39:62:36:ec:a0:38"
      cert_thumbprint     = "FF8014C820D337E3844AFF84CB61C4748888AB28"
      cert_valid_from     = "2025-07-11"
      cert_valid_to       = "2026-07-12"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "navrngerecoveryservices@gmail.com"
      rdn_serial_number   = "UDYAM-BR-30-0066580"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "79:dd:b9:19:30:04:39:62:36:ec:a0:38"
      )
}

rule MAL_Compromised_Cert_Matanbuchus_DigiCert_061A27A3A3771BB440FC16CADF2675C4 {
   meta:
      description         = "Detects Matanbuchus with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-18"
      version             = "1.0"

      hash                = "face46e6593206867da39e47001f134a00385898a36b8142a21ad54954682666"
      malware             = "Matanbuchus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Westeast Tech Consulting, Corp."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:1a:27:a3:a3:77:1b:b4:40:fc:16:ca:df:26:75:c4"
      cert_thumbprint     = "2A40875C895B648C9583925C7DAD694A2A11D7DD"
      cert_valid_from     = "2022-05-18"
      cert_valid_to       = "2023-05-11"

      country             = "US"
      state               = "California"
      locality            = "NORTHRIDGE"
      email               = "???"
      rdn_serial_number   = "4088386"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:1a:27:a3:a3:77:1b:b4:40:fc:16:ca:df:26:75:c4"
      )
}

rule MAL_Compromised_Cert_Matanbuchus_Sectigo_00EDA0F47B3B38E781CDF6EF6BE5D3F6EE {
   meta:
      description         = "Detects Matanbuchus with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-26"
      version             = "1.0"

      hash                = "67a9e8599ab71865a97e75dae9be438c24d015a93e6a12fb5b450ec558528290"
      malware             = "Matanbuchus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ADVANCED ACCESS SERVICES LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:ed:a0:f4:7b:3b:38:e7:81:cd:f6:ef:6b:e5:d3:f6:ee"
      cert_thumbprint     = "16DDF43DC302F8FFBD637DD89068FFE62713BF80"
      cert_valid_from     = "2022-04-26"
      cert_valid_to       = "2023-04-26"

      country             = "GB"
      state               = "Ayrshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:ed:a0:f4:7b:3b:38:e7:81:cd:f6:ef:6b:e5:d3:f6:ee"
      )
}

rule MAL_Compromised_Cert_Matanbuchus_Sectigo_205483936F360924E8D2A4EB6D3A9F31 {
   meta:
      description         = "Detects Matanbuchus with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-02"
      version             = "1.0"

      hash                = "e58b9bbb7bcdf3e901453b7b9c9e514fed1e53565e3280353dccc77cde26a98e"
      malware             = "Matanbuchus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SATURN CONSULTANCY LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "20:54:83:93:6f:36:09:24:e8:d2:a4:eb:6d:3a:9f:31"
      cert_thumbprint     = "430DBEFF2F6DF708B03354D5D07E78400CFED8E9"
      cert_valid_from     = "2021-12-02"
      cert_valid_to       = "2022-12-02"

      country             = "GB"
      state               = "Essex"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "20:54:83:93:6f:36:09:24:e8:d2:a4:eb:6d:3a:9f:31"
      )
}

rule MAL_Compromised_Cert_Matanbuchus_TrustOcean_1EF6392B2993A6F67578299659467EA8 {
   meta:
      description         = "Detects Matanbuchus with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-16"
      version             = "1.0"

      hash                = "490bcee7c0b9607d834fd8b3e5d01613d062fcf48be043e6f5f60c5077b55e3c"
      malware             = "Matanbuchus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ALUSEN d. o. o."
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "1e:f6:39:2b:29:93:a6:f6:75:78:29:96:59:46:7e:a8"
      cert_thumbprint     = "E87D3E289CCB9F8F9CAA53F2AEFBA102FBF4B231"
      cert_valid_from     = "2021-04-16"
      cert_valid_to       = "2022-04-16"

      country             = "SI"
      state               = "Ormož"
      locality            = "Podgorci"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "1e:f6:39:2b:29:93:a6:f6:75:78:29:96:59:46:7e:a8"
      )
}

rule MAL_Compromised_Cert_MediaArena_GlobalSign_4469809AA0E206829C99CD18 {
   meta:
      description         = "Detects MediaArena with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-21"
      version             = "1.0"

      hash                = "0bda8ea6fb5f46f110c18e72bcef514d5cdf5270f310e7286d3d03a263ed8772"
      malware             = "MediaArena"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LIGHTNER TOK LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "44:69:80:9a:a0:e2:06:82:9c:99:cd:18"
      cert_thumbprint     = "B0F054A3A02999D47B5FADE5C33FA9C9FE1B951F"
      cert_valid_from     = "2024-02-21"
      cert_valid_to       = "2025-02-21"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Tel Aviv-Jaffa"
      email               = "contactus@lightnertok.com"
      rdn_serial_number   = "516201944"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "44:69:80:9a:a0:e2:06:82:9c:99:cd:18"
      )
}

rule MAL_Compromised_Cert_Meowsterio_Traffer_Team_GlobalSign_41506BE5E85C247D61CCCE7E {
   meta:
      description         = "Detects Meowsterio Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-05"
      version             = "1.0"

      hash                = "65c4b56197458a7cce0daf9a4c7991b6f202367294c87d4c4a024e2dc64659ce"
      malware             = "Meowsterio Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HIGHNOR INDIA PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:50:6b:e5:e8:5c:24:7d:61:cc:ce:7e"
      cert_thumbprint     = "8351DCE66144F50452466FA9104B18B23C577E72"
      cert_valid_from     = "2025-05-05"
      cert_valid_to       = "2026-05-06"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:50:6b:e5:e8:5c:24:7d:61:cc:ce:7e"
      )
}

rule MAL_Compromised_Cert_Meowsterio_Traffer_Team_SSL_com_01A146B12374DE73D9B4176F837099C1 {
   meta:
      description         = "Detects Meowsterio Traffer Team with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-28"
      version             = "1.0"

      hash                = "96fd0900a2bf751559dcc6327c15028131c674bf6e4fb7656d762f66897d1211"
      malware             = "Meowsterio Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Jianhe Network Technology (Shanghai) Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "01:a1:46:b1:23:74:de:73:d9:b4:17:6f:83:70:99:c1"
      cert_thumbprint     = "7CF0AF8137B3B264DB67CE782084BCAF370340F9"
      cert_valid_from     = "2024-09-28"
      cert_valid_to       = "2025-09-27"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310115MA1K42143K"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "01:a1:46:b1:23:74:de:73:d9:b4:17:6f:83:70:99:c1"
      )
}

rule MAL_Compromised_Cert_MeshAgentTrojan_GlobalSign_480ED01C27E3CD365556EECE {
   meta:
      description         = "Detects MeshAgentTrojan with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-31"
      version             = "1.0"

      hash                = "cdb4e4b35b002bd64e701f3c1e8b147b96cb0907bcc88ead92521777781ca2d1"
      malware             = "MeshAgentTrojan"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Leap Grace Electronics Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "48:0e:d0:1c:27:e3:cd:36:55:56:ee:ce"
      cert_thumbprint     = "EC1453D0BCEA9F9B416D32308EA9534865BE71BD"
      cert_valid_from     = "2024-07-31"
      cert_valid_to       = "2025-08-01"

      country             = "CN"
      state               = "Shandong"
      locality            = "Jinan"
      email               = "???"
      rdn_serial_number   = "91370102MA3C9D0U34"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "48:0e:d0:1c:27:e3:cd:36:55:56:ee:ce"
      )
}

rule MAL_Compromised_Cert_MeshAgent_DigiCert_028349DAF3B78B800A5845AA01F19806 {
   meta:
      description         = "Detects MeshAgent with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-21"
      version             = "1.0"

      hash                = "35896102d20903ff9bab19295e1144f7cff80872749fd875d946b553fbd9302e"
      malware             = "MeshAgent"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TechMonstar LTD"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "02:83:49:da:f3:b7:8b:80:0a:58:45:aa:01:f1:98:06"
      cert_thumbprint     = "3FC97234C39375061E3771C9B0A952CE6E4E478E"
      cert_valid_from     = "2025-11-21"
      cert_valid_to       = "2028-11-20"

      country             = "BD"
      state               = "???"
      locality            = "Dhaka"
      email               = "???"
      rdn_serial_number   = "C-192953"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "02:83:49:da:f3:b7:8b:80:0a:58:45:aa:01:f1:98:06"
      )
}

rule MAL_Compromised_Cert_MeshAgent_GlobalSign_5D35276009EC70A2818D3B24 {
   meta:
      description         = "Detects MeshAgent with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-28"
      version             = "1.0"

      hash                = "bac580330533d88615cff21f12aed1b8e045034f5f7f98875f2edf4b063fe554"
      malware             = "MeshAgent"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC MISTAKE"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5d:35:27:60:09:ec:70:a2:81:8d:3b:24"
      cert_thumbprint     = "104C5A5155DE9062F51F40EE1ABCABC6E369C20B"
      cert_valid_from     = "2025-03-28"
      cert_valid_to       = "2026-03-29"

      country             = "RU"
      state               = "Republic of Kalmykia"
      locality            = "Elista"
      email               = "???"
      rdn_serial_number   = "1220800003160"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5d:35:27:60:09:ec:70:a2:81:8d:3b:24"
      )
}

rule MAL_Compromised_Cert_Metasploit_SSL_com_0B26B62AB59556B229BD9905D33D43E8 {
   meta:
      description         = "Detects Metasploit with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "f8b313d8d8ee0a622b1eea8cb148323b6194228014f11402967f065351e473ab"
      malware             = "Metasploit"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Roger Alexander Gonzalez Castillo"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "0b:26:b6:2a:b5:95:56:b2:29:bd:99:05:d3:3d:43:e8"
      cert_thumbprint     = "C5EF53AF49EA288D56C5A2EAB81CA2D480AA810E"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-10-21"

      country             = "EC"
      state               = "Sucumbíos Province"
      locality            = "Nueva Loja"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "0b:26:b6:2a:b5:95:56:b2:29:bd:99:05:d3:3d:43:e8"
      )
}

rule MAL_Compromised_Cert_Meterpreter_DigiCert_03B50181EBBAD1AB42C7D901FB1A932A {
   meta:
      description         = "Detects Meterpreter with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-17"
      version             = "1.0"

      hash                = "5dda81c4f51a5189adc50e8943d6e6849f0538898552a41caa7cf6ad9585cd18"
      malware             = "Meterpreter"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "優勢領航科技有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "03:b5:01:81:eb:ba:d1:ab:42:c7:d9:01:fb:1a:93:2a"
      cert_thumbprint     = "C40DE237745620CA2583ADF850D1540262EE439B"
      cert_valid_from     = "2023-05-17"
      cert_valid_to       = "2026-05-17"

      country             = "TW"
      state               = "台北市"
      locality            = "大安区"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "03:b5:01:81:eb:ba:d1:ab:42:c7:d9:01:fb:1a:93:2a"
      )
}

rule MAL_Compromised_Cert_ModiLoader_Sectigo_0095E5793F2ABE0B4EC9BE54FD24F76AE5 {
   meta:
      description         = "Detects ModiLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-16"
      version             = "1.0"

      hash                = "56007af3c6b00548660560601efe9e3ea1fbec553562dd7436fe85673ed7a0c8"
      malware             = "ModiLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kommservice LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:95:e5:79:3f:2a:be:0b:4e:c9:be:54:fd:24:f7:6a:e5"
      cert_thumbprint     = "6ACDFEE2A1AB425B7927D0FFE6AFC38C794F1240"
      cert_valid_from     = "2020-09-16"
      cert_valid_to       = "2021-09-16"

      country             = "RU"
      state               = "???"
      locality            = "Moskva"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:95:e5:79:3f:2a:be:0b:4e:c9:be:54:fd:24:f7:6a:e5"
      )
}

rule MAL_Compromised_Cert_Mofongoloader_GlobalSign_06FA9DF25D522FB355CC41E8 {
   meta:
      description         = "Detects Mofongoloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-07"
      version             = "1.0"

      hash                = "c25b566d99d55fe5cb1a19290748dac70845663fe0f8bf78f741fe4440055551"
      malware             = "Mofongoloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xuaony Plantain E-Commerce Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "06:fa:9d:f2:5d:52:2f:b3:55:cc:41:e8"
      cert_thumbprint     = "DFCDB964C7C596DBA245A066F08989C9AC1AD4B0"
      cert_valid_from     = "2024-04-07"
      cert_valid_to       = "2025-03-30"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420600MACLU7R889"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "06:fa:9d:f2:5d:52:2f:b3:55:cc:41:e8"
      )
}

rule MAL_Compromised_Cert_Mofongoloader_GlobalSign_4D6069B50525633949C12B22 {
   meta:
      description         = "Detects Mofongoloader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-01"
      version             = "1.0"

      hash                = "6b0ce8e6ccab57ece76302b1c9ab570336f63bae4d11137ccf0b662fa323a457"
      malware             = "Mofongoloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO BASIS"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4d:60:69:b5:05:25:63:39:49:c1:2b:22"
      cert_thumbprint     = "F81BB0C6DCC4ED1FC06A7004D0A7A636B42013A5"
      cert_valid_from     = "2023-06-01"
      cert_valid_to       = "2024-04-19"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1227700563133"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4d:60:69:b5:05:25:63:39:49:c1:2b:22"
      )
}

rule MAL_Compromised_Cert_Mofongoloader_Sectigo_6AB35C5785260695E9C012514DB0C299 {
   meta:
      description         = "Detects Mofongoloader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-15"
      version             = "1.0"

      hash                = "b68adceb4eea31a7f1ad264b3fbff20526bb96049ceb41f43310c46bc543d4a5"
      malware             = "Mofongoloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GreenEngine OU"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "6a:b3:5c:57:85:26:06:95:e9:c0:12:51:4d:b0:c2:99"
      cert_thumbprint     = "69B1966E16949B9C76A66C82EB077109F764EBA2"
      cert_valid_from     = "2023-05-15"
      cert_valid_to       = "2024-05-14"

      country             = "EE"
      state               = "Harjumaa"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "6a:b3:5c:57:85:26:06:95:e9:c0:12:51:4d:b0:c2:99"
      )
}

rule MAL_Compromised_Cert_MonsterV2_Aurotun_Microsoft_3300037399890C4DCE9776933C000000037399 {
   meta:
      description         = "Detects MonsterV2 Aurotun with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-28"
      version             = "1.0"

      hash                = "b660af020b832d2c3d8b1606c76ded2229f22085e667ff3c8d23146ee2993897"
      malware             = "MonsterV2 Aurotun"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MEANINGFUL CONSULTING, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:73:99:89:0c:4d:ce:97:76:93:3c:00:00:00:03:73:99"
      cert_thumbprint     = "02827920DA8306FD2D3220AB2E7D33C587AFC2E9"
      cert_valid_from     = "2025-06-28"
      cert_valid_to       = "2025-07-01"

      country             = "US"
      state               = "Arizona"
      locality            = "Mesa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:73:99:89:0c:4d:ce:97:76:93:3c:00:00:00:03:73:99"
      )
}

rule MAL_Compromised_Cert_NET_Adloader_SSL_com_7650EF62C23E31E8237ECB5DB64A9BAC {
   meta:
      description         = "Detects .NET Adloader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-11"
      version             = "1.0"

      hash                = "7d86a15da892322e14c2d892afb4fd56772d098bd4d91578c6e6bb5366d4f9f4"
      malware             = ".NET Adloader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Drake Media Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "76:50:ef:62:c2:3e:31:e8:23:7e:cb:5d:b6:4a:9b:ac"
      cert_thumbprint     = "8AF2C1B537D7ABF208B1F6957EEACA8A4158B05C"
      cert_valid_from     = "2023-03-11"
      cert_valid_to       = "2025-03-09"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704428"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "76:50:ef:62:c2:3e:31:e8:23:7e:cb:5d:b6:4a:9b:ac"
      )
}

rule MAL_Compromised_Cert_NW0rm_Comodo_00B1BBEF3ABA79AB2EAE5B8015F26B34F8 {
   meta:
      description         = "Detects NW0rm with compromised cert (Comodo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2016-05-13"
      version             = "1.0"

      hash                = "d2802c979bc2fae533fb089fcf5c6cc0622245e874bee0c3faa23056443310a3"
      malware             = "NW0rm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DIDZHITAL ART, OOO"
      cert_issuer_short   = "Comodo"
      cert_issuer         = "COMODO RSA Code Signing CA"
      cert_serial         = "00:b1:bb:ef:3a:ba:79:ab:2e:ae:5b:80:15:f2:6b:34:f8"
      cert_thumbprint     = "A286AFFC5F6E92BDC93374646676EBC49E21BCAE"
      cert_valid_from     = "2016-05-13"
      cert_valid_to       = "2017-05-13"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "COMODO RSA Code Signing CA" and
         sig.serial == "00:b1:bb:ef:3a:ba:79:ab:2e:ae:5b:80:15:f2:6b:34:f8"
      )
}

rule MAL_Compromised_Cert_Nefilim_Sectigo_39F56251DF2088223CC03494084E6081 {
   meta:
      description         = "Detects Nefilim with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-03-06"
      version             = "1.0"

      hash                = "08c7dfde13ade4b13350ae290616d7c2f4a87cbeac9a3886e90a175ee40fb641"
      malware             = "Nefilim"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Inter Med Pty. Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "39:f5:62:51:df:20:88:22:3c:c0:34:94:08:4e:60:81"
      cert_thumbprint     = "29239659231A88CA518839BF57048FF79A272554"
      cert_valid_from     = "2020-03-06"
      cert_valid_to       = "2021-03-06"

      country             = "AU"
      state               = "Queensland"
      locality            = "North Lakes"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "39:f5:62:51:df:20:88:22:3c:c0:34:94:08:4e:60:81"
      )
}

rule MAL_Compromised_Cert_Nemty_Sectigo_0084A4A0D0657E217B176B455E2465AEE0 {
   meta:
      description         = "Detects Nemty with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-23"
      version             = "1.0"

      hash                = "511fee839098dfa28dd859ffd3ece5148be13bfb83baa807ed7cac2200103390"
      malware             = "Nemty"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AATB ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:84:a4:a0:d0:65:7e:21:7b:17:6b:45:5e:24:65:ae:e0"
      cert_thumbprint     = "AD2496D9F9A1E86FB8D7E4C2762C6035B883F3A4"
      cert_valid_from     = "2021-03-23"
      cert_valid_to       = "2022-03-23"

      country             = "DK"
      state               = "???"
      locality            = "Aalborg SØ"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:84:a4:a0:d0:65:7e:21:7b:17:6b:45:5e:24:65:ae:e0"
      )
}

rule MAL_Compromised_Cert_Nemty_Sectigo_00FC7065ABF8303FB472B8AF85918F5C24 {
   meta:
      description         = "Detects Nemty with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-03"
      version             = "1.0"

      hash                = "006c9ba4ca0218e7bd2c7c21653497d3215bbeefbc1f5c2781549b306bab8e5e"
      malware             = "Nemty"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DIG IN VISION SP Z O O"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:fc:70:65:ab:f8:30:3f:b4:72:b8:af:85:91:8f:5c:24"
      cert_thumbprint     = "B61A6607154D27D64DE35E7529CB853DCB47F51F"
      cert_valid_from     = "2020-11-03"
      cert_valid_to       = "2021-11-03"

      country             = "PL"
      state               = "???"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:fc:70:65:ab:f8:30:3f:b4:72:b8:af:85:91:8f:5c:24"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_DigiCert_03A656478B714A24DD5DAF98F68E878B {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-12"
      version             = "1.0"

      hash                = "af143b79a29e51366964416da4b3a30b26def93d52b67a6ad6e9528935bf4a62"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "FILIPA S.R.L."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "03:a6:56:47:8b:71:4a:24:dd:5d:af:98:f6:8e:87:8b"
      cert_thumbprint     = "938EDBA2A0B446E6FE094E15075EE612DCE53A7E"
      cert_valid_from     = "2025-09-12"
      cert_valid_to       = "2026-09-11"

      country             = "AR"
      state               = "???"
      locality            = "Buenos Aires"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "03:a6:56:47:8b:71:4a:24:dd:5d:af:98:f6:8e:87:8b"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_GlobalSign_536A9BBEAB40AAF25024CD8B {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "f4615a9c1a9f922536e1ffdd0264ce6c94ef84534ff27b35bd93f1c818eaa743"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "LLC GrandStroy"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "53:6a:9b:be:ab:40:aa:f2:50:24:cd:8b"
      cert_thumbprint     = "29EB40C0EFE05D01210D6F3197F854E214CB5A3B"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2026-06-04"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1091103000922"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "53:6a:9b:be:ab:40:aa:f2:50:24:cd:8b"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_GlobalSign_6D5BF63F03EA0DD2B37228FA {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-17"
      version             = "1.0"

      hash                = "9fb97ddbe7875a6162a0f6803c1e1679d6e8797c473b676f9d51ca77691abfeb"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "SIAFU LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6d:5b:f6:3f:03:ea:0d:d2:b3:72:28:fa"
      cert_thumbprint     = "B0D91034DAB6E6C6FA1ECDA42975D4AB03646CA7"
      cert_valid_from     = "2025-02-17"
      cert_valid_to       = "2026-02-18"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "C.10158"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6d:5b:f6:3f:03:ea:0d:d2:b3:72:28:fa"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_GlobalSign_768D8B5A95252BFCF9BE0497 {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-14"
      version             = "1.0"

      hash                = "ae45484a1881d55afae4952224c4a8352e1163a9fb57d095431711e5dccdcd18"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Blockfi Ruinor Security Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "76:8d:8b:5a:95:25:2b:fc:f9:be:04:97"
      cert_thumbprint     = "4ACC7502C2F5106D47911AF8AB41B4C83D758DDE"
      cert_valid_from     = "2025-04-14"
      cert_valid_to       = "2026-04-15"

      country             = "CN"
      state               = "Shandong"
      locality            = "Jinan"
      email               = "???"
      rdn_serial_number   = "91370102307284861T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "76:8d:8b:5a:95:25:2b:fc:f9:be:04:97"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_Microsoft_3300058BD460154028B0E8504E000000058BD4 {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-02"
      version             = "1.0"

      hash                = "c7cefe78fa66d76523beb05969fc5df2eff2db1512249bbcf9fd8fb2220723de"
      malware             = "NetSupportRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RITZ AND JOHNSON BUILDING PARTNERSHIP, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:8b:d4:60:15:40:28:b0:e8:50:4e:00:00:00:05:8b:d4"
      cert_thumbprint     = "D5B56201BE8C2A43291A1F8381BDBA39F4345F2B"
      cert_valid_from     = "2025-12-02"
      cert_valid_to       = "2025-12-05"

      country             = "US"
      state               = "Florida"
      locality            = "OCALA"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:8b:d4:60:15:40:28:b0:e8:50:4e:00:00:00:05:8b:d4"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_Microsoft_33000650DDD1E73845146E2D260000000650DD {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-30"
      version             = "1.0"

      hash                = "6684bd671de9dce1e8cfc4d41bf5a4ef3dabc8925eac4a47712b128224518b9e"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "File is dropped from a fake logistics website: https://x.com/malwrhunterteam/status/1995974194006552855?s=20"

      signer              = "RITZ AND JOHNSON BUILDING PARTNERSHIP, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:50:dd:d1:e7:38:45:14:6e:2d:26:00:00:00:06:50:dd"
      cert_thumbprint     = "761C3D17E789A71CA32A8C0C85B8FF769BA05BCF"
      cert_valid_from     = "2025-11-30"
      cert_valid_to       = "2025-12-03"

      country             = "US"
      state               = "Florida"
      locality            = "OCALA"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:50:dd:d1:e7:38:45:14:6e:2d:26:00:00:00:06:50:dd"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_SSL_com_1D0DB421029C76D20849B6F6D0257D96 {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-30"
      version             = "1.0"

      hash                = "76053660a8f03b6cf58158e7db53052dc5ecc0f8d0cdd3c5237cd976cb6fd2f7"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Ek-Market Ab Quercus Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1d:0d:b4:21:02:9c:76:d2:08:49:b6:f6:d0:25:7d:96"
      cert_thumbprint     = "221B8FCC0917B0EE755616142AF13B826E4AD9B9"
      cert_valid_from     = "2025-09-30"
      cert_valid_to       = "2026-09-30"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Ekenäs"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1d:0d:b4:21:02:9c:76:d2:08:49:b6:f6:d0:25:7d:96"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_SSL_com_24991F9305780821FB0326248BCBB0EE {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-19"
      version             = "1.0"

      hash                = "c14cf48a6853918d2928b42ac35c6a3952bd33f5e7ae7be01a294dc2292c1925"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Syntech Software Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "24:99:1f:93:05:78:08:21:fb:03:26:24:8b:cb:b0:ee"
      cert_thumbprint     = "d088c86c5b8955bd5634b17c73621e72b4d0534e7538ba850e2ec21ba2944712"
      cert_valid_from     = "2024-12-19"
      cert_valid_to       = "2025-12-19"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "24:99:1f:93:05:78:08:21:fb:03:26:24:8b:cb:b0:ee"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_SSL_com_31F2B8DF98119016D60A1DFD656FE40E {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-29"
      version             = "1.0"

      hash                = "b9576867738918a2d065dfa9b78ec9657a2a8a7464d786d836bfdc843d43a812"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "SMI Consulting GmbH"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "31:f2:b8:df:98:11:90:16:d6:0a:1d:fd:65:6f:e4:0e"
      cert_thumbprint     = "FF5156C6FE68B5C49035DE4F0DDAD5322467166A"
      cert_valid_from     = "2025-09-29"
      cert_valid_to       = "2026-08-19"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "31:f2:b8:df:98:11:90:16:d6:0a:1d:fd:65:6f:e4:0e"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_SSL_com_3333576DC3404BF2E440D60B60582C33 {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-23"
      version             = "1.0"

      hash                = "f5ba7bdc07e9c6cc9f22ca5680e51363acd4a8e74587ee3d10bc189ea8ff123a"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Thea Software"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "33:33:57:6d:c3:40:4b:f2:e4:40:d6:0b:60:58:2c:33"
      cert_thumbprint     = ""
      cert_valid_from     = "2024-12-23"
      cert_valid_to       = "2025-12-23"

      country             = "FR"
      state               = "Nouvelle-Aquitaine"
      locality            = "Le Bouscat"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "33:33:57:6d:c3:40:4b:f2:e4:40:d6:0b:60:58:2c:33"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_SSL_com_53A4AF566690F74B15A2232F7B01CD61 {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "acfa8e673b641ed1be17dff41f52589605abbd3afe305a1580b3c8977e90a7fa"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Advik Tech Corporation"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:a4:af:56:66:90:f7:4b:15:a2:23:2f:7b:01:cd:61"
      cert_thumbprint     = "9A1CBD2C7831CC8CD56298B01189AF437E0B1673"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-12-24"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Surrey"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:a4:af:56:66:90:f7:4b:15:a2:23:2f:7b:01:cd:61"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_Sectigo_139E4375C99FC46A535D52A8550F1A19 {
   meta:
      description         = "Detects NetSupportRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-05"
      version             = "1.0"

      hash                = "f11c4a1d7d446218b70a52669840b8362dad781bd2939185c8b2b20357f2a8df"
      malware             = "NetSupportRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "A2Z Services AB"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "13:9e:43:75:c9:9f:c4:6a:53:5d:52:a8:55:0f:1a:19"
      cert_thumbprint     = "11F3885DC8A43D414CCBE3B5679D9A8B00980C8B"
      cert_valid_from     = "2025-05-05"
      cert_valid_to       = "2026-05-05"

      country             = "SE"
      state               = "Stockholms län"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "13:9e:43:75:c9:9f:c4:6a:53:5d:52:a8:55:0f:1a:19"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_version2_SSL_com_48CAB18CD944F857F70A7C3506270364 {
   meta:
      description         = "Detects NetSupportRAT_version2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-24"
      version             = "1.0"

      hash                = "6e3084fc8efa08cfa3d95b2c78042092d13a31075714ff1b4af979a01e44dfbc"
      malware             = "NetSupportRAT_version2"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Gesellschaft für Softwareentwicklung und Analytik GmbH"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "48:ca:b1:8c:d9:44:f8:57:f7:0a:7c:35:06:27:03:64"
      cert_thumbprint     = "F19B05B2C406A06B1A801B170955F1693C84C9C6"
      cert_valid_from     = "2020-07-24"
      cert_valid_to       = "2023-07-24"

      country             = "DE"
      state               = "Mecklenburg Vorpommern"
      locality            = "Rostock"
      email               = "???"
      rdn_serial_number   = "HRB 12514"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "48:ca:b1:8c:d9:44:f8:57:f7:0a:7c:35:06:27:03:64"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_version2_Sectigo_00F99AB9FCDF58E1771827FC26FDB62B62 {
   meta:
      description         = "Detects NetSupportRAT_version2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-15"
      version             = "1.0"

      hash                = "fa3cb4f183ac3c1a7f6bc534d60f00468fa64ac0e91f1ffd83a89a4be2e70af7"
      malware             = "NetSupportRAT_version2"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Techsoft"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:f9:9a:b9:fc:df:58:e1:77:18:27:fc:26:fd:b6:2b:62"
      cert_thumbprint     = "C85DF3623274F9A30144BD72350B56C8DEE9AE76"
      cert_valid_from     = "2022-03-15"
      cert_valid_to       = "2025-03-15"

      country             = "IN"
      state               = "West Bengal"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:f9:9a:b9:fc:df:58:e1:77:18:27:fc:26:fd:b6:2b:62"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_version2_Sectigo_111F05B2988349803917252D01EED309 {
   meta:
      description         = "Detects NetSupportRAT_version2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-24"
      version             = "1.0"

      hash                = "ef93c3569e5a26c1caa17c8371a7897fff65a7f8f0466cefeeb8220876f66097"
      malware             = "NetSupportRAT_version2"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Ivosight Software Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "11:1f:05:b2:98:83:49:80:39:17:25:2d:01:ee:d3:09"
      cert_thumbprint     = "16D3312563F689AD1716ABC8DD0E711F510F4CA2"
      cert_valid_from     = "2020-12-24"
      cert_valid_to       = "2023-10-03"

      country             = "US"
      state               = "Washington"
      locality            = "University Place"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "11:1f:05:b2:98:83:49:80:39:17:25:2d:01:ee:d3:09"
      )
}

rule MAL_Compromised_Cert_NetSupportRAT_version2_Sectigo_45691637802B584104DB69BFE5D19CF8 {
   meta:
      description         = "Detects NetSupportRAT_version2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-11"
      version             = "1.0"

      hash                = "027ecb49da01452f5a573f3c2a67ec2d64a851f487da05aca4de6c46955552d3"
      malware             = "NetSupportRAT_version2"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "TWO PILOTS DOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "45:69:16:37:80:2b:58:41:04:db:69:bf:e5:d1:9c:f8"
      cert_thumbprint     = "273786A315BEA0FB02D26EFDEAF83C17BD878A00"
      cert_valid_from     = "2020-09-11"
      cert_valid_to       = "2023-09-12"

      country             = "RS"
      state               = "???"
      locality            = "BELGRADE"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "45:69:16:37:80:2b:58:41:04:db:69:bf:e5:d1:9c:f8"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_0445579500D62BABFC28FD8CAA4F305D {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "dd004507cf28c1a965b6475afa071e0aad2644056a84e173ce74b73cbcc8facb"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Satago Software Solutions Sp. z o.o."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "04:45:57:95:00:d6:2b:ab:fc:28:fd:8c:aa:4f:30:5d"
      cert_thumbprint     = "57F629EDE7002C2BEA1AF8B60062C303FA12F957"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-05"

      country             = "PL"
      state               = "???"
      locality            = "Kraków"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "04:45:57:95:00:d6:2b:ab:fc:28:fd:8c:aa:4f:30:5d"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_06B6D93159708182E93C6EA793F5EA1F {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "9fa68287729336e8d77a29ce1a9c71ff47e8ad54e4627623ca6ec581f3285146"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Beijing Ruiyunteng Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "06:b6:d9:31:59:70:81:82:e9:3c:6e:a7:93:f5:ea:1f"
      cert_thumbprint     = "4761A2225BC36B9CDDA3B26553DCEA94C79AC150"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "CN"
      state               = "Beijing"
      locality            = "Beijing"
      email               = "???"
      rdn_serial_number   = "91110229MA001HBGX8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "06:b6:d9:31:59:70:81:82:e9:3c:6e:a7:93:f5:ea:1f"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_1B4174AA6AAF8921F344AAB138FF7F33 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-17"
      version             = "1.0"

      hash                = "0ec34875eaef4719aaea86ca037cb6fe89f897a1cbbdd01013e71637fa7e89e1"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Skilsure Software Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1b:41:74:aa:6a:af:89:21:f3:44:aa:b1:38:ff:7f:33"
      cert_thumbprint     = "E823FD216198C8647D78D83E9947918B68B0D27A"
      cert_valid_from     = "2024-06-17"
      cert_valid_to       = "2025-06-17"

      country             = "GB"
      state               = "???"
      locality            = "Milton Keynes"
      email               = "???"
      rdn_serial_number   = "13393128"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1b:41:74:aa:6a:af:89:21:f3:44:aa:b1:38:ff:7f:33"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_22CD8B39C5186E4CA6217F6F0EF06933 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-31"
      version             = "1.0"

      hash                = "ab1e644201b5b72b588210769a3065a8244729d4ad33815551a09131a12b3ab5"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Cangzhou Chenyue Electronic Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "22:cd:8b:39:c5:18:6e:4c:a6:21:7f:6f:0e:f0:69:33"
      cert_thumbprint     = "432BBA0314FF92DC5E3988CBD46D50D2533F61C2"
      cert_valid_from     = "2024-05-31"
      cert_valid_to       = "2025-05-31"

      country             = "CN"
      state               = "Hebei"
      locality            = "Cangzhou"
      email               = "???"
      rdn_serial_number   = "91130922MA0G8AN920"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "22:cd:8b:39:c5:18:6e:4c:a6:21:7f:6f:0e:f0:69:33"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_332BD5801E8415585E72C87E0E2EC71D {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-08"
      version             = "1.0"

      hash                = "306a4acb51995d012cedf11eeae5e6cd9f41bf577dc5b6855a9df61ce843bc67"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Elite Marketing Strategies, Inc."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "33:2b:d5:80:1e:84:15:58:5e:72:c8:7e:0e:2e:c7:1d"
      cert_thumbprint     = "A9709D8C4C121682DC67DF6D9C16FB79694C6BCC"
      cert_valid_from     = "2022-09-08"
      cert_valid_to       = "2023-09-08"

      country             = "US"
      state               = "Wyoming"
      locality            = "Cheyenne"
      email               = "???"
      rdn_serial_number   = "2022-001126825"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "33:2b:d5:80:1e:84:15:58:5e:72:c8:7e:0e:2e:c7:1d"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_56E7441971712C25563CA0202DF64313 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-06"
      version             = "1.0"

      hash                = "7f6bd2fb62b7d513213a4ea7e6da2750506600c60c1b42b32c75502906d428e4"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Guangxi Hanhe Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "56:e7:44:19:71:71:2c:25:56:3c:a0:20:2d:f6:43:13"
      cert_thumbprint     = "DCA3C823A7E4E4591DE17640A96803F6E496A3FF"
      cert_valid_from     = "2024-06-06"
      cert_valid_to       = "2025-06-06"

      country             = "CN"
      state               = "Guangxi-Zhuang Autonomous Region"
      locality            = "Nanning"
      email               = "???"
      rdn_serial_number   = "91450103MA5LBQKB3C"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "56:e7:44:19:71:71:2c:25:56:3c:a0:20:2d:f6:43:13"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_5D0F5A3545E7F903EA79DB0E57235288 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-11"
      version             = "1.0"

      hash                = "bae3c4cfcb9525a6b024d0f69c34d040133474fa3f8dd9007179828e234708fa"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "BERCIS Software SIA"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "5d:0f:5a:35:45:e7:f9:03:ea:79:db:0e:57:23:52:88"
      cert_thumbprint     = "4919C99F5826B6E47218B2F59CEBBE6A1CF0E898"
      cert_valid_from     = "2024-10-11"
      cert_valid_to       = "2025-10-11"

      country             = "LV"
      state               = "???"
      locality            = "Riga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "5d:0f:5a:35:45:e7:f9:03:ea:79:db:0e:57:23:52:88"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_6BE642576DDB9D7631CF2DFCE425CC9F {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-01"
      version             = "1.0"

      hash                = "672eebccfb00a9a4cc11fec4232eff3c87f7870d1cef4c647d364801cab814ca"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Cloud Estates London Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "6b:e6:42:57:6d:db:9d:76:31:cf:2d:fc:e4:25:cc:9f"
      cert_thumbprint     = "56D79CEB82432BD6E4EBE56779049DE806A2D3B4"
      cert_valid_from     = "2020-12-01"
      cert_valid_to       = "2021-12-01"

      country             = "GB"
      state               = "London"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "10476674"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "6b:e6:42:57:6d:db:9d:76:31:cf:2d:fc:e4:25:cc:9f"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_7193E5BAAAE48F34526467BA794A0F58 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-01"
      version             = "1.0"

      hash                = "7f4aca86b3ac80d29bb34801c48fb6a5a34887d4b76e9c16e4e080c16c23819a"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Destiny Software Sp. z o.o."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "71:93:e5:ba:aa:e4:8f:34:52:64:67:ba:79:4a:0f:58"
      cert_thumbprint     = "F62D3C51E6F9BEC0C7184FB43BE990D5F69884FE"
      cert_valid_from     = "2024-10-01"
      cert_valid_to       = "2025-10-01"

      country             = "PL"
      state               = "???"
      locality            = "Zielona Gora"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "71:93:e5:ba:aa:e4:8f:34:52:64:67:ba:79:4a:0f:58"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Certum_721A46AC53182005B04CFFC2E743EB66 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "5436d1607e673ed60dc18778c8bebdb6a6d6091cb67668f93732546b745ec08b"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Amon Software"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "72:1a:46:ac:53:18:20:05:b0:4c:ff:c2:e7:43:eb:66"
      cert_thumbprint     = "1473005A61848671CEF1C8776C6C989EDD776D55"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-05"

      country             = "BE"
      state               = "???"
      locality            = "Braine-l'Alleud"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "72:1a:46:ac:53:18:20:05:b0:4c:ff:c2:e7:43:eb:66"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_DigiCert_016558F3759AB455D5497251C51FF8F6 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-07-01"
      version             = "1.0"

      hash                = "7a5f2afe726768008f80860aa992e56e01cb609d6a0510348a528182ae4ad8d1"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "GetScatter Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "01:65:58:f3:75:9a:b4:55:d5:49:72:51:c5:1f:f8:f6"
      cert_thumbprint     = "31F52C1E030737D8BB0DCF6E3B3EC25D030396AF"
      cert_valid_from     = "2019-07-01"
      cert_valid_to       = "2022-07-06"

      country             = "MT"
      state               = "???"
      locality            = "Sliema"
      email               = "???"
      rdn_serial_number   = "C 89452"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "01:65:58:f3:75:9a:b4:55:d5:49:72:51:c5:1f:f8:f6"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_DigiCert_025020668F51235E9ECFFF8CF00DA63E {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-04"
      version             = "1.0"

      hash                = "01910bddacbf2ea878b487dd3dfc2cfbeabf1a3dba94309b4a84c9e6b4b4afc9"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Knassar DK ApS"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA"
      cert_serial         = "02:50:20:66:8f:51:23:5e:9e:cf:ff:8c:f0:0d:a6:3e"
      cert_thumbprint     = "59F82837FA672A81841D8FA4D3BA290395C10200"
      cert_valid_from     = "2021-03-04"
      cert_valid_to       = "2022-03-10"

      country             = "DK"
      state               = "???"
      locality            = "Copenhagen"
      email               = "???"
      rdn_serial_number   = "41948590"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA" and
         sig.serial == "02:50:20:66:8f:51:23:5e:9e:cf:ff:8c:f0:0d:a6:3e"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_DigiCert_070843EA189B84048AE0A3415816EBA3 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-07"
      version             = "1.0"

      hash                = "0d4e1abeba056550ae04d476a81e4f90ac7681845e53d913a8bb802114e814ff"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Resedavide AB"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "07:08:43:ea:18:9b:84:04:8a:e0:a3:41:58:16:eb:a3"
      cert_thumbprint     = "264D284AFAE1598DF4236E990AF033DD761D7A99"
      cert_valid_from     = "2021-12-07"
      cert_valid_to       = "2022-12-02"

      country             = "SE"
      state               = "???"
      locality            = "Stockholm"
      email               = "???"
      rdn_serial_number   = "5592127780"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "07:08:43:ea:18:9b:84:04:8a:e0:a3:41:58:16:eb:a3"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_DigiCert_0AB6F755FFA3C3F19E380DDFFE37F19D {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-17"
      version             = "1.0"

      hash                = "7748483b44afcdd7fbda3501c25e4ebeff29b9733f70c944a7ca1b3701b87e85"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Creative Force ApS"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA"
      cert_serial         = "0a:b6:f7:55:ff:a3:c3:f1:9e:38:0d:df:fe:37:f1:9d"
      cert_thumbprint     = "5A17CDD78C7EAD36EC986BFE49FE7552D44C8B3B"
      cert_valid_from     = "2021-01-17"
      cert_valid_to       = "2022-01-20"

      country             = "DK"
      state               = "???"
      locality            = "Holstebro"
      email               = "???"
      rdn_serial_number   = "41956895"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA" and
         sig.serial == "0a:b6:f7:55:ff:a3:c3:f1:9e:38:0d:df:fe:37:f1:9d"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_DigiCert_0D848B64F0E176904FFC50DE2497D6E8 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-03"
      version             = "1.0"

      hash                = "032b067091d530a3a2079140e7550b447ecb3accd2a09b247d0126193bb3953c"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Rbit Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:84:8b:64:f0:e1:76:90:4f:fc:50:de:24:97:d6:e8"
      cert_thumbprint     = "F5C77CE3DD49167541BE6E5A2E5334F16B9770E3"
      cert_valid_from     = "2021-12-03"
      cert_valid_to       = "2022-12-03"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "11633091"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:84:8b:64:f0:e1:76:90:4f:fc:50:de:24:97:d6:e8"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_DigiCert_0E8AA328AF207CE8BCAE1DC15C626188 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-27"
      version             = "1.0"

      hash                = "45ff625f17a1e9ad65dd94c376034148d6d8eee8a41b1209f566a907f5d6d6c7"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "PRO SAT SRL"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0e:8a:a3:28:af:20:7c:e8:bc:ae:1d:c1:5c:62:61:88"
      cert_thumbprint     = "96AD6679F52FEB25C81DEF440003A4AB737718C5"
      cert_valid_from     = "2021-07-27"
      cert_valid_to       = "2023-07-27"

      country             = "RO"
      state               = "???"
      locality            = "ALBA IULIA"
      email               = "???"
      rdn_serial_number   = "J01/557/1993"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0e:8a:a3:28:af:20:7c:e8:bc:ae:1d:c1:5c:62:61:88"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Entrust_7010DF2D3C8A608E6CF69B79C7AD074E {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-16"
      version             = "1.0"

      hash                = "524bfdb6922acdb543165762769df5bc7f6871751769c8923b213c3ac7ebd9ca"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Software Alliance ApS"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "70:10:df:2d:3c:8a:60:8e:6c:f6:9b:79:c7:ad:07:4e"
      cert_thumbprint     = "27C2E54C69BCD81490999F1FC5E8DA18D2C1192B"
      cert_valid_from     = "2024-04-16"
      cert_valid_to       = "2025-04-16"

      country             = "DK"
      state               = "???"
      locality            = "Køge"
      email               = "???"
      rdn_serial_number   = "41660635"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "70:10:df:2d:3c:8a:60:8e:6c:f6:9b:79:c7:ad:07:4e"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_05BF822AC83E8A6BC0277A41 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-13"
      version             = "1.0"

      hash                = "233d0e0483c769061d61201b6b06ab8c9460ad40ec7e70384ce54c8c258fa5e5"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "LLC Extrastroy"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "05:bf:82:2a:c8:3e:8a:6b:c0:27:7a:41"
      cert_thumbprint     = "C699047F344062CCF95578BF470DD08BFBDD7ECB"
      cert_valid_from     = "2025-06-13"
      cert_valid_to       = "2026-06-14"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1187746693640"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "05:bf:82:2a:c8:3e:8a:6b:c0:27:7a:41"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_0F8483C4C222876DD6C6ABED {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-24"
      version             = "1.0"

      hash                = "06dec1d05b77f765b9d12c223d4b7887dc0a526e8d8a790bd2b99346619dc837"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Shanghai Lijin Chemical Technology Development Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0f:84:83:c4:c2:22:87:6d:d6:c6:ab:ed"
      cert_thumbprint     = "BA413448EFA6BAEC05C37262FDFC5CCAE0639A93"
      cert_valid_from     = "2024-05-24"
      cert_valid_to       = "2025-05-25"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310114607545250A"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0f:84:83:c4:c2:22:87:6d:d6:c6:ab:ed"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_1BACADCA4264971772A3A024 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-14"
      version             = "1.0"

      hash                = "894266d5eddd19d343f354cfc235149bc4d85fbe2dea2544708a51b425ae8e34"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "VINA 68 INVESTMENT AND CONSTRUCTION JOINT STOCK COMPANY"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1b:ac:ad:ca:42:64:97:17:72:a3:a0:24"
      cert_thumbprint     = "B50F0450A280825E1B08DEC289E1BE8936F3E90E"
      cert_valid_from     = "2025-04-14"
      cert_valid_to       = "2026-04-15"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1b:ac:ad:ca:42:64:97:17:72:a3:a0:24"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_2FDB811D0B45ECBB4725623C {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-06"
      version             = "1.0"

      hash                = "b7bd2a1969234d77ce7bdab808d77243e31899412e918c269b9f1b6748434be1"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "BCF SOFTWARE Sp. z o.o."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2f:db:81:1d:0b:45:ec:bb:47:25:62:3c"
      cert_thumbprint     = "22164A50E1447B7B7B04A7B02087BB2035D9651D"
      cert_valid_from     = "2023-12-06"
      cert_valid_to       = "2024-12-06"

      country             = "PL"
      state               = "Opolskie"
      locality            = "Opole"
      email               = "admin@bcfsoftware.com"
      rdn_serial_number   = "0000634606"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2f:db:81:1d:0b:45:ec:bb:47:25:62:3c"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_34A8A2E38E640CDA8D8599B7 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-04"
      version             = "1.0"

      hash                = "bd97ecf1a07fbc5cc1cfcbdfb73368e01f14c3e8abe061f73543627bddd9eb6d"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "STK LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:a8:a2:e3:8e:64:0c:da:8d:85:99:b7"
      cert_thumbprint     = "E105FAF738FD342D18D180B32E952599FE2E3333"
      cert_valid_from     = "2025-07-04"
      cert_valid_to       = "2026-07-05"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1187746040228"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:a8:a2:e3:8e:64:0c:da:8d:85:99:b7"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_3F4C9B98FD5FBBFF44B8A012 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-13"
      version             = "1.0"

      hash                = "d263dc3cef339b6192232d835e4f20049a3f88531453ffa078d3bcea9b40febe"
      malware             = "NetSupport RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC SKT SERVICE"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3f:4c:9b:98:fd:5f:bb:ff:44:b8:a0:12"
      cert_thumbprint     = "E7873FBED486092FAA43DF45D79E33CA2115284B"
      cert_valid_from     = "2025-12-13"
      cert_valid_to       = "2026-03-27"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1187746507850"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3f:4c:9b:98:fd:5f:bb:ff:44:b8:a0:12"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_418E8B8B66DADCA197FF421B {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-06"
      version             = "1.0"

      hash                = "5342fa80b4f8f983322e8932819ef6037f837b93719a77f06f48d4a6eb7b17f8"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Wuxi James Lndustrial Automation Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:8e:8b:8b:66:da:dc:a1:97:ff:42:1b"
      cert_thumbprint     = "EC05F66F97CCA0ECEED159E1836D571E6AB7B1E9"
      cert_valid_from     = "2025-03-06"
      cert_valid_to       = "2026-03-07"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "91320213MA1XXDB71G"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:8e:8b:8b:66:da:dc:a1:97:ff:42:1b"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_432291EE2D1F6B4F2D5E1E00 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-26"
      version             = "1.0"

      hash                = "cc66e005be8348b49b9886f5bb57772b230bb147bc57983fd7c1cfa4cfa84bb7"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "SOFTWARE SP Z O O"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "43:22:91:ee:2d:1f:6b:4f:2d:5e:1e:00"
      cert_thumbprint     = "83D5809E026B355EE19ADF29CF09CB6C99E624C0"
      cert_valid_from     = "2024-04-26"
      cert_valid_to       = "2025-03-08"

      country             = "PL"
      state               = "MAZOWIECKIE"
      locality            = "WARSZAWA"
      email               = "admin@softwarepoland.com"
      rdn_serial_number   = "0000682860"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "43:22:91:ee:2d:1f:6b:4f:2d:5e:1e:00"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_4E49B35F9A33867E60262272 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-25"
      version             = "1.0"

      hash                = "99da08e1e26390610c2431c8237a0fa2caf5e9c781db06170851f151ed3d65bf"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "LLC Capital Garant"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4e:49:b3:5f:9a:33:86:7e:60:26:22:72"
      cert_thumbprint     = "0958F6DEE35AE2DD4601F43631CB0095E55781D4"
      cert_valid_from     = "2025-07-25"
      cert_valid_to       = "2026-07-12"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4e:49:b3:5f:9a:33:86:7e:60:26:22:72"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_509CC777A842A8EDC4F7E28F {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-22"
      version             = "1.0"

      hash                = "ffed8cd32c68d30a9e0f3d4484084982ca92667a99ade3bf32d58125dcd15f5e"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "RIMMA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:9c:c7:77:a8:42:a8:ed:c4:f7:e2:8f"
      cert_thumbprint     = "50316559E0E132F84D6FE3572C0F8360E41B10BB"
      cert_valid_from     = "2025-09-22"
      cert_valid_to       = "2025-12-05"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:9c:c7:77:a8:42:a8:ed:c4:f7:e2:8f"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_543A61A75B00D24BE9901085 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-16"
      version             = "1.0"

      hash                = "8f9abc7d4c506597867d65bb902ed8fca719e55e7173b9d5c82b0b30633bb84c"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "LLC PET"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "54:3a:61:a7:5b:00:d2:4b:e9:90:10:85"
      cert_thumbprint     = "0076727A360E455A67CAF5A9FC1B27EE9E02191D"
      cert_valid_from     = "2025-06-16"
      cert_valid_to       = "2026-06-17"

      country             = "RU"
      state               = "Kemerovo Oblast"
      locality            = "Kemerovo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "54:3a:61:a7:5b:00:d2:4b:e9:90:10:85"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_546650E1123B8A5CF89E9427 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-04"
      version             = "1.0"

      hash                = "3d47aa3f5d36514cf264d75f75774318f4a00f8258c73f61631f995613f7290d"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "DAMOKLES SECURITY INNOVATIONS LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "54:66:50:e1:12:3b:8a:5c:f8:9e:94:27"
      cert_thumbprint     = "66CEECE185E725DD4E86433BD4AC28B87115FAB8"
      cert_valid_from     = "2022-03-04"
      cert_valid_to       = "2023-03-05"

      country             = "CA"
      state               = "Alberta"
      locality            = "Airdrie"
      email               = "A.Campbell@guarantaccess.com"
      rdn_serial_number   = "2120160458"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "54:66:50:e1:12:3b:8a:5c:f8:9e:94:27"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_5B98E466D6E65C422F7990E8 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-24"
      version             = "1.0"

      hash                = "fb76386ce3f17a25d59046a70cc05898bcccc7422ab92681777071e46d8943e5"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "DAMOKLES SECURITY INNOVATIONS LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5b:98:e4:66:d6:e6:5c:42:2f:79:90:e8"
      cert_thumbprint     = "6474103BB486B38FA949EAA4322C8CDD857CAF00"
      cert_valid_from     = "2022-06-24"
      cert_valid_to       = "2023-03-05"

      country             = "CA"
      state               = "Alberta"
      locality            = "Airdrie"
      email               = "A.Campbell@guarantaccess.com"
      rdn_serial_number   = "2120160458"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5b:98:e4:66:d6:e6:5c:42:2f:79:90:e8"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_5D3422FD4AFCF7D012D60C25 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-22"
      version             = "1.0"

      hash                = "58c12cdf6fd101f2aec69cac01147393f7132de474920aa0cf2a4b95689bc5b7"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "SOFTWARE BYTES LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5d:34:22:fd:4a:fc:f7:d0:12:d6:0c:25"
      cert_thumbprint     = "DC656AF416A78304F08264E379DA8AB1DF6C4432"
      cert_valid_from     = "2024-01-22"
      cert_valid_to       = "2025-01-22"

      country             = "GB"
      state               = "Wales"
      locality            = "Cardiff"
      email               = "admin@softwarebytes.uk"
      rdn_serial_number   = "12315026"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5d:34:22:fd:4a:fc:f7:d0:12:d6:0c:25"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_646E606D30DF08F8C51ACBC1 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-11"
      version             = "1.0"

      hash                = "0bb16506d1f5c422644435a7dafd379c96f136f4e68703a45266066694ede59e"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Changchun Bapco Technology Development Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:6e:60:6d:30:df:08:f8:c5:1a:cb:c1"
      cert_thumbprint     = "E03C2FF39F7E304C2737AEEB68182381277172B8"
      cert_valid_from     = "2024-06-11"
      cert_valid_to       = "2025-06-12"

      country             = "CN"
      state               = "Jilin"
      locality            = "Changchun"
      email               = "???"
      rdn_serial_number   = "91220105MA145FUX1P"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:6e:60:6d:30:df:08:f8:c5:1a:cb:c1"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_7EAF9EB4886EDA7C48DC8EA4 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-05"
      version             = "1.0"

      hash                = "98e12e68c45dc1b540c7f1c87e4293e3f0f0fecae98d3f49b60fdb4f646082d1"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Xuaony Lucid Dotaku Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:af:9e:b4:88:6e:da:7c:48:dc:8e:a4"
      cert_thumbprint     = "59CED3057E88B69EDD38587ACEE2BAEF92D32852"
      cert_valid_from     = "2024-07-05"
      cert_valid_to       = "2025-07-06"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420600MA488H2M4C"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:af:9e:b4:88:6e:da:7c:48:dc:8e:a4"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_GlobalSign_7F07AA1BB8A3B0183893B1AA {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-26"
      version             = "1.0"

      hash                = "7b13496fb45b51e821771d63bbd1d503f07710f676481ff34962b051283d8033"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "OMICARE JOINT STOCK COMPANY"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7f:07:aa:1b:b8:a3:b0:18:38:93:b1:aa"
      cert_thumbprint     = "56FC98490B4845072947536B9E0AC121A37744E6"
      cert_valid_from     = "2024-09-26"
      cert_valid_to       = "2025-09-27"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "makedasalzbergneu79@gmail.com"
      rdn_serial_number   = "0108523661"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7f:07:aa:1b:b8:a3:b0:18:38:93:b1:aa"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Microsoft_33000578F93468681279E2CFDE0000000578F9 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-27"
      version             = "1.0"

      hash                = "1e92331008dcbb8231fb750ec4d6dbda4d5b6c16e9c4ef302e261b06a9d19929"
      malware             = "NetSupport RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GROUPE PROMO-STAFF RTM INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:78:f9:34:68:68:12:79:e2:cf:de:00:00:00:05:78:f9"
      cert_thumbprint     = "E75CE4F6D588555B946CF3066983990C57B3E9F2"
      cert_valid_from     = "2025-11-27"
      cert_valid_to       = "2025-11-30"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Philippe"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:78:f9:34:68:68:12:79:e2:cf:de:00:00:00:05:78:f9"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Microsoft_3300058C942C910D349BCEE8B2000000058C94 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-02"
      version             = "1.0"

      hash                = "e9c5c6132f2d222ce4f76ff1bf59735f6c527b2e44b8fea4b4275eebfaeaa4e2"
      malware             = "NetSupport RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GROUPE PROMO-STAFF RTM INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:8c:94:2c:91:0d:34:9b:ce:e8:b2:00:00:00:05:8c:94"
      cert_thumbprint     = "1BD24A8E138EEBF3CECF87893B0852AD472E7B37"
      cert_valid_from     = "2025-12-02"
      cert_valid_to       = "2025-12-05"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Philippe"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:8c:94:2c:91:0d:34:9b:ce:e8:b2:00:00:00:05:8c:94"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Microsoft_3300065D3BA41494C817A7E2BA000000065D3B {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-03"
      version             = "1.0"

      hash                = "c260577f01c09fb0076fe3990d809964848e40930ac53070bab4e27da3ca2a81"
      malware             = "NetSupport RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GROUPE PROMO-STAFF RTM INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:5d:3b:a4:14:94:c8:17:a7:e2:ba:00:00:00:06:5d:3b"
      cert_thumbprint     = "BF4D7A7AA0414C7F006E8BA3FDA5DF56A7F945CD"
      cert_valid_from     = "2025-12-03"
      cert_valid_to       = "2025-12-06"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Philippe"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:5d:3b:a4:14:94:c8:17:a7:e2:ba:00:00:00:06:5d:3b"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Microsoft_3300066EACA3015D01FAFC05C3000000066EAC {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-08"
      version             = "1.0"

      hash                = "b0383b31ab663412a3a50e9a19032942a4819320055577f583b0831760a8cf12"
      malware             = "NetSupport RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Martines Palmeiro Construction, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:6e:ac:a3:01:5d:01:fa:fc:05:c3:00:00:00:06:6e:ac"
      cert_thumbprint     = "86F61E8A4342E1EF55DDDFFD14469CCC68D40D9B"
      cert_valid_from     = "2025-12-08"
      cert_valid_to       = "2025-12-11"

      country             = "US"
      state               = "Colorado"
      locality            = "Denver"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:6e:ac:a3:01:5d:01:fa:fc:05:c3:00:00:00:06:6e:ac"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_0C7C3D057E97CA0CB7A00DA10EF2F477 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "bd71ab909ad6fa9c57c00d0d31c721d55983da819b9c09da78f91a0658df9b41"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "GREEN ENTERPRISE SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0c:7c:3d:05:7e:97:ca:0c:b7:a0:0d:a1:0e:f2:f4:77"
      cert_thumbprint     = "5FF0B85D1650C4CD4BBF44134F846DFCFB12B769"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2025-01-25"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "0000564145"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0c:7c:3d:05:7e:97:ca:0c:b7:a0:0d:a1:0e:f2:f4:77"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_0FA27D2553F24DA79D1CC6BD8773EE9A {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-25"
      version             = "1.0"

      hash                = "113290aaa5c0b0793d50de6819f2b2eead5e321e9300d91b9a36d62ba8e5bbc1"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "CYNC LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0f:a2:7d:25:53:f2:4d:a7:9d:1c:c6:bd:87:73:ee:9a"
      cert_thumbprint     = "E9007755CFE5643D18618786DE1995914098307F"
      cert_valid_from     = "2024-07-25"
      cert_valid_to       = "2025-07-25"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "13066343"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0f:a2:7d:25:53:f2:4d:a7:9d:1c:c6:bd:87:73:ee:9a"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_15D82B35761FE064DF2BC72C62D69A04 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-03"
      version             = "1.0"

      hash                = "4e25b7cc56cbf7a5670d696f9833a794885b6698e4d9b002957ea09645af763d"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Laks Tech Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "15:d8:2b:35:76:1f:e0:64:df:2b:c7:2c:62:d6:9a:04"
      cert_thumbprint     = "B9C03DF2C57C398DA548FCC57F7B46E6BA8E2780"
      cert_valid_from     = "2024-07-03"
      cert_valid_to       = "2025-07-03"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "15:d8:2b:35:76:1f:e0:64:df:2b:c7:2c:62:d6:9a:04"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_1D84AEF0C4EF73EEC7B2794EE51BD73F {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-16"
      version             = "1.0"

      hash                = "f45b008c2dc3a65788aeac2040a067bd1a6100a06f8855d741ed9c82b94b7c3b"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "MAD PANDA LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1d:84:ae:f0:c4:ef:73:ee:c7:b2:79:4e:e5:1b:d7:3f"
      cert_thumbprint     = "977A8331DCC4C0B37CA7EF6DB4B5B865DE16A989"
      cert_valid_from     = "2024-07-16"
      cert_valid_to       = "2025-07-16"

      country             = "GB"
      state               = "???"
      locality            = "Cobham"
      email               = "???"
      rdn_serial_number   = "12535189"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1d:84:ae:f0:c4:ef:73:ee:c7:b2:79:4e:e5:1b:d7:3f"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_27CD9AAFD8A9E3C32C365F75DF24C59F {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-13"
      version             = "1.0"

      hash                = "36ddf45c5d3b0bd830107dd4b31742372e31b81db79b757c2357049bf37de9a9"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Destiny Software Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "27:cd:9a:af:d8:a9:e3:c3:2c:36:5f:75:df:24:c5:9f"
      cert_thumbprint     = "9F1A0A1F31FEEE993F5B3ECBB9FE5EE536B85594"
      cert_valid_from     = "2024-08-13"
      cert_valid_to       = "2025-08-13"

      country             = "PL"
      state               = "Lubusz Voivodeship"
      locality            = "Zielona Góra"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "27:cd:9a:af:d8:a9:e3:c3:2c:36:5f:75:df:24:c5:9f"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_2B364A266B662217E23527D86CB66017 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "8c8c535e458d9aaf346c5acb3402ce4f9223a845a805ad4c9d5d13a7f5485562"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "LUCKY7 VENTURES LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2b:36:4a:26:6b:66:22:17:e2:35:27:d8:6c:b6:60:17"
      cert_thumbprint     = "B887E53FCA162CDAE20C1F9340FBF5AE390DE324"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2026-09-10"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2b:36:4a:26:6b:66:22:17:e2:35:27:d8:6c:b6:60:17"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_316BB5E6D2D5FF1F4C2C60028E1CEC08 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-06"
      version             = "1.0"

      hash                = "cb517c016416fc55bd64a82fe1d9c5d5e05e227fa6a6878d2ec98903e1bc9ecb"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "SIA SoftWorks"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "31:6b:b5:e6:d2:d5:ff:1f:4c:2c:60:02:8e:1c:ec:08"
      cert_thumbprint     = "129C2424E2CF3CAB9F1195D0EB90337C5187C5EA"
      cert_valid_from     = "2024-08-06"
      cert_valid_to       = "2025-08-06"

      country             = "LV"
      state               = "Rīga"
      locality            = "Latgales priekšpilsēta"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "31:6b:b5:e6:d2:d5:ff:1f:4c:2c:60:02:8e:1c:ec:08"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_3487F6776C8B2565336755E086868AB1 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-16"
      version             = "1.0"

      hash                = "e70ae269c2ce3d77bb5b5494bd64be7154d542ab84948fed6c68addae735bbf4"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Huus Consulting ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "34:87:f6:77:6c:8b:25:65:33:67:55:e0:86:86:8a:b1"
      cert_thumbprint     = "81F223057B0FBB6DAF6FC1C2BE8315E603E9ECA8"
      cert_valid_from     = "2024-07-16"
      cert_valid_to       = "2025-07-15"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Copenhagen"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "34:87:f6:77:6c:8b:25:65:33:67:55:e0:86:86:8a:b1"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_36C5DB58902613F6221E388B95DCF8A4 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-17"
      version             = "1.0"

      hash                = "6d7fddff5b509fdd5372caa740e2227a8b0be2db1a7e9a59e16873ffc4f351e4"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "GINA International s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "36:c5:db:58:90:26:13:f6:22:1e:38:8b:95:dc:f8:a4"
      cert_thumbprint     = "8CBA06BD53411043CB7DF4F6ACFE7856D9440815"
      cert_valid_from     = "2024-07-17"
      cert_valid_to       = "2025-07-17"

      country             = "CZ"
      state               = "???"
      locality            = "Brno"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "36:c5:db:58:90:26:13:f6:22:1e:38:8b:95:dc:f8:a4"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_3A0D91732285BF24FDA0564AF5A98E71 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-22"
      version             = "1.0"

      hash                = "980fcb6365092cd752934417abb0f2a95bca452c58856240157107e70c1d754d"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Changsha Ruike Hotel Management Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3a:0d:91:73:22:85:bf:24:fd:a0:56:4a:f5:a9:8e:71"
      cert_thumbprint     = "2EA4B7DCF74AF6E4F8F27F5FBBEBAC033661A126"
      cert_valid_from     = "2024-01-22"
      cert_valid_to       = "2025-01-21"

      country             = "CN"
      state               = "Hunan"
      locality            = "Changsha"
      email               = "???"
      rdn_serial_number   = "91430104MA4QAQW82U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3a:0d:91:73:22:85:bf:24:fd:a0:56:4a:f5:a9:8e:71"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_3AB74A2EBF93447ADB83554B5564FE03 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-19"
      version             = "1.0"

      hash                = "e7ec6934a362bcdb3d6c686c39d6130174622000f3fdda9274a6d7d2418e515f"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "IMPERIOUS TECHNOLOGIES LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "3a:b7:4a:2e:bf:93:44:7a:db:83:55:4b:55:64:fe:03"
      cert_thumbprint     = "21A97512A2959B0E74729BE220102AEF1DCF56FD"
      cert_valid_from     = "2023-05-19"
      cert_valid_to       = "2024-05-17"

      country             = "GB"
      state               = "???"
      locality            = "Ringwood"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "3a:b7:4a:2e:bf:93:44:7a:db:83:55:4b:55:64:fe:03"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_3D4972F14D443D3FCCF56EF6AB6F6CFB {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-17"
      version             = "1.0"

      hash                = "a701979c800e77288f1c28b340b77f62329296d934db727648212e62587bb0f9"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "EPRIS, d.o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "3d:49:72:f1:4d:44:3d:3f:cc:f5:6e:f6:ab:6f:6c:fb"
      cert_thumbprint     = "65EED6B2D21D614C8F031386DADA573B8BFAABEA"
      cert_valid_from     = "2024-07-17"
      cert_valid_to       = "2025-07-17"

      country             = "SI"
      state               = "???"
      locality            = "Kranj"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "3d:49:72:f1:4d:44:3d:3f:cc:f5:6e:f6:ab:6f:6c:fb"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_465CED3B7CCC4501558680ECA61BBB9E {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-27"
      version             = "1.0"

      hash                = "5b04d7fee45d12dd86decd6b8ee075e95b3f1d7d689df824df0bffdcf9c0b6c8"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Dai Software Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "46:5c:ed:3b:7c:cc:45:01:55:86:80:ec:a6:1b:bb:9e"
      cert_thumbprint     = "49CDFC26AE060028F5FEC00E18DC52540470A328"
      cert_valid_from     = "2024-06-27"
      cert_valid_to       = "2025-06-27"

      country             = "GB"
      state               = "Wales"
      locality            = "Talbot Green"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "46:5c:ed:3b:7c:cc:45:01:55:86:80:ec:a6:1b:bb:9e"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_46EBF14BF2B2F88F2EE3372CB0F6AA9E {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-01"
      version             = "1.0"

      hash                = "341b7c4f0a76487e345ed2e79e29c3c1043f5ca77e0a2008928fc8d7bf51cd18"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "NXG Software Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "46:eb:f1:4b:f2:b2:f8:8f:2e:e3:37:2c:b0:f6:aa:9e"
      cert_thumbprint     = "88F53BCA3C84A4184D2C79A7ADEFA552048843D1"
      cert_valid_from     = "2024-07-01"
      cert_valid_to       = "2025-07-01"

      country             = "GB"
      state               = "Kent"
      locality            = "Orpington"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "46:eb:f1:4b:f2:b2:f8:8f:2e:e3:37:2c:b0:f6:aa:9e"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_4F0E9913D60904BC7917AE8CBFA11DF6 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-08"
      version             = "1.0"

      hash                = "8f700d6ac2bc4e939e959b14b42c637a516c78d16fdbd3605c83872254a1065e"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Affable Software, s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4f:0e:99:13:d6:09:04:bc:79:17:ae:8c:bf:a1:1d:f6"
      cert_thumbprint     = "4D9276AA8BA55CCDE5ABD449D6AE4CE025EB84D7"
      cert_valid_from     = "2024-08-08"
      cert_valid_to       = "2025-08-07"

      country             = "CZ"
      state               = "Pardubice"
      locality            = "Zelené Předměstí"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4f:0e:99:13:d6:09:04:bc:79:17:ae:8c:bf:a1:1d:f6"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_5258128CB8E2C4816C2F9F13BAF422D7 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-02"
      version             = "1.0"

      hash                = "a8b56d92607550947e223d22e0baba8a05c8a3f1c9efe6db30c2a54bc6dec3ff"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Mac Softwares Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "52:58:12:8c:b8:e2:c4:81:6c:2f:9f:13:ba:f4:22:d7"
      cert_thumbprint     = "2DDDE1128529FA31F6B7E6D817DB09667BF3E803"
      cert_valid_from     = "2024-07-02"
      cert_valid_to       = "2025-07-02"

      country             = "GB"
      state               = "England"
      locality            = "Epsom"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "52:58:12:8c:b8:e2:c4:81:6c:2f:9f:13:ba:f4:22:d7"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_57E43478EAD985E2C781F377BF551614 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-14"
      version             = "1.0"

      hash                = "c241d88e64697f8a7e4a80b10677952bf6df072465e3a75ad5295d010cb5f4d2"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "ACM Software ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "57:e4:34:78:ea:d9:85:e2:c7:81:f3:77:bf:55:16:14"
      cert_thumbprint     = "BC89457220753CA347D15E24C328D24A5886AF13"
      cert_valid_from     = "2024-07-14"
      cert_valid_to       = "2025-07-14"

      country             = "DK"
      state               = "???"
      locality            = "Risskov"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "57:e4:34:78:ea:d9:85:e2:c7:81:f3:77:bf:55:16:14"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_627BC57981E18D8EC4DD9D1AA500A8CA {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-03"
      version             = "1.0"

      hash                = "0fe151a3925e90f87ca716372a8eb7b4195dcfa7e64591a350ad6655ca36446d"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Air Code Design inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "62:7b:c5:79:81:e1:8d:8e:c4:dd:9d:1a:a5:00:a8:ca"
      cert_thumbprint     = "152B35C0C7ABC1AEBCB211753BA0D49446D3E34E"
      cert_valid_from     = "2024-07-03"
      cert_valid_to       = "2025-07-03"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Kelowna"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "62:7b:c5:79:81:e1:8d:8e:c4:dd:9d:1a:a5:00:a8:ca"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_651F3E5B491B197D20C49B9C7B25B775 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-04"
      version             = "1.0"

      hash                = "686495bd2f04f2402b3543efd574a707caac0003dd682909db87da286173e771"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Rhynedahll Software LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "65:1f:3e:5b:49:1b:19:7d:20:c4:9b:9c:7b:25:b7:75"
      cert_thumbprint     = "97A037320A2AC3A7C4A41FA7B53AFC6EC886450B"
      cert_valid_from     = "2023-05-04"
      cert_valid_to       = "2024-05-03"

      country             = "US"
      state               = "Louisiana"
      locality            = "Doyline"
      email               = "???"
      rdn_serial_number   = "42115577K"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "65:1f:3e:5b:49:1b:19:7d:20:c4:9b:9c:7b:25:b7:75"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_66F965DEE2E387D6B5233CF39DFDE75F {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-18"
      version             = "1.0"

      hash                = "e16ef57ddac8cf1ab3b4b20e1915bd0790eb049aabff91f4576c883246914de4"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "BERCIS Software SIA"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "66:f9:65:de:e2:e3:87:d6:b5:23:3c:f3:9d:fd:e7:5f"
      cert_thumbprint     = "2894E68AA4B8AF304F6877D39A218214B458D71C"
      cert_valid_from     = "2024-07-18"
      cert_valid_to       = "2025-07-18"

      country             = "LV"
      state               = "???"
      locality            = "Riga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "66:f9:65:de:e2:e3:87:d6:b5:23:3c:f3:9d:fd:e7:5f"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_726DC2955912DC0E6072B40690760BC3 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-11"
      version             = "1.0"

      hash                = "4ecd4fb56d55e34778d10c6a4c3a52531a76b4c3ec6d3436405a81ec87735843"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Brango ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "72:6d:c2:95:59:12:dc:0e:60:72:b4:06:90:76:0b:c3"
      cert_thumbprint     = "5411829A2D9416D61E323279F3AC86F4D78FF5AB"
      cert_valid_from     = "2024-01-11"
      cert_valid_to       = "2025-01-08"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Valby"
      email               = "???"
      rdn_serial_number   = "38181297"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "72:6d:c2:95:59:12:dc:0e:60:72:b4:06:90:76:0b:c3"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_SSL_com_76771B8BF57A621AF11F57CFB0285C88 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-06"
      version             = "1.0"

      hash                = "b8d481bfba169aa3d77b0c49cbb93d907417357d6db7ecdaa280623897c3ecec"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Satago Software Solutions Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "76:77:1b:8b:f5:7a:62:1a:f1:1f:57:cf:b0:28:5c:88"
      cert_thumbprint     = "AF9A758C6A97D52083416775446940321909433E"
      cert_valid_from     = "2024-09-06"
      cert_valid_to       = "2025-09-06"

      country             = "PL"
      state               = "Lesser Poland Voivodeship"
      locality            = "Kraków"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "76:77:1b:8b:f5:7a:62:1a:f1:1f:57:cf:b0:28:5c:88"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Sectigo_00BDB99D5ECF8271D48E35F1039C2160EF {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-07-09"
      version             = "1.0"

      hash                = "c8425cf994f02784d3f8eeb570b6ac1edc5876908b64b40b532e2534a84a19ad"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Gavrilov Andrei Alekseevich"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:bd:b9:9d:5e:cf:82:71:d4:8e:35:f1:03:9c:21:60:ef"
      cert_thumbprint     = "331F96A1A187723EAA5B72C9D0115C1C57F08B66"
      cert_valid_from     = "2019-07-09"
      cert_valid_to       = "2024-07-08"

      country             = "RU"
      state               = "Sankt-Peterburg"
      locality            = "Sankt-Peterburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:bd:b9:9d:5e:cf:82:71:d4:8e:35:f1:03:9c:21:60:ef"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Sectigo_15C5AF15AFECF1C900CBAB0CA9165629 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-03-20"
      version             = "1.0"

      hash                = "2ae575f006fc418c72a55ec5fdc26bc821aa3929114ee979b7065bf5072c488f"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Kompaniya Auttek"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "15:c5:af:15:af:ec:f1:c9:00:cb:ab:0c:a9:16:56:29"
      cert_thumbprint     = "69735EC138C555D9A0D410C450D8BCC7C222E104"
      cert_valid_from     = "2020-03-20"
      cert_valid_to       = "2021-03-20"

      country             = "RU"
      state               = "Sankt-Peterburg"
      locality            = "Sankt-Peterburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "15:c5:af:15:af:ec:f1:c9:00:cb:ab:0c:a9:16:56:29"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Sectigo_2924785FD7990B2D510675176DAE2BED {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-14"
      version             = "1.0"

      hash                = "68313d4b45cc908f541dd581d7b9d1e8ccadcbf205714c12c36b58083ada7345"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Neoopt LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "29:24:78:5f:d7:99:0b:2d:51:06:75:17:6d:ae:2b:ed"
      cert_thumbprint     = "71FC852FFCC92F6ED54CF703BB825E084410878C"
      cert_valid_from     = "2020-07-14"
      cert_valid_to       = "2021-07-14"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "29:24:78:5f:d7:99:0b:2d:51:06:75:17:6d:ae:2b:ed"
      )
}

rule MAL_Compromised_Cert_NetSupport_RAT_Sectigo_333705C20B56E57F60B5EB191EEF0D90 {
   meta:
      description         = "Detects NetSupport RAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-10"
      version             = "1.0"

      hash                = "2bc947ba8cdd40b69936dbe365357961bdc99eb38fe999d9b906d10c5325a10e"
      malware             = "NetSupport RAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "TASK Holding ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "33:37:05:c2:0b:56:e5:7f:60:b5:eb:19:1e:ef:0d:90"
      cert_thumbprint     = "44F0F77D8B649579FA6F88AE9FA4B4206B90B120"
      cert_valid_from     = "2021-09-10"
      cert_valid_to       = "2022-09-11"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "33:37:05:c2:0b:56:e5:7f:60:b5:eb:19:1e:ef:0d:90"
      )
}

rule MAL_Compromised_Cert_NetSupport_SSL_com_0CC645E9075DEE38345BE490179177DC {
   meta:
      description         = "Detects NetSupport with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-24"
      version             = "1.0"

      hash                = "3a0fc4f5955096ced2382800e3c11da5244279307db7b5371a2295692b862367"
      malware             = "NetSupport"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "Kačina Software s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "0c:c6:45:e9:07:5d:ee:38:34:5b:e4:90:17:91:77:dc"
      cert_thumbprint     = "C516B5CDADB9BDA44DCD9DE12266FC00AACF0223"
      cert_valid_from     = "2025-01-24"
      cert_valid_to       = "2026-01-24"

      country             = "CZ"
      state               = "Středočeský kraj"
      locality            = "Kolín"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "0c:c6:45:e9:07:5d:ee:38:34:5b:e4:90:17:91:77:dc"
      )
}

rule MAL_Compromised_Cert_NetSupport_SSL_com_7D3C1B5030F422BB6B1C72A2E4B3E7BE {
   meta:
      description         = "Detects NetSupport with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-25"
      version             = "1.0"

      hash                = "0a827cc64b4a5c0c3199322b59681f69502ce365fdc5f97d30dda1d5f505775a"
      malware             = "NetSupport"
      malware_type        = "Remote access tool"
      malware_notes       = "This is a weaponised Remote Management and monitoring tool."

      signer              = "BI-TEST, OSOO"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7d:3c:1b:50:30:f4:22:bb:6b:1c:72:a2:e4:b3:e7:be"
      cert_thumbprint     = "EA07FAF24DBE71EED89946698E901DA4BFE3E820"
      cert_valid_from     = "2025-03-25"
      cert_valid_to       = "2026-03-25"

      country             = "KG"
      state               = "???"
      locality            = "Bishkek"
      email               = "???"
      rdn_serial_number   = "31548832"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7d:3c:1b:50:30:f4:22:bb:6b:1c:72:a2:e4:b3:e7:be"
      )
}

rule MAL_Compromised_Cert_NetWire_DigiCert_0DED332027907F50BE1B7FF42BE59AA5 {
   meta:
      description         = "Detects NetWire with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-28"
      version             = "1.0"

      hash                = "17a3a47fee308ff270af546a193a78a7328f43a1fa3bdaee5fdbd96f4bf6cbd4"
      malware             = "NetWire"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ORANGE VIEW LIMITED"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0d:ed:33:20:27:90:7f:50:be:1b:7f:f4:2b:e5:9a:a5"
      cert_thumbprint     = "7A08FEAD84E1823418798EEE3DA3B49B6115FA71"
      cert_valid_from     = "2020-11-28"
      cert_valid_to       = "2023-10-22"

      country             = "HK"
      state               = "???"
      locality            = "Kowloon"
      email               = "???"
      rdn_serial_number   = "2770852"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0d:ed:33:20:27:90:7f:50:be:1b:7f:f4:2b:e5:9a:a5"
      )
}

rule MAL_Compromised_Cert_NetWire_Sectigo_2D8CFCF04209DC7F771D8D18E462C35A {
   meta:
      description         = "Detects NetWire with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-13"
      version             = "1.0"

      hash                = "af27173ed576215bb06dab3a1526992ee1f8bd358a92d63ad0cfbc0325c70acf"
      malware             = "NetWire"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AA PLUS INVEST d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "2d:8c:fc:f0:42:09:dc:7f:77:1d:8d:18:e4:62:c3:5a"
      cert_thumbprint     = "A9C61E299634BA01E269239DE322FB85E2DA006B"
      cert_valid_from     = "2021-09-13"
      cert_valid_to       = "2022-09-13"

      country             = "SI"
      state               = "Maribor"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "2d:8c:fc:f0:42:09:dc:7f:77:1d:8d:18:e4:62:c3:5a"
      )
}

rule MAL_Compromised_Cert_NetWire_Sectigo_62205361A758B00572D417CBA014F007 {
   meta:
      description         = "Detects NetWire with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-05-21"
      version             = "1.0"

      hash                = "480e69a305098701404ab144ae64f297e342ca265309dfb7105bbc944aa31cae"
      malware             = "NetWire"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UNITEKH-S, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "62:20:53:61:a7:58:b0:05:72:d4:17:cb:a0:14:f0:07"
      cert_thumbprint     = "5AEBFEEF4BB5DC7AD5C51001A9CA52A309051D8A"
      cert_valid_from     = "2020-05-21"
      cert_valid_to       = "2021-05-21"

      country             = "RU"
      state               = "Novosibirskaya Obl"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "62:20:53:61:a7:58:b0:05:72:d4:17:cb:a0:14:f0:07"
      )
}

rule MAL_Compromised_Cert_Netfilim_Sectigo_00C04F5D17AF872CB2C37E3367FE761D0D {
   meta:
      description         = "Detects Netfilim with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-12"
      version             = "1.0"

      hash                = "0bafde9b22d7147de8fdb852bcd529b1730acddc9eb71316b66c180106f777f5"
      malware             = "Netfilim"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DES SP Z O O"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c0:4f:5d:17:af:87:2c:b2:c3:7e:33:67:fe:76:1d:0d"
      cert_thumbprint     = "255B36617C0D1C0AFF3B819CE9DC2CD0F0A67A8A"
      cert_valid_from     = "2020-07-12"
      cert_valid_to       = "2021-07-12"

      country             = "PL"
      state               = "???"
      locality            = "Krakow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c0:4f:5d:17:af:87:2c:b2:c3:7e:33:67:fe:76:1d:0d"
      )
}

rule MAL_Compromised_Cert_NitrogenLoader_GlobalSign_55BBAE7D7C8BCC0026AADD4C {
   meta:
      description         = "Detects NitrogenLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-17"
      version             = "1.0"

      hash                = "c8e04a01432e56f1d9290f828f54cc683c50bfe656cf69e28549279df2b54c38"
      malware             = "NitrogenLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MAKENI LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "55:bb:ae:7d:7c:8b:cc:00:26:aa:dd:4c"
      cert_thumbprint     = "25263D4932AEADBDCD36677100383D13D6A7312A"
      cert_valid_from     = "2025-02-17"
      cert_valid_to       = "2026-02-18"

      country             = "KE"
      state               = "Kitui"
      locality            = "Kitui"
      email               = "???"
      rdn_serial_number   = "CPR/2015/200478"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "55:bb:ae:7d:7c:8b:cc:00:26:aa:dd:4c"
      )
}

rule MAL_Compromised_Cert_Numando_Sectigo_00F6AD45188E5566AA317BE23B4B8B2C2F {
   meta:
      description         = "Detects Numando with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-22"
      version             = "1.0"

      hash                = "b535f3c56749c532d29440fc0a446e3d5a46c294996af8c2992273e2499222e0"
      malware             = "Numando"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gary Kramlich"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f6:ad:45:18:8e:55:66:aa:31:7b:e2:3b:4b:8b:2c:2f"
      cert_thumbprint     = "ADFA744AA074FB5DC57EE6445A3E18D606C7BF96"
      cert_valid_from     = "2021-03-22"
      cert_valid_to       = "2024-03-21"

      country             = "US"
      state               = "Wisconsin"
      locality            = "MILWAUKEE"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f6:ad:45:18:8e:55:66:aa:31:7b:e2:3b:4b:8b:2c:2f"
      )
}

rule MAL_Compromised_Cert_Octowave_Loader_Certum_6E84423B5FF541764F3ECA7100B06D17 {
   meta:
      description         = "Detects Octowave Loader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-02"
      version             = "1.0"

      hash                = "9ad4274d21feed404714b504eb3a076745e0250a9e62dfdb2615b5614eb9287e"
      malware             = "Octowave Loader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LeYao Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6e:84:42:3b:5f:f5:41:76:4f:3e:ca:71:00:b0:6d:17"
      cert_thumbprint     = "C5D93C655202104525F207C9B101B00C330481B7"
      cert_valid_from     = "2024-12-02"
      cert_valid_to       = "2025-12-02"

      country             = "CN"
      state               = "Hebei"
      locality            = "Qinhuangdao"
      email               = "???"
      rdn_serial_number   = "91130302MA0G33CQ5Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6e:84:42:3b:5f:f5:41:76:4f:3e:ca:71:00:b0:6d:17"
      )
}

rule MAL_Compromised_Cert_Odyssey_Stealer_Apple_6B8C696E62836AC7 {
   meta:
      description         = "Detects Odyssey Stealer with compromised cert (Apple)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-10"
      version             = "1.0"

      hash                = "a031ba8111ded0c11acfedea9ab83b4be8274584da71bcc88ff72e2d51957dd7"
      malware             = "Odyssey Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THOMAS BOULAY DUVAL"
      cert_issuer_short   = "Apple"
      cert_issuer         = "Apple Inc."
      cert_serial         = "6b:8c:69:6e:62:83:6a:c7"
      cert_thumbprint     = "FE168DBB8B78694EF58D02CE89D50B30DF6CE82D"
      cert_valid_from     = "2025-09-10"
      cert_valid_to       = "2027-02-01"

      country             = "---"
      state               = "---"
      locality            = "---"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Apple Inc." and
         sig.serial == "6b:8c:69:6e:62:83:6a:c7"
      )
}

rule MAL_Compromised_Cert_Odyssey_Stealer_Apple_7EA0BCC77567E8B1 {
   meta:
      description         = "Detects Odyssey Stealer with compromised cert (Apple)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-15"
      version             = "1.0"

      hash                = "22840ea54fe4dd3608a8815e72b8c1d2632ff054472e1dde1e56de676e63d07c"
      malware             = "Odyssey Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Alina Balaban"
      cert_issuer_short   = "Apple"
      cert_issuer         = "Apple Inc."
      cert_serial         = "7e:a0:bc:c7:75:67:e8:b1"
      cert_thumbprint     = "3306A2C6130B04B1E18ECBF9BE5CFCDF697C32C4"
      cert_valid_from     = "2025-07-15"
      cert_valid_to       = "2027-02-01"

      country             = "---"
      state               = "---"
      locality            = "---"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Apple Inc." and
         sig.serial == "7e:a0:bc:c7:75:67:e8:b1"
      )
}

rule MAL_Compromised_Cert_Odyssey_Stealer_Apple_D2A0EC47605756 {
   meta:
      description         = "Detects Odyssey Stealer with compromised cert (Apple)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-30"
      version             = "1.0"

      hash                = "8bfdd239da6948b4903a92287cd6e15f86d96187c36ed75e796d99adcc09f66f"
      malware             = "Odyssey Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Amjadi Khalaily"
      cert_issuer_short   = "Apple"
      cert_issuer         = "Apple Inc."
      cert_serial         = "d2:a0:ec:47:60:57:56"
      cert_thumbprint     = "EFF0E776FF8EFC64D969058F4253E2BDCFC0B1D5"
      cert_valid_from     = "2025-06-30"
      cert_valid_to       = "2027-02-01"

      country             = "-"
      state               = "-"
      locality            = "-"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Apple Inc." and
         sig.serial == "d2:a0:ec:47:60:57:56"
      )
}

rule MAL_Compromised_Cert_OneStart_Adware_GlobalSign_7209B6BCFD61AFA5A476DBF0 {
   meta:
      description         = "Detects OneStart Adware with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-10"
      version             = "1.0"

      hash                = "7ae44a0606e74fa34cde274a0ed05b899992a9cda60124e8c60403774c7206bc"
      malware             = "OneStart Adware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Apollo Technologies Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "72:09:b6:bc:fd:61:af:a5:a4:76:db:f0"
      cert_thumbprint     = "B515DF656EE4C27ED1F9FEBC2CE6F9756E6F023B"
      cert_valid_from     = "2024-05-10"
      cert_valid_to       = "2027-05-11"

      country             = "PA"
      state               = "Panama"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155722923"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "72:09:b6:bc:fd:61:af:a5:a4:76:db:f0"
      )
}

rule MAL_Compromised_Cert_OneStart_Adware_SSL_com_7DE8123E2B4CB350291ED602EDBC4592 {
   meta:
      description         = "Detects OneStart Adware with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-28"
      version             = "1.0"

      hash                = "469960964daf6666231f379604cb0cbd536b277bdb595c7ded9e8147278ba5ea"
      malware             = "OneStart Adware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Apollo Technologies Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7d:e8:12:3e:2b:4c:b3:50:29:1e:d6:02:ed:bc:45:92"
      cert_thumbprint     = "EB5A7872B0563D261362F00BC6AF0AFC36877A89"
      cert_valid_from     = "2023-07-28"
      cert_valid_to       = "2026-07-25"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155722923"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7d:e8:12:3e:2b:4c:b3:50:29:1e:d6:02:ed:bc:45:92"
      )
}

rule MAL_Compromised_Cert_OneStart_DigiCert_09561E1A16C2BE16570AC674712B56F1 {
   meta:
      description         = "Detects OneStart with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-16"
      version             = "1.0"

      hash                = "5e1689ca04778ff0c5764abc50b023bd71b9ab7841a40f425c5fee4b798f8e11"
      malware             = "OneStart"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OneStart Technologies LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "09:56:1e:1a:16:c2:be:16:57:0a:c6:74:71:2b:56:f1"
      cert_thumbprint     = "612DE79A0369AFF3507DEF7A39DF2F4F7A82E51D"
      cert_valid_from     = "2025-05-16"
      cert_valid_to       = "2026-03-18"

      country             = "US"
      state               = "Delaware"
      locality            = "Dover"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "09:56:1e:1a:16:c2:be:16:57:0a:c6:74:71:2b:56:f1"
      )
}

rule MAL_Compromised_Cert_OneStart_SSL_com_0FEC8600AC121FCB227A54B52A49C46E {
   meta:
      description         = "Detects OneStart with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-04"
      version             = "1.0"

      hash                = "c571c75b1878c02f801ef1e953176c1e7db1ca2c9809811637a44e5a98d228cd"
      malware             = "OneStart"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Caerus Media LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0f:ec:86:00:ac:12:1f:cb:22:7a:54:b5:2a:49:c4:6e"
      cert_thumbprint     = "93D7CCF32FDAC1FAAD0BA923E56FA8DAFEE2B352"
      cert_valid_from     = "2024-09-04"
      cert_valid_to       = "2025-09-04"

      country             = "US"
      state               = "Delaware"
      locality            = "Dover"
      email               = "???"
      rdn_serial_number   = "6125248"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0f:ec:86:00:ac:12:1f:cb:22:7a:54:b5:2a:49:c4:6e"
      )
}

rule MAL_Compromised_Cert_OneStart_SSL_com_2834C87E4445D1B6FF560A24D7F3E0AC {
   meta:
      description         = "Detects OneStart with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-06"
      version             = "1.0"

      hash                = "058a6c5a7dd6037265cc8a756d6b04bad9fb11b040560db159bc6125372a0001"
      malware             = "OneStart"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Onestart Technologies LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "28:34:c8:7e:44:45:d1:b6:ff:56:0a:24:d7:f3:e0:ac"
      cert_thumbprint     = "AD2349D7E79F21E3BC073DCB79B4D7ED38BAB7A8"
      cert_valid_from     = "2025-03-06"
      cert_valid_to       = "2026-03-06"

      country             = "US"
      state               = "Delaware"
      locality            = "Dover"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "28:34:c8:7e:44:45:d1:b6:ff:56:0a:24:d7:f3:e0:ac"
      )
}

rule MAL_Compromised_Cert_OnionProxy_SSL_com_35B1041EC0C7C7181DCC7339D1094981 {
   meta:
      description         = "Detects OnionProxy with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-06"
      version             = "1.0"

      hash                = "a7480fac99ee466a2c14393464dd84e10f8362910796d73122674d7e87ce8499"
      malware             = "OnionProxy"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Creditamore Software"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "35:b1:04:1e:c0:c7:c7:18:1d:cc:73:39:d1:09:49:81"
      cert_thumbprint     = "4AD468065B72D16C3C2100F5ED115A61EBE9993C"
      cert_valid_from     = "2025-02-06"
      cert_valid_to       = "2026-02-06"

      country             = "FR"
      state               = "Île-de-France"
      locality            = "Paris"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "35:b1:04:1e:c0:c7:c7:18:1d:cc:73:39:d1:09:49:81"
      )
}

rule MAL_Compromised_Cert_Onyx_RMM_SSL_com_7301BD775D3E4DC6539B217A2C3CB137 {
   meta:
      description         = "Detects Onyx RMM with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-03"
      version             = "1.0"

      hash                = "1fd040c91b03f71d5a120f3c6b696da441d8424ba6f874991f5e7f1b014beb65"
      malware             = "Onyx RMM"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CHRISSY'S CREDIBLE CLEANING LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "73:01:bd:77:5d:3e:4d:c6:53:9b:21:7a:2c:3c:b1:37"
      cert_thumbprint     = "CDE577D14506EA213ED20C15014336586F3B18A3"
      cert_valid_from     = "2025-09-03"
      cert_valid_to       = "2026-09-03"

      country             = "US"
      state               = "Florida"
      locality            = "Cape Coral"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "73:01:bd:77:5d:3e:4d:c6:53:9b:21:7a:2c:3c:b1:37"
      )
}

rule MAL_Compromised_Cert_Onyx_RMM_Sectigo_00C33C5E2FDC570E323B8EB3789C68B016 {
   meta:
      description         = "Detects Onyx RMM with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-07"
      version             = "1.0"

      hash                = "566a38f3244e8bb54ae80feb54928e39868f84ce838378e4f984eafbcf64a84f"
      malware             = "Onyx RMM"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chrissy's Credible Cleaning LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:c3:3c:5e:2f:dc:57:0e:32:3b:8e:b3:78:9c:68:b0:16"
      cert_thumbprint     = "862937CFE306D2A83C146744AB6BE23A7F744977"
      cert_valid_from     = "2025-11-07"
      cert_valid_to       = "2026-11-07"

      country             = "US"
      state               = "Florida"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:c3:3c:5e:2f:dc:57:0e:32:3b:8e:b3:78:9c:68:b0:16"
      )
}

rule MAL_Compromised_Cert_Onyx_RMM_Sectigo_06F88E55252FF3342C6C47004DD8022A {
   meta:
      description         = "Detects Onyx RMM with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-06"
      version             = "1.0"

      hash                = "bd12c6d8caeb7e4a473c37878435e812db9a379b435ac1aa66b41e1036eb02eb"
      malware             = "Onyx RMM"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CHRISSY'S CREDIBLE CLEANING LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "06:f8:8e:55:25:2f:f3:34:2c:6c:47:00:4d:d8:02:2a"
      cert_thumbprint     = "D181F621AE2CBD299592A7DCE1AB4C4E9A9E9364"
      cert_valid_from     = "2025-10-06"
      cert_valid_to       = "2026-10-06"

      country             = "US"
      state               = "Florida"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "06:f8:8e:55:25:2f:f3:34:2c:6c:47:00:4d:d8:02:2a"
      )
}

rule MAL_Compromised_Cert_Osiris_Sectigo_00FA3DCAC19B884B44EF4F81541184D6B0 {
   meta:
      description         = "Detects Osiris with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-27"
      version             = "1.0"

      hash                = "bf9eb06db25ea1d3138b8e19a18d248df56a04200f9e54edfed850d018d2bb62"
      malware             = "Osiris"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Unicom Ltd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:fa:3d:ca:c1:9b:88:4b:44:ef:4f:81:54:11:84:d6:b0"
      cert_thumbprint     = "465E3197DA655543D29216A906BA3913B76A27B7"
      cert_valid_from     = "2020-10-27"
      cert_valid_to       = "2021-10-27"

      country             = "RU"
      state               = "???"
      locality            = "Omsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:fa:3d:ca:c1:9b:88:4b:44:ef:4f:81:54:11:84:d6:b0"
      )
}

rule MAL_Compromised_Cert_Ousaban_GlobalSign_0B98FD483EA0DD6E7C6A6317 {
   meta:
      description         = "Detects Ousaban with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-13"
      version             = "1.0"

      hash                = "40c708f5f85591eab36738ba4df9c46b296bd417bec2c4f5fabfc27b7b5fb317"
      malware             = "Ousaban"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PAGAMENTOS DIGITAIS LTDA"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0b:98:fd:48:3e:a0:dd:6e:7c:6a:63:17"
      cert_thumbprint     = "19baf25862979bc0c7cb3971187128986beb6db4a4c6986b452a286850e570b0"
      cert_valid_from     = "2024-12-13"
      cert_valid_to       = "2025-12-14"

      country             = "BR"
      state               = "PARAIBA"
      locality            = "JOAO PESSOA"
      email               = "pagamentosdigitaais@gmail.com"
      rdn_serial_number   = "55.972.702/0001-29"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0b:98:fd:48:3e:a0:dd:6e:7c:6a:63:17"
      )
}

rule MAL_Compromised_Cert_OysterLoader_DigiCert_05E4DF61BA3ED3493ACC12C5AAF7F04B {
   meta:
      description         = "Detects OysterLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-06"
      version             = "1.0"

      hash                = "cc1dae253b72906cfe2e89c278ab45a9ccc63567919373de7600783a05dd6d0a"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "SWS SOFT SRL"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:e4:df:61:ba:3e:d3:49:3a:cc:12:c5:aa:f7:f0:4b"
      cert_thumbprint     = "A4D933F8396BE233E86F7F09D4312DAD5F55C3EE"
      cert_valid_from     = "2024-12-06"
      cert_valid_to       = "2025-12-05"

      country             = "MD"
      state               = "???"
      locality            = "Chişinău"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:e4:df:61:ba:3e:d3:49:3a:cc:12:c5:aa:f7:f0:4b"
      )
}

rule MAL_Compromised_Cert_OysterLoader_DigiCert_0ED7F77844A2FA7D73F285219EE1A519 {
   meta:
      description         = "Detects OysterLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-28"
      version             = "1.0"

      hash                = "0e68c2fc400036eb279460e37953b1f9db393c6cb8c604ec0504e9de1866ab1c"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "AQUA TRACKSIDE LTD"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0e:d7:f7:78:44:a2:fa:7d:73:f2:85:21:9e:e1:a5:19"
      cert_thumbprint     = "9B841C0D6745420D3902B51938A5C675B21FAB19"
      cert_valid_from     = "2025-10-28"
      cert_valid_to       = "2026-10-27"

      country             = "GB"
      state               = "???"
      locality            = "Skelmersdale"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0e:d7:f7:78:44:a2:fa:7d:73:f2:85:21:9e:e1:a5:19"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_04CF28D1A98360DF407FBED6 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-06"
      version             = "1.0"

      hash                = "777bc86e3796d5d470950d84be16d51fd4e7b9c644cb95fd3db915fc53f5f80e"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC NOVOTEK"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "04:cf:28:d1:a9:83:60:df:40:7f:be:d6"
      cert_thumbprint     = "A774E9D46CB669A2566C340D343C305AA8D8A8F2"
      cert_valid_from     = "2025-10-06"
      cert_valid_to       = "2026-07-17"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "04:cf:28:d1:a9:83:60:df:40:7f:be:d6"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_0E937B1ED66ECC467E3A3714 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-01"
      version             = "1.0"

      hash                = "abb0e6628c891bcd8ed54bf08790718eeb0c7a44f157d28ced18adfebe4dce21"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Pili-Sverli"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0e:93:7b:1e:d6:6e:cc:46:7e:3a:37:14"
      cert_thumbprint     = "C834CA98AC7C7B848EEEC6A633E0F54B87B6E286"
      cert_valid_from     = "2025-10-01"
      cert_valid_to       = "2026-05-31"

      country             = "RU"
      state               = "Novosibirsk Oblast"
      locality            = "Elitny"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0e:93:7b:1e:d6:6e:cc:46:7e:3a:37:14"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_14DE6008EE49B48E31CDA252 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "a8e9f0da26a3d6729e744a6ea566c4fd4e372ceb4b2e7fc01d08844bfc5c3abb"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Infomed22"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "14:de:60:08:ee:49:b4:8e:31:cd:a2:52"
      cert_thumbprint     = "12CFA8824939504311DA5F35A52A16743199FB1E"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2026-07-04"

      country             = "RU"
      state               = "Republic of Bashkortostan"
      locality            = "Ishimbay"
      email               = "???"
      rdn_serial_number   = "1220200021557"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "14:de:60:08:ee:49:b4:8e:31:cd:a2:52"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_2ADE428D4873792ACB86F867 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-21"
      version             = "1.0"

      hash                = "d57f995e5e7806cad3e8e6d54fc090e8f32a9f4a2e05afe725acf9e762dab575"
      malware             = "OysterLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "E.M.Z.A. GROUP MARKETING & DISTRIBUTION LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2a:de:42:8d:48:73:79:2a:cb:86:f8:67"
      cert_thumbprint     = "C96359CCCC307FABD56CE17AB05DB2E599A9DD7A"
      cert_valid_from     = "2025-11-21"
      cert_valid_to       = "2026-11-22"

      country             = "IL"
      state               = "Judea And Samaria"
      locality            = "Beitar Illit"
      email               = "???"
      rdn_serial_number   = "513845909"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2a:de:42:8d:48:73:79:2a:cb:86:f8:67"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_307E841F5277C970CEA18C01 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-14"
      version             = "1.0"

      hash                = "9d669404f58ee1437e23ea74e3565a7d445142e0a428d3add6e633b691426e08"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "S.N. ADVANCED SEWERAGE SOLUTIONS LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "30:7e:84:1f:52:77:c9:70:ce:a1:8c:01"
      cert_thumbprint     = "CBBD6817F60B3746069D18C4BAD9761B5E7D57AA"
      cert_valid_from     = "2025-11-14"
      cert_valid_to       = "2026-11-15"

      country             = "IL"
      state               = "Central District"
      locality            = "Kiryat Ekron"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "30:7e:84:1f:52:77:c9:70:ce:a1:8c:01"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_389C4A5BD8B84886ADAFD32C {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-23"
      version             = "1.0"

      hash                = "6b3e43c17908ee10944c2453983444da0f0242eac47534d0fb6111a03df0c66c"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Stroy-Vertical"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:9c:4a:5b:d8:b8:48:86:ad:af:d3:2c"
      cert_thumbprint     = "0A0D669E3899C3E8CF8ADEFB56B827DE0F052876"
      cert_valid_from     = "2025-04-23"
      cert_valid_to       = "2026-04-24"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:9c:4a:5b:d8:b8:48:86:ad:af:d3:2c"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GlobalSign_569587BA554EAD2539616B50 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "455979f3887f9ce119d56291df97dd71a3760676b498689e68495f329489e886"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Aktivstroy"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:95:87:ba:55:4e:ad:25:39:61:6b:50"
      cert_thumbprint     = "49137F18750BF8CE41A7F0C95982048AA693406F"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2026-07-04"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1157746898902"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:95:87:ba:55:4e:ad:25:39:61:6b:50"
      )
}

rule MAL_Compromised_Cert_OysterLoader_GoGetSSL_0CD398F0C19E99E5A5CD1CCB63D49059 {
   meta:
      description         = "Detects OysterLoader with compromised cert (GoGetSSL)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-13"
      version             = "1.0"

      hash                = "4631309051a5943e92656a421a01f79132f47b0367462ee1b9c50f56ab38e04f"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Soft Furniture OÜ"
      cert_issuer_short   = "GoGetSSL"
      cert_issuer         = "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1"
      cert_serial         = "0c:d3:98:f0:c1:9e:99:e5:a5:cd:1c:cb:63:d4:90:59"
      cert_thumbprint     = "B67606F36E62A50B04422AE9BDE3F2E24D57726B"
      cert_valid_from     = "2025-02-13"
      cert_valid_to       = "2026-02-12"

      country             = "EE"
      state               = "???"
      locality            = "Tallinn"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1" and
         sig.serial == "0c:d3:98:f0:c1:9e:99:e5:a5:cd:1c:cb:63:d4:90:59"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_330004A21E6A9A01E65912C57200000004A21E {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-03"
      version             = "1.0"

      hash                = "a3b858014d60eaa5b356b7e707a263d98b111b53835ae326cd4e0fb19e7f5b35"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Nitta-Lai Investment Corp."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:a2:1e:6a:9a:01:e6:59:12:c5:72:00:00:00:04:a2:1e"
      cert_thumbprint     = "082EF59E74FC9AAC0A61CAAF9318A562562BB33E"
      cert_valid_from     = "2025-10-03"
      cert_valid_to       = "2025-10-06"

      country             = "CA"
      state               = "Ontario"
      locality            = "Etobicoke"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:a2:1e:6a:9a:01:e6:59:12:c5:72:00:00:00:04:a2:1e"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_330004BE507DF668D35C53F0C500000004BE50 {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-10"
      version             = "1.0"

      hash                = "f79ca66eba8c25d4e96b5afafbe1299c0d1e73816c6668df827776ad8362a5de"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "ECHO PADDLES INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:be:50:7d:f6:68:d3:5c:53:f0:c5:00:00:00:04:be:50"
      cert_thumbprint     = "7DA67F4A21734AFA39F1DE8EA2C21823773530C3"
      cert_valid_from     = "2025-10-10"
      cert_valid_to       = "2025-10-13"

      country             = "CA"
      state               = "Québec"
      locality            = "Wakefield"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:be:50:7d:f6:68:d3:5c:53:f0:c5:00:00:00:04:be:50"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_3300050DC76B5EAA3EBF6729AB000000050DC7 {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-28"
      version             = "1.0"

      hash                = "a9522fbe86712f17679ad5d900408cb1258886896c219bd647253ef54c36648a"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "INDIANA PROPERTY RIGHTS ALLIANCE, INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:0d:c7:6b:5e:aa:3e:bf:67:29:ab:00:00:00:05:0d:c7"
      cert_thumbprint     = "B1C1B565F1B670A6D1BB4FA9173FCD85BAFC6639"
      cert_valid_from     = "2025-10-28"
      cert_valid_to       = "2025-10-31"

      country             = "US"
      state               = "Indiana"
      locality            = "Indianapolis"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:0d:c7:6b:5e:aa:3e:bf:67:29:ab:00:00:00:05:0d:c7"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_330005700A78B0BEC32F1C809F00000005700A {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-25"
      version             = "1.0"

      hash                = "c4f0350f6f55708fbb52cb853b1f9951856b1e1579e9a67f9dff11361f64b2f4"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:70:0a:78:b0:be:c3:2f:1c:80:9f:00:00:00:05:70:0a"
      cert_thumbprint     = "5029EEA156DDEE45A62209311B7C8CB71CB1EE58"
      cert_valid_from     = "2025-11-25"
      cert_valid_to       = "2025-11-28"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:70:0a:78:b0:be:c3:2f:1c:80:9f:00:00:00:05:70:0a"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_33000579BB23E9DB7D00BF761A0000000579BB {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-26"
      version             = "1.0"

      hash                = "c48d1803b84e1da6cb53f0bd279376247fbb0ae1d32115c44ad29bdbccbb1b71"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LES LOGICIELS SYSTAMEX INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:79:bb:23:e9:db:7d:00:bf:76:1a:00:00:00:05:79:bb"
      cert_thumbprint     = "4A109720C3D9CAAD4A88A285AB058A1ACF1BF6A6"
      cert_valid_from     = "2025-11-26"
      cert_valid_to       = "2025-11-29"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Basile-le-Grand"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:79:bb:23:e9:db:7d:00:bf:76:1a:00:00:00:05:79:bb"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_3300059AE61DF12BC90C40CC42000000059AE6 {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-09"
      version             = "1.0"

      hash                = "fdfae96c3e943c16f7946d820598b2d205395fe7483b5b82e4a9903dc96c1eb1"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "ECHO PADDLES INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:9a:e6:1d:f1:2b:c9:0c:40:cc:42:00:00:00:05:9a:e6"
      cert_thumbprint     = "2CFA6A828A11EC66ED4CD86DF73D25B139A42EED"
      cert_valid_from     = "2025-10-09"
      cert_valid_to       = "2025-10-12"

      country             = "CA"
      state               = "Québec"
      locality            = "Wakefield"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:9a:e6:1d:f1:2b:c9:0c:40:cc:42:00:00:00:05:9a:e6"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_3300059D7CA689D296AEAC9E1D000000059D7C {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-26"
      version             = "1.0"

      hash                = "ac5065a351313cc522ab6004b98578a2704d2f636fc2ca78764ab239f4f594a3"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "NRM NETWORK RISK MANAGEMENT INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:9d:7c:a6:89:d2:96:ae:ac:9e:1d:00:00:00:05:9d:7c"
      cert_thumbprint     = "3842E79F105D3BEBD83FD737FFE9A2F11B920FA4"
      cert_valid_from     = "2025-09-26"
      cert_valid_to       = "2025-09-29"

      country             = "CA"
      state               = "Ontario"
      locality            = "MISSISSAUGA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:9d:7c:a6:89:d2:96:ae:ac:9e:1d:00:00:00:05:9d:7c"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_330005D52D7502E06772B1B3E100000005D52D {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-30"
      version             = "1.0"

      hash                = "637c9408e573f1173b40a51a8b4dac0632723da2cc8dee816dc8134c07785c90"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Management Performance Auto Service Ltd."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:d5:2d:75:02:e0:67:72:b1:b3:e1:00:00:00:05:d5:2d"
      cert_thumbprint     = "4030C41170A40253C55A6202D7B724E13CBAB1A1"
      cert_valid_from     = "2025-10-30"
      cert_valid_to       = "2025-11-02"

      country             = "CA"
      state               = "Prince Edward Island"
      locality            = "Charlottetown"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:d5:2d:75:02:e0:67:72:b1:b3:e1:00:00:00:05:d5:2d"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_33000654E6E57454AFB42B53190000000654E6 {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-01"
      version             = "1.0"

      hash                = "326bec0147517a2735cba6dc1604d538f33cbc5ad82a3cf24585a00940bada0f"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = ""

      signer              = "HARTMANN EXECUTIVE CONSULTING LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:54:e6:e5:74:54:af:b4:2b:53:19:00:00:00:06:54:e6"
      cert_thumbprint     = "B99804D9DE416FD030C20A62CA9C6DB1CBA6E4BB"
      cert_valid_from     = "2025-12-01"
      cert_valid_to       = "2025-12-04"

      country             = "US"
      state               = "New York"
      locality            = "MOUNT KISCO"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:54:e6:e5:74:54:af:b4:2b:53:19:00:00:00:06:54:e6"
      )
}

rule MAL_Compromised_Cert_OysterLoader_Microsoft_3300066515AC0ED03F9FD3F2E2000000066515 {
   meta:
      description         = "Detects OysterLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-23"
      version             = "1.0"

      hash                = "d869ef7d429c6c79bed369217e1b87b05236e35469b3d8264c775dd2dce5757b"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Reach First Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:65:15:ac:0e:d0:3f:9f:d3:f2:e2:00:00:00:06:65:15"
      cert_thumbprint     = "EDE64C2A0AA33D0B0043D6B443113611296F4806"
      cert_valid_from     = "2025-11-23"
      cert_valid_to       = "2025-11-26"

      country             = "CA"
      state               = "Alberta"
      locality            = "Edmonton"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:65:15:ac:0e:d0:3f:9f:d3:f2:e2:00:00:00:06:65:15"
      )
}

rule MAL_Compromised_Cert_OysterLoader_SSL_com_0268598BAEB054A09457D976E86EF28B {
   meta:
      description         = "Detects OysterLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-05"
      version             = "1.0"

      hash                = "0f680169d5eaab7cebda7b323c59518b31d70efe2a8a1b759f0698d5f918dd9d"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "BKM PROPERTY MANAGERS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "02:68:59:8b:ae:b0:54:a0:94:57:d9:76:e8:6e:f2:8b"
      cert_thumbprint     = "57D7488CD8482F410D004C73FDEB89838423E9D7"
      cert_valid_from     = "2025-09-05"
      cert_valid_to       = "2026-09-05"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "02:68:59:8b:ae:b0:54:a0:94:57:d9:76:e8:6e:f2:8b"
      )
}

rule MAL_Compromised_Cert_OysterLoader_SSL_com_13CEA619DDE4C2A434A8974E4AC18FB4 {
   meta:
      description         = "Detects OysterLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-04"
      version             = "1.0"

      hash                = "7c88fc26ab4abd3798d8e0c1de7d2bb8f05d73ea2a209b443f01681b3cfc624c"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "EOR SOFTWARE LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "13:ce:a6:19:dd:e4:c2:a4:34:a8:97:4e:4a:c1:8f:b4"
      cert_thumbprint     = "0D1E89918C49DFE5214DFC822AB676D2253849D4"
      cert_valid_from     = "2025-09-04"
      cert_valid_to       = "2026-09-04"

      country             = "GB"
      state               = "???"
      locality            = "Ipswich"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "13:ce:a6:19:dd:e4:c2:a4:34:a8:97:4e:4a:c1:8f:b4"
      )
}

rule MAL_Compromised_Cert_OysterLoader_SSL_com_5EC13F23067D4BC6F01883A00B32553B {
   meta:
      description         = "Detects OysterLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-26"
      version             = "1.0"

      hash                = "ada8654dcc9b01811e2e902e857d2b1960b5b58ac4f86b0b67147f5d8c6ca3a5"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Internet Hotspot"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:c1:3f:23:06:7d:4b:c6:f0:18:83:a0:0b:32:55:3b"
      cert_thumbprint     = "900F213D296D59E663C2474638C5E7E061124058"
      cert_valid_from     = "2025-09-26"
      cert_valid_to       = "2026-09-26"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:c1:3f:23:06:7d:4b:c6:f0:18:83:a0:0b:32:55:3b"
      )
}

rule MAL_Compromised_Cert_OysterLoader_SSL_com_6E4E1C0C8DAD20BF52B5928502824B49 {
   meta:
      description         = "Detects OysterLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-19"
      version             = "1.0"

      hash                = "1c9dfbc336b6b7a4ce7c101d51edd3f0a3fee7ed9fe79d634268486078c446d7"
      malware             = "OysterLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "SMI Consulting GmbH"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "6e:4e:1c:0c:8d:ad:20:bf:52:b5:92:85:02:82:4b:49"
      cert_thumbprint     = "1360EB62C6FA8E75299C2C8810CFA68E57F197E5"
      cert_valid_from     = "2025-08-19"
      cert_valid_to       = "2026-08-19"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "6e:4e:1c:0c:8d:ad:20:bf:52:b5:92:85:02:82:4b:49"
      )
}

rule MAL_Compromised_Cert_OysterLoader_stage2_GlobalSign_70B9F4AB48DE26204AD9129B {
   meta:
      description         = "Detects OysterLoader_stage2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-29"
      version             = "1.0"

      hash                = "8339392bded530e54115016e1a78b2f692a9c15a42f5f9c956de51f3f4aa1278"
      malware             = "OysterLoader_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Antek"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "70:b9:f4:ab:48:de:26:20:4a:d9:12:9b"
      cert_thumbprint     = "8EEA8EC2B67C2E0E5E79ABA355935DD69ED75E37"
      cert_valid_from     = "2025-09-29"
      cert_valid_to       = "2026-06-06"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "70:b9:f4:ab:48:de:26:20:4a:d9:12:9b"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_03401D78C301D8B05979084B {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-07"
      version             = "1.0"

      hash                = "d32b4924143948935a74f03ae921a4c2efa4a94848d49274208e7007c0102f73"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "BLUS CONSULTING LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "03:40:1d:78:c3:01:d8:b0:59:79:08:4b"
      cert_thumbprint     = "42FE654215B0D1046BDA7B5CD3A9B372449F9844"
      cert_valid_from     = "2025-08-07"
      cert_valid_to       = "2026-08-08"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "ceoblusconsulting@gmail.com"
      rdn_serial_number   = "AAS-4006"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "03:40:1d:78:c3:01:d8:b0:59:79:08:4b"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_14DE6008EE49B48E31CDA252 {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "3d22a974677164d6bd7166e521e96d07cd00c884b0aeacb5555505c6a62a1c26"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Infomed22"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "14:de:60:08:ee:49:b4:8e:31:cd:a2:52"
      cert_thumbprint     = "12CFA8824939504311DA5F35A52A16743199FB1E"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2026-07-04"

      country             = "RU"
      state               = "Republic of Bashkortostan"
      locality            = "Ishimbay"
      email               = "???"
      rdn_serial_number   = "1220200021557"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "14:de:60:08:ee:49:b4:8e:31:cd:a2:52"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_18F9B670AB6C08E2AA13B122 {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-07"
      version             = "1.0"

      hash                = "401e3fe6d27a438016a82c4bbc710dfca5ff3c8f533f5eadc7393ce4f1c2d498"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC MCD - Profile"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "18:f9:b6:70:ab:6c:08:e2:aa:13:b1:22"
      cert_thumbprint     = "03C6A12293856EC70A88A91E9DEF3224103B3262"
      cert_valid_from     = "2025-08-07"
      cert_valid_to       = "2026-04-24"

      country             = "RU"
      state               = "Moscow Oblast"
      locality            = "Khimki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "18:f9:b6:70:ab:6c:08:e2:aa:13:b1:22"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_20E91E269C6767BC49EB3D34 {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-08"
      version             = "1.0"

      hash                = "eb56b8c537a20ffcefa4140ab30a2b6ee009c531c6c9748935574b7b3d7f41b0"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Bi-Test Limited Liability Company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "20:e9:1e:26:9c:67:67:bc:49:eb:3d:34"
      cert_thumbprint     = "392603E3F1D066C037F300FFF8D777856218F8E3"
      cert_valid_from     = "2025-08-08"
      cert_valid_to       = "2026-03-14"

      country             = "KG"
      state               = "Bishkek"
      locality            = "Bishkek"
      email               = "zaharmurashev@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "20:e9:1e:26:9c:67:67:bc:49:eb:3d:34"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_387867714BEB47BED987CB83 {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-26"
      version             = "1.0"

      hash                = "2e34b7e186e2a40c25177b573981c5c817c104f91a58a93a2e1bd1a0bbfd596a"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Abris"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "38:78:67:71:4b:eb:47:be:d9:87:cb:83"
      cert_thumbprint     = "3C19819D63233B5D516B6D45F2FA8FC6A6EB7989"
      cert_valid_from     = "2025-06-26"
      cert_valid_to       = "2026-06-27"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "38:78:67:71:4b:eb:47:be:d9:87:cb:83"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_3C7F0B3E22B1572B71883C94 {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-06"
      version             = "1.0"

      hash                = "681c59113d3a87a0086716b91642258097dc4da809d76c5566d184783d3b6cd4"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Shanxi Jiusheng Tongtai Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3c:7f:0b:3e:22:b1:57:2b:71:88:3c:94"
      cert_thumbprint     = "B4335AA9A34670C139BAD65C3DF83CAAA5147BB1"
      cert_valid_from     = "2025-05-06"
      cert_valid_to       = "2026-05-07"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Jinzhong"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3c:7f:0b:3e:22:b1:57:2b:71:88:3c:94"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_3FAFE7EA5469C17A1069661F {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "a653b4f7f76ee8e6bd9ffa816c0a14dca2d591a84ee570d4b6245079064b5794"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Fortuna"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3f:af:e7:ea:54:69:c1:7a:10:69:66:1f"
      cert_thumbprint     = "CF22E3985849DD295571C535385019FA9559758C"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-26"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3f:af:e7:ea:54:69:c1:7a:10:69:66:1f"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_410DCFAE3DB2E499FD92C563 {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-11"
      version             = "1.0"

      hash                = "80c8a6ecd5619d137aa57ddf252ab5dc9044266fca87f3e90c5b7f3664c5142f"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "PROFTORG LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:0d:cf:ae:3d:b2:e4:99:fd:92:c5:63"
      cert_thumbprint     = "D8F9AD4881FAEDF9B2EB4983C321FF499DCB931F"
      cert_valid_from     = "2025-06-11"
      cert_valid_to       = "2026-06-12"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "proftorg.info@rambler.ru"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:0d:cf:ae:3d:b2:e4:99:fd:92:c5:63"
      )
}

rule MAL_Compromised_Cert_Oyster_GlobalSign_48CC67779AA54699C6B1D7FE {
   meta:
      description         = "Detects Oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-02"
      version             = "1.0"

      hash                = "b61b51ba6ad7f7fe6465093a7c3f3f10d1079159febe33efb26fd64fa80408f1"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Globalnerudpostavka"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "48:cc:67:77:9a:a5:46:99:c6:b1:d7:fe"
      cert_thumbprint     = "48D6D6529B0B98FD7CEAC4BF044519098ACE9213"
      cert_valid_from     = "2025-08-02"
      cert_valid_to       = "2026-04-11"

      country             = "RU"
      state               = "Moscow"
      locality            = "Kommunarka"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "48:cc:67:77:9a:a5:46:99:c6:b1:d7:fe"
      )
}

rule MAL_Compromised_Cert_Oyster_Latrodectus_Stage2_GlobalSign_104D1BFA90D93794EA361457 {
   meta:
      description         = "Detects Oyster_Latrodectus_Stage2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-06"
      version             = "1.0"

      hash                = "13b1d27bb1fa279da12934f1c219baf993b1170c57207d95c4a5aa258c402b6c"
      malware             = "Oyster_Latrodectus_Stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Nasta"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "10:4d:1b:fa:90:d9:37:94:ea:36:14:57"
      cert_thumbprint     = "610A4DAD49F7B559EC0C81A5610FA7E8D06F99BA"
      cert_valid_from     = "2025-10-06"
      cert_valid_to       = "2026-07-01"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "10:4d:1b:fa:90:d9:37:94:ea:36:14:57"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330003252AF2DC64B34CB7F7DB00000003252A {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-06"
      version             = "1.0"

      hash                = "daa4ca6b3a4d567eac51b70921a9d6254884477bf5454f966d0ef412c6f0e443"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "GALVIN & ASSOCIATES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:25:2a:f2:dc:64:b3:4c:b7:f7:db:00:00:00:03:25:2a"
      cert_thumbprint     = "802BB60E5A6C41D66D4BD76E5A62474BF2CBCDB7"
      cert_valid_from     = "2025-06-06"
      cert_valid_to       = "2025-06-09"

      country             = "US"
      state               = "New York"
      locality            = "NEW YORK"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:25:2a:f2:dc:64:b3:4c:b7:f7:db:00:00:00:03:25:2a"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_3300034227859130DB98A2AA4A000000034227 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "cd671cfa42714a6d517476add60690081a16a5c6abaacce25fcb9c5ddf41b7d3"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Micros in Action, Incorporated"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:42:27:85:91:30:db:98:a2:aa:4a:00:00:00:03:42:27"
      cert_thumbprint     = "10F1D072B41F68104AAD99659EE2F97E0D62F37A"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2025-06-13"

      country             = "US"
      state               = "North Carolina"
      locality            = "Mocksville"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:42:27:85:91:30:db:98:a2:aa:4a:00:00:00:03:42:27"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_3300034A49F250470438D14A33000000034A49 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "e9e5311fbf76eea22c42daa381074feecb745020db473184e6236f9a08816925"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Micros in Action, Incorporated"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:4a:49:f2:50:47:04:38:d1:4a:33:00:00:00:03:4a:49"
      cert_thumbprint     = "CF798CFDD81C09378349DC8A9331C144E3797CBE"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2025-06-15"

      country             = "US"
      state               = "North Carolina"
      locality            = "Mocksville"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:4a:49:f2:50:47:04:38:d1:4a:33:00:00:00:03:4a:49"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_33000373DA29C35A6AC0484D690000000373DA {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-28"
      version             = "1.0"

      hash                = "0ada29254a6f60816b648c8247d46f1eb122439137f93c91388da2c0d4586550"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "TOLEDO SOFTWARE LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:73:da:29:c3:5a:6a:c0:48:4d:69:00:00:00:03:73:da"
      cert_thumbprint     = "EE70CAA544AFDFF40ED83528B637A7651B3EAA3C"
      cert_valid_from     = "2025-06-28"
      cert_valid_to       = "2025-07-01"

      country             = "US"
      state               = "Ohio"
      locality            = "Toledo"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:73:da:29:c3:5a:6a:c0:48:4d:69:00:00:00:03:73:da"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330003808CC20DE933506ACB4F00000003808C {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-01"
      version             = "1.0"

      hash                = "eaebd963b1e8dc5d3bd53a4842401559700f3201cd6589870281ab5b1ab57af3"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Alternative Power Systems Solutions LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:80:8c:c2:0d:e9:33:50:6a:cb:4f:00:00:00:03:80:8c"
      cert_thumbprint     = "5E48471106CD3B222863E6A27B8C86F98DCE369A"
      cert_valid_from     = "2025-07-01"
      cert_valid_to       = "2025-07-04"

      country             = "US"
      state               = "Arizona"
      locality            = "Chandler"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:80:8c:c2:0d:e9:33:50:6a:cb:4f:00:00:00:03:80:8c"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330003F85E2BF6B2496DC329F000000003F85E {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-05"
      version             = "1.0"

      hash                = "dae9df9ce0f5286cfe871fda680e4de440c8444a44ceb434c28d5ccf786f5e8d"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "GALVIN & ASSOCIATES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:03:f8:5e:2b:f6:b2:49:6d:c3:29:f0:00:00:00:03:f8:5e"
      cert_thumbprint     = "F88EF64C0B48D03ACC8F4916A9331BF0B961AC85"
      cert_valid_from     = "2025-06-05"
      cert_valid_to       = "2025-06-08"

      country             = "US"
      state               = "New York"
      locality            = "NEW YORK"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:03:f8:5e:2b:f6:b2:49:6d:c3:29:f0:00:00:00:03:f8:5e"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330004081060BEC8220B100D8B000000040810 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-15"
      version             = "1.0"

      hash                = "0bcdbd79c13fc50955804d0f2666c878542157fc3d4987d18d13c72e9697209e"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "IceCube Software, Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:04:08:10:60:be:c8:22:0b:10:0d:8b:00:00:00:04:08:10"
      cert_thumbprint     = "98FF3C03623F77A5A43D4C32A39A1CBE9DF42DD7"
      cert_valid_from     = "2025-06-15"
      cert_valid_to       = "2025-06-18"

      country             = "US"
      state               = "North Carolina"
      locality            = "Davidson"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:04:08:10:60:be:c8:22:0b:10:0d:8b:00:00:00:04:08:10"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330004293537896BFB9C5AFFF6000000042935 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-27"
      version             = "1.0"

      hash                = "51c85e40fb4f5bc3fd872261ffef181485791e2ffbe84ab96227461040a1ca4d"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "TOLEDO SOFTWARE LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:04:29:35:37:89:6b:fb:9c:5a:ff:f6:00:00:00:04:29:35"
      cert_thumbprint     = "AA330263723DDE937F070D2018F29DB7EE05E9B4"
      cert_valid_from     = "2025-06-27"
      cert_valid_to       = "2025-06-30"

      country             = "US"
      state               = "Ohio"
      locality            = "Toledo"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:04:29:35:37:89:6b:fb:9c:5a:ff:f6:00:00:00:04:29:35"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_3300043B67E4F8C74D2C120775000000043B67 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "dd995934bdab89ca6941633dea1ef6e6d9c3982af5b454ecb0a6c440032b30fb"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "NEW VISION MARKETING LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:04:3b:67:e4:f8:c7:4d:2c:12:07:75:00:00:00:04:3b:67"
      cert_thumbprint     = "51BB5BAEB3D293332FAB7E9A4CC23F406AFB0D94"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2025-06-28"

      country             = "US"
      state               = "Arizona"
      locality            = "Mesa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:04:3b:67:e4:f8:c7:4d:2c:12:07:75:00:00:00:04:3b:67"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330004716107E4C6AFE2950F49000000047161 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-23"
      version             = "1.0"

      hash                = "32b0f69e2d046cb835060751fcda28b633cbbd964e6e54dbbc1482fff4d51b57"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "KUTTANADAN CREATIONS INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:71:61:07:e4:c6:af:e2:95:0f:49:00:00:00:04:71:61"
      cert_thumbprint     = "A81B9CB3F76D8AD099102B4F05531DD1C877D845"
      cert_valid_from     = "2025-09-23"
      cert_valid_to       = "2025-09-26"

      country             = "US"
      state               = "New York"
      locality            = "Floral Park"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:71:61:07:e4:c6:af:e2:95:0f:49:00:00:00:04:71:61"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_3300049B30C093ECFBF658940B000000049B30 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-02"
      version             = "1.0"

      hash                = "464db7461d6d67d99132eeaa9962d3691a3efc73f194fb660b4b8c77c10d9591"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Nitta-Lai Investment Corp."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:9b:30:c0:93:ec:fb:f6:58:94:0b:00:00:00:04:9b:30"
      cert_thumbprint     = "220BF4DB83683AD2B0C78852BE2B1D71699C6AD2"
      cert_valid_from     = "2025-10-02"
      cert_valid_to       = "2025-10-05"

      country             = "CA"
      state               = "Ontario"
      locality            = "Etobicoke"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:9b:30:c0:93:ec:fb:f6:58:94:0b:00:00:00:04:9b:30"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_330004DF75475E1045FF87DE4200000004DF75 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-17"
      version             = "1.0"

      hash                = "b52dddf4022ee45243ad01705d5a8d5070cd62aa89174f1ab83f5b58f66d577a"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Chidiac Entreprises Commerciales Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:df:75:47:5e:10:45:ff:87:de:42:00:00:00:04:df:75"
      cert_thumbprint     = "3C8979488316F223F882BCBBA527BB7D9D96A9AF"
      cert_valid_from     = "2025-10-17"
      cert_valid_to       = "2025-10-20"

      country             = "CA"
      state               = "Québec"
      locality            = "MONTREAL"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:df:75:47:5e:10:45:ff:87:de:42:00:00:00:04:df:75"
      )
}

rule MAL_Compromised_Cert_Oyster_Microsoft_33000571E980AABA26C5B271BD0000000571E9 {
   meta:
      description         = "Detects Oyster with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-22"
      version             = "1.0"

      hash                = "5c797080fa605cab2cd581645f00843f9c91c9c2d0ad4598ccb7886f990c916b"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "DELANEY HOME INSPECTIONS LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:71:e9:80:aa:ba:26:c5:b2:71:bd:00:00:00:05:71:e9"
      cert_thumbprint     = "003075A520624B49542FDBE04DB976D04D2B7A0A"
      cert_valid_from     = "2025-09-22"
      cert_valid_to       = "2025-09-25"

      country             = "US"
      state               = "New York"
      locality            = "Oceanside"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:71:e9:80:aa:ba:26:c5:b2:71:bd:00:00:00:05:71:e9"
      )
}

rule MAL_Compromised_Cert_Oyster_SSL_com_14E52D6A45004663FEF6E69DAAA54FEF {
   meta:
      description         = "Detects Oyster with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-17"
      version             = "1.0"

      hash                = "a4e1c33b1280a0b2daab512b5a4cfdd775743a1980c9b63eb4bfb739356378ae"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "NEETLA LIFESTYLE PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "14:e5:2d:6a:45:00:46:63:fe:f6:e6:9d:aa:a5:4f:ef"
      cert_thumbprint     = "4FB21616AA8C7042CCAD9095DA5E14376EE75796"
      cert_valid_from     = "2025-10-17"
      cert_valid_to       = "2026-10-17"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "14:e5:2d:6a:45:00:46:63:fe:f6:e6:9d:aa:a5:4f:ef"
      )
}

rule MAL_Compromised_Cert_Oyster_SSL_com_28352420650C12A8E08A1B9909DE99FF {
   meta:
      description         = "Detects Oyster with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-08"
      version             = "1.0"

      hash                = "067f6c9d36af9d3c088a37151721eb4981dde65c549d22b5a3ada0b90441e571"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "P M-Soft v/Per Mortensen"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "28:35:24:20:65:0c:12:a8:e0:8a:1b:99:09:de:99:ff"
      cert_thumbprint     = "984CA1B6801E7109D4074D6BFC2B606B9DAC363A"
      cert_valid_from     = "2025-08-08"
      cert_valid_to       = "2026-08-08"

      country             = "DK"
      state               = "Region Zealand"
      locality            = "Nykøbing Falster"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "28:35:24:20:65:0c:12:a8:e0:8a:1b:99:09:de:99:ff"
      )
}

rule MAL_Compromised_Cert_Oyster_SSL_com_2A3A540A1CAFC491099CEFCDC539548F {
   meta:
      description         = "Detects Oyster with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-23"
      version             = "1.0"

      hash                = "b339fed7fef43e82877fa606d19ae94b1393d75e09637066acc69777478a3799"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Wuxi Dainaide Network Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2a:3a:54:0a:1c:af:c4:91:09:9c:ef:cd:c5:39:54:8f"
      cert_thumbprint     = "151A8B902C8FA864B8D7DB95FFA2784E3DD4C4B7"
      cert_valid_from     = "2025-07-23"
      cert_valid_to       = "2026-07-01"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2a:3a:54:0a:1c:af:c4:91:09:9c:ef:cd:c5:39:54:8f"
      )
}

rule MAL_Compromised_Cert_Oyster_SSL_com_31D4015BD379F5DC18056F60D51A43CF {
   meta:
      description         = "Detects Oyster with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-08"
      version             = "1.0"

      hash                = "4e4a3751581252e210f6f45881d778d1f482146f92dc790504bfbcd2bdfa0129"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Art en Code B.V."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "31:d4:01:5b:d3:79:f5:dc:18:05:6f:60:d5:1a:43:cf"
      cert_thumbprint     = "A122735906981AF7D785808D27830E4894801B2D"
      cert_valid_from     = "2025-09-08"
      cert_valid_to       = "2026-09-07"

      country             = "NL"
      state               = "Noord-Holland"
      locality            = "Zwanenburg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "31:d4:01:5b:d3:79:f5:dc:18:05:6f:60:d5:1a:43:cf"
      )
}

rule MAL_Compromised_Cert_Oyster_SSL_com_53E6BB421575CFA2BE73195FD4049955 {
   meta:
      description         = "Detects Oyster with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-30"
      version             = "1.0"

      hash                = "4ddb9521976c04879613601ae1399b7b9809dcd33d58869b2a2053e716d35442"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "CAPELLO MEDIA SOLUTIONS LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:e6:bb:42:15:75:cf:a2:be:73:19:5f:d4:04:99:55"
      cert_thumbprint     = "AFA4DBE5B098717A926F7A28C100E87C9788BBDF"
      cert_valid_from     = "2025-06-30"
      cert_valid_to       = "2026-06-30"

      country             = "GB"
      state               = "???"
      locality            = "ALTRINCHAM"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:e6:bb:42:15:75:cf:a2:be:73:19:5f:d4:04:99:55"
      )
}

rule MAL_Compromised_Cert_Oyster_SSL_com_7227974DB1FF4268501BB4B31EB8FF39 {
   meta:
      description         = "Detects Oyster with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-04"
      version             = "1.0"

      hash                = "31ebdf2d6fb973f648c05226b57ff264d8b650dfe03f995deba0fa795d76f37c"
      malware             = "Oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "4th State Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "72:27:97:4d:b1:ff:42:68:50:1b:b4:b3:1e:b8:ff:39"
      cert_thumbprint     = "24010C3BA7C765BF2F46DE1D2412736CF869A0FE"
      cert_valid_from     = "2025-09-04"
      cert_valid_to       = "2026-09-04"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "72:27:97:4d:b1:ff:42:68:50:1b:b4:b3:1e:b8:ff:39"
      )
}

rule MAL_Compromised_Cert_Oyster_Stage2_Microsoft_3300048CC8BF27D2DF65D0518D000000048CC8 {
   meta:
      description         = "Detects Oyster_Stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-30"
      version             = "1.0"

      hash                = "c41f42e11e699f45a77ac4e8aef455a07b052180863748f96589d45525e250f6"
      malware             = "Oyster_Stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "CARLMICH MANAGEMENT, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:8c:c8:bf:27:d2:df:65:d0:51:8d:00:00:00:04:8c:c8"
      cert_thumbprint     = "3E6A5628B3EF9CD95825FAD59BA748C9C85A3F04"
      cert_valid_from     = "2025-09-30"
      cert_valid_to       = "2025-10-03"

      country             = "US"
      state               = "Michigan"
      locality            = "West Bloomfield"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:8c:c8:bf:27:d2:df:65:d0:51:8d:00:00:00:04:8c:c8"
      )
}

rule MAL_Compromised_Cert_Oyster_stage2_Microsoft_3300046D2CA79D945D76ADD4FE000000046D2C {
   meta:
      description         = "Detects Oyster_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-23"
      version             = "1.0"

      hash                = "c66540bc726ae996fdc876819e41cdc0af4bdb092acb16ed5aefe031a3f20403"
      malware             = "Oyster_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "HCCO Retail Ltd."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:6d:2c:a7:9d:94:5d:76:ad:d4:fe:00:00:00:04:6d:2c"
      cert_thumbprint     = "2B271BC5959B537DDF674BED54A605C07C3D5218"
      cert_valid_from     = "2025-09-23"
      cert_valid_to       = "2025-09-26"

      country             = "CA"
      state               = "Ontario"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:6d:2c:a7:9d:94:5d:76:ad:d4:fe:00:00:00:04:6d:2c"
      )
}

rule MAL_Compromised_Cert_Oyster_stage2_Microsoft_33000478C5E08C58614B3FDF0E0000000478C5 {
   meta:
      description         = "Detects Oyster_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-25"
      version             = "1.0"

      hash                = "2a70db4e14fca6d80ce90c21954323299f8c32bc6fabd67744896af4ee8809b7"
      malware             = "Oyster_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "HCCO Retail Ltd."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:78:c5:e0:8c:58:61:4b:3f:df:0e:00:00:00:04:78:c5"
      cert_thumbprint     = "0F84F2FC0600A53AA4BF793A3F54D6B4EF8C3B56"
      cert_valid_from     = "2025-09-25"
      cert_valid_to       = "2025-09-28"

      country             = "CA"
      state               = "Ontario"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:78:c5:e0:8c:58:61:4b:3f:df:0e:00:00:00:04:78:c5"
      )
}

rule MAL_Compromised_Cert_Oyster_stage2_Microsoft_33000487A5FBFCCAB5ECACDA5E0000000487A5 {
   meta:
      description         = "Detects Oyster_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-30"
      version             = "1.0"

      hash                = "f21483536cbd1fa4f5cb1e996adbe6a82522ca90e14975f6172794995ed9e9a2"
      malware             = "Oyster_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "BRANCH INVESTMENTS HAWAII LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:87:a5:fb:fc:ca:b5:ec:ac:da:5e:00:00:00:04:87:a5"
      cert_thumbprint     = "8763137375E2D46397DA8AD1043F9278F5B7FA0F"
      cert_valid_from     = "2025-09-30"
      cert_valid_to       = "2025-10-03"

      country             = "US"
      state               = "Hawaii"
      locality            = "Kaneohe"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:87:a5:fb:fc:ca:b5:ec:ac:da:5e:00:00:00:04:87:a5"
      )
}

rule MAL_Compromised_Cert_Oyster_stage2_Microsoft_330004EF22BFE922309CD4C0C500000004EF22 {
   meta:
      description         = "Detects Oyster_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-21"
      version             = "1.0"

      hash                = "b4a4d565a4d69e1e54557044809fc281591cdc5781126f978df8094467ba59fd"
      malware             = "Oyster_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Mobiquity Technologies, Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:ef:22:bf:e9:22:30:9c:d4:c0:c5:00:00:00:04:ef:22"
      cert_thumbprint     = "979EF570CFF446527C36501AE0BD844256224D92"
      cert_valid_from     = "2025-10-21"
      cert_valid_to       = "2025-10-24"

      country             = "US"
      state               = "New York"
      locality            = "Shoreham"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:ef:22:bf:e9:22:30:9c:d4:c0:c5:00:00:00:04:ef:22"
      )
}

rule MAL_Compromised_Cert_Oyster_stage2_Microsoft_33000576F970BACFD97EC1EBD90000000576F9 {
   meta:
      description         = "Detects Oyster_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-24"
      version             = "1.0"

      hash                = "d19a497670314a3bbff5bc958db3eacfe591c04f866f779cbc06e0f0f48b991f"
      malware             = "Oyster_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "HCCO Retail Ltd."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:76:f9:70:ba:cf:d9:7e:c1:eb:d9:00:00:00:05:76:f9"
      cert_thumbprint     = "87F20D0095F9A8D6A187A6B08A14312B2DD72081"
      cert_valid_from     = "2025-09-24"
      cert_valid_to       = "2025-09-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:76:f9:70:ba:cf:d9:7e:c1:eb:d9:00:00:00:05:76:f9"
      )
}

rule MAL_Compromised_Cert_Oyster_stage2_Microsoft_330005BBDA9F71B5F4A6B7BD4200000005BBDA {
   meta:
      description         = "Detects Oyster_stage2 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-20"
      version             = "1.0"

      hash                = "db16458f707d77cecc73c0f52db943bfd40970d9074f2d405e1fe1fd84fa5b32"
      malware             = "Oyster_stage2"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "Mobiquity Technologies, Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:bb:da:9f:71:b5:f4:a6:b7:bd:42:00:00:00:05:bb:da"
      cert_thumbprint     = "1F6461C8CF231A1F1B9B9F2FA899E974B04ED48E"
      cert_valid_from     = "2025-10-20"
      cert_valid_to       = "2025-10-23"

      country             = "US"
      state               = "New York"
      locality            = "Shoreham"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:bb:da:9f:71:b5:f4:a6:b7:bd:42:00:00:00:05:bb:da"
      )
}

rule MAL_Compromised_Cert_PDFSkills_GlobalSign_1FA2242655ADC212D505871A {
   meta:
      description         = "Detects PDFSkills with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-18"
      version             = "1.0"

      hash                = "f1773b399bbcfb8656c9ae9dd8f7a79c281ab04c4127e8cb8376400f45dd22be"
      malware             = "PDFSkills"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Impresan Solutions OÜ"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1f:a2:24:26:55:ad:c2:12:d5:05:87:1a"
      cert_thumbprint     = "f8c955ff0a96b06f90b6b8750cd4cb1b15c90cfe"
      cert_valid_from     = "2025-07-18"
      cert_valid_to       = "2026-07-19"

      country             = "EE"
      state               = "Harju maakond"
      locality            = "Tallinn"
      email               = "impresansolutions@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1f:a2:24:26:55:ad:c2:12:d5:05:87:1a"
      )
}

rule MAL_Compromised_Cert_PDFSkills_GlobalSign_476A4CA18A6095A5619A7C4D {
   meta:
      description         = "Detects PDFSkills with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-12"
      version             = "1.0"

      hash                = "1994b6c8c30b4346f6b00da12fc161eb73210af08b914a1c4768b109b234f2df"
      malware             = "PDFSkills"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BLACK INDIGO LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:6a:4c:a1:8a:60:95:a5:61:9a:7c:4d"
      cert_thumbprint     = "3B5253A4853056458675B5CB1903C05BC2DBBD1B"
      cert_valid_from     = "2024-11-12"
      cert_valid_to       = "2025-11-13"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "Support@blackindigoltd.com"
      rdn_serial_number   = "515530624"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:6a:4c:a1:8a:60:95:a5:61:9a:7c:4d"
      )
}

rule MAL_Compromised_Cert_PDFSkills_GlobalSign_6838E670EA30DFA3294EA278 {
   meta:
      description         = "Detects PDFSkills with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-26"
      version             = "1.0"

      hash                = "9c9cdb1a91444dc9c99df071f2dac4791d20112e0df786da40069a1e76594803"
      malware             = "PDFSkills"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RED ROOT LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "68:38:e6:70:ea:30:df:a3:29:4e:a2:78"
      cert_thumbprint     = "D9AFF96830351EB0B8B219729D110822448FE511"
      cert_valid_from     = "2024-02-26"
      cert_valid_to       = "2025-02-26"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "info@redrootltd.com"
      rdn_serial_number   = "516201936"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "68:38:e6:70:ea:30:df:a3:29:4e:a2:78"
      )
}

rule MAL_Compromised_Cert_PDFSpark_Microsoft_330005057672A0AAC2A4B79566000000050576 {
   meta:
      description         = "Detects PDFSpark with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-24"
      version             = "1.0"

      hash                = "00f0338e7caa630d10347a5bebed83bb4c11ebce34f4470a213f93828a66addf"
      malware             = "PDFSpark"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mainstay Crypto LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:05:76:72:a0:aa:c2:a4:b7:95:66:00:00:00:05:05:76"
      cert_thumbprint     = "E3EFCCB48A282FE2091CBA889D79BF65DEF49607"
      cert_valid_from     = "2025-10-24"
      cert_valid_to       = "2025-10-27"

      country             = "US"
      state               = "New Hampshire"
      locality            = "Salem"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:05:76:72:a0:aa:c2:a4:b7:95:66:00:00:00:05:05:76"
      )
}

rule MAL_Compromised_Cert_PDFSpark_Microsoft_3300055DD299B40E0C0D1166C7000000055DD2 {
   meta:
      description         = "Detects PDFSpark with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-20"
      version             = "1.0"

      hash                = "4fa777e1392037fde13b8e93b7d69427926fca5000b816f562e829c9246f46c9"
      malware             = "PDFSpark"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mainstay Crypto LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:5d:d2:99:b4:0e:0c:0d:11:66:c7:00:00:00:05:5d:d2"
      cert_thumbprint     = "CAA635133D0CBD12C822A2C7BCC8FC9A95286E5A"
      cert_valid_from     = "2025-11-20"
      cert_valid_to       = "2025-11-23"

      country             = "US"
      state               = "New Hampshire"
      locality            = "Salem"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:5d:d2:99:b4:0e:0c:0d:11:66:c7:00:00:00:05:5d:d2"
      )
}

rule MAL_Compromised_Cert_PDFSpark_Microsoft_330005F6CBCB2E27282DDFF9E200000005F6CB {
   meta:
      description         = "Detects PDFSpark with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-26"
      version             = "1.0"

      hash                = "4a4747e861df7ecef1269f26ffc2197b4b23397be3dbaf4b4c6fc8f31c9ff0d8"
      malware             = "PDFSpark"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mainstay Crypto LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:f6:cb:cb:2e:27:28:2d:df:f9:e2:00:00:00:05:f6:cb"
      cert_thumbprint     = "4081C12711D8B7B51A6C21A575F6318094DFBE4D"
      cert_valid_from     = "2025-10-26"
      cert_valid_to       = "2025-10-29"

      country             = "US"
      state               = "New Hampshire"
      locality            = "Salem"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:f6:cb:cb:2e:27:28:2d:df:f9:e2:00:00:00:05:f6:cb"
      )
}

rule MAL_Compromised_Cert_PDFSpark_Microsoft_3300068102C2D97F2FA0C377B0000000068102 {
   meta:
      description         = "Detects PDFSpark with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-30"
      version             = "1.0"

      hash                = "8e1fc5417df402b45b544858bc3526ccc8177af48341a9412e5e98a7fc19fd66"
      malware             = "PDFSpark"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mainstay Crypto LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:81:02:c2:d9:7f:2f:a0:c3:77:b0:00:00:00:06:81:02"
      cert_thumbprint     = "FA5C45BB05CF999E67E32BFE0B87EEA7C1C407B9"
      cert_valid_from     = "2025-11-30"
      cert_valid_to       = "2025-12-03"

      country             = "US"
      state               = "New Hampshire"
      locality            = "Salem"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:81:02:c2:d9:7f:2f:a0:c3:77:b0:00:00:00:06:81:02"
      )
}

rule MAL_Compromised_Cert_PDF_Spark_GlobalSign_7BF01F1C79B42C10A321CBE6 {
   meta:
      description         = "Detects PDF Spark with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-24"
      version             = "1.0"

      hash                = "cb54030ecafc2af39c03bf0fc80fdc5de11764249bdca85c81457f3fcf9bc201"
      malware             = "PDF Spark"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Eman Group, LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7b:f0:1f:1c:79:b4:2c:10:a3:21:cb:e6"
      cert_thumbprint     = "702813CD746BA6CBA5DDE0F31FDAB1EA735353BD"
      cert_valid_from     = "2025-02-24"
      cert_valid_to       = "2026-02-25"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "2021-000993778"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7b:f0:1f:1c:79:b4:2c:10:a3:21:cb:e6"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_08B4249EC5131AE0856893BB {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-20"
      version             = "1.0"

      hash                = "4f3a8d56a20474eb3962457689614d2360b99f6d034a60d207550abac99896a2"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Called Sparkline LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "08:b4:24:9e:c5:13:1a:e0:85:68:93:bb"
      cert_thumbprint     = "B30F77A8BC06AADA08B76E9176C3C15E7C9C49FF"
      cert_valid_from     = "2024-12-20"
      cert_valid_to       = "2025-12-21"

      country             = "US"
      state               = "Texas"
      locality            = "Austin"
      email               = "fm760984@gmail.com"
      rdn_serial_number   = "0805421133"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "08:b4:24:9e:c5:13:1a:e0:85:68:93:bb"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_36CC39AA22030F7FA71592F8 {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-09"
      version             = "1.0"

      hash                = "103c8764f8af476e8801c03a03969f388133b8586de93b13fcba52bf1772c8e5"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SEELIV (SMC-PRIVATE) LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "36:cc:39:aa:22:03:0f:7f:a7:15:92:f8"
      cert_thumbprint     = "77E3B1710323F25812A7AF8D2A6A5C6A743DC25F"
      cert_valid_from     = "2024-10-09"
      cert_valid_to       = "2025-10-10"

      country             = "PK"
      state               = "Punjab"
      locality            = "Multan"
      email               = "farhadikhlaq483@gmail.com"
      rdn_serial_number   = "0175853"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "36:cc:39:aa:22:03:0f:7f:a7:15:92:f8"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_36CCA0554D1130A8455DE146 {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-16"
      version             = "1.0"

      hash                = "6ef80b596195ac002f072811bb2c73e6d45b8f914ada6d1e613ad9abe14bc09c"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IBRAHIM MANNAN LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "36:cc:a0:55:4d:11:30:a8:45:5d:e1:46"
      cert_thumbprint     = "5AD122B091C21EB546DFD20086D266E0E8429ABF"
      cert_valid_from     = "2024-04-16"
      cert_valid_to       = "2025-04-17"

      country             = "US"
      state               = "Florida"
      locality            = "Saint Petersburg"
      email               = "farhadikhlaq483@gmail.com"
      rdn_serial_number   = "L23000274215"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "36:cc:a0:55:4d:11:30:a8:45:5d:e1:46"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_448B91A86A90F9E0E585A032 {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-25"
      version             = "1.0"

      hash                = "2ef67a07ced37631e6984f98a8ee249164a25da79358e0a0461ab50ac0b02f8f"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HOTEL FATAZ (PRIVATE) LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "44:8b:91:a8:6a:90:f9:e0:e5:85:a0:32"
      cert_thumbprint     = "68BFBA3FC7ABD9D8727DBA1DB15F161E69FB09CE"
      cert_valid_from     = "2024-04-25"
      cert_valid_to       = "2025-04-26"

      country             = "PK"
      state               = "Sindh"
      locality            = "Hyderabad"
      email               = "reema77ik@gmail.com"
      rdn_serial_number   = "0004890"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "44:8b:91:a8:6a:90:f9:e0:e5:85:a0:32"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_6F967286B3DB0B954F9A84E7 {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-30"
      version             = "1.0"

      hash                = "efea4b2f5df566c507e96f11a8a74b00724015cac86e5d08b85f6c31d2284413"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SHINE YOUR GUTS (SMC-PRIVATE) LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 CodeSigning CA 2020"
      cert_serial         = "6f:96:72:86:b3:db:0b:95:4f:9a:84:e7"
      cert_thumbprint     = "F59F7E5AD23D964F614D0A7549F5D49EB166EFEE"
      cert_valid_from     = "2024-09-30"
      cert_valid_to       = "2025-10-01"

      country             = "PK"
      state               = "Punjab"
      locality            = "Lahore"
      email               = "REEMA77IK@GMAIL.COM"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 CodeSigning CA 2020" and
         sig.serial == "6f:96:72:86:b3:db:0b:95:4f:9a:84:e7"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_7492A1D8A6E9489CA1872F02 {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-02"
      version             = "1.0"

      hash                = "f87f43af104abbb84208b97877eaa5e34b657ab1c381c458bcb805801ff3cc03"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THE-SHOP STOP LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "74:92:a1:d8:a6:e9:48:9c:a1:87:2f:02"
      cert_thumbprint     = "3ACF161DC680CB52BDCF3227248E933DE361BD48"
      cert_valid_from     = "2024-10-02"
      cert_valid_to       = "2025-10-03"

      country             = "US"
      state               = "Florida"
      locality            = "Saint Petersburg"
      email               = "farhadikhlaq483@gmail.com"
      rdn_serial_number   = "L23000038092"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "74:92:a1:d8:a6:e9:48:9c:a1:87:2f:02"
      )
}

rule MAL_Compromised_Cert_PDFast_GlobalSign_7D3626E63E3516AB22116D1E {
   meta:
      description         = "Detects PDFast with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-09"
      version             = "1.0"

      hash                = "a7f0794872bc5d0fedcf6161c7002e0d9fc7e23cd8d390e0327db7c010dd7a1a"
      malware             = "PDFast"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AL STARE LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7d:36:26:e6:3e:35:16:ab:22:11:6d:1e"
      cert_thumbprint     = "2DEFD4D6CBB10B7AFD9B5A3DBD61E756549EE3CB"
      cert_valid_from     = "2024-04-09"
      cert_valid_to       = "2025-04-10"

      country             = "US"
      state               = "TEXAS"
      locality            = "AUSTIN"
      email               = "fm760984@gmail.com"
      rdn_serial_number   = "0805239913"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7d:36:26:e6:3e:35:16:ab:22:11:6d:1e"
      )
}

rule MAL_Compromised_Cert_PDFixers_GlobalSign_2AC7FCE6B9C96D57663F6BB4 {
   meta:
      description         = "Detects PDFixers with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-21"
      version             = "1.0"

      hash                = "cc0cb1ff8cd7c38e282fc2822a94fdd93773e0f6d046d9328cdd6c1d49f4483d"
      malware             = "PDFixers"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ADSMARKETO LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2a:c7:fc:e6:b9:c9:6d:57:66:3f:6b:b4"
      cert_thumbprint     = "40C0CB1A69BC8AF1256B2862D729A330937B4CFF"
      cert_valid_from     = "2023-11-21"
      cert_valid_to       = "2024-11-21"

      country             = "UA"
      state               = "Kyiv"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2a:c7:fc:e6:b9:c9:6d:57:66:3f:6b:b4"
      )
}

rule MAL_Compromised_Cert_PDFusion_GlobalSign_538F0DC7777C4F5A602D8A14 {
   meta:
      description         = "Detects PDFusion with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-19"
      version             = "1.0"

      hash                = "90d9d441a92a3746b76657b3d95af6b25c125a196a4d2c0b6731241209428ea8"
      malware             = "PDFusion"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KNAF TCHELET LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "53:8f:0d:c7:77:7c:4f:5a:60:2d:8a:14"
      cert_thumbprint     = "832B58B047B2424E684A9E792DFD02F5282CD467"
      cert_valid_from     = "2024-09-19"
      cert_valid_to       = "2025-09-20"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Tel Aviv-Jaffa"
      email               = "support@knaftchelet.com"
      rdn_serial_number   = "516891132"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "53:8f:0d:c7:77:7c:4f:5a:60:2d:8a:14"
      )
}

rule MAL_Compromised_Cert_PSBackdoor_GlobalSign_12F7A735DF3603B17CDE6352 {
   meta:
      description         = "Detects PSBackdoor with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-15"
      version             = "1.0"

      hash                = "e6786d6e0ea80175944e470dcccf61b322f3fadd438c975e0aee31705d9de7b6"
      malware             = "PSBackdoor"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LIBERTY TRADE LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "12:f7:a7:35:df:36:03:b1:7c:de:63:52"
      cert_thumbprint     = "0FD7FB5E430395867D93AACB46C98DEB102BBC17"
      cert_valid_from     = "2025-11-15"
      cert_valid_to       = "2026-02-08"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "12:f7:a7:35:df:36:03:b1:7c:de:63:52"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Certum_6DAA67498C3A5D8133F28FEFE9CCC20E {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-21"
      version             = "1.0"

      hash                = "dae9032c305a447c81635cfae72e942b411b531c1892c943ac80fa0797b8dc05"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Rimsara Development OU"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6d:aa:67:49:8c:3a:5d:81:33:f2:8f:ef:e9:cc:c2:0e"
      cert_thumbprint     = "0B7228ED2EB6FA002AAAC75896C15912D95AA08B"
      cert_valid_from     = "2023-09-21"
      cert_valid_to       = "2024-09-20"

      country             = "EE"
      state               = "Ida-Viru maakond"
      locality            = "Narva"
      email               = "???"
      rdn_serial_number   = "16807868"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6d:aa:67:49:8c:3a:5d:81:33:f2:8f:ef:e9:cc:c2:0e"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_GlobalSign_05D50A0E09BB9A836FFB90A3 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-03"
      version             = "1.0"

      hash                = "377ecfd2413aa044082c4f89e7c50baaeac0acbae8d7f5ada32ad915ad905557"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Toliz Info Tech Solutions INC."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "05:d5:0a:0e:09:bb:9a:83:6f:fb:90:a3"
      cert_thumbprint     = "975AFE2CC21AE05FF4EE5A7271E125D13BF6163C"
      cert_valid_from     = "2022-02-03"
      cert_valid_to       = "2023-02-04"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ajax"
      email               = "Abigail.D@solbertec.com"
      rdn_serial_number   = "1005311-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "05:d5:0a:0e:09:bb:9a:83:6f:fb:90:a3"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_GlobalSign_12527F7D7F83A74C9721008F {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-04"
      version             = "1.0"

      hash                = "f95f203c80586c9e6ea078bc983f690e8b15c6e133e70554fb75b3469e3dae17"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Blockfi Ruinor Security Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "12:52:7f:7d:7f:83:a7:4c:97:21:00:8f"
      cert_thumbprint     = "091A22C7A90C723EA2F1A9D38374D3F7BF855371"
      cert_valid_from     = "2024-06-04"
      cert_valid_to       = "2025-06-05"

      country             = "CN"
      state               = "Shandong"
      locality            = "Jinan"
      email               = "???"
      rdn_serial_number   = "91370102307284861T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "12:52:7f:7d:7f:83:a7:4c:97:21:00:8f"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00801689896ED339237464A41A2900A969 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-12"
      version             = "1.0"

      hash                = "ebf0083ad227764b7963171f0c2d156f56ad5a5835ce1a74e3c85b4902b04695"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "GLG Rental ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:80:16:89:89:6e:d3:39:23:74:64:a4:1a:29:00:a9:69"
      cert_thumbprint     = "9B0AB2E7F3514F6372D14B1F7F963C155B18BD24"
      cert_valid_from     = "2021-03-12"
      cert_valid_to       = "2022-03-12"

      country             = "DK"
      state               = "Nordjylland"
      locality            = "Farsø"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:80:16:89:89:6e:d3:39:23:74:64:a4:1a:29:00:a9:69"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00846F77D9919FC4405AEFE1701309BD67 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-19"
      version             = "1.0"

      hash                = "8c6e507be687fd725cf66f3a4d405a43fc575a275024a5ed164e90b873fe447c"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "IPM Skupina d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:84:6f:77:d9:91:9f:c4:40:5a:ef:e1:70:13:09:bd:67"
      cert_thumbprint     = "FFDF8C9A92823B7198BDCBD4611A4087A5BE222D"
      cert_valid_from     = "2021-05-19"
      cert_valid_to       = "2022-05-19"

      country             = "SI"
      state               = "Ljubljana"
      locality            = "Ljubljana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:84:6f:77:d9:91:9f:c4:40:5a:ef:e1:70:13:09:bd:67"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_008B3333D32B2C2A1D33B41BA5DB9D4D2D {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-03"
      version             = "1.0"

      hash                = "5d5684ccef3ce3b6e92405f73794796e131d3cb1424d757828c3fb62f70f6227"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "BOOK CAFÉ, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:8b:33:33:d3:2b:2c:2a:1d:33:b4:1b:a5:db:9d:4d:2d"
      cert_thumbprint     = "7ECAA9A507A6672144A82D453413591067FC1D27"
      cert_valid_from     = "2021-05-03"
      cert_valid_to       = "2022-05-03"

      country             = "CZ"
      state               = "???"
      locality            = "Brno"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:8b:33:33:d3:2b:2c:2a:1d:33:b4:1b:a5:db:9d:4d:2d"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_008D52FB12A2511E86BBB0BA75C517EAB0 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-04"
      version             = "1.0"

      hash                = "6b4db883cf4c04eedb117c22ea5adf581c76a1ceff8ace962182866f91587120"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "VThink Software Consulting Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:8d:52:fb:12:a2:51:1e:86:bb:b0:ba:75:c5:17:ea:b0"
      cert_thumbprint     = "A7425B343917A65DB27268B8FEA5D6D4FD482F76"
      cert_valid_from     = "2020-09-04"
      cert_valid_to       = "2021-09-04"

      country             = "CA"
      state               = "Ontario"
      locality            = "Orangeville"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:8d:52:fb:12:a2:51:1e:86:bb:b0:ba:75:c5:17:ea:b0"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_009CFBB4C69008821AAACECDE97EE149AB {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-05-27"
      version             = "1.0"

      hash                = "bbe2a604c11442ee74adb7fa17910ca8e5665ab463e4a45b478707faa3a284e4"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Kivaliz Prest s.r.l."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:9c:fb:b4:c6:90:08:82:1a:aa:ce:cd:e9:7e:e1:49:ab"
      cert_thumbprint     = "0E392277EF97BF372F17ADDEF94BA14961E376B3"
      cert_valid_from     = "2020-05-27"
      cert_valid_to       = "2021-05-27"

      country             = "RO"
      state               = "Mures"
      locality            = "Livezeni"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:9c:fb:b4:c6:90:08:82:1a:aa:ce:cd:e9:7e:e1:49:ab"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00BE8E91BA93724AC74B5A862AFCD34077 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-19"
      version             = "1.0"

      hash                = "9ccce653cb66833e9396151f5bc65f6c2744d955a9eaedad81eccd3da252803e"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "A-LINE PIPE TOOLS INC."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:be:8e:91:ba:93:72:4a:c7:4b:5a:86:2a:fc:d3:40:77"
      cert_thumbprint     = "B0BF883E29C245A68D4861D8C50CFC75DCADC669"
      cert_valid_from     = "2021-05-19"
      cert_valid_to       = "2022-05-19"

      country             = "CA"
      state               = "Ontario"
      locality            = "THUNDER BAY"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:be:8e:91:ba:93:72:4a:c7:4b:5a:86:2a:fc:d3:40:77"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00BFCEA72A7A44662E74E77163BD89C2AA {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-27"
      version             = "1.0"

      hash                = "389c556e30252966f34f1bc23348e182af2c0883771f9c8abe299a8ba54b1f6a"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Special Floors ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:bf:ce:a7:2a:7a:44:66:2e:74:e7:71:63:bd:89:c2:aa"
      cert_thumbprint     = "D60AB44BE669AE7F22FA5B05FDA65AB30B9ED61A"
      cert_valid_from     = "2021-07-27"
      cert_valid_to       = "2022-07-27"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "København SV"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:bf:ce:a7:2a:7a:44:66:2e:74:e7:71:63:bd:89:c2:aa"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00D0EDA76C13D30C97015708790BB94214 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-23"
      version             = "1.0"

      hash                = "83afabd3bf44ba07ad9b09ffc85db8ea7ff0a32d888bd829e8733dcd2cd2779e"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "LAEN ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d0:ed:a7:6c:13:d3:0c:97:01:57:08:79:0b:b9:42:14"
      cert_thumbprint     = "CB6DBEFC0949F7CC59BBDEEFFCA2F86D3CC8B630"
      cert_valid_from     = "2021-04-23"
      cert_valid_to       = "2022-04-23"

      country             = "DK"
      state               = "???"
      locality            = "Vallensbæk Strand"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d0:ed:a7:6c:13:d3:0c:97:01:57:08:79:0b:b9:42:14"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00D1737E5A94D2AFF121163DF177ED7CF7 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-28"
      version             = "1.0"

      hash                = "66dfb7c408d734edc2967d50244babae27e4268ea93aa0daa5e6bbace607024c"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "BedstSammen ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d1:73:7e:5a:94:d2:af:f1:21:16:3d:f1:77:ed:7c:f7"
      cert_thumbprint     = "ED2E4F72E8CB9B008A28B31DE440F024381E4C8D"
      cert_valid_from     = "2021-05-28"
      cert_valid_to       = "2022-05-28"

      country             = "DK"
      state               = "???"
      locality            = "Søborg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d1:73:7e:5a:94:d2:af:f1:21:16:3d:f1:77:ed:7c:f7"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00D2CAF7908AAEBFA1A8F3E2136FECE024 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-26"
      version             = "1.0"

      hash                = "f7bab5e7e4487b86dd052dc4e9b9fd27f53d1a33852f6e5ce9ae91c302c33bcf"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "FANATOR, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d2:ca:f7:90:8a:ae:bf:a1:a8:f3:e2:13:6f:ec:e0:24"
      cert_thumbprint     = "629EDB30A50E365794D08E87217CB8CC324854AE"
      cert_valid_from     = "2020-08-26"
      cert_valid_to       = "2021-08-26"

      country             = "RU"
      state               = "???"
      locality            = "Volgograd"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d2:ca:f7:90:8a:ae:bf:a1:a8:f3:e2:13:6f:ec:e0:24"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00D609B6C95428954A999A8A99D4F198AF {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-09"
      version             = "1.0"

      hash                = "525d3b180847b425e376157caabbf860b421078903228d919d1e5e0fcce5741c"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "OOO Fudl"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d6:09:b6:c9:54:28:95:4a:99:9a:8a:99:d4:f1:98:af"
      cert_thumbprint     = "B1D8033DD7AD9E82674299FAED410817E42C4C40"
      cert_valid_from     = "2021-02-09"
      cert_valid_to       = "2022-02-09"

      country             = "RU"
      state               = "???"
      locality            = "Sankt-Peterburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d6:09:b6:c9:54:28:95:4a:99:9a:8a:99:d4:f1:98:af"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00F112993CA9F2B1956ADBB0C86FB42292 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-19"
      version             = "1.0"

      hash                = "d8eb5792d969c21c364da69eca1322ab5f63e0a39b0e542bad4ee95be873c296"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Key 4 Solutions, s. r. o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f1:12:99:3c:a9:f2:b1:95:6a:db:b0:c8:6f:b4:22:92"
      cert_thumbprint     = "82D94E43B13C84DCFAD0AB35A73077F61524336E"
      cert_valid_from     = "2021-05-19"
      cert_valid_to       = "2022-05-19"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava - mestská časť Ružinov"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f1:12:99:3c:a9:f2:b1:95:6a:db:b0:c8:6f:b4:22:92"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00F4D2DEF53BCCB0DD2B7D54E4853A2FC5 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-27"
      version             = "1.0"

      hash                = "138c60f8df9c59cf59cbdfbf5004ceda539b0de2cd70207b79833805594a9746"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "PETROYL GROUP, TOV"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f4:d2:de:f5:3b:cc:b0:dd:2b:7d:54:e4:85:3a:2f:c5"
      cert_thumbprint     = "3725EB9700D2761EAF52972972540F06E28F8053"
      cert_valid_from     = "2020-07-27"
      cert_valid_to       = "2021-07-27"

      country             = "UA"
      state               = "???"
      locality            = "Vinnytska region"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f4:d2:de:f5:3b:cc:b0:dd:2b:7d:54:e4:85:3a:2f:c5"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_00FBB1198BD8BDDB0D693EB72A8613FE3F {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-03"
      version             = "1.0"

      hash                = "abba8d0990bb52ecc9c282ca8e98e83076fbd5d86afe2efecdbc236a5c610de8"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Trade Hunters, s. r. o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:fb:b1:19:8b:d8:bd:db:0d:69:3e:b7:2a:86:13:fe:3f"
      cert_thumbprint     = "8D9EFDCE4F0D50387D8A6FD6C349DB593A00FB20"
      cert_valid_from     = "2021-05-03"
      cert_valid_to       = "2022-05-03"

      country             = "SK"
      state               = "Bratislavský kraj"
      locality            = "mestská časť Rača"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:fb:b1:19:8b:d8:bd:db:0d:69:3e:b7:2a:86:13:fe:3f"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_029685CDA1C8233D2409A31206F78F9F {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-04"
      version             = "1.0"

      hash                = "4737b939774fa43ffaec93dcee6112b2c3372bcd9910ecd2969cb8dc75ef4857"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "KOTO TRADE, družba za posredovanje, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "02:96:85:cd:a1:c8:23:3d:24:09:a3:12:06:f7:8f:9f"
      cert_thumbprint     = "86574B0EF7FBCE15F208BF801866F34C664CF7CE"
      cert_valid_from     = "2021-02-04"
      cert_valid_to       = "2022-02-04"

      country             = "SI"
      state               = "???"
      locality            = "Ljubljana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "02:96:85:cd:a1:c8:23:3d:24:09:a3:12:06:f7:8f:9f"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_03B27D7F4EE21A462A064A17EEF70D6C {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-22"
      version             = "1.0"

      hash                = "7087214159114804bf5e751cee8004818f6d78d671c646ec0775fbc5b3954b10"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "CCL TRADING LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "03:b2:7d:7f:4e:e2:1a:46:2a:06:4a:17:ee:f7:0d:6c"
      cert_thumbprint     = "A278B5C8A9798EE3B3299EC92A4AB618016628EE"
      cert_valid_from     = "2021-02-22"
      cert_valid_to       = "2022-02-22"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "03:b2:7d:7f:4e:e2:1a:46:2a:06:4a:17:ee:f7:0d:6c"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_0A5B4F67AD8B22AFC2DEBE6CE5F8F679 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-09"
      version             = "1.0"

      hash                = "723cb0067010b79e0cc780ea786fef8c6c17b68c383acc8183b2ae7332e95abf"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Farad LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "0a:5b:4f:67:ad:8b:22:af:c2:de:be:6c:e5:f8:f6:79"
      cert_thumbprint     = "1213865AF7DDAC1568830748DBDDA21498DFB0BA"
      cert_valid_from     = "2020-12-09"
      cert_valid_to       = "2021-12-09"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "0a:5b:4f:67:ad:8b:22:af:c2:de:be:6c:e5:f8:f6:79"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_28C57DF09CE7CC3FDE2243BEB4D00101 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-06-03"
      version             = "1.0"

      hash                = "88c109e8bca8a35c02efa6ce6f27bb714d16623382cd8181011e8776c5f017a5"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "WATER, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "28:c5:7d:f0:9c:e7:cc:3f:de:22:43:be:b4:d0:01:01"
      cert_thumbprint     = "E8AF91EB205CBAEAD7F4D08DEB8AA776C075EB80"
      cert_valid_from     = "2021-06-03"
      cert_valid_to       = "2022-06-03"

      country             = "CZ"
      state               = "???"
      locality            = "Praha"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "28:c5:7d:f0:9c:e7:cc:3f:de:22:43:be:b4:d0:01:01"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_292EB1133507F42E6F36C5549C189D5E {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-06"
      version             = "1.0"

      hash                = "f0b3b36086e58964bf4b9d655568ab5c7f798bd89e7a8581069e65f8189c0b79"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Affairs-case s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "29:2e:b1:13:35:07:f4:2e:6f:36:c5:54:9c:18:9d:5e"
      cert_thumbprint     = "48C32548FF651E2AAC12716EFB448F5583577E35"
      cert_valid_from     = "2021-12-06"
      cert_valid_to       = "2022-12-06"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "29:2e:b1:13:35:07:f4:2e:6f:36:c5:54:9c:18:9d:5e"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_2AAA455A172F7E3A2DFFB5C6B14F9C16 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-14"
      version             = "1.0"

      hash                = "7852cf2dfe60b60194dae9b037298ed0a9c84fa1d850f3898751575f4377215f"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "DREAM VILLAGE s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "2a:aa:45:5a:17:2f:7e:3a:2d:ff:b5:c6:b1:4f:9c:16"
      cert_thumbprint     = "23C91B66BD07E56E60724B0064D4FEDBDB1C8913"
      cert_valid_from     = "2021-12-14"
      cert_valid_to       = "2022-12-14"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "2a:aa:45:5a:17:2f:7e:3a:2d:ff:b5:c6:b1:4f:9c:16"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_30318FC997744B5DC5EC9480BF80AD0C {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-27"
      version             = "1.0"

      hash                = "dd2b6e5b02de97b7888bb22135c2c9771c6a2477a59e96463141c36d30e80fbb"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "ZOMI INVEST, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "30:31:8f:c9:97:74:4b:5d:c5:ec:94:80:bf:80:ad:0c"
      cert_thumbprint     = "1ED0A44354A6E750B26594A0819CC0BBBAB16299"
      cert_valid_from     = "2021-05-27"
      cert_valid_to       = "2022-05-27"

      country             = "SI"
      state               = "???"
      locality            = "Trebnje"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "30:31:8f:c9:97:74:4b:5d:c5:ec:94:80:bf:80:ad:0c"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_3B0914E2982BE8980AA23F49848555E5 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-01-26"
      version             = "1.0"

      hash                = "c4ca06766b0b2f5a7aeb24aa39d3b3695bcbe94b96a506dd9950e795064d875c"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Office Rat s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "3b:09:14:e2:98:2b:e8:98:0a:a2:3f:49:84:85:55:e5"
      cert_thumbprint     = "32640A143458C8543EEC7E2438D0518EAE8A8AB9"
      cert_valid_from     = "2022-01-26"
      cert_valid_to       = "2023-01-26"

      country             = "CZ"
      state               = "Plzeňský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "3b:09:14:e2:98:2b:e8:98:0a:a2:3f:49:84:85:55:e5"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_59A57E8BA3DCF2B6F59981FDA14B03 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-28"
      version             = "1.0"

      hash                = "d9ace2d97010316fdb0f416920232e8d4c59b01614633c4d5def79abb15d0175"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Medium LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "59:a5:7e:8b:a3:dc:f2:b6:f5:99:81:fd:a1:4b:03"
      cert_thumbprint     = "E201821E152D7AE86078C4E6A3A3A1E1C5E29F9A"
      cert_valid_from     = "2020-12-28"
      cert_valid_to       = "2021-12-28"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "59:a5:7e:8b:a3:dc:f2:b6:f5:99:81:fd:a1:4b:03"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_5B37AC3479283B6F9D75DDF0F8742D06 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-30"
      version             = "1.0"

      hash                = "a7fab8c1fc7ffc5002452f5a783f7a43b263ad302fab8d9fdd412610122f77ce"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "ART BOOK PHOTO s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "5b:37:ac:34:79:28:3b:6f:9d:75:dd:f0:f8:74:2d:06"
      cert_thumbprint     = "48F745BDA9A47F48D798E4F71B81B9560EBAC141"
      cert_valid_from     = "2021-04-30"
      cert_valid_to       = "2022-04-30"

      country             = "CZ"
      state               = "???"
      locality            = "Javorník"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "5b:37:ac:34:79:28:3b:6f:9d:75:dd:f0:f8:74:2d:06"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_6401831B46588B9D872B02076C3A7B00 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-12"
      version             = "1.0"

      hash                = "0cfa9021ddabb0a9f3306397234f3f19ce70da1082b4291bfe9477c974aebbec"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "ACTIV GROUP ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "64:01:83:1b:46:58:8b:9d:87:2b:02:07:6c:3a:7b:00"
      cert_thumbprint     = "19FC95AC815865E8B57C80ED21A22E2C0FECC1FF"
      cert_valid_from     = "2021-03-12"
      cert_valid_to       = "2022-03-12"

      country             = "DK"
      state               = "Sjælland"
      locality            = "Hvalsø"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "64:01:83:1b:46:58:8b:9d:87:2b:02:07:6c:3a:7b:00"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_661BA8F3C9D1B348413484E9A49502F7 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-11"
      version             = "1.0"

      hash                = "ed5215be40b05fe324dfd185a741a48c604215482095e1953bfdad62725c8092"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Unique Digital Services Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "66:1b:a8:f3:c9:d1:b3:48:41:34:84:e9:a4:95:02:f7"
      cert_thumbprint     = "A7F7AFB9DD29EDE298EF1D941D0A34EB110F3CEC"
      cert_valid_from     = "2020-07-11"
      cert_valid_to       = "2021-07-11"

      country             = "CA"
      state               = "Alberta"
      locality            = "Calgary"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "66:1b:a8:f3:c9:d1:b3:48:41:34:84:e9:a4:95:02:f7"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_6A568F85DE2061F67DED98707D4988DF {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-11"
      version             = "1.0"

      hash                = "6f8fc539952555b057adf7810aca782a29f8f624e1d46a0f4732db3763130725"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "OOO Apladis"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "6a:56:8f:85:de:20:61:f6:7d:ed:98:70:7d:49:88:df"
      cert_thumbprint     = "ED7E16A65294086FBDEEE09C562B0722FDB2DB48"
      cert_valid_from     = "2021-02-11"
      cert_valid_to       = "2022-02-11"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "6a:56:8f:85:de:20:61:f6:7d:ed:98:70:7d:49:88:df"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_74FC9257BC86F8C618501695AD4B1606 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-28"
      version             = "1.0"

      hash                = "58a6a07940b4e3f69415097f67f8062938290677d0c9632f29a8facddd2de46f"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "169Teaco Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "74:fc:92:57:bc:86:f8:c6:18:50:16:95:ad:4b:16:06"
      cert_thumbprint     = "C6F9CAD38279E78EF4D0624221D40D6ACDE14966"
      cert_valid_from     = "2021-09-28"
      cert_valid_to       = "2022-09-28"

      country             = "CA"
      state               = "Ontario"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "74:fc:92:57:bc:86:f8:c6:18:50:16:95:ad:4b:16:06"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_Sectigo_77550ED697992B397E3F1AD8E2A662D1 {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-22"
      version             = "1.0"

      hash                = "517af63bf54611b1ae3707b905aa9263c3e139dc576acc53ee1cf34e75c3ac7a"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "GRASS RAIN, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "77:55:0e:d6:97:99:2b:39:7e:3f:1a:d8:e2:a6:62:d1"
      cert_thumbprint     = "525426938BB20CB83887BCB852CF5BC9B0D4B10E"
      cert_valid_from     = "2022-03-22"
      cert_valid_to       = "2023-03-22"

      country             = "SK"
      state               = "Trnavský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "77:55:0e:d6:97:99:2b:39:7e:3f:1a:d8:e2:a6:62:d1"
      )
}

rule MAL_Compromised_Cert_ParallaxRAT_TrustOcean_066276AF2F2C7E246D3B1CAB1B4AA42E {
   meta:
      description         = "Detects ParallaxRAT with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-25"
      version             = "1.0"

      hash                = "222c327eef40050baf9e05f80d39f53bf7955bd84bf212887405a665060c369f"
      malware             = "ParallaxRAT"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "IQ Trade ApS"
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "06:62:76:af:2f:2c:7e:24:6d:3b:1c:ab:1b:4a:a4:2e"
      cert_thumbprint     = "DEE5CA4BE94A8737C85BBEE27BD9D81B235FB700"
      cert_valid_from     = "2021-03-25"
      cert_valid_to       = "2022-03-25"

      country             = "DK"
      state               = "???"
      locality            = "Rødovre"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "06:62:76:af:2f:2c:7e:24:6d:3b:1c:ab:1b:4a:a4:2e"
      )
}

rule MAL_Compromised_Cert_ParallaxRat_DigiCert_0883DB137021B51F3A2A08A76A4BC066 {
   meta:
      description         = "Detects ParallaxRat with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-28"
      version             = "1.0"

      hash                = "7220bd358f7a359fba4e076252af1c06eddf175463b32a03aa1d59b199c684de"
      malware             = "ParallaxRat"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Divertida Creative Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "08:83:db:13:70:21:b5:1f:3a:2a:08:a7:6a:4b:c0:66"
      cert_thumbprint     = "C049731B453AB96F0D81D02392C9FC57257E647D"
      cert_valid_from     = "2021-07-28"
      cert_valid_to       = "2022-07-27"

      country             = "IE"
      state               = "???"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "700013"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "08:83:db:13:70:21:b5:1f:3a:2a:08:a7:6a:4b:c0:66"
      )
}

rule MAL_Compromised_Cert_ParallaxRat_TrustOcean_00D1B8F1FE56381BEFDB2E73FFEF2A4B28 {
   meta:
      description         = "Detects ParallaxRat with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-06"
      version             = "1.0"

      hash                = "6f522cc6adbe791575df40a518ba10c89cb54af0d849be0841b036b05d441fa9"
      malware             = "ParallaxRat"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Seinäjoen Squash ja Bowling Oy"
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "00:d1:b8:f1:fe:56:38:1b:ef:db:2e:73:ff:ef:2a:4b:28"
      cert_thumbprint     = "350540A81922B63C31B3BE2D3B4E8BECE001726B"
      cert_valid_from     = "2021-04-06"
      cert_valid_to       = "2022-04-06"

      country             = "FI"
      state               = "???"
      locality            = "Seinäjoki"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "00:d1:b8:f1:fe:56:38:1b:ef:db:2e:73:ff:ef:2a:4b:28"
      )
}

rule MAL_Compromised_Cert_Parallax_RAT_Microsoft_330006AD4E524073EDED4175E200000006AD4E {
   meta:
      description         = "Detects Parallax RAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-12"
      version             = "1.0"

      hash                = "f85cfe9466ca6d61adb2a4b1e498c2e6617ae57d9c21dccf7081bf83f8070778"
      malware             = "Parallax RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PANGEA CIVIL ENGINEERS S.R.L."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:ad:4e:52:40:73:ed:ed:41:75:e2:00:00:00:06:ad:4e"
      cert_thumbprint     = "3462069EC4BF0797912DE5D40A8788FF61BCBA8C"
      cert_valid_from     = "2025-12-12"
      cert_valid_to       = "2025-12-15"

      country             = "RO"
      state               = "Ilfov"
      locality            = "POPESTI LEORDENI"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:ad:4e:52:40:73:ed:ed:41:75:e2:00:00:00:06:ad:4e"
      )
}

rule MAL_Compromised_Cert_Parallax_RAT_SSL_com_0B92FA7F2D8A5348D081C74D63D0E10E {
   meta:
      description         = "Detects Parallax RAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-12"
      version             = "1.0"

      hash                = "be4cb40066c72827f2bf393b79c8b3f3cf135ae38cb33c919d3147d669d634a2"
      malware             = "Parallax RAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ALL-TECH LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0b:92:fa:7f:2d:8a:53:48:d0:81:c7:4d:63:d0:e1:0e"
      cert_thumbprint     = "3BBE32A7734B982264811E831228B163D0C26756"
      cert_valid_from     = "2024-12-12"
      cert_valid_to       = "2025-12-12"

      country             = "UA"
      state               = "???"
      locality            = "Poltava"
      email               = "???"
      rdn_serial_number   = "41260714"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0b:92:fa:7f:2d:8a:53:48:d0:81:c7:4d:63:d0:e1:0e"
      )
}

rule MAL_Compromised_Cert_Parallax_SSL_com_08ACB32A2E27CD8624B556CF496DE888 {
   meta:
      description         = "Detects Parallax with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-28"
      version             = "1.0"

      hash                = "bde8be565aa929b0c4ae5bb7fa6da74896779ec13bb28d488ade9445a5fe7137"
      malware             = "Parallax"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "SPACE.WAW SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "08:ac:b3:2a:2e:27:cd:86:24:b5:56:cf:49:6d:e8:88"
      cert_thumbprint     = "C3D849F83D6C4FED05CED3C202F0174E82A34410"
      cert_valid_from     = "2025-08-28"
      cert_valid_to       = "2026-08-28"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "08:ac:b3:2a:2e:27:cd:86:24:b5:56:cf:49:6d:e8:88"
      )
}

rule MAL_Compromised_Cert_Parallax_Sectigo_2D067DC5B5A4B9B9A950D779E045F409 {
   meta:
      description         = "Detects Parallax with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-16"
      version             = "1.0"

      hash                = "bf6f0db6beb6359e23103f4e4286ea0f81e495b1161ca5d167ea16c59367fbef"
      malware             = "Parallax"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware is sold as a service. It started being seen first in 2019: https://www.morphisec.com/blog/parallax-rat-active-status/"

      signer              = "Wuhan Shuoxi Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "2d:06:7d:c5:b5:a4:b9:b9:a9:50:d7:79:e0:45:f4:09"
      cert_thumbprint     = "B8EE7EA2977BEAFDB0EF7977AFEFE210F9912938"
      cert_valid_from     = "2025-10-16"
      cert_valid_to       = "2026-10-16"

      country             = "CN"
      state               = "Hubei Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "2d:06:7d:c5:b5:a4:b9:b9:a9:50:d7:79:e0:45:f4:09"
      )
}

rule MAL_Compromised_Cert_PatchWork_Certum_7E62CF95CF6830668D5433052DC63A62 {
   meta:
      description         = "Detects PatchWork with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-08"
      version             = "1.0"

      hash                = "fb75316e371b73eec437e2a0a997f4d04eaca78f7a36cba7b71095d75e4aae01"
      malware             = "PatchWork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xi'an Qinxuntao Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "7e:62:cf:95:cf:68:30:66:8d:54:33:05:2d:c6:3a:62"
      cert_thumbprint     = "DC0370E05588243E8F5C0D116CA2F76459C6BEBF"
      cert_valid_from     = "2024-05-08"
      cert_valid_to       = "2025-05-08"

      country             = "CN"
      state               = "Shaanxi"
      locality            = "Xian"
      email               = "???"
      rdn_serial_number   = "91610113MA6X13GR4H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "7e:62:cf:95:cf:68:30:66:8d:54:33:05:2d:c6:3a:62"
      )
}

rule MAL_Compromised_Cert_PatchWork_SSL_com_0C03FD84E8E8569F0253D099494690D4 {
   meta:
      description         = "Detects PatchWork with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-05"
      version             = "1.0"

      hash                = "a68eff3ae040246a305b4aff70b09ab557d900dc6954ef498b030f87c5fedf0b"
      malware             = "PatchWork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Software Consulting Group Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "0c:03:fd:84:e8:e8:56:9f:02:53:d0:99:49:46:90:d4"
      cert_thumbprint     = "B185F504221A54E5219A063C8056F79736F7E98E"
      cert_valid_from     = "2024-02-05"
      cert_valid_to       = "2025-02-04"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "0c:03:fd:84:e8:e8:56:9f:02:53:d0:99:49:46:90:d4"
      )
}

rule MAL_Compromised_Cert_PatchWork_SSL_com_22A068D490E1F24964C3E5BDD4055C8C {
   meta:
      description         = "Detects PatchWork with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-20"
      version             = "1.0"

      hash                = "bf9445ded122ee5853bb45d69b390ed5a0b36baa0c48adc7a8fa65e526116720"
      malware             = "PatchWork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nikl Design Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "22:a0:68:d4:90:e1:f2:49:64:c3:e5:bd:d4:05:5c:8c"
      cert_thumbprint     = "27E1485F9B3B7CCE0576CE74A87CE57F9F65C88C"
      cert_valid_from     = "2024-05-20"
      cert_valid_to       = "2025-05-20"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "22:a0:68:d4:90:e1:f2:49:64:c3:e5:bd:d4:05:5c:8c"
      )
}

rule MAL_Compromised_Cert_PatchWork_Sectigo_00C60E355DF4D8FD635BDF10547947A99C {
   meta:
      description         = "Detects PatchWork with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-10"
      version             = "1.0"

      hash                = "f23219ecdaf0a4adceed01b9e363f66ff16b0ce0b269763d0cfc7309eaba44f7"
      malware             = "PatchWork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GJT AUTOMOTIVE LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA 2"
      cert_serial         = "00:c6:0e:35:5d:f4:d8:fd:63:5b:df:10:54:79:47:a9:9c"
      cert_thumbprint     = "380DE3C9CC3ADB85573FC8E8ACD8E855B13FEE54"
      cert_valid_from     = "2023-05-10"
      cert_valid_to       = "2024-05-09"

      country             = "GB"
      state               = "Lancashire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA 2" and
         sig.serial == "00:c6:0e:35:5d:f4:d8:fd:63:5b:df:10:54:79:47:a9:9c"
      )
}

rule MAL_Compromised_Cert_Patchwork_Certum_23C462C35AFF4789FF24599B0EBC6BE9 {
   meta:
      description         = "Detects Patchwork with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-28"
      version             = "1.0"

      hash                = "e6071ae0da3289eb87edf67b2b198b0a3f0cf9da8eb35a8a2b5aa8989b6c0ef5"
      malware             = "Patchwork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shandong Hongfu Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "23:c4:62:c3:5a:ff:47:89:ff:24:59:9b:0e:bc:6b:e9"
      cert_thumbprint     = "B915200E731D43F900D57AF7A2DE8467638282CA"
      cert_valid_from     = "2024-06-28"
      cert_valid_to       = "2025-06-28"

      country             = "CN"
      state               = "Shandong"
      locality            = "Linyi"
      email               = "???"
      rdn_serial_number   = "91371311MA3UWD0J5J"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "23:c4:62:c3:5a:ff:47:89:ff:24:59:9b:0e:bc:6b:e9"
      )
}

rule MAL_Compromised_Cert_Patchwork_DigiCert_0E427DE03B671DC464DEF6C38BEE9216 {
   meta:
      description         = "Detects Patchwork with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-16"
      version             = "1.0"

      hash                = "622e1b6677c32ff0b83f08a2c1f4a7384dbe8e7075f6c5917dd3419df1311631"
      malware             = "Patchwork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Baizhi Network Technology Co., Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0e:42:7d:e0:3b:67:1d:c4:64:de:f6:c3:8b:ee:92:16"
      cert_thumbprint     = "4D875FFF62AFEAC46BD847CC710F5B5C8D1333A8"
      cert_valid_from     = "2023-08-16"
      cert_valid_to       = "2026-08-15"

      country             = "CN"
      state               = "上海市"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91310114MA1GWA6R46"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0e:42:7d:e0:3b:67:1d:c4:64:de:f6:c3:8b:ee:92:16"
      )
}

rule MAL_Compromised_Cert_Patchwork_SSL_com_35483C93453F1FD87066ABC2075FA85B {
   meta:
      description         = "Detects Patchwork with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-30"
      version             = "1.0"

      hash                = "54fb4b99a4a45338809ee58a3ee43bf0bd9cb97b356c466cd19a87497f216985"
      malware             = "Patchwork"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BPM Micro ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "35:48:3c:93:45:3f:1f:d8:70:66:ab:c2:07:5f:a8:5b"
      cert_thumbprint     = "61BF6497E36516857FCC89508C644B6123E5D0BA"
      cert_valid_from     = "2025-05-30"
      cert_valid_to       = "2026-05-30"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Frederiksberg C"
      email               = "???"
      rdn_serial_number   = "39746875"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "35:48:3c:93:45:3f:1f:d8:70:66:ab:c2:07:5f:a8:5b"
      )
}

rule MAL_Compromised_Cert_Patchwork_SloppyLemming_SSL_com_16A7DA92271850749D3DD696D5874B7E {
   meta:
      description         = "Detects Patchwork,SloppyLemming with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-31"
      version             = "1.0"

      hash                = "331e7af55dc9e985a7918926b308ca3c24b1c47257c187de6481354c96f95b1e"
      malware             = "Patchwork,SloppyLemming"
      malware_type        = "Backdoor"
      malware_notes       = "The malware is delivered via phishing, disguised as a document. The malware may be involved in espionage activities targeting South East Asian organizations."

      signer              = "Fidus Software Consulting Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "16:a7:da:92:27:18:50:74:9d:3d:d6:96:d5:87:4b:7e"
      cert_thumbprint     = "9F2A133A77AC3ADA8B902FC8E8A67F422B15A3DE"
      cert_valid_from     = "2025-07-31"
      cert_valid_to       = "2026-07-31"

      country             = "CA"
      state               = "Ontario"
      locality            = "Stittsville"
      email               = "???"
      rdn_serial_number   = "1247135-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "16:a7:da:92:27:18:50:74:9d:3d:d6:96:d5:87:4b:7e"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_GlobalSign_2023C408EA40040913B41197 {
   meta:
      description         = "Detects PayDayLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-25"
      version             = "1.0"

      hash                = "82d2b0397dba3749c0444a70a197edaf4c862d815f00c2c4b47746c8e11da4f7"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuhan Nuochenxing Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "20:23:c4:08:ea:40:04:09:13:b4:11:97"
      cert_thumbprint     = "3C71900AAAA75A93FCF53D5EA207D29423C20A16"
      cert_valid_from     = "2025-04-25"
      cert_valid_to       = "2026-04-26"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "91420100MA49JDXD83"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "20:23:c4:08:ea:40:04:09:13:b4:11:97"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_GlobalSign_2316BBA5B2150DC6DAA6FA9B {
   meta:
      description         = "Detects PayDayLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-13"
      version             = "1.0"

      hash                = "9963af60316bb5da48072145ba147b82588f7ac56448d3723dd6629118bbed35"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "K.MY TRADING TRANSPORT COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "23:16:bb:a5:b2:15:0d:c6:da:a6:fa:9b"
      cert_thumbprint     = "E3AC11D2E804AA9464780ACA008193AEB430B48E"
      cert_valid_from     = "2024-12-13"
      cert_valid_to       = "2025-12-14"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "omeyakalima1@gmail.com"
      rdn_serial_number   = "0700867207"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "23:16:bb:a5:b2:15:0d:c6:da:a6:fa:9b"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_GlobalSign_4E8CCC13DF95117058746F21 {
   meta:
      description         = "Detects PayDayLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-01"
      version             = "1.0"

      hash                = "c3f9c300ca939a51d599114246beb08afb473bff565438994e9e1b457dbf5492"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC KomService"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4e:8c:cc:13:df:95:11:70:58:74:6f:21"
      cert_thumbprint     = "531C408CC578CD47B2B012AF2DE61698F657D0A9"
      cert_valid_from     = "2025-05-01"
      cert_valid_to       = "2026-05-02"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4e:8c:cc:13:df:95:11:70:58:74:6f:21"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_GlobalSign_75E46913F980041F17089F38 {
   meta:
      description         = "Detects PayDayLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-15"
      version             = "1.0"

      hash                = "86653cee7b63f7ced22546693b7f86c65c439dce97612be9cdf9aeccdd59c1df"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ICEL LOGISTICS COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "75:e4:69:13:f9:80:04:1f:17:08:9f:38"
      cert_thumbprint     = "31F9D9A6B70A5B9AA73025F45ACA1E562C35CC87"
      cert_valid_from     = "2024-10-15"
      cert_valid_to       = "2025-10-16"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "elmabordonbwa63@gmail.com"
      rdn_serial_number   = "0108307780"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "75:e4:69:13:f9:80:04:1f:17:08:9f:38"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_GlobalSign_77CB989CABBD6073B51B2762 {
   meta:
      description         = "Detects PayDayLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-27"
      version             = "1.0"

      hash                = "b5151e75e8e8af1519bef9111f2acbb24b290f0b1f9e7bc0518e9e6eac95f7cc"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AKE Holdings Limited"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "77:cb:98:9c:ab:bd:60:73:b5:1b:27:62"
      cert_thumbprint     = "FA33055AB8C304B4FDED16D55A28DFBF0DFB9992"
      cert_valid_from     = "2025-01-27"
      cert_valid_to       = "2026-01-28"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310000051291784T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "77:cb:98:9c:ab:bd:60:73:b5:1b:27:62"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_SSL_com_1F9173767331DE57953640A27B097968 {
   meta:
      description         = "Detects PayDayLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-04"
      version             = "1.0"

      hash                = "5ca6b15a14af2c8e9024e6168a8b30b84b49aeb593af31ecd7d0bbfc0a82c067"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Weifang Hanya Cultural Communication Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1f:91:73:76:73:31:de:57:95:36:40:a2:7b:09:79:68"
      cert_thumbprint     = "FC9982AA34B9F886E060953048FC3A5465DCB41B"
      cert_valid_from     = "2025-03-04"
      cert_valid_to       = "2026-03-02"

      country             = "CN"
      state               = "Shandong"
      locality            = "Weifang"
      email               = "???"
      rdn_serial_number   = "91370724MA7CKD064J"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1f:91:73:76:73:31:de:57:95:36:40:a2:7b:09:79:68"
      )
}

rule MAL_Compromised_Cert_PayDayLoader_SSL_com_3892A47F836D071C6747D8E5A77A3916 {
   meta:
      description         = "Detects PayDayLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "f82be98ea43b62e983683c0494dc6abf7a155843363f0107d484247ff1c2520a"
      malware             = "PayDayLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanxi Jiusheng Tongyuan Renewable Energy Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "38:92:a4:7f:83:6d:07:1c:67:47:d8:e5:a7:7a:39:16"
      cert_thumbprint     = "A6550C5129DC0C2C7F7C45DCB75C9C4B9EC77666"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2026-05-08"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Jinzhong"
      email               = "???"
      rdn_serial_number   = "91140727MA0GU6PQ3G"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "38:92:a4:7f:83:6d:07:1c:67:47:d8:e5:a7:7a:39:16"
      )
}

rule MAL_Compromised_Cert_PerfectStudio_GlobalSign_54A91ED64CA970FB46DACBA5 {
   meta:
      description         = "Detects PerfectStudio with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-15"
      version             = "1.0"

      hash                = "e1b9dce593374af5d44bf62350c5ba44c01416d73514557e03a228de46fafab3"
      malware             = "PerfectStudio"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SUNDARAM FOOTWEAR MARKETING PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "54:a9:1e:d6:4c:a9:70:fb:46:da:cb:a5"
      cert_thumbprint     = "EBF1B938F9B831B58F1571D798CBEFF84F02DF4C"
      cert_valid_from     = "2025-04-15"
      cert_valid_to       = "2026-04-16"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "54:a9:1e:d6:4c:a9:70:fb:46:da:cb:a5"
      )
}

rule MAL_Compromised_Cert_Pikabot_SSL_com_08BFA0ECA008014A726359AEE87C1828 {
   meta:
      description         = "Detects Pikabot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-15"
      version             = "1.0"

      hash                = "6c91b714aefef2438be04161d812403279c2da887902f9e979e83ace50dbb37a"
      malware             = "Pikabot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ARCHIKADIA SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "08:bf:a0:ec:a0:08:01:4a:72:63:59:ae:e8:7c:18:28"
      cert_thumbprint     = "566E7BCC466E79F9A21D4FF7DFF0A407D76B41F9"
      cert_valid_from     = "2024-01-15"
      cert_valid_to       = "2025-01-14"

      country             = "PL"
      state               = "Malopolskie"
      locality            = "Krakow"
      email               = "???"
      rdn_serial_number   = "0000806540"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "08:bf:a0:ec:a0:08:01:4a:72:63:59:ae:e8:7c:18:28"
      )
}

rule MAL_Compromised_Cert_Pikabot_SSL_com_2941D5F8758501F9DBC4BA158058C3B5 {
   meta:
      description         = "Detects Pikabot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-25"
      version             = "1.0"

      hash                = "89dc50024836f9ad406504a3b7445d284e97ec5dafdd8f2741f496cac84ccda9"
      malware             = "Pikabot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "A.P.Hernandez Consulting s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "29:41:d5:f8:75:85:01:f9:db:c4:ba:15:80:58:c3:b5"
      cert_thumbprint     = "AE7AD3DF41DEF3E3169FFA94B2E854D4EFDCEC35"
      cert_valid_from     = "2024-01-25"
      cert_valid_to       = "2025-01-24"

      country             = "SK"
      state               = "Trnava Region"
      locality            = "Sered"
      email               = "???"
      rdn_serial_number   = "51 770 075"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "29:41:d5:f8:75:85:01:f9:db:c4:ba:15:80:58:c3:b5"
      )
}

rule MAL_Compromised_Cert_Pikabot_SSL_com_5E90650175692086F73DD05EE14B3DA5 {
   meta:
      description         = "Detects Pikabot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "fafdd87991351ff0fa2b888a9d22fc058f1a08a6c08651d7ee0164740c70ec51"
      malware             = "Pikabot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "4leaf Holding Corp."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5e:90:65:01:75:69:20:86:f7:3d:d0:5e:e1:4b:3d:a5"
      cert_thumbprint     = "94BACD94876552AA683B8D9E4772A0E37C985E30"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2025-01-25"

      country             = "CA"
      state               = "Alberta"
      locality            = "Edmonton"
      email               = "???"
      rdn_serial_number   = "1017531-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5e:90:65:01:75:69:20:86:f7:3d:d0:5e:e1:4b:3d:a5"
      )
}

rule MAL_Compromised_Cert_Pikabot_SSL_com_79695808028C2494541535419610A4E0 {
   meta:
      description         = "Detects Pikabot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-19"
      version             = "1.0"

      hash                = "1626880b917b7f5756109dcb6533a5dbae859ccd841554e5bdb6c602cc3a9226"
      malware             = "Pikabot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Talk Invest ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "79:69:58:08:02:8c:24:94:54:15:35:41:96:10:a4:e0"
      cert_thumbprint     = "7B75394FF02197A21E6F683A717CB5A94C7C3DAE"
      cert_valid_from     = "2024-01-19"
      cert_valid_to       = "2025-01-18"

      country             = "DK"
      state               = "Region of Southern Denmark"
      locality            = "Tommerup"
      email               = "???"
      rdn_serial_number   = "40777555"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "79:69:58:08:02:8c:24:94:54:15:35:41:96:10:a4:e0"
      )
}

rule MAL_Compromised_Cert_PureHVNC_SSL_com_7EBAD9C6708D4A8E7673717C7D99E4CF {
   meta:
      description         = "Detects PureHVNC with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-20"
      version             = "1.0"

      hash                = "68eee73b68add553dcac41be42b0f41159d4fb02335ef4a3813efad8ff64d1f6"
      malware             = "PureHVNC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ferratum Capital Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7e:ba:d9:c6:70:8d:4a:8e:76:73:71:7c:7d:99:e4:cf"
      cert_thumbprint     = "223AC26A72792ACCA517AD143EFFE4E0E0FC5762"
      cert_valid_from     = "2025-08-20"
      cert_valid_to       = "2026-08-20"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7e:ba:d9:c6:70:8d:4a:8e:76:73:71:7c:7d:99:e4:cf"
      )
}

rule MAL_Compromised_Cert_QuakBot_Sectigo_45245EEF53FCF38169C715CF68F44452 {
   meta:
      description         = "Detects QuakBot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-20"
      version             = "1.0"

      hash                = "baad4165318587463cd3bd68857e6ebb43b8b184a8e9af133da1c786a0dd7a21"
      malware             = "QuakBot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "PAPER AND CORE SUPPLIES LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "45:24:5e:ef:53:fc:f3:81:69:c7:15:cf:68:f4:44:52"
      cert_thumbprint     = "448FCB70D90CBFD544E96149B85DC6364A3DB274"
      cert_valid_from     = "2021-12-20"
      cert_valid_to       = "2022-12-20"

      country             = "GB"
      state               = "London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "45:24:5e:ef:53:fc:f3:81:69:c7:15:cf:68:f4:44:52"
      )
}

rule MAL_Compromised_Cert_Quakbot_Certum_3CDBD09436B29CB127FCFB1823EE9A9A {
   meta:
      description         = "Detects Quakbot with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-05"
      version             = "1.0"

      hash                = "de095ea31816e724d6ec46f703b096e893efec5bcba9d018c52820e22d4fbd45"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "FORMICA Solution a.s."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "3c:db:d0:94:36:b2:9c:b1:27:fc:fb:18:23:ee:9a:9a"
      cert_thumbprint     = "CD868D85C7FA7A55C568ECD4B3F835D9D0486266"
      cert_valid_from     = "2021-02-05"
      cert_valid_to       = "2022-02-05"

      country             = "CZ"
      state               = "???"
      locality            = "Čestlice"
      email               = "???"
      rdn_serial_number   = "04668855"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "3c:db:d0:94:36:b2:9c:b1:27:fc:fb:18:23:ee:9a:9a"
      )
}

rule MAL_Compromised_Cert_Quakbot_SSL_com_03980D54388F052199A48939D5203C0C {
   meta:
      description         = "Detects Quakbot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-14"
      version             = "1.0"

      hash                = "e88610db05636a1476435ec1f39d3651b080c8a6b8756452d421d7a822a2e115"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Clover Field ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "03:98:0d:54:38:8f:05:21:99:a4:89:39:d5:20:3c:0c"
      cert_thumbprint     = "1C2C084FB6E18A4033B63E619868CF81819BF46E"
      cert_valid_from     = "2023-12-14"
      cert_valid_to       = "2024-12-13"

      country             = "DK"
      state               = "Region of Southern Denmark"
      locality            = "Nyborg"
      email               = "???"
      rdn_serial_number   = "33584113"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "03:98:0d:54:38:8f:05:21:99:a4:89:39:d5:20:3c:0c"
      )
}

rule MAL_Compromised_Cert_Quakbot_SSL_com_1730848A0A9AEB9F5968331E08D74236 {
   meta:
      description         = "Detects Quakbot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-22"
      version             = "1.0"

      hash                = "93a98b919aec23411ae62dba8d0d22f939da45dec19db2b4e7293124d8f1507f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SOFTWARE AGILITY LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "17:30:84:8a:0a:9a:eb:9f:59:68:33:1e:08:d7:42:36"
      cert_thumbprint     = "50E22AA4B3B145FE1193EBBABED0637FA381FAC3"
      cert_valid_from     = "2023-11-22"
      cert_valid_to       = "2024-11-21"

      country             = "GB"
      state               = "???"
      locality            = "Ashby-De-La-Zouch"
      email               = "???"
      rdn_serial_number   = "08424580"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "17:30:84:8a:0a:9a:eb:9f:59:68:33:1e:08:d7:42:36"
      )
}

rule MAL_Compromised_Cert_Quakbot_SSL_com_44E737228040233FCD8DED2BF108CE8C {
   meta:
      description         = "Detects Quakbot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-26"
      version             = "1.0"

      hash                = "8db0b8f45f726a963b34410c74194e0b40f6720561731e8242ee60a8a7d7e3ce"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Ken Friedman AB"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "44:e7:37:22:80:40:23:3f:cd:8d:ed:2b:f1:08:ce:8c"
      cert_thumbprint     = "BB296138FB75F5CEB45E36B85A8DF7CC82C6364C"
      cert_valid_from     = "2023-12-26"
      cert_valid_to       = "2024-12-25"

      country             = "SE"
      state               = "Kalmar County"
      locality            = "Kalmar"
      email               = "???"
      rdn_serial_number   = "556982-0771"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "44:e7:37:22:80:40:23:3f:cd:8d:ed:2b:f1:08:ce:8c"
      )
}

rule MAL_Compromised_Cert_Quakbot_SSL_com_4A3F0BF26862263DAC496033F50594CB {
   meta:
      description         = "Detects Quakbot with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-15"
      version             = "1.0"

      hash                = "fda2abd24764809fb36d4d2ee7ab5f6e8c06381fe6d9bb191bde62411c96ba92"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SOFTWARE MEDICAL DEVICES LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4a:3f:0b:f2:68:62:26:3d:ac:49:60:33:f5:05:94:cb"
      cert_thumbprint     = "7917A946ED473A0E81BD4501B0B1736FB1AC653D"
      cert_valid_from     = "2023-12-15"
      cert_valid_to       = "2024-12-14"

      country             = "GB"
      state               = "???"
      locality            = "Tadworth"
      email               = "???"
      rdn_serial_number   = "12713418"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4a:3f:0b:f2:68:62:26:3d:ac:49:60:33:f5:05:94:cb"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00881573FC67FF7395DDE5BCCFBCE5B088 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-03"
      version             = "1.0"

      hash                = "de9738c0910931b2b5e1f68841637a25301d17ab3860cd6e2cc1cbef9af1f5dd"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Trade in Brasil s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:88:15:73:fc:67:ff:73:95:dd:e5:bc:cf:bc:e5:b0:88"
      cert_thumbprint     = "31B3A3C173C2A2D1086794BFC8D853E25E62FB46"
      cert_valid_from     = "2021-05-03"
      cert_valid_to       = "2022-05-03"

      country             = "SK"
      state               = "Bratislavský kraj"
      locality            = "mestská časť Nové Mesto"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:88:15:73:fc:67:ff:73:95:dd:e5:bc:cf:bc:e5:b0:88"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00890570B6B0E2868A53BE3F8F904A88EE {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-11"
      version             = "1.0"

      hash                = "f5e0f08a97072dde8e5481e5cc645717055c821ce76d2d0d80e76a57b47f931b"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "JESEN LESS d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:89:05:70:b6:b0:e2:86:8a:53:be:3f:8f:90:4a:88:ee"
      cert_thumbprint     = "D74A465037EE5FB1D7D4C46A58E960459A3D0174"
      cert_valid_from     = "2021-11-11"
      cert_valid_to       = "2022-11-11"

      country             = "SI"
      state               = "Ljubljana"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:89:05:70:b6:b0:e2:86:8a:53:be:3f:8f:90:4a:88:ee"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_0092D9B92F8CF7A1BA8B2C025BE730C300 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-22"
      version             = "1.0"

      hash                = "18462e94cec35c1bf5be85d3473631829e1aea7ab283df694606d8a5057e538a"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "UPLagga Systems s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:92:d9:b9:2f:8c:f7:a1:ba:8b:2c:02:5b:e7:30:c3:00"
      cert_thumbprint     = "58B677149BC75D71CDC97A4E1BD56534ADA8FBCC"
      cert_valid_from     = "2020-08-22"
      cert_valid_to       = "2021-08-22"

      country             = "CZ"
      state               = "???"
      locality            = "Praha"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:92:d9:b9:2f:8c:f7:a1:ba:8b:2c:02:5b:e7:30:c3:00"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00984E84CFE362E278F558E2C70AAAFAC2 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-24"
      version             = "1.0"

      hash                = "94f38d5422e546a4569120ceca7895b0b0828cffac8beb82c57135ccd82cbbd6"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Arctic Nights Äkäslompolo Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:98:4e:84:cf:e3:62:e2:78:f5:58:e2:c7:0a:aa:fa:c2"
      cert_thumbprint     = "BA543D98A47AC10C6298281B7800F7F439A7EFA3"
      cert_valid_from     = "2021-12-24"
      cert_valid_to       = "2022-12-24"

      country             = "FI"
      state               = "Lappi"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:98:4e:84:cf:e3:62:e2:78:f5:58:e2:c7:0a:aa:fa:c2"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_009BD81A9ADAF71F1FF081C1F4A05D7FD7 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-03"
      version             = "1.0"

      hash                = "d86093212dafd8a363412060ce27984f98829de5cbe684978407f6478b8d68cf"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SMART TOYS AND GAMES, INC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:9b:d8:1a:9a:da:f7:1f:1f:f0:81:c1:f4:a0:5d:7f:d7"
      cert_thumbprint     = "122DEB269E3DF6CEE8396E450D66CB679CEF38FC"
      cert_valid_from     = "2020-10-03"
      cert_valid_to       = "2021-10-03"

      country             = "US"
      state               = "California"
      locality            = "SAN FRANCISCO"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:9b:d8:1a:9a:da:f7:1f:1f:f0:81:c1:f4:a0:5d:7f:d7"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00A03EA3A4FA772B17037A0B80F1F968AA {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-16"
      version             = "1.0"

      hash                = "fc7a4edf9d9984d4a53b4296f0d0160436144bc5631b8c5b445a86f3bfa9ff61"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "DREVOKAPITAL, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:a0:3e:a3:a4:fa:77:2b:17:03:7a:0b:80:f1:f9:68:aa"
      cert_thumbprint     = "D3145F5D55A7399C46AE011711B479985459D39A"
      cert_valid_from     = "2020-12-16"
      cert_valid_to       = "2021-12-16"

      country             = "SK"
      state               = "???"
      locality            = "Svidník"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:a0:3e:a3:a4:fa:77:2b:17:03:7a:0b:80:f1:f9:68:aa"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00A7989F8BE0C82D35A19E7B3DD4BE30E5 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-22"
      version             = "1.0"

      hash                = "8b49bc1afd15dcc2bcc23b7637d58aca9a17b5b8a9e66ebdd109200fda384f0e"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Instamix Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:a7:98:9f:8b:e0:c8:2d:35:a1:9e:7b:3d:d4:be:30:e5"
      cert_thumbprint     = "3593F02EB856F36BE77458777C86028DB5BD7588"
      cert_valid_from     = "2020-08-22"
      cert_valid_to       = "2021-08-22"

      country             = "IE"
      state               = "Dublin"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:a7:98:9f:8b:e0:c8:2d:35:a1:9e:7b:3d:d4:be:30:e5"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00A918455C0D4DA7CA474F41F11A7CF38C {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-21"
      version             = "1.0"

      hash                = "e7a6e97363a3160280cdff69153dad3255759fc76dd10fc990432fd6c8f20cd4"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "MIDDRA INTERNATIONAL CORP."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:a9:18:45:5c:0d:4d:a7:ca:47:4f:41:f1:1a:7c:f3:8c"
      cert_thumbprint     = "CE69E1DC8E1BC1B49A523E7B7B0E9A22FAC826AB"
      cert_valid_from     = "2021-04-21"
      cert_valid_to       = "2022-04-21"

      country             = "US"
      state               = "California"
      locality            = "Los Angeles"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:a9:18:45:5c:0d:4d:a7:ca:47:4f:41:f1:1a:7c:f3:8c"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00AA07D4F2857119CEE514A0BD412F8201 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-15"
      version             = "1.0"

      hash                = "cb4241399f69ba6a8b4e2297b225953b764fb41b4c27dcb3c923c0c54a51d627"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "HANGA GIP d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:aa:07:d4:f2:85:71:19:ce:e5:14:a0:bd:41:2f:82:01"
      cert_thumbprint     = "D303630353BB98D67EFCDF298119B9A1BE208D20"
      cert_valid_from     = "2021-03-15"
      cert_valid_to       = "2022-03-15"

      country             = "SI"
      state               = "???"
      locality            = "Velenje"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:aa:07:d4:f2:85:71:19:ce:e5:14:a0:bd:41:2f:82:01"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00AA1D84779792B57F91FE7A4BDE041942 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-19"
      version             = "1.0"

      hash                = "8ad652ed5304408015e65d5ab8ecf65fecf8f00c1e5eb97606bd01d6031f5418"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "AXIUM NORTHWESTERN HYDRO INC."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:aa:1d:84:77:97:92:b5:7f:91:fe:7a:4b:de:04:19:42"
      cert_thumbprint     = "6C15651791EA8D91909A557EADABE3581B4D1BE9"
      cert_valid_from     = "2021-12-19"
      cert_valid_to       = "2022-12-19"

      country             = "CA"
      state               = "Ontario"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:aa:1d:84:77:97:92:b5:7f:91:fe:7a:4b:de:04:19:42"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00AA28C9BD16D9D304F18AF223B27BFA1E {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-27"
      version             = "1.0"

      hash                = "68199ddf000a34ebcf9cedb1d45eefb0319f0a802197e64c4658e7ea9f04a943"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Tecno trade d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:aa:28:c9:bd:16:d9:d3:04:f1:8a:f2:23:b2:7b:fa:1e"
      cert_thumbprint     = "252E076F4AC2A0EBA7BC1F62C6FB9B1137D4754E"
      cert_valid_from     = "2021-01-27"
      cert_valid_to       = "2022-01-27"

      country             = "SI"
      state               = "???"
      locality            = "Koper"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:aa:28:c9:bd:16:d9:d3:04:f1:8a:f2:23:b2:7b:fa:1e"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00AC307E5257BB814B818D3633B630326F {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-23"
      version             = "1.0"

      hash                = "3b2e8af68cd45ca960f18b429395e701b650e7d603060282994feb9d01c90852"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Aqua Direct s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ac:30:7e:52:57:bb:81:4b:81:8d:36:33:b6:30:32:6f"
      cert_thumbprint     = "4D6A089EC4EDCAC438717C1D64A8BE4EF925A9C6"
      cert_valid_from     = "2020-11-23"
      cert_valid_to       = "2021-11-23"

      country             = "CZ"
      state               = "???"
      locality            = "Brno"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ac:30:7e:52:57:bb:81:4b:81:8d:36:33:b6:30:32:6f"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00AFE8FEE94B41422E01E4897BCD52D0A4 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-30"
      version             = "1.0"

      hash                = "253b5a915f1d7e14804228c862f39df4f8b2a7e7f96d94a863069c1c4d87e4e6"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "TLGM ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:af:e8:fe:e9:4b:41:42:2e:01:e4:89:7b:cd:52:d0:a4"
      cert_thumbprint     = "6E0E838F5F5194DC08CC0D750E76B2DA3060265C"
      cert_valid_from     = "2021-03-30"
      cert_valid_to       = "2022-03-30"

      country             = "DK"
      state               = "???"
      locality            = "Allerød"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:af:e8:fe:e9:4b:41:42:2e:01:e4:89:7b:cd:52:d0:a4"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00B2E730B0526F36FAF7D093D48D6D9997 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-13"
      version             = "1.0"

      hash                = "fa8bb8aade3749fb3338d7cd35c9e07781a5422aed193f85e5a3bc1b2fd02c1f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Bamboo Connect s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b2:e7:30:b0:52:6f:36:fa:f7:d0:93:d4:8d:6d:99:97"
      cert_thumbprint     = "5036853F8EF939ADEDE39BD7E620C5A9788C24D6"
      cert_valid_from     = "2020-08-13"
      cert_valid_to       = "2021-08-13"

      country             = "CZ"
      state               = "???"
      locality            = "Ostrava"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b2:e7:30:b0:52:6f:36:fa:f7:d0:93:d4:8d:6d:99:97"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00B2F9C693A2E6634565F63C79B01DD8F8 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-03"
      version             = "1.0"

      hash                = "e3bf20fa69644c0ca34c600feb3c43f70a1d51408534d1167825a2178a7b7073"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "PHL E STATE ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b2:f9:c6:93:a2:e6:63:45:65:f6:3c:79:b0:1d:d8:f8"
      cert_thumbprint     = "7F6DB1E8EFE0831E81A5994DD74158875D0D8268"
      cert_valid_from     = "2021-05-03"
      cert_valid_to       = "2022-05-03"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Gentofte"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b2:f9:c6:93:a2:e6:63:45:65:f6:3c:79:b0:1d:d8:f8"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00B61B8E71514059ADC604DA05C283E514 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-22"
      version             = "1.0"

      hash                = "12a59869c0e78eed60e76adc9c592ba8b9f3d2835f19d4c46e7a458739d6aedf"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "APP DIVISION ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b6:1b:8e:71:51:40:59:ad:c6:04:da:05:c2:83:e5:14"
      cert_thumbprint     = "67EE69F380CA62B28CECFBEF406970DDD26CD9BE"
      cert_valid_from     = "2020-10-22"
      cert_valid_to       = "2021-10-22"

      country             = "DK"
      state               = "Syddanmark"
      locality            = "Årslev"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b6:1b:8e:71:51:40:59:ad:c6:04:da:05:c2:83:e5:14"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00BDC81BC76090DAE0EEE2E1EB744A4F9A {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-01-24"
      version             = "1.0"

      hash                = "892f8de40ffec90d9316a37e3a7cea1a137aa278c733fd599333f3ba0f5e4157"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "ALM4U GmbH"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:bd:c8:1b:c7:60:90:da:e0:ee:e2:e1:eb:74:4a:4f:9a"
      cert_thumbprint     = "AA41AC7A5B40A4140D72ABC136226973098F5330"
      cert_valid_from     = "2020-01-24"
      cert_valid_to       = "2021-01-23"

      country             = "AT"
      state               = "Lower Austria"
      locality            = "Langenrohr"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:bd:c8:1b:c7:60:90:da:e0:ee:e2:e1:eb:74:4a:4f:9a"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00C2FC83D458E653837FCFC132C9B03062 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-09"
      version             = "1.0"

      hash                = "dcda70b5cc63629dd2760dbc76ffda0bedefd0ee92af4d4e3740acc7dd2eaff2"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OOO Vertical"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c2:fc:83:d4:58:e6:53:83:7f:cf:c1:32:c9:b0:30:62"
      cert_thumbprint     = "3B49AE9768E845E6225D3DC8FF347CB2607FF052"
      cert_valid_from     = "2020-10-09"
      cert_valid_to       = "2021-10-09"

      country             = "RU"
      state               = "???"
      locality            = "Moskva"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c2:fc:83:d4:58:e6:53:83:7f:cf:c1:32:c9:b0:30:62"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00C318D876768258A696AB9DD825E27ACD {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-08"
      version             = "1.0"

      hash                = "4be7aad46de1042ea916b9e6ef6f18fcb56b40e768b94b733b70ca2995866cc6"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OOO Genezis"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c3:18:d8:76:76:82:58:a6:96:ab:9d:d8:25:e2:7a:cd"
      cert_thumbprint     = "4D201ED143905E95834BEC8161225ACDC38A8827"
      cert_valid_from     = "2021-03-08"
      cert_valid_to       = "2022-03-08"

      country             = "RU"
      state               = "???"
      locality            = "Ufa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c3:18:d8:76:76:82:58:a6:96:ab:9d:d8:25:e2:7a:cd"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00C51F4CF4D82BC920421E1AD93E39D490 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-12"
      version             = "1.0"

      hash                = "37e973699f119ce5a2047281aa6f52429bc15164abdfe110f3340ee02d4c21b5"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "CUT AHEAD LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:c5:1f:4c:f4:d8:2b:c9:20:42:1e:1a:d9:3e:39:d4:90"
      cert_thumbprint     = "93E82A7C73DBE0741BBC926A8CF17DFA5BBEA1E1"
      cert_valid_from     = "2022-02-12"
      cert_valid_to       = "2023-02-12"

      country             = "GB"
      state               = "Cheshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:c5:1f:4c:f4:d8:2b:c9:20:42:1e:1a:d9:3e:39:d4:90"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00C8442A8185082EF1ED7DC3FFF2176AA7 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-29"
      version             = "1.0"

      hash                = "53214f4721ef1221632de09fd853580056811ac6632b517d77fb326956129530"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Ambidekstr LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c8:44:2a:81:85:08:2e:f1:ed:7d:c3:ff:f2:17:6a:a7"
      cert_thumbprint     = "C403C50A6FDFB39B9197EFBA4F253715C346090D"
      cert_valid_from     = "2021-03-29"
      cert_valid_to       = "2022-03-29"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c8:44:2a:81:85:08:2e:f1:ed:7d:c3:ff:f2:17:6a:a7"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00C8EDCFE8BE174C2F204D858C5B91DEA5 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-16"
      version             = "1.0"

      hash                = "11d92a8bbd12d0f4634904ccc0037f58e99ab9d71e8341930a25564b3f2dec78"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Paarcopy Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c8:ed:cf:e8:be:17:4c:2f:20:4d:85:8c:5b:91:de:a5"
      cert_thumbprint     = "7F5F205094940793D1028960E0F0E8B654F9956E"
      cert_valid_from     = "2020-12-16"
      cert_valid_to       = "2021-12-16"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "ESPOO"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c8:ed:cf:e8:be:17:4c:2f:20:4d:85:8c:5b:91:de:a5"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00CA646B4275406DF639CF603756F63D77 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-20"
      version             = "1.0"

      hash                = "6fcb5a86e736d4ec02334c9573a3eab21769538b30786cf02c5744ad5336594f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SHOECORP LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ca:64:6b:42:75:40:6d:f6:39:cf:60:37:56:f6:3d:77"
      cert_thumbprint     = "2A68CFAD2D82CAAE48D4DCBB49AA73AAF3FE79DD"
      cert_valid_from     = "2020-11-20"
      cert_valid_to       = "2021-11-20"

      country             = "IE"
      state               = "???"
      locality            = "TIPPERARY"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ca:64:6b:42:75:40:6d:f6:39:cf:60:37:56:f6:3d:77"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00CC95D6EBF18A3711E196AEA210465A19 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-26"
      version             = "1.0"

      hash                = "f86eb10a728b912bfb98529ccc0e2dfedfe1bda9b12b8556dba19f810720a567"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "GEN Sistemi, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:cc:95:d6:eb:f1:8a:37:11:e1:96:ae:a2:10:46:5a:19"
      cert_thumbprint     = "319F0E03F0F230629258C7EA05E7D56EAD830CE9"
      cert_valid_from     = "2021-02-26"
      cert_valid_to       = "2022-02-26"

      country             = "SI"
      state               = "???"
      locality            = "Hajdina"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:cc:95:d6:eb:f1:8a:37:11:e1:96:ae:a2:10:46:5a:19"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D3356318924C8C42959BF1D1574E6482 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-11"
      version             = "1.0"

      hash                = "e38dfd919696b891fad1c1e5e0d69bcda08a044b526db42f68a149cd5d871bfb"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "ADV TOURS d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d3:35:63:18:92:4c:8c:42:95:9b:f1:d1:57:4e:64:82"
      cert_thumbprint     = "E21F261F5CF7C2856BD9DA5A5ED2C4E2B2EF4C9A"
      cert_valid_from     = "2021-02-11"
      cert_valid_to       = "2022-02-11"

      country             = "SI"
      state               = "???"
      locality            = "Velenje"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d3:35:63:18:92:4c:8c:42:95:9b:f1:d1:57:4e:64:82"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D338F8A490E37E6C2BE80A0E349929FA {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-10"
      version             = "1.0"

      hash                = "dbc1c772413a6d461d8c5db0d1b2538d9879c3f6890c8be34fe9723b5817909f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SAGUARO ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d3:38:f8:a4:90:e3:7e:6c:2b:e8:0a:0e:34:99:29:fa"
      cert_thumbprint     = "9F039085397000D32A63A5AC092903E3655F9243"
      cert_valid_from     = "2020-12-10"
      cert_valid_to       = "2021-12-10"

      country             = "DK"
      state               = "???"
      locality            = "Vallensbæk Strand"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d3:38:f8:a4:90:e3:7e:6c:2b:e8:0a:0e:34:99:29:fa"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D3AEE8ABB9948844A3AC1C04CC7E6BDF {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-12-30"
      version             = "1.0"

      hash                = "cd8a94e42e7119a3f1b5117151b7bb2fe4a777f221581b2dae0c2cf0e8ddedf2"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "HOUSE 9A s.r.o"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:d3:ae:e8:ab:b9:94:88:44:a3:ac:1c:04:cc:7e:6b:df"
      cert_thumbprint     = "E5732E135DD2336153938B25B82E0D1F392A4449"
      cert_valid_from     = "2021-12-30"
      cert_valid_to       = "2022-12-30"

      country             = "SK"
      state               = "Žilinský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:d3:ae:e8:ab:b9:94:88:44:a3:ac:1c:04:cc:7e:6b:df"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D4EF1AB6AB5D3CB35E4EFB7984DEF7A2 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-21"
      version             = "1.0"

      hash                = "309bca5d9fde32746cd61a7ea4b2da3ef8f6cf2de57ee40e835c1b26237c991a"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "REIGN BROS ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d4:ef:1a:b6:ab:5d:3c:b3:5e:4e:fb:79:84:de:f7:a2"
      cert_thumbprint     = "10D82C75A1846EBFB2A0D1ABE9C01622BDFABF0A"
      cert_valid_from     = "2021-01-21"
      cert_valid_to       = "2022-01-21"

      country             = "DK"
      state               = "???"
      locality            = "København K"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d4:ef:1a:b6:ab:5d:3c:b3:5e:4e:fb:79:84:de:f7:a2"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D59A05955A4A421500F9561CE983AAC4 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-30"
      version             = "1.0"

      hash                = "f0329494b1a9a26aac06e2606c95e31167035d8f576ed8773664d7578913cf36"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Olymp LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d5:9a:05:95:5a:4a:42:15:00:f9:56:1c:e9:83:aa:c4"
      cert_thumbprint     = "0F131A77C53A2123AD8C57A2110BE44FE73473DE"
      cert_valid_from     = "2020-09-30"
      cert_valid_to       = "2021-09-04"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d5:9a:05:95:5a:4a:42:15:00:f9:56:1c:e9:83:aa:c4"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D627F1000D12485995514BFBDEFC55D9 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-17"
      version             = "1.0"

      hash                = "27a1293d50124b0f40f4872bca6490eda7f01462dc612de6898e264bb91d9a6c"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "THREE D CORPORATION PTY LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d6:27:f1:00:0d:12:48:59:95:51:4b:fb:de:fc:55:d9"
      cert_thumbprint     = "51BE49CF33BE69695216FDE854479F4E5DEE5987"
      cert_valid_from     = "2020-08-17"
      cert_valid_to       = "2021-08-17"

      country             = "AU"
      state               = "???"
      locality            = "MILL PARK"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d6:27:f1:00:0d:12:48:59:95:51:4b:fb:de:fc:55:d9"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00D7C432E8D4EDEF515BFB9D1C214FF0F5 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-02"
      version             = "1.0"

      hash                = "fc59281d717018816d0ff8f2aa58e5491df892d3e85c50c8826b8e0ee5904af1"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "LLC \"MILKY PUT\""
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:d7:c4:32:e8:d4:ed:ef:51:5b:fb:9d:1c:21:4f:f0:f5"
      cert_thumbprint     = "045050E789C0E3DFC972CC97EFB4A49709A80AF1"
      cert_valid_from     = "2020-10-02"
      cert_valid_to       = "2021-10-02"

      country             = "RU"
      state               = "???"
      locality            = "Sankt-Peterburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:d7:c4:32:e8:d4:ed:ef:51:5b:fb:9d:1c:21:4f:f0:f5"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00DA156922F4760E0C5F5BCF79812A27E1 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-05"
      version             = "1.0"

      hash                = "2b9861436d994bee6a332cbaf71a9fd6f157089062f414207c9effe84bf556e5"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "DRINK AND BUBBLE LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:da:15:69:22:f4:76:0e:0c:5f:5b:cf:79:81:2a:27:e1"
      cert_thumbprint     = "3E4EA5E17FEA0603E82D9FE1376D739B827C4E5B"
      cert_valid_from     = "2022-04-05"
      cert_valid_to       = "2023-04-05"

      country             = "GB"
      state               = "London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:da:15:69:22:f4:76:0e:0c:5f:5b:cf:79:81:2a:27:e1"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00DA20761AFBB0463C55B1EA88BBC7EC57 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-01-18"
      version             = "1.0"

      hash                = "a9db99b934cb21df04e03d2b0d08ea6e6aaaa31ed185cdcff3d0148ea28454a3"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "CLEVER CLOSE s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:da:20:76:1a:fb:b0:46:3c:55:b1:ea:88:bb:c7:ec:57"
      cert_thumbprint     = "62590D0A1333574142A7CB65A9BC4D4874BD8563"
      cert_valid_from     = "2022-01-18"
      cert_valid_to       = "2023-01-18"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:da:20:76:1a:fb:b0:46:3c:55:b1:ea:88:bb:c7:ec:57"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00DADF44E4046372313EE97B8E394C4079 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-08"
      version             = "1.0"

      hash                = "07dc705da27544ca4d232515c665dff2bbbf6b0ab49fd07c602e20d6a512b4af"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Digital Capital Management Ireland Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:da:df:44:e4:04:63:72:31:3e:e9:7b:8e:39:4c:40:79"
      cert_thumbprint     = "BE030FEFB88F9CFD0B67BE014662AE419E4936C0"
      cert_valid_from     = "2020-09-08"
      cert_valid_to       = "2021-09-08"

      country             = "IE"
      state               = "Kildare"
      locality            = "Naas"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:da:df:44:e4:04:63:72:31:3e:e9:7b:8e:39:4c:40:79"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00E04A344B397F752A45B128A594A3D6B5 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-18"
      version             = "1.0"

      hash                = "fa70becac90d59aa490f4735e317fe5950b3e05dd6537894a38608413369d649"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Highweb Ireland Operations Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e0:4a:34:4b:39:7f:75:2a:45:b1:28:a5:94:a3:d6:b5"
      cert_thumbprint     = "1EE4240E49F7889BFD57304E967247BDA7C2F2CB"
      cert_valid_from     = "2020-08-18"
      cert_valid_to       = "2021-08-18"

      country             = "IE"
      state               = "Dublin"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e0:4a:34:4b:39:7f:75:2a:45:b1:28:a5:94:a3:d6:b5"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00E267FDBDC16F22E8185D35C437F84C87 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-01"
      version             = "1.0"

      hash                = "4767f1d796361381636e0a0f6815346e85e23e441fa9e281baa17fc93910117d"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "APOTHEKA, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e2:67:fd:bd:c1:6f:22:e8:18:5d:35:c4:37:f8:4c:87"
      cert_thumbprint     = "CDF4A69402936ECE82F3F9163E6CC648BCBB2680"
      cert_valid_from     = "2020-12-01"
      cert_valid_to       = "2021-12-01"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e2:67:fd:bd:c1:6f:22:e8:18:5d:35:c4:37:f8:4c:87"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00E38259CF24CC702CE441B683AD578911 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-13"
      version             = "1.0"

      hash                = "f953b103ae09065e639890aa4e133f54ac9a2a5f5eb519d970b2b8d40d251626"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Akhirah Technologies Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e3:82:59:cf:24:cc:70:2c:e4:41:b6:83:ad:57:89:11"
      cert_thumbprint     = "528F7B649E2600B5F5672233611A9319858B9A9F"
      cert_valid_from     = "2020-08-13"
      cert_valid_to       = "2021-08-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Etobicoke"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e3:82:59:cf:24:cc:70:2c:e4:41:b6:83:ad:57:89:11"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00E5AD42C509A7C24605530D35832C091E {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-04"
      version             = "1.0"

      hash                = "3849944c5db10f13305f76c92c1a8c80bc37f6a0514c19ea4a2bbeae62438113"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "VESNA, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e5:ad:42:c5:09:a7:c2:46:05:53:0d:35:83:2c:09:1e"
      cert_thumbprint     = "64197FF3B465B9D3C9300EB985CE635EE1C3DD6A"
      cert_valid_from     = "2020-09-04"
      cert_valid_to       = "2021-09-04"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e5:ad:42:c5:09:a7:c2:46:05:53:0d:35:83:2c:09:1e"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00E953ADA7E8F1438E5F7680FF599AE43E {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-03"
      version             = "1.0"

      hash                = "2606bf8f473dee7f8407db99323d14f8c241c25db538b20dfe7fb368c46b4278"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "KULBYT LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e9:53:ad:a7:e8:f1:43:8e:5f:76:80:ff:59:9a:e4:3e"
      cert_thumbprint     = "D994C0AFCFF039229E7CE86E2926B2B29430544B"
      cert_valid_from     = "2021-03-03"
      cert_valid_to       = "2022-03-03"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e9:53:ad:a7:e8:f1:43:8e:5f:76:80:ff:59:9a:e4:3e"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00EA720222D92DC8D48E3B3C3B0FC360A6 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-16"
      version             = "1.0"

      hash                = "c972346b25a36cb3ddaeb4ede844d18711cbbf8226d74075879e5d8b49b8d46c"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "CAVANAGH NETS LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ea:72:02:22:d9:2d:c8:d4:8e:3b:3c:3b:0f:c3:60:a6"
      cert_thumbprint     = "522D0F1CA87EF784994DFD63CB0919722DFDB79F"
      cert_valid_from     = "2020-12-16"
      cert_valid_to       = "2021-12-16"

      country             = "IE"
      state               = "???"
      locality            = "GREENCASTLE"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ea:72:02:22:d9:2d:c8:d4:8e:3b:3c:3b:0f:c3:60:a6"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00F097E59809AE2E771B7B9AE5FC3408D7 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-07"
      version             = "1.0"

      hash                = "96e21a6d02770fdff74ac912154f8c7c7a934d7236360485920c8550fa0050a1"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "ABEL RENOVATIONS, INC."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f0:97:e5:98:09:ae:2e:77:1b:7b:9a:e5:fc:34:08:d7"
      cert_thumbprint     = "AC0E2E057CADD25B569B10BB5760C1A7E17569AB"
      cert_valid_from     = "2020-10-07"
      cert_valid_to       = "2021-10-07"

      country             = "US"
      state               = "Florida"
      locality            = "JACKSONVILLE"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f0:97:e5:98:09:ae:2e:77:1b:7b:9a:e5:fc:34:08:d7"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00F675139EA68B897A865A98F8E4611F00 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-03"
      version             = "1.0"

      hash                = "c2482679c665dbec35164aba7554000817139035dc12efc9e936790ca49e7854"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "BS TEHNIK d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f6:75:13:9e:a6:8b:89:7a:86:5a:98:f8:e4:61:1f:00"
      cert_thumbprint     = "06D46EE9037080C003983D76BE3216B7CAD528F8"
      cert_valid_from     = "2020-12-03"
      cert_valid_to       = "2021-12-03"

      country             = "SI"
      state               = "???"
      locality            = "Lukovica"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f6:75:13:9e:a6:8b:89:7a:86:5a:98:f8:e4:61:1f:00"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00F8C2E08438BB0E9ADC955E4B493E5821 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-08"
      version             = "1.0"

      hash                = "b66b7bfcdc8d6fb55fe600c20302405a22e1e7b60a0bb1e48a0ccf4e5daf8e50"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "DocsGen Software Solutions Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f8:c2:e0:84:38:bb:0e:9a:dc:95:5e:4b:49:3e:58:21"
      cert_thumbprint     = "C4B81197FAC9129D0D1D65FE14FDAC7F2008BFF6"
      cert_valid_from     = "2020-09-08"
      cert_valid_to       = "2021-09-08"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f8:c2:e0:84:38:bb:0e:9a:dc:95:5e:4b:49:3e:58:21"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00FE41941464B9992A69B7317418AE8EB7 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-08"
      version             = "1.0"

      hash                = "9668bf80c1521a42cebce4a8c81da28fd5b10d846af370b2ad7c0ccda415c258"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Milsean Software Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:fe:41:94:14:64:b9:99:2a:69:b7:31:74:18:ae:8e:b7"
      cert_thumbprint     = "552EABCAF5B6D26BCD9D584346701C45C3FDA18C"
      cert_valid_from     = "2020-09-08"
      cert_valid_to       = "2021-09-08"

      country             = "IE"
      state               = "???"
      locality            = "Waterford"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:fe:41:94:14:64:b9:99:2a:69:b7:31:74:18:ae:8e:b7"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00FED006FBF85CD1C6BA6B4345B198E1E6 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-26"
      version             = "1.0"

      hash                = "ca14dd19ab553fa613a98a71f1d50ef73b9f91436f47b1a35c9ea8a4be2c2cc5"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "LoL d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:fe:d0:06:fb:f8:5c:d1:c6:ba:6b:43:45:b1:98:e1:e6"
      cert_thumbprint     = "4BC67ACA336287FF574978EF3BF67C688F6449F2"
      cert_valid_from     = "2021-02-26"
      cert_valid_to       = "2022-02-26"

      country             = "SI"
      state               = "???"
      locality            = "Ljubljana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:fe:d0:06:fb:f8:5c:d1:c6:ba:6b:43:45:b1:98:e1:e6"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_00FF52EB011BB748FEE75153CBE1E50DD6 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-16"
      version             = "1.0"

      hash                = "62653335118bb647653455b6aba600123b00a26e2b1fb74ad422b66abba60cfe"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "TASK ANNA LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:ff:52:eb:01:1b:b7:48:fe:e7:51:53:cb:e1:e5:0d:d6"
      cert_thumbprint     = "5158D965A6FFABA73FBB2EDE0E540100B8FD15CC"
      cert_valid_from     = "2022-03-16"
      cert_valid_to       = "2023-03-16"

      country             = "GB"
      state               = "Northamptonshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:ff:52:eb:01:1b:b7:48:fe:e7:51:53:cb:e1:e5:0d:d6"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_016836311FC39FBB8E6F308BB03CC2B3 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-13"
      version             = "1.0"

      hash                = "91020b6ada47f05e9941da3d5fc747a4bdf088e30fdbf010b50ce9ccf0de0cc6"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SERVICE STREAM LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "01:68:36:31:1f:c3:9f:bb:8e:6f:30:8b:b0:3c:c2:b3"
      cert_thumbprint     = "C23CC34AF4B7A019030706F33B72542CD9A192B0"
      cert_valid_from     = "2020-10-13"
      cert_valid_to       = "2021-10-13"

      country             = "AU"
      state               = "Victoria"
      locality            = "Melbourne"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "01:68:36:31:1f:c3:9f:bb:8e:6f:30:8b:b0:3c:c2:b3"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_02B6656292310B84022DB5541BC48FAF {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-21"
      version             = "1.0"

      hash                = "a4649e5f4c93e99352a63345569bf762c0eace3f56f6b8da56f3802923bf058d"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "DILA d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "02:b6:65:62:92:31:0b:84:02:2d:b5:54:1b:c4:8f:af"
      cert_thumbprint     = "BB58A3D322FD67122804B2924AD1DDC27016E11A"
      cert_valid_from     = "2021-02-21"
      cert_valid_to       = "2022-02-21"

      country             = "SI"
      state               = "???"
      locality            = "Kranj"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "02:b6:65:62:92:31:0b:84:02:2d:b5:54:1b:c4:8f:af"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_0A392F03DED5D73CDEEDA75052A57176 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-27"
      version             = "1.0"

      hash                = "f9bbfe101624f224998b0ad845512014efa6a42265ebe45e8e13a28a775d39b2"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "FLOWER COMPUTERS LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "0a:39:2f:03:de:d5:d7:3c:de:ed:a7:50:52:a5:71:76"
      cert_thumbprint     = "0979567833867AB7630F462DC4214D6CFE202660"
      cert_valid_from     = "2022-04-27"
      cert_valid_to       = "2023-04-27"

      country             = "GB"
      state               = "Dorset"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "0a:39:2f:03:de:d5:d7:3c:de:ed:a7:50:52:a5:71:76"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_0CF2D0B5BFDD68CF777A0C12F806A569 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-27"
      version             = "1.0"

      hash                = "f270de517926fb72dbc2e5e5d7335568f426fc524ad07e0ba553619080dbba3c"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "PROTIP d.o.o. - v stečaju"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "0c:f2:d0:b5:bf:dd:68:cf:77:7a:0c:12:f8:06:a5:69"
      cert_thumbprint     = "0C212CDF3D9A46621C19AF5C494FF6BAD25D3190"
      cert_valid_from     = "2021-01-27"
      cert_valid_to       = "2022-01-27"

      country             = "SI"
      state               = "???"
      locality            = "Domžale"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "0c:f2:d0:b5:bf:dd:68:cf:77:7a:0c:12:f8:06:a5:69"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_121070BE1E782F206985543BC7BC58B6 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-21"
      version             = "1.0"

      hash                = "423e9834d7e38533008abe7196be51ca3d424a16c9a96fd4b2638933eab8bb83"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Prod Can Holdings Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "12:10:70:be:1e:78:2f:20:69:85:54:3b:c7:bc:58:b6"
      cert_thumbprint     = "2AA8D5E1316B791C90F5F3AAB909467D9B16492D"
      cert_valid_from     = "2022-03-21"
      cert_valid_to       = "2023-03-21"

      country             = "CA"
      state               = "Ontario"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "12:10:70:be:1e:78:2f:20:69:85:54:3b:c7:bc:58:b6"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_121FCA3CFA4BD011669F5CC4E053AA3F {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-03"
      version             = "1.0"

      hash                = "692aa8adc305de52bc4c784fc272aaf943b4f8128162b712b24444342078c751"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Kymijoen Projektipalvelut Oy"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "12:1f:ca:3c:fa:4b:d0:11:66:9f:5c:c4:e0:53:aa:3f"
      cert_thumbprint     = "84B5EF4F981020DF2385754AB1296821FA2F8977"
      cert_valid_from     = "2020-12-03"
      cert_valid_to       = "2021-12-03"

      country             = "FI"
      state               = "???"
      locality            = "KOUVOLA"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "12:1f:ca:3c:fa:4b:d0:11:66:9f:5c:c4:e0:53:aa:3f"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_1249AA2ADA4967969B71CE63BF187C38 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-04"
      version             = "1.0"

      hash                = "0dc710737c12ea1c1215fbd39e00347649fff1fb0e512287c86873f66a9f0a35"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Umbrella LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "12:49:aa:2a:da:49:67:96:9b:71:ce:63:bf:18:7c:38"
      cert_thumbprint     = "BE99FDA34C1567D7FE65AD5DE01CE54E9673CEB4"
      cert_valid_from     = "2020-09-04"
      cert_valid_to       = "2021-09-04"

      country             = "RU"
      state               = "???"
      locality            = "Krasnoyarsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "12:49:aa:2a:da:49:67:96:9b:71:ce:63:bf:18:7c:38"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_13794371C052EC0559E9B492ABB25C26 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-04"
      version             = "1.0"

      hash                = "0652d513a2c43aaabbb806eeda3e035aa3b12449a718610d42453896d9f97751"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Carmel group LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "13:79:43:71:c0:52:ec:05:59:e9:b4:92:ab:b2:5c:26"
      cert_thumbprint     = "4D127CE781A74AF7AAB1373A5AF2625FFB27E2FA"
      cert_valid_from     = "2020-09-04"
      cert_valid_to       = "2021-09-04"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "13:79:43:71:c0:52:ec:05:59:e9:b4:92:ab:b2:5c:26"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_13C7B92282AAE782BFB00BAF879935F4 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-29"
      version             = "1.0"

      hash                = "ba505ad08b0cc2ca037d5349a1076be579e53b7f20750e779ad07692489eea6f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "THE WIZARD GIFT CORPORATION"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "13:c7:b9:22:82:aa:e7:82:bf:b0:0b:af:87:99:35:f4"
      cert_thumbprint     = "C664B29247AF0D0365E117694D2BFFEEAC07C019"
      cert_valid_from     = "2020-09-29"
      cert_valid_to       = "2021-09-29"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "13:c7:b9:22:82:aa:e7:82:bf:b0:0b:af:87:99:35:f4"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_142AAC4217E22B525C8587589773BA9B {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-24"
      version             = "1.0"

      hash                = "f543e03f714e5105b167fbddfe2112f0decaa3521971ed88f631dbca39caf8f2"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "A.B. gostinstvo trgovina posredništvo in druge storitve, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "14:2a:ac:42:17:e2:2b:52:5c:85:87:58:97:73:ba:9b"
      cert_thumbprint     = "B15A4189DCBB27F9B7CED94BC5CA40B7E62135C3"
      cert_valid_from     = "2021-02-24"
      cert_valid_to       = "2022-02-24"

      country             = "SI"
      state               = "???"
      locality            = "Maribor"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "14:2a:ac:42:17:e2:2b:52:5c:85:87:58:97:73:ba:9b"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_15C21DAB7F4E644E4B35C4858004D8A9 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-06"
      version             = "1.0"

      hash                = "82dae5e93006e8bbbef21b855953a5445999ec08a89852f40bdc848c9c072186"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "P.REGO, s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "15:c2:1d:ab:7f:4e:64:4e:4b:35:c4:85:80:04:d8:a9"
      cert_thumbprint     = "328264490A82A576FC5EE14D0B1A879BDEA1EBAE"
      cert_valid_from     = "2022-04-06"
      cert_valid_to       = "2023-04-06"

      country             = "SK"
      state               = "Žilinský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "15:c2:1d:ab:7f:4e:64:4e:4b:35:c4:85:80:04:d8:a9"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_17D99CC2F5B29522D422332E681F3E18 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-12"
      version             = "1.0"

      hash                = "a50992df4e3904b464d2202318046d25e5e072f56fcee0d524ceedcced0db0ed"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "PKV Trading ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "17:d9:9c:c2:f5:b2:95:22:d4:22:33:2e:68:1f:3e:18"
      cert_thumbprint     = "969932039E8BF3B4C71D9A55119071CFA1C4A41B"
      cert_valid_from     = "2021-02-12"
      cert_valid_to       = "2022-02-12"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Skævinge"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "17:d9:9c:c2:f5:b2:95:22:d4:22:33:2e:68:1f:3e:18"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_186D49FAC34CE99775B8E7FFBF50679D {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-09"
      version             = "1.0"

      hash                = "aadef6b90d90f628926fe3ca9bcc2104430bc404e9e451282ae139bcbde43320"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Hairis LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "18:6d:49:fa:c3:4c:e9:97:75:b8:e7:ff:bf:50:67:9d"
      cert_thumbprint     = "9E6B37CB10C99057177F2FED41E1068149A3BF40"
      cert_valid_from     = "2020-10-09"
      cert_valid_to       = "2021-10-09"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "18:6d:49:fa:c3:4c:e9:97:75:b8:e7:ff:bf:50:67:9d"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_1AE3C4ECCECDA2127D43BE390A850DDA {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-05"
      version             = "1.0"

      hash                = "5e840de448a948691f5dcb9699a771e9b0cff4c87a279070aa049eb336afbc9f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "PARTYNET LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "1a:e3:c4:ec:ce:cd:a2:12:7d:43:be:39:0a:85:0d:da"
      cert_thumbprint     = "61E86F40C4DDBC3B0EDAB66909E061E3B9EDE966"
      cert_valid_from     = "2021-03-05"
      cert_valid_to       = "2022-03-05"

      country             = "IE"
      state               = "???"
      locality            = "Limerick"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "1a:e3:c4:ec:ce:cd:a2:12:7d:43:be:39:0a:85:0d:da"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_1AEC3D3F752A38617C1D7A677D0B5591 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-27"
      version             = "1.0"

      hash                = "c9c640e28bf179489b862381ef3e20c50a2557d76e6f165968433753d6e78d60"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SILVER d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "1a:ec:3d:3f:75:2a:38:61:7c:1d:7a:67:7d:0b:55:91"
      cert_thumbprint     = "1D41B9F7714F221D76592E403D2FBB0F0310E697"
      cert_valid_from     = "2021-01-27"
      cert_valid_to       = "2022-01-27"

      country             = "SI"
      state               = "???"
      locality            = "Novo mesto"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "1a:ec:3d:3f:75:2a:38:61:7c:1d:7a:67:7d:0b:55:91"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_1DEEA179F5757FE529043577762419DF {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-21"
      version             = "1.0"

      hash                = "07c6b6453907697a5832f5ef5b99dda2180b9f5fd4fee7ba8f64bab637db8fb1"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SPIRIT CONSULTING s. r. o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "1d:ee:a1:79:f5:75:7f:e5:29:04:35:77:76:24:19:df"
      cert_thumbprint     = "FFEED7E7C8E52BE64DC7DDFEFF2B1FB257607EF2"
      cert_valid_from     = "2022-02-21"
      cert_valid_to       = "2023-02-21"

      country             = "SK"
      state               = "Trnavský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "1d:ee:a1:79:f5:75:7f:e5:29:04:35:77:76:24:19:df"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_1F23F001458716D435CCA1A55D660EC5 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-09"
      version             = "1.0"

      hash                = "e187fbf6543d1993f0945c04ee520600b6493236bae169a020f9a10c547e249d"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OOO Ringen"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "1f:23:f0:01:45:87:16:d4:35:cc:a1:a5:5d:66:0e:c5"
      cert_thumbprint     = "B35AFD1621F148C65259EA13014DD745383E6483"
      cert_valid_from     = "2020-10-09"
      cert_valid_to       = "2021-10-09"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "1f:23:f0:01:45:87:16:d4:35:cc:a1:a5:5d:66:0e:c5"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_1FFC9825644CAF5B1F521780C5C7F42C {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-12"
      version             = "1.0"

      hash                = "378a6fdf9d2629f912926cdee7dbe401675d31dda23fa6a0b5a150db80e62739"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "ACTIVUS LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "1f:fc:98:25:64:4c:af:5b:1f:52:17:80:c5:c7:f4:2c"
      cert_thumbprint     = "4E7E022C7BB6BD90A75674A67F82E839D54A0A5E"
      cert_valid_from     = "2021-03-12"
      cert_valid_to       = "2022-03-12"

      country             = "NZ"
      state               = "???"
      locality            = "Christchurch"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "1f:fc:98:25:64:4c:af:5b:1f:52:17:80:c5:c7:f4:2c"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_24E4A2B3DB6BE1007B9DDC91995BC0C8 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-18"
      version             = "1.0"

      hash                = "2d68755335776e3de28fcd1757b7dcc07688b31c37205ce2324d92c2f419c6f0"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "FLY BETTER s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "24:e4:a2:b3:db:6b:e1:00:7b:9d:dc:91:99:5b:c0:c8"
      cert_thumbprint     = "E55B27C39CBD67F647BE381AC4D5FFA8A042BA19"
      cert_valid_from     = "2022-02-18"
      cert_valid_to       = "2023-02-18"

      country             = "SK"
      state               = "Bratislavský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "24:e4:a2:b3:db:6b:e1:00:7b:9d:dc:91:99:5b:c0:c8"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_26F855A25890B749578F13E4B9459768 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-21"
      version             = "1.0"

      hash                = "866343b3294e723c5ba44a197dd24e180471ca3f5b811281b16087855b369c16"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Boo’s Q & Sweets Corporation"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "26:f8:55:a2:58:90:b7:49:57:8f:13:e4:b9:45:97:68"
      cert_thumbprint     = "20553AC4E2BBDE9BAC6065884BFA05BA6EF789C0"
      cert_valid_from     = "2022-02-21"
      cert_valid_to       = "2023-02-21"

      country             = "CA"
      state               = "Ontario"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "26:f8:55:a2:58:90:b7:49:57:8f:13:e4:b9:45:97:68"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_2C1EE9B583310B5E34A1EE6945A34B26 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-10"
      version             = "1.0"

      hash                = "71e2483b2d36765651132c9c1f935784a2008a91159b0ee3bbfb94193d0d644e"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OOO Artmarket"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "2c:1e:e9:b5:83:31:0b:5e:34:a1:ee:69:45:a3:4b:26"
      cert_thumbprint     = "C5F078E8476D5FCFE35F67719BF6E7CAF9F85F61"
      cert_valid_from     = "2020-12-10"
      cert_valid_to       = "2021-12-10"

      country             = "RU"
      state               = "???"
      locality            = "Ekaterinburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "2c:1e:e9:b5:83:31:0b:5e:34:a1:ee:69:45:a3:4b:26"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_2E36360538624C9B1AFD78A2FB756028 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-15"
      version             = "1.0"

      hash                = "ead37db279d439a8b30916b254590b21fe9ed268447bafd2fbc8e693e8ba7200"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Ts Trade ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "2e:36:36:05:38:62:4c:9b:1a:fd:78:a2:fb:75:60:28"
      cert_thumbprint     = "CE0A151E91751F047A6A77D327E52489AF380B1D"
      cert_valid_from     = "2021-03-15"
      cert_valid_to       = "2022-03-15"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Charlottenlund"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "2e:36:36:05:38:62:4c:9b:1a:fd:78:a2:fb:75:60:28"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_3223B4616C2687C04865BEE8321726A8 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-29"
      version             = "1.0"

      hash                = "8584e035ae371ae08206bc56eaffdb6ebb0284adfdd3612f6ae40d07676d5f08"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "FORTUNE STAR TRADING, INC."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "32:23:b4:61:6c:26:87:c0:48:65:be:e8:32:17:26:a8"
      cert_thumbprint     = "07EB627B760C866485296D97AD41118C023D9B0C"
      cert_valid_from     = "2020-09-29"
      cert_valid_to       = "2021-09-29"

      country             = "US"
      state               = "California"
      locality            = "SAN FRANCISCO"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "32:23:b4:61:6c:26:87:c0:48:65:be:e8:32:17:26:a8"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_333CA7D100B139B0D9C1A97CB458E226 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-16"
      version             = "1.0"

      hash                = "45406dae6b2c7383a3464de9112940cc9a388767fa867f17bc2a9c904861b358"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "FSE, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "33:3c:a7:d1:00:b1:39:b0:d9:c1:a9:7c:b4:58:e2:26"
      cert_thumbprint     = "D618CF7EF3A674FF1EA50800B4D965DE0FF463CB"
      cert_valid_from     = "2020-12-16"
      cert_valid_to       = "2021-12-16"

      country             = "SI"
      state               = "???"
      locality            = "Ljubljana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "33:3c:a7:d1:00:b1:39:b0:d9:c1:a9:7c:b4:58:e2:26"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_35590EBE4A02DC23317D8CE47A947A9B {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-09"
      version             = "1.0"

      hash                = "fab5aa283fc3a246f79d64cd53a2a6ac62aa0a34d86c2f637d766adb16574a99"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OOO Largos"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "35:59:0e:be:4a:02:dc:23:31:7d:8c:e4:7a:94:7a:9b"
      cert_thumbprint     = "3B454479F75CEE023D1C92950DD40D9AF965575C"
      cert_valid_from     = "2020-10-09"
      cert_valid_to       = "2021-10-09"

      country             = "RU"
      state               = "???"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "35:59:0e:be:4a:02:dc:23:31:7d:8c:e4:7a:94:7a:9b"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_3696883055975D571199C6B5D48F3CD5 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-03"
      version             = "1.0"

      hash                = "dec2d24131b54bda92b59c49acc410da4af20a730b3113c0472479ac168e3a81"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Korist Networks Incorporated"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "36:96:88:30:55:97:5d:57:11:99:c6:b5:d4:8f:3c:d5"
      cert_thumbprint     = "1D2F7867DCCAC28A856CF884E4DB54E7A99D1382"
      cert_valid_from     = "2020-09-03"
      cert_valid_to       = "2021-09-03"

      country             = "CA"
      state               = "Ontario"
      locality            = "Brampton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "36:96:88:30:55:97:5d:57:11:99:c6:b5:d4:8f:3c:d5"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_37F3384B16D4EEF0A9B3344B50F1D8A3 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-27"
      version             = "1.0"

      hash                = "c0f3d4a44486b91a5cb4911608f036ce303b3020aa90cbe5d79c35bc84e1ad5b"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Sore Loser Games ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "37:f3:38:4b:16:d4:ee:f0:a9:b3:34:4b:50:f1:d8:a3"
      cert_thumbprint     = "3FCDCF15C35EF74DC48E1573AD1170B11A623B40"
      cert_valid_from     = "2021-01-27"
      cert_valid_to       = "2022-01-27"

      country             = "DK"
      state               = "Sjælland"
      locality            = "Roskilde"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "37:f3:38:4b:16:d4:ee:f0:a9:b3:34:4b:50:f1:d8:a3"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_38989EC61ECDB7391FF5647F7D58AD18 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-12"
      version             = "1.0"

      hash                = "ec9352eeb82834a128bd306eddc085b5138083a4ce1e98d847fd936a309b52cb"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "RotA Games ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "38:98:9e:c6:1e:cd:b7:39:1f:f5:64:7f:7d:58:ad:18"
      cert_thumbprint     = "71E74A735C72D220AA45E9F1B83F0B867F2DA166"
      cert_valid_from     = "2021-02-12"
      cert_valid_to       = "2022-02-12"

      country             = "DK"
      state               = "???"
      locality            = "Aalborg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "38:98:9e:c6:1e:cd:b7:39:1f:f5:64:7f:7d:58:ad:18"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_3990362C34015CE4C23ECC3377FD3C06 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-01"
      version             = "1.0"

      hash                = "7308f0965c7fa1b09efb2c252c2868b77e52527dac3f33eea697148bda017c48"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "RZOH ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "39:90:36:2c:34:01:5c:e4:c2:3e:cc:33:77:fd:3c:06"
      cert_thumbprint     = "48444DEC9D6839734D8383B110FAABE05E697D45"
      cert_valid_from     = "2020-12-01"
      cert_valid_to       = "2021-12-01"

      country             = "DK"
      state               = "???"
      locality            = "Charlottenlund"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "39:90:36:2c:34:01:5c:e4:c2:3e:cc:33:77:fd:3c:06"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_3BCAED3EF678F2F9BF38D09E149B8D70 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-03"
      version             = "1.0"

      hash                = "78749911faeac0032bb0c8562761fa6ee3fb85f37e099f5169d9dcc29c8024bd"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "StarY Media Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "3b:ca:ed:3e:f6:78:f2:f9:bf:38:d0:9e:14:9b:8d:70"
      cert_thumbprint     = "18BE3EEAE77E60744FFA1D3DB4E3B47DF9C7F28E"
      cert_valid_from     = "2020-09-03"
      cert_valid_to       = "2021-09-03"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "3b:ca:ed:3e:f6:78:f2:f9:bf:38:d0:9e:14:9b:8d:70"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_425DC3E0CA8BCDCE19D00D87E3F0BA28 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-25"
      version             = "1.0"

      hash                = "29ab0dd1ecd81ef53162bc8d991b18113eac17f876cac17ffc301e589030f9a2"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Protover LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "42:5d:c3:e0:ca:8b:cd:ce:19:d0:0d:87:e3:f0:ba:28"
      cert_thumbprint     = "C58BC4370FA01D9A7772FA8C0E7C4C6C99B90561"
      cert_valid_from     = "2021-05-25"
      cert_valid_to       = "2022-05-25"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "42:5d:c3:e0:ca:8b:cd:ce:19:d0:0d:87:e3:f0:ba:28"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_435ABF46053A0A445C54217A8C233A7F {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-29"
      version             = "1.0"

      hash                = "ae940943dc46aa505baf564660c241d7ac92a0018b663142ba08296f6d129af2"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OOO Kodemika"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "43:5a:bf:46:05:3a:0a:44:5c:54:21:7a:8c:23:3a:7f"
      cert_thumbprint     = "94D6E69564868A44FEB430D4166A71C251F4AC0D"
      cert_valid_from     = "2021-03-29"
      cert_valid_to       = "2022-03-29"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "43:5a:bf:46:05:3a:0a:44:5c:54:21:7a:8c:23:3a:7f"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_4679C5398A279318365FD77A84445699 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-03"
      version             = "1.0"

      hash                = "964b4ec11e60e4a5f7464b8ec4510f6f514e7e49185da9f445e07724536febd0"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "HURT GROUP HOLDINGS LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "46:79:c5:39:8a:27:93:18:36:5f:d7:7a:84:44:56:99"
      cert_thumbprint     = "0962F0A080BC1AB38AA39730D38AF2603DC65BD4"
      cert_valid_from     = "2022-02-03"
      cert_valid_to       = "2023-02-03"

      country             = "GB"
      state               = "Lancashire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "46:79:c5:39:8a:27:93:18:36:5f:d7:7a:84:44:56:99"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_4728189FA0F57793484CDF764F5E283D {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-15"
      version             = "1.0"

      hash                = "d5ef3d005f494f728076a6e0fe22a9160ac4fa584f4956582cbe77b499b586de"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Power Save Systems s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "47:28:18:9f:a0:f5:77:93:48:4c:df:76:4f:5e:28:3d"
      cert_thumbprint     = "2BEE3F716B80273DB9639376A296CF19CDBA0F1A"
      cert_valid_from     = "2022-03-15"
      cert_valid_to       = "2023-03-15"

      country             = "CZ"
      state               = "Plzeňský kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "47:28:18:9f:a0:f5:77:93:48:4c:df:76:4f:5e:28:3d"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_4743E140C05B33F0449023946BD05ACB {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-11"
      version             = "1.0"

      hash                = "0170f0382c417a0c0b14cce5c023563e60cd75583a0ce5d6393f4d1f55d548e6"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "STROI RENOV SARL"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "47:43:e1:40:c0:5b:33:f0:44:90:23:94:6b:d0:5a:cb"
      cert_thumbprint     = "2E36340548D27E6FD8A5131FDB07405CEBD38C42"
      cert_valid_from     = "2020-12-11"
      cert_valid_to       = "2021-12-11"

      country             = "FR"
      state               = "???"
      locality            = "PLOMBIERES LES DIJON"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "47:43:e1:40:c0:5b:33:f0:44:90:23:94:6b:d0:5a:cb"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_4A7F07C5D4AD2E23F9E8E03F0E229DD4 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-23"
      version             = "1.0"

      hash                = "8b843d780403b64d562c38c56dcd9cc8abe2c70cc5324660cbd2757e41fd5057"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Danalis LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "4a:7f:07:c5:d4:ad:2e:23:f9:e8:e0:3f:0e:22:9d:d4"
      cert_thumbprint     = "B37E7F9040C4ADC6D29DA6829C7A35A2F6A56FDB"
      cert_valid_from     = "2020-12-23"
      cert_valid_to       = "2021-12-23"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "4a:7f:07:c5:d4:ad:2e:23:f9:e8:e0:3f:0e:22:9d:d4"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_4B03CABE6A0481F17A2DBEB9AEFAD425 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-10"
      version             = "1.0"

      hash                = "f15e75823d25a23ed5ec3c5236b514add35a9a104803f0e16527c087f8a7c26b"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "RASSVET, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "4b:03:ca:be:6a:04:81:f1:7a:2d:be:b9:ae:fa:d4:25"
      cert_thumbprint     = "25ECC0F4B78BCC02498CEAF7A2DE2883574ACB1C"
      cert_valid_from     = "2020-10-10"
      cert_valid_to       = "2021-10-10"

      country             = "RU"
      state               = "???"
      locality            = "Moskva"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "4b:03:ca:be:6a:04:81:f1:7a:2d:be:b9:ae:fa:d4:25"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_4E7545C9FC5938F5198AB9F1749CA31C {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-26"
      version             = "1.0"

      hash                = "4b485f8f1809545de7951d651893358ea247b2788811ab09654ded91fd2449b3"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "For M d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "4e:75:45:c9:fc:59:38:f5:19:8a:b9:f1:74:9c:a3:1c"
      cert_thumbprint     = "7A49677C535A13D0A9B6DEB539D084FF431A5B54"
      cert_valid_from     = "2021-02-26"
      cert_valid_to       = "2022-02-26"

      country             = "SI"
      state               = "???"
      locality            = "Škofja Loka"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "4e:75:45:c9:fc:59:38:f5:19:8a:b9:f1:74:9c:a3:1c"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_51CD5393514F7ACE2B407C3DBFB09D8D {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-23"
      version             = "1.0"

      hash                = "1a49d434e0a95bd312d3d0a6d4fd5335830970bef8009eac1739c27f4986753c"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "APPI CZ a.s"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "51:cd:53:93:51:4f:7a:ce:2b:40:7c:3d:bf:b0:9d:8d"
      cert_thumbprint     = "07A9FD6AF84983DBF083C15983097AC9CE761864"
      cert_valid_from     = "2020-10-23"
      cert_valid_to       = "2021-10-23"

      country             = "CZ"
      state               = "???"
      locality            = "Praha 10 - Malesice"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "51:cd:53:93:51:4f:7a:ce:2b:40:7c:3d:bf:b0:9d:8d"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_5226A724CFA0B4BC0164ECDA3F02A3DC {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-15"
      version             = "1.0"

      hash                = "de3ace90ae7600dd07a646040f20b96a426bea44d6747e83ea903ea50f70372f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "VALENTE SP Z O O"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "52:26:a7:24:cf:a0:b4:bc:01:64:ec:da:3f:02:a3:dc"
      cert_thumbprint     = "111E36502A8F8BCBF8418FDA751EA57EA6710919"
      cert_valid_from     = "2022-03-15"
      cert_valid_to       = "2023-03-15"

      country             = "PL"
      state               = "Śląskie"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "52:26:a7:24:cf:a0:b4:bc:01:64:ec:da:3f:02:a3:dc"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_539015999E304A5952985A994F9C3A53 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-04"
      version             = "1.0"

      hash                = "31b1c3b7706cbd03c97eb962c049dd024c06129648849206530dd960d2fdf115"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Service lab LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "53:90:15:99:9e:30:4a:59:52:98:5a:99:4f:9c:3a:53"
      cert_thumbprint     = "AD966944FC007A8E75128744541AB9F995BD0706"
      cert_valid_from     = "2020-09-04"
      cert_valid_to       = "2021-09-04"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "53:90:15:99:9e:30:4a:59:52:98:5a:99:4f:9c:3a:53"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_58AF00CE542760FC116B41FA92E18589 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-10"
      version             = "1.0"

      hash                = "78bc13074087f93fcc8f11ae013995f9a366b6943330c3d02f0b50c4ae96c8a7"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "DICKIE MUSDALE WINDFARM LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "58:af:00:ce:54:27:60:fc:11:6b:41:fa:92:e1:85:89"
      cert_thumbprint     = "AE5E59B981901B69380AC47D0FF499D1BA0AFFC2"
      cert_valid_from     = "2022-06-10"
      cert_valid_to       = "2023-06-10"

      country             = "GB"
      state               = "Scotland"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "58:af:00:ce:54:27:60:fc:11:6b:41:fa:92:e1:85:89"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_5B1F9EC88D185631AB032DBFD5166C0D {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-24"
      version             = "1.0"

      hash                = "42bc9b623f70e46d6aab4910d8c75221aecf89a00756a61b21f952eea13a446c"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "TOPFLIGHT GROUP LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "5b:1f:9e:c8:8d:18:56:31:ab:03:2d:bf:d5:16:6c:0d"
      cert_thumbprint     = "79E48E1BAB6039D7088FECBF10257E3E177599F5"
      cert_valid_from     = "2022-06-24"
      cert_valid_to       = "2023-06-24"

      country             = "GB"
      state               = "Lanarkshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "5b:1f:9e:c8:8d:18:56:31:ab:03:2d:bf:d5:16:6c:0d"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_5B440A47E8CE3DD202271E5C7A666C78 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-08"
      version             = "1.0"

      hash                = "f82299590f685b0915f2f18ad25c1d11ab35120d5055b1c06720b519ac2cb23f"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Master Networking s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "5b:44:0a:47:e8:ce:3d:d2:02:27:1e:5c:7a:66:6c:78"
      cert_thumbprint     = "2DBBBEDC7FD628132660C05EF3D1147E1194D8DD"
      cert_valid_from     = "2020-09-08"
      cert_valid_to       = "2021-09-08"

      country             = "CZ"
      state               = "Jihomoravský kraj"
      locality            = "Brno"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "5b:44:0a:47:e8:ce:3d:d2:02:27:1e:5c:7a:66:6c:78"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_5C7E78F53C31D6AA5B45DE14B47EB5C4 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-01-24"
      version             = "1.0"

      hash                = "d041ef7ec1117e7947220390fb169788d96ae373471029f83fe9a0858a92f39e"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Cubic Information Systems, UAB"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "5c:7e:78:f5:3c:31:d6:aa:5b:45:de:14:b4:7e:b5:c4"
      cert_thumbprint     = "D8CC9100FB36F8CDD372F9FEE9F550C2F2E2C99D"
      cert_valid_from     = "2020-01-24"
      cert_valid_to       = "2021-01-23"

      country             = "LT"
      state               = "Vilnius"
      locality            = "Vilnius"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "5c:7e:78:f5:3c:31:d6:aa:5b:45:de:14:b4:7e:b5:c4"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_623EAE6A66D3A6EE80DF9CCEBE51181E {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-14"
      version             = "1.0"

      hash                = "8cc8f32b2f44e84325e5153ec4fd60c31a35884220e7c36b753550356d6a25c8"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "GAIN AI LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "62:3e:ae:6a:66:d3:a6:ee:80:df:9c:ce:be:51:18:1e"
      cert_thumbprint     = "F1D238E66A6537393D738E4CEE813A2DB72A09C5"
      cert_valid_from     = "2022-04-14"
      cert_valid_to       = "2023-04-14"

      country             = "GB"
      state               = "West Midlands"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "62:3e:ae:6a:66:d3:a6:ee:80:df:9c:ce:be:51:18:1e"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_626735ED30E50E3E0553986D806BFC54 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-10-26"
      version             = "1.0"

      hash                = "085f0f3f25b1328d153a7c56125e1d8a4d43bc882fe3f250d742ea5247850c02"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "FISH ACCOUNTING & TRANSLATING LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "62:67:35:ed:30:e5:0e:3e:05:53:98:6d:80:6b:fc:54"
      cert_thumbprint     = "AAD723780CD440026A6CA0AA1E9D13D09F877E8F"
      cert_valid_from     = "2022-10-26"
      cert_valid_to       = "2023-10-26"

      country             = "GB"
      state               = "Cambridgeshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "62:67:35:ed:30:e5:0e:3e:05:53:98:6d:80:6b:fc:54"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_690910DC89D7857C3500FB74BED2B08D {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-13"
      version             = "1.0"

      hash                = "fe1fe8c9671f6b23f16c52d3a726ba99f00e2559e7991c4e67d88b7cf945da9d"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "OLIMP STROI, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "69:09:10:dc:89:d7:85:7c:35:00:fb:74:be:d2:b0:8d"
      cert_thumbprint     = "030C98A029F7CC4B460187AE954E304055EF2C6D"
      cert_valid_from     = "2020-08-13"
      cert_valid_to       = "2021-08-13"

      country             = "RU"
      state               = "Saratovskaya oblast"
      locality            = "Saratov"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "69:09:10:dc:89:d7:85:7c:35:00:fb:74:be:d2:b0:8d"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_69A72F5591AD78A0825FBB9402AB9543 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-16"
      version             = "1.0"

      hash                = "80b5ed7b12e236b36722bed7293766a4a7307a948c841eef8585fd8ae4813608"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "PUSH BANK LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "69:a7:2f:55:91:ad:78:a0:82:5f:bb:94:02:ab:95:43"
      cert_thumbprint     = "094B5650BA763AD448C958F873E37DC067B85645"
      cert_valid_from     = "2022-02-16"
      cert_valid_to       = "2023-02-16"

      country             = "GB"
      state               = "Cumbria"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "69:a7:2f:55:91:ad:78:a0:82:5f:bb:94:02:ab:95:43"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_6A241FFE96A6349DF608D22C02942268 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-11"
      version             = "1.0"

      hash                = "f01877dc957f31702ff592478646c66b44abb7c02d40f20031de3a7b98b28e2b"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "HELP, d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "6a:24:1f:fe:96:a6:34:9d:f6:08:d2:2c:02:94:22:68"
      cert_thumbprint     = "ADE0A549A3BB9D11F588E5DF22DD921315B96813"
      cert_valid_from     = "2020-11-11"
      cert_valid_to       = "2021-11-11"

      country             = "SI"
      state               = "???"
      locality            = "Škofja Loka"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "6a:24:1f:fe:96:a6:34:9d:f6:08:d2:2c:02:94:22:68"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_6E0CCBDFB4777E10EA6221B90DC350C2 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-16"
      version             = "1.0"

      hash                = "664772bd38ffaf9acb17b9485747ba706d7ddf1d8374f8fd6594251d1df85be9"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "TRAUMALAB INTERNATIONAL APS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "6e:0c:cb:df:b4:77:7e:10:ea:62:21:b9:0d:c3:50:c2"
      cert_thumbprint     = "A6E18ECDB7F82D3E1D609536AFBE0225ED04D123"
      cert_valid_from     = "2020-10-16"
      cert_valid_to       = "2021-10-16"

      country             = "DK"
      state               = "???"
      locality            = "Bagsværd"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "6e:0c:cb:df:b4:77:7e:10:ea:62:21:b9:0d:c3:50:c2"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_70E1EBD170DB8102D8C28E58392E5632 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-05"
      version             = "1.0"

      hash                = "c3cba8b38b1c9d930d6352803848798e6e9b8ef37e52523b97d5b94dd52fc732"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Equal Cash Technologies Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "70:e1:eb:d1:70:db:81:02:d8:c2:8e:58:39:2e:56:32"
      cert_thumbprint     = "345C2A6A717273E365F9302BC52CE065C50518E6"
      cert_valid_from     = "2020-09-05"
      cert_valid_to       = "2021-09-05"

      country             = "CA"
      state               = "Saskatchewan"
      locality            = "Regina"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "70:e1:eb:d1:70:db:81:02:d8:c2:8e:58:39:2e:56:32"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_7156EC47EF01AB8359EF4304E5AF1A05 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-14"
      version             = "1.0"

      hash                = "5aef62812d4c85ceff8b7242d7903482754f0f0bd49712f1a9746bd07a99cb72"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "BOREC, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "71:56:ec:47:ef:01:ab:83:59:ef:43:04:e5:af:1a:05"
      cert_thumbprint     = "6AFA5449C14C28F8F0A53CF49113EE895A2899F2"
      cert_valid_from     = "2020-08-14"
      cert_valid_to       = "2021-08-14"

      country             = "RU"
      state               = "Primorskiy kray"
      locality            = "Vladivostok"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "71:56:ec:47:ef:01:ab:83:59:ef:43:04:e5:af:1a:05"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_7AB21306B11FF280A93FC445876988AB {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-19"
      version             = "1.0"

      hash                = "3d6f88d4ae3da95201d454a65199a8402e1834973c934f5e6658b8964c4d9105"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "ABC BIOS d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7a:b2:13:06:b1:1f:f2:80:a9:3f:c4:45:87:69:88:ab"
      cert_thumbprint     = "6D0D10933B355EE2D8701510F22AFF4A06ADBE5B"
      cert_valid_from     = "2021-01-19"
      cert_valid_to       = "2022-01-19"

      country             = "SI"
      state               = "???"
      locality            = "Maribor"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7a:b2:13:06:b1:1f:f2:80:a9:3f:c4:45:87:69:88:ab"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_7E0CCDA0EF37ACEF6C2EBE4538627E5C {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-04"
      version             = "1.0"

      hash                = "dc062275af294c93bf891da3aa1445bb52433632e83c97d152d05f0aa3466650"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "Orangetree B.V."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7e:0c:cd:a0:ef:37:ac:ef:6c:2e:be:45:38:62:7e:5c"
      cert_thumbprint     = "A758D6799E218DD66261DC5E2E21791CBCCCD6CB"
      cert_valid_from     = "2020-11-04"
      cert_valid_to       = "2021-11-04"

      country             = "NL"
      state               = "???"
      locality            = "Etten-Leur"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7e:0c:cd:a0:ef:37:ac:ef:6c:2e:be:45:38:62:7e:5c"
      )
}

rule MAL_Compromised_Cert_Quakbot_Sectigo_7ED801843FA001B8ADD52D3A97B25931 {
   meta:
      description         = "Detects Quakbot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-26"
      version             = "1.0"

      hash                = "d148d0eee0b33861cc58801464a1c04c4b61aaf87be8b2fbc027d8fd1ce8b9a6"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "AM El-Teknik ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7e:d8:01:84:3f:a0:01:b8:ad:d5:2d:3a:97:b2:59:31"
      cert_thumbprint     = "4EE1539C1455F0070D8D04820FB814F8794F84DF"
      cert_valid_from     = "2021-02-26"
      cert_valid_to       = "2022-02-26"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Ølstykke"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7e:d8:01:84:3f:a0:01:b8:ad:d5:2d:3a:97:b2:59:31"
      )
}

rule MAL_Compromised_Cert_Quakbot_TrustOcean_00936BC256D2057CA9B9EC3034C3ED0EE6 {
   meta:
      description         = "Detects Quakbot with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-28"
      version             = "1.0"

      hash                = "dbac4888cb2be8a41986d0992abcb7215556da786e9b12759f6a39eede97b5f5"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "SALES & MAINTENANCE LIMITED"
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "00:93:6b:c2:56:d2:05:7c:a9:b9:ec:30:34:c3:ed:0e:e6"
      cert_thumbprint     = "CB559881E873DB671F10CFB5929D6750AD08720E"
      cert_valid_from     = "2021-03-28"
      cert_valid_to       = "2022-03-28"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "00:93:6b:c2:56:d2:05:7c:a9:b9:ec:30:34:c3:ed:0e:e6"
      )
}

rule MAL_Compromised_Cert_Quakbot_TrustOcean_00ADDB899F8229FD53E6435E08BBD3A733 {
   meta:
      description         = "Detects Quakbot with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-25"
      version             = "1.0"

      hash                = "d617ac91f216f3fb38c60b1c5bb1f623805d69fdf076636167bb09adfba5af67"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "U.K. STEEL EXPORTS LIMITED"
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "00:ad:db:89:9f:82:29:fd:53:e6:43:5e:08:bb:d3:a7:33"
      cert_thumbprint     = "DB1E0168B0A62E827745B3499B23A0F41746359D"
      cert_valid_from     = "2021-03-25"
      cert_valid_to       = "2022-03-25"

      country             = "GB"
      state               = "???"
      locality            = "Wattsville"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "00:ad:db:89:9f:82:29:fd:53:e6:43:5e:08:bb:d3:a7:33"
      )
}

rule MAL_Compromised_Cert_Quakbot_TrustOcean_00BC6C43D206A360F2D6B58537C456B709 {
   meta:
      description         = "Detects Quakbot with compromised cert (TrustOcean)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-25"
      version             = "1.0"

      hash                = "77abaa92184007a6176bf62098a90cf705254fae15ba25bcf2cd4359ca708428"
      malware             = "Quakbot"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware originated as a banking trojan and then became a initial access tool used by ransomware gangs."

      signer              = "ANKADA GROUP, d.o.o."
      cert_issuer_short   = "TrustOcean"
      cert_issuer         = "TrustOcean Organization Software Vendor CA"
      cert_serial         = "00:bc:6c:43:d2:06:a3:60:f2:d6:b5:85:37:c4:56:b7:09"
      cert_thumbprint     = "E30264DC33571BB02647190AC8191B8439631380"
      cert_valid_from     = "2021-03-25"
      cert_valid_to       = "2022-03-25"

      country             = "SI"
      state               = "???"
      locality            = "Prosenjakovci - Pártosfalva"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "TrustOcean Organization Software Vendor CA" and
         sig.serial == "00:bc:6c:43:d2:06:a3:60:f2:d6:b5:85:37:c4:56:b7:09"
      )
}

rule MAL_Compromised_Cert_QuasarRAT_Microsoft_33000201B5D72372EE416F0D8F0000000201B5 {
   meta:
      description         = "Detects QuasarRAT with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-08"
      version             = "1.0"

      hash                = "f1e99a7e9c48ecefd988f244085bd291f7d2c06e081338a9c104e8294ccb01bd"
      malware             = "QuasarRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "InLine"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:01:b5:d7:23:72:ee:41:6f:0d:8f:00:00:00:02:01:b5"
      cert_thumbprint     = "91C71CD1B81D99B0B51D1EC542A4FB27BBBF42E2"
      cert_valid_from     = "2025-03-08"
      cert_valid_to       = "2025-03-11"

      country             = "KR"
      state               = "South Gyeongsang"
      locality            = "Gimhae-si"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:01:b5:d7:23:72:ee:41:6f:0d:8f:00:00:00:02:01:b5"
      )
}

rule MAL_Compromised_Cert_QuasarRAT_SSL_com_0AFDA52EC44C7F7ADF710EA694A78DC9 {
   meta:
      description         = "Detects QuasarRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "e4922484284c90de832ea50a4e2866490af799b31dfcb81f5d4034c3ce8b6bbf"
      malware             = "QuasarRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "XTRA Software, s.r.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0a:fd:a5:2e:c4:4c:7f:7a:df:71:0e:a6:94:a7:8d:c9"
      cert_thumbprint     = "36DE4CB9AD93B90EE12E2B3F8FD71F20F586F2C2"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-17"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "Praha"
      email               = "???"
      rdn_serial_number   = "24251950"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0a:fd:a5:2e:c4:4c:7f:7a:df:71:0e:a6:94:a7:8d:c9"
      )
}

rule MAL_Compromised_Cert_QuasarRAT_SSL_com_2E0166B936533F45D5DD693122092E35 {
   meta:
      description         = "Detects QuasarRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-30"
      version             = "1.0"

      hash                = "8b648a9eb5283d67a7e17b76d6f0e795ef9d47dc78bb30c4a98428ef0078415c"
      malware             = "QuasarRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tangshan Jimin Information Technology Partnership Enterprise(LP)"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2e:01:66:b9:36:53:3f:45:d5:dd:69:31:22:09:2e:35"
      cert_thumbprint     = "9FD0CCC95444813A9D9ABECAE11E39C30640E537"
      cert_valid_from     = "2024-12-30"
      cert_valid_to       = "2025-12-30"

      country             = "CN"
      state               = "Hebei"
      locality            = "Tangshan"
      email               = "???"
      rdn_serial_number   = "91130202MA0F6L3T78"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2e:01:66:b9:36:53:3f:45:d5:dd:69:31:22:09:2e:35"
      )
}

rule MAL_Compromised_Cert_QuasarRAT_Sectigo_1D11ED1006343E0FD1BC5511F3AB2084 {
   meta:
      description         = "Detects QuasarRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-08-31"
      version             = "1.0"

      hash                = "28efc53ff3f91f47ca7a83789330c7b1d7f86acbe510b3a58a497f388ce368a1"
      malware             = "QuasarRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "12980215 Canada Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "1d:11:ed:10:06:34:3e:0f:d1:bc:55:11:f3:ab:20:84"
      cert_thumbprint     = "1373BA6C061866EF7DA2A7592237642DD8C672D5"
      cert_valid_from     = "2022-08-31"
      cert_valid_to       = "2023-08-31"

      country             = "CA"
      state               = "Ontario"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "1d:11:ed:10:06:34:3e:0f:d1:bc:55:11:f3:ab:20:84"
      )
}

rule MAL_Compromised_Cert_QuirkyLoader_SSL_com_5C06E4EE4EA78E8F24B10D1238DAAB64 {
   meta:
      description         = "Detects QuirkyLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-30"
      version             = "1.0"

      hash                = "f470ab8df8dc7764cb726c85d9a6f5daadca98d45f34bff992a563754b484b93"
      malware             = "QuirkyLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Universal Vision Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5c:06:e4:ee:4e:a7:8e:8f:24:b1:0d:12:38:da:ab:64"
      cert_thumbprint     = "ED4230930868AF4447D4A6C844D1C41E90EAC83E"
      cert_valid_from     = "2025-09-30"
      cert_valid_to       = "2026-09-30"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5c:06:e4:ee:4e:a7:8e:8f:24:b1:0d:12:38:da:ab:64"
      )
}

rule MAL_Compromised_Cert_RDPWrap_DigiCert_096473E3991014691A73038C059A866E {
   meta:
      description         = "Detects RDPWrap with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-29"
      version             = "1.0"

      hash                = "70c7f64eadfade752b92f336bcf80a52266ed908ce3fc4000f91533f91f71f46"
      malware             = "RDPWrap"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CTY TNHH MOT THANH VIEN THUONG MAI DICH VU TAM TAI"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "09:64:73:e3:99:10:14:69:1a:73:03:8c:05:9a:86:6e"
      cert_thumbprint     = "D5D40096B4D3863D404B54730859EC87575E1816"
      cert_valid_from     = "2025-04-29"
      cert_valid_to       = "2026-04-28"

      country             = "VN"
      state               = "Thua Thien Hue"
      locality            = "Thuan Hoa"
      email               = "???"
      rdn_serial_number   = "3301565601"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "09:64:73:e3:99:10:14:69:1a:73:03:8c:05:9a:86:6e"
      )
}

rule MAL_Compromised_Cert_RMMLoader_GlobalSign_7744041A0EE72E8546C37940 {
   meta:
      description         = "Detects RMMLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-06"
      version             = "1.0"

      hash                = "6869e503460bc04bfdc6ea36a3439b898711ec8aaf7176906464a5147672410c"
      malware             = "RMMLoader"
      malware_type        = "Unknown"
      malware_notes       = "This malicious signer build loads a legit RMM tool from dwservice.net"

      signer              = "Xingtai Yali Intelligent Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "77:44:04:1a:0e:e7:2e:85:46:c3:79:40"
      cert_thumbprint     = "3CCF15A6D26A6CF3813957D48FFB005BBCD5BC76"
      cert_valid_from     = "2025-05-06"
      cert_valid_to       = "2026-05-07"

      country             = "CN"
      state               = "河北省"
      locality            = "邢台市"
      email               = "???"
      rdn_serial_number   = "91130503MA0G685G99"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "77:44:04:1a:0e:e7:2e:85:46:c3:79:40"
      )
}

rule MAL_Compromised_Cert_RMMLoader_Sectigo_00F9248EA686FE42C08F22EE5A522CA067 {
   meta:
      description         = "Detects RMMLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-24"
      version             = "1.0"

      hash                = "f6a85889f1e9d725f5807d9dab542d7367619bd91286678340a5e638f2b362a7"
      malware             = "RMMLoader"
      malware_type        = "Remote access tool"
      malware_notes       = "Loads NinjaOne RMM tool: https://app.any.run/tasks/0ef046ff-3ec7-4b18-8755-f7387e061a3f"

      signer              = "CÔNG TY TNHH XB FLOW TECHNOLOGIES"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:f9:24:8e:a6:86:fe:42:c0:8f:22:ee:5a:52:2c:a0:67"
      cert_thumbprint     = "D287FEC7DDC1CB3B4F34DE24C3A08033020CC4B8"
      cert_valid_from     = "2025-09-24"
      cert_valid_to       = "2026-10-24"

      country             = "VN"
      state               = "Quảng Trị"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "3101145367"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:f9:24:8e:a6:86:fe:42:c0:8f:22:ee:5a:52:2c:a0:67"
      )
}

rule MAL_Compromised_Cert_RUS_51_GlobalSign_40A362E350689119F52EC34C {
   meta:
      description         = "Detects RUS-51 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-08"
      version             = "1.0"

      hash                = "1da91d2570329f9e214f51bc633283f10bd55a145b7b3d254e03175fd86292d9"
      malware             = "RUS-51"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AM MISBAH Tech Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "40:a3:62:e3:50:68:91:19:f5:2e:c3:4c"
      cert_thumbprint     = "80A9BC77CE11DA98E9E54F1E545C6C5B806C518A"
      cert_valid_from     = "2024-11-08"
      cert_valid_to       = "2025-11-09"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Surrey"
      email               = "???"
      rdn_serial_number   = "13355462"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "40:a3:62:e3:50:68:91:19:f5:2e:c3:4c"
      )
}

rule MAL_Compromised_Cert_RUS_51_GlobalSign_44B8667357BB95651D61D061 {
   meta:
      description         = "Detects RUS-51 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-19"
      version             = "1.0"

      hash                = "9ebfe694914d337304edded8b6406bd3fbff1d4ee110ef3a8bf95c3fb5de7c38"
      malware             = "RUS-51"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cascade Tech-Trek Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "44:b8:66:73:57:bb:95:65:1d:61:d0:61"
      cert_thumbprint     = "9F24096B07D3AC87E48DB7D37CC70F269AE643A3"
      cert_valid_from     = "2024-11-19"
      cert_valid_to       = "2025-11-20"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Burnaby"
      email               = "???"
      rdn_serial_number   = "771956-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "44:b8:66:73:57:bb:95:65:1d:61:d0:61"
      )
}

rule MAL_Compromised_Cert_RUS_51_GlobalSign_4F2343D96154B941DB0A26B2 {
   meta:
      description         = "Detects RUS-51 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-29"
      version             = "1.0"

      hash                = "ff82c4c679c5486aed2d66a802682245a1e9cd7d6ceb65fa0e7b222f902998e8"
      malware             = "RUS-51"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KouisMoa MegaByte Information Technolog Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4f:23:43:d9:61:54:b9:41:db:0a:26:b2"
      cert_thumbprint     = "32A9B43EB22374AE870D5AC1C5357889CDF1C9E8"
      cert_valid_from     = "2023-12-29"
      cert_valid_to       = "2024-12-29"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420600MA488H2M4C"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4f:23:43:d9:61:54:b9:41:db:0a:26:b2"
      )
}

rule MAL_Compromised_Cert_RUS_55_Certum_43CFEE96B948B5B672754F51A0E6E719 {
   meta:
      description         = "Detects RUS-55 with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-12"
      version             = "1.0"

      hash                = "c85a23cddbc9979c0c9c8040218c41b0a0008fee9e60cf8a885f94594eff04ea"
      malware             = "RUS-55"
      malware_type        = "Remote access tool"
      malware_notes       = "File was distributed as a trojanized RVTools installer. See analysis here https://tria.ge/251217-ny7gksen6v/behavioral1"

      signer              = "Taiyuan Tataomi Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "43:cf:ee:96:b9:48:b5:b6:72:75:4f:51:a0:e6:e7:19"
      cert_thumbprint     = "0C707864C9FF609E40497A7C6920C0B2A01CF174"
      cert_valid_from     = "2025-11-12"
      cert_valid_to       = "2026-11-12"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "91140105MADC8HF4XN"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "43:cf:ee:96:b9:48:b5:b6:72:75:4f:51:a0:e6:e7:19"
      )
}

rule MAL_Compromised_Cert_RUS_55_GlobalSign_5A076B593C5E7DCA24430353 {
   meta:
      description         = "Detects RUS-55 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-02"
      version             = "1.0"

      hash                = "75485847e431dddea1d9aee4cbc49066defc4fa8347cda67835009ca7d95b799"
      malware             = "RUS-55"
      malware_type        = "Remote access tool"
      malware_notes       = "This malware was distributed as a trojanized RVTools installer: https://app.any.run/tasks/4e6d41c8-08d6-4f2c-9eb5-3fd29ee5900b"

      signer              = "WEGUN (THAILAND) CO., LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:07:6b:59:3c:5e:7d:ca:24:43:03:53"
      cert_thumbprint     = "81162039094342A54A726E98C4DECB147152D193"
      cert_valid_from     = "2025-12-02"
      cert_valid_to       = "2026-11-21"

      country             = "TH"
      state               = "Chonburi"
      locality            = "Bang Lamung"
      email               = "???"
      rdn_serial_number   = "0205567025431"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:07:6b:59:3c:5e:7d:ca:24:43:03:53"
      )
}

rule MAL_Compromised_Cert_RUS_55_GlobalSign_65E6B4B9104AFCF9BEE6F984 {
   meta:
      description         = "Detects RUS-55 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-11"
      version             = "1.0"

      hash                = "65a1d8ca5284d70df6a0a5cbd9a69c11c87e8cf7c17483aa213c31fe544c9c9f"
      malware             = "RUS-55"
      malware_type        = "Remote access tool"
      malware_notes       = "Uses a python script to prepare a .NET binary to be compiled and executed: https://tria.ge/251129-pycsmsht2e/behavioral2"

      signer              = "WILD LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:e6:b4:b9:10:4a:fc:f9:be:e6:f9:84"
      cert_thumbprint     = "83FDE682DB8C8C8D039F21D2ECB5F6AC9FA38E4B"
      cert_valid_from     = "2025-03-11"
      cert_valid_to       = "2026-03-12"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700481423"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:e6:b4:b9:10:4a:fc:f9:be:e6:f9:84"
      )
}

rule MAL_Compromised_Cert_RaccoonStealer_DigiCert_0F0ED5318848703405D40F7C62D0F39A {
   meta:
      description         = "Detects RaccoonStealer with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-03"
      version             = "1.0"

      hash                = "e51a5ecb5c7ab754cccf2531882b6e724dcd0b15a9c3978384480605549096c5"
      malware             = "RaccoonStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SIES UPRAVLENIE PROTSESSAMI, OOO"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0f:0e:d5:31:88:48:70:34:05:d4:0f:7c:62:d0:f3:9a"
      cert_thumbprint     = "ED91194EE135B24D5DF160965D8036587D6C8C35"
      cert_valid_from     = "2021-03-03"
      cert_valid_to       = "2021-04-26"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1155038005320"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0f:0e:d5:31:88:48:70:34:05:d4:0f:7c:62:d0:f3:9a"
      )
}

rule MAL_Compromised_Cert_RaccoonStealer_Sectigo_00B0A308FC2E71AC4AC40677B9C27CCBAD {
   meta:
      description         = "Detects RaccoonStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-01-27"
      version             = "1.0"

      hash                = "18f6edcc25f8528d841203138beedaee611f3b3d17fbc5e13be8fd744ca413ed"
      malware             = "RaccoonStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Volpayk LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b0:a3:08:fc:2e:71:ac:4a:c4:06:77:b9:c2:7c:cb:ad"
      cert_thumbprint     = "15E502F1482A280F7285168BB5E227FFDE4E41A6"
      cert_valid_from     = "2021-01-27"
      cert_valid_to       = "2022-01-27"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b0:a3:08:fc:2e:71:ac:4a:c4:06:77:b9:c2:7c:cb:ad"
      )
}

rule MAL_Compromised_Cert_RaccoonStealer_Sectigo_1895433EE9E2BD48619D75132262616F {
   meta:
      description         = "Detects RaccoonStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-23"
      version             = "1.0"

      hash                = "65482dad9fc3afdae3eadc30dcc55ab9407f93b0d63a2d3e62156f3c104dc22c"
      malware             = "RaccoonStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Evetrans Ltd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "18:95:43:3e:e9:e2:bd:48:61:9d:75:13:22:62:61:6f"
      cert_thumbprint     = "69D18725C64C50D58598BD255C26E225EF227D14"
      cert_valid_from     = "2021-03-23"
      cert_valid_to       = "2022-03-23"

      country             = "GB"
      state               = "West Midlands"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "18:95:43:3e:e9:e2:bd:48:61:9d:75:13:22:62:61:6f"
      )
}

rule MAL_Compromised_Cert_RaccoonStealer_Sectigo_54C793D2224BDD6CA527BB2B7B9DFE9D {
   meta:
      description         = "Detects RaccoonStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-08-23"
      version             = "1.0"

      hash                = "0b68bc5c0df6f79fc25b191dc85bf3b5d9c3e2c9b77a3b64fe258d81cfe7169e"
      malware             = "RaccoonStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CODE - HANDLE, s. r. o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "54:c7:93:d2:22:4b:dd:6c:a5:27:bb:2b:7b:9d:fe:9d"
      cert_thumbprint     = "D171D91C33FC3E7CB4BDEFC6677FEC1DC71CA53D"
      cert_valid_from     = "2021-08-23"
      cert_valid_to       = "2022-08-23"

      country             = "SK"
      state               = "Trenčiansky kraj"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "54:c7:93:d2:22:4b:dd:6c:a5:27:bb:2b:7b:9d:fe:9d"
      )
}

rule MAL_Compromised_Cert_RaccoonStealer_Sectigo_7709D2DF39E9A4F7DB2F3CBC29B49743 {
   meta:
      description         = "Detects RaccoonStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-03"
      version             = "1.0"

      hash                = "e8002fbc4bd5e57fd317fb99e3bb2bc8965e94761e37757aed51f3f21486c0ad"
      malware             = "RaccoonStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Grina LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "77:09:d2:df:39:e9:a4:f7:db:2f:3c:bc:29:b4:97:43"
      cert_thumbprint     = "5430CC38C8218F3CF754A01D5A5612C26404068E"
      cert_valid_from     = "2020-10-03"
      cert_valid_to       = "2021-10-03"

      country             = "RU"
      state               = "???"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "77:09:d2:df:39:e9:a4:f7:db:2f:3c:bc:29:b4:97:43"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_GlobalSign_630FDDE61C01FA9713DE135B {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-28"
      version             = "1.0"

      hash                = "a90dc68f5c888a8e7f922c215ccd2bc7400da17616bcb37aa91a234a6df809ad"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ezhou Taihaocheng Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "63:0f:dd:e6:1c:01:fa:97:13:de:13:5b"
      cert_thumbprint     = "8E68FA147901336EC6B35728E39151FA543B1EA4"
      cert_valid_from     = "2025-05-28"
      cert_valid_to       = "2026-05-29"

      country             = "CN"
      state               = "Hubei"
      locality            = "Ezhou"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "63:0f:dd:e6:1c:01:fa:97:13:de:13:5b"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_3300020EDF3515BE59E6A8EC97000000020EDF {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-12"
      version             = "1.0"

      hash                = "b1e48bdb7dcdcca142d457bb033633edd5c1b599207c643de3ceee55b20571ec"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "志超 柴"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:0e:df:35:15:be:59:e6:a8:ec:97:00:00:00:02:0e:df"
      cert_thumbprint     = "6B3553EFDCBE075492A4FB28B5C7063922F637BD"
      cert_valid_from     = "2025-03-12"
      cert_valid_to       = "2025-03-15"

      country             = "CN"
      state               = "???"
      locality            = "平南"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:0e:df:35:15:be:59:e6:a8:ec:97:00:00:00:02:0e:df"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_330002C012FD70C2539C6E20C100000002C012 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-04"
      version             = "1.0"

      hash                = "85d02a6af9729fef603c18adbe3e080f4682b16d13951882311ddb018341253b"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SRI NOVA SOLUTIONS, INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:c0:12:fd:70:c2:53:9c:6e:20:c1:00:00:00:02:c0:12"
      cert_thumbprint     = "C3E86B836E0F2683FCC2F0CE50773D321B703BF5"
      cert_valid_from     = "2025-05-04"
      cert_valid_to       = "2025-05-07"

      country             = "US"
      state               = "New York"
      locality            = "Staten Island"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:c0:12:fd:70:c2:53:9c:6e:20:c1:00:00:00:02:c0:12"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_330002F6B621C3DACF7C0F844C00000002F6B6 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-20"
      version             = "1.0"

      hash                = "67a4f229c6426e032e071a9826cd3c2462bdd69c372b7d4da7f77b8fb9846705"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AMAVI CONSULTING LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:f6:b6:21:c3:da:cf:7c:0f:84:4c:00:00:00:02:f6:b6"
      cert_thumbprint     = "9FC7AF90537A25295C838DF0BA8B61308F55A7EB"
      cert_valid_from     = "2025-05-20"
      cert_valid_to       = "2025-05-23"

      country             = "US"
      state               = "Arizona"
      locality            = "Glendale"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:f6:b6:21:c3:da:cf:7c:0f:84:4c:00:00:00:02:f6:b6"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_33000305923E9A6B3748F117A5000000030592 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-29"
      version             = "1.0"

      hash                = "5245b70201643b135c53e7dd19a44f2b3d84ff7bb0e3a3ab3c300f59aeda7297"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INITIATIVE PARTNERS GROUP, LLC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:05:92:3e:9a:6b:37:48:f1:17:a5:00:00:00:03:05:92"
      cert_thumbprint     = "50CFC1828E31158D5317BAED4F246D883725C087"
      cert_valid_from     = "2025-05-29"
      cert_valid_to       = "2025-06-01"

      country             = "US"
      state               = "Arizona"
      locality            = "Waddell"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:05:92:3e:9a:6b:37:48:f1:17:a5:00:00:00:03:05:92"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_3300031D99C867BB46F4D2ABC0000000031D99 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-05"
      version             = "1.0"

      hash                = "949675ef054d7a94eeeae058ae9ee413c68289aac88ac7ff5f043f30565fd2f5"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "POINT CLICK LEARN, INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:1d:99:c8:67:bb:46:f4:d2:ab:c0:00:00:00:03:1d:99"
      cert_thumbprint     = "94B44CBB7B69D4CA6E55A014DF1F46F3AB55B62E"
      cert_valid_from     = "2025-06-05"
      cert_valid_to       = "2025-06-08"

      country             = "US"
      state               = "Pennsylvania"
      locality            = "Mc Kean"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:1d:99:c8:67:bb:46:f4:d2:ab:c0:00:00:00:03:1d:99"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_330003A015011F7E6188B8823D00000003A015 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "3fd6f78600d58c88f734b01fff2e605087d1c2957cc1d6c2867df575816c9dd4"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "A TO Z ENTERPRISES, INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:03:a0:15:01:1f:7e:61:88:b8:82:3d:00:00:00:03:a0:15"
      cert_thumbprint     = "A0F10F17F30D8072706C62474A624F19B4E35276"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2025-05-12"

      country             = "US"
      state               = "Utah"
      locality            = "Salt Lake City"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:03:a0:15:01:1f:7e:61:88:b8:82:3d:00:00:00:03:a0:15"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_Microsoft_330003D491DF08DD9705B0F94900000003D491 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-25"
      version             = "1.0"

      hash                = "a069032baf4fe2514ec106c5731a035361dfefd0b68a23c782ac7ad82428da7d"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ZONA ENTERPRISES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:03:d4:91:df:08:dd:97:05:b0:f9:49:00:00:00:03:d4:91"
      cert_thumbprint     = "7BCA2D50D3787AD89A0D116CECEA2280530F6368"
      cert_valid_from     = "2025-05-25"
      cert_valid_to       = "2025-05-28"

      country             = "US"
      state               = "Arizona"
      locality            = "Chandler"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:03:d4:91:df:08:dd:97:05:b0:f9:49:00:00:00:03:d4:91"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_SSL_com_3A6949F6D63C0B1D48AC3F4544B52F80 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-12"
      version             = "1.0"

      hash                = "3f5c435d0f8adad303318007bfcea2a3c6a8f6f7db49af5747fff1a88ff91672"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IT WEST POLAND SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3a:69:49:f6:d6:3c:0b:1d:48:ac:3f:45:44:b5:2f:80"
      cert_thumbprint     = "93607709B8DA3F9A62C2400FB30E3FA7CD1F0C22"
      cert_valid_from     = "2025-04-12"
      cert_valid_to       = "2026-04-12"

      country             = "PL"
      state               = "???"
      locality            = "Wroclaw"
      email               = "???"
      rdn_serial_number   = "0000974845"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3a:69:49:f6:d6:3c:0b:1d:48:ac:3f:45:44:b5:2f:80"
      )
}

rule MAL_Compromised_Cert_RealPeopleLoader_SSL_com_65897B2D2ADF2946F895D98F627E5D86 {
   meta:
      description         = "Detects RealPeopleLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-03"
      version             = "1.0"

      hash                = "d4abd215ec31afa8738aed827e2fdb2e4de18aa5dad70d95874ac87e5bc93988"
      malware             = "RealPeopleLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SUPERNOVA SOFTWARE CONSULTANCY LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "65:89:7b:2d:2a:df:29:46:f8:95:d9:8f:62:7e:5d:86"
      cert_thumbprint     = "278E182D4055B9D064A0222C7EA79373450A903A"
      cert_valid_from     = "2025-03-03"
      cert_valid_to       = "2026-03-03"

      country             = "GB"
      state               = "???"
      locality            = "Ipswich"
      email               = "???"
      rdn_serial_number   = "11788397"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "65:89:7b:2d:2a:df:29:46:f8:95:d9:8f:62:7e:5d:86"
      )
}

rule MAL_Compromised_Cert_RecipeLister_TamperedChef_GlobalSign_6088C44EA70DFF6DB14A005D {
   meta:
      description         = "Detects RecipeLister,TamperedChef with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-06"
      version             = "1.0"

      hash                = "d8bff72de51213510004a2652b9e31b48a25e2eb0d7184fab4ef9014fc85e145"
      malware             = "RecipeLister,TamperedChef"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was downloaded by advertisements for a Recipe application. The recipes contained hidden characters that could be decoded by the application. See the following for more details: https://www.bluevoyant.com/blog/recipelister-a-recipe-for-disaster"

      signer              = "IT BRIDGE CONNECT LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:88:c4:4e:a7:0d:ff:6d:b1:4a:00:5d"
      cert_thumbprint     = "4DC75B08FE34B0A4E8040C7EBA65783B17B75E06"
      cert_valid_from     = "2024-12-06"
      cert_valid_to       = "2025-12-07"

      country             = "UA"
      state               = "Kyiv"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "45342266"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:88:c4:4e:a7:0d:ff:6d:b1:4a:00:5d"
      )
}

rule MAL_Compromised_Cert_RecipeLister_TamperedChef_SSL_com_3FCF3181373998BB62084F8D2DD318A3 {
   meta:
      description         = "Detects RecipeLister,TamperedChef with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-25"
      version             = "1.0"

      hash                = "1619bcad3785be31ac2fdee0ab91392d08d9392032246e42673c3cb8964d4cb7"
      malware             = "RecipeLister,TamperedChef"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was downloaded by advertisements for a Recipe application. The recipes contained hidden characters that could be decoded by the application. See the following for more details: https://www.bluevoyant.com/blog/recipelister-a-recipe-for-disaster"

      signer              = "Global Tech Allies ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "3f:cf:31:81:37:39:98:bb:62:08:4f:8d:2d:d3:18:a3"
      cert_thumbprint     = "C9BE49E1CFD42DA1B305344C2D705397CDC5A12B"
      cert_valid_from     = "2025-02-25"
      cert_valid_to       = "2026-02-25"

      country             = "GB"
      state               = "???"
      locality            = "Luton"
      email               = "???"
      rdn_serial_number   = "15440807"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "3f:cf:31:81:37:39:98:bb:62:08:4f:8d:2d:d3:18:a3"
      )
}

rule MAL_Compromised_Cert_RecordBreaker_Sectigo_00A32F3BA229704AD400473F7479E4C3E4 {
   meta:
      description         = "Detects RecordBreaker with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-21"
      version             = "1.0"

      hash                = "002500484b7931b442a89842c37f22d3fa4038e8d4a803ccd6c5c9651523a294"
      malware             = "RecordBreaker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOTUL SOLUTIONS LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:a3:2f:3b:a2:29:70:4a:d4:00:47:3f:74:79:e4:c3:e4"
      cert_thumbprint     = "898B9EA9638B86A5FF87EDC5731C17F529F17A4D"
      cert_valid_from     = "2023-03-21"
      cert_valid_to       = "2024-03-20"

      country             = "GB"
      state               = "London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:a3:2f:3b:a2:29:70:4a:d4:00:47:3f:74:79:e4:c3:e4"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_DigiCert_030012F134E64347669F3256C7D050C5 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-21"
      version             = "1.0"

      hash                = "446edc0d1f7fff55b43dc47d935ac4c8b4ec345a5edaf90f5ea2122d3137f19b"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "Futumarket LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "03:00:12:f1:34:e6:43:47:66:9f:32:56:c7:d0:50:c5"
      cert_thumbprint     = "959CAA354B28892608AB1BB9519424C30BEBC155"
      cert_valid_from     = "2020-07-21"
      cert_valid_to       = "2021-07-26"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "1167847450407"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "03:00:12:f1:34:e6:43:47:66:9f:32:56:c7:d0:50:c5"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_SSL_com_53EC0CC48C77C33EEC15ED3B7DD44A8E {
   meta:
      description         = "Detects RedLineStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-19"
      version             = "1.0"

      hash                = "73fd02a8b1bdc0b24969a8fbc40471e3cc531d77711cd74ec4358f86b1285c4a"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "TIMBER DIGITAL LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:ec:0c:c4:8c:77:c3:3e:ec:15:ed:3b:7d:d4:4a:8e"
      cert_thumbprint     = "3D470D3F32806CCAD515A88768E8EA0A56CAC919"
      cert_valid_from     = "2024-07-19"
      cert_valid_to       = "2025-07-19"

      country             = "GB"
      state               = "???"
      locality            = "Leamington Spa"
      email               = "???"
      rdn_serial_number   = "12933141"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:ec:0c:c4:8c:77:c3:3e:ec:15:ed:3b:7d:d4:4a:8e"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_SSL_com_5BCA9068E4878788F76ECBB9CE312669 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-26"
      version             = "1.0"

      hash                = "db8d4cc2d61f71408623dc1aa242d874c754a6ba51e53b2514888016a0444fe0"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "Ranwell Creative Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "5b:ca:90:68:e4:87:87:88:f7:6e:cb:b9:ce:31:26:69"
      cert_thumbprint     = "2FE2725217483111DB53167C53657AA0FAAD5DEE"
      cert_valid_from     = "2024-01-26"
      cert_valid_to       = "2025-01-24"

      country             = "GB"
      state               = "???"
      locality            = "Little Rissington"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "5b:ca:90:68:e4:87:87:88:f7:6e:cb:b9:ce:31:26:69"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_00A2253AEB5B0FF1AECBFD412C18CCF07A {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-27"
      version             = "1.0"

      hash                = "ae2ff54d0460f10178a7984924504119353fe27dd7c84f1166505593cb7e464b"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "Gallopers Software Solutions Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:a2:25:3a:eb:5b:0f:f1:ae:cb:fd:41:2c:18:cc:f0:7a"
      cert_thumbprint     = "B03DB8E908DCF0E00A5A011BA82E673D91524816"
      cert_valid_from     = "2020-08-27"
      cert_valid_to       = "2021-08-27"

      country             = "IE"
      state               = "Kildare"
      locality            = "Naas"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:a2:25:3a:eb:5b:0f:f1:ae:cb:fd:41:2c:18:cc:f0:7a"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_00A758504E7971869D0AEC2775FFFA03D5 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-06-14"
      version             = "1.0"

      hash                = "ba313b84b44bb158c77aacd4fc959014ac5d3af815da80938937168f2305b85f"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "Amcert LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:a7:58:50:4e:79:71:86:9d:0a:ec:27:75:ff:fa:03:d5"
      cert_thumbprint     = "646BBB3A37CC004BEA6EFCD48579D1A5776CB157"
      cert_valid_from     = "2021-06-14"
      cert_valid_to       = "2022-06-14"

      country             = "AM"
      state               = "???"
      locality            = "Yerevan"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:a7:58:50:4e:79:71:86:9d:0a:ec:27:75:ff:fa:03:d5"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_00C667FFE3A5B0A5AE7CF3A9E41682E91B {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-29"
      version             = "1.0"

      hash                = "47ec7e0eb40aa7f939e9e83dc2eba55c0806449453bfe5a2aa603a66a094e64f"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "NAILS UNLIMITED LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:c6:67:ff:e3:a5:b0:a5:ae:7c:f3:a9:e4:16:82:e9:1b"
      cert_thumbprint     = "6B66BA34FF01E0DAB6E68BA244D991578A69C4AD"
      cert_valid_from     = "2021-03-29"
      cert_valid_to       = "2022-03-29"

      country             = "GB"
      state               = "Dorset"
      locality            = "Dorchester"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:c6:67:ff:e3:a5:b0:a5:ae:7c:f3:a9:e4:16:82:e9:1b"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_00C81319D20C6F1F1AEC3398522189D90C {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-01-30"
      version             = "1.0"

      hash                = "8c98497cb266d1e0713969a64b2f3728017052d243469bfb22deb9c742ea9d9f"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "AMCERT,LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:c8:13:19:d2:0c:6f:1f:1a:ec:33:98:52:21:89:d9:0c"
      cert_thumbprint     = "A6206300DB0CD79F5A39CA715B0F5E16A5BCBA61"
      cert_valid_from     = "2022-01-30"
      cert_valid_to       = "2023-01-30"

      country             = "AM"
      state               = "Erevan"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:c8:13:19:d2:0c:6f:1f:1a:ec:33:98:52:21:89:d9:0c"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_00E0A83917660D05CF476374659D3C7B85 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-20"
      version             = "1.0"

      hash                = "7f5fb937bb138c7e292ec64f79ac0b6d887d47a8b3e21153c1a05df91dfb823b"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "PIK MOTEL S.R.L."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e0:a8:39:17:66:0d:05:cf:47:63:74:65:9d:3c:7b:85"
      cert_thumbprint     = "E997177ABB8C6A01A9D5B2E9578E9F7E9C6E6576"
      cert_valid_from     = "2021-05-20"
      cert_valid_to       = "2022-05-20"

      country             = "RO"
      state               = "Prahova"
      locality            = "Negoiesti"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e0:a8:39:17:66:0d:05:cf:47:63:74:65:9d:3c:7b:85"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_00E3B80C0932B52A708477939B0D32186F {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-30"
      version             = "1.0"

      hash                = "619f3111ecda81c05a1caa5d84be3bd13afd54439610738637615da53418922a"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "BISOYETUTU LTD LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:e3:b8:0c:09:32:b5:2a:70:84:77:93:9b:0d:32:18:6f"
      cert_thumbprint     = "1D2B5D4F0DE1D7CE4ABF82FDC58ADC43BC28ADEE"
      cert_valid_from     = "2021-03-30"
      cert_valid_to       = "2022-03-30"

      country             = "GB"
      state               = "West Midlands"
      locality            = "Coventry"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:e3:b8:0c:09:32:b5:2a:70:84:77:93:9b:0d:32:18:6f"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_0139DDE119BB320DFB9F5DEFE3F71245 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-10"
      version             = "1.0"

      hash                = "64df21caada72b25868c916b897d5188935337edb476cf1c850317ac7aa28d1e"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "Hangil IT Co., Ltd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "01:39:dd:e1:19:bb:32:0d:fb:9f:5d:ef:e3:f7:12:45"
      cert_thumbprint     = "28F9A8E7601F5338BF6E194151A718608C0124A8"
      cert_valid_from     = "2021-11-10"
      cert_valid_to       = "2024-11-09"

      country             = "KR"
      state               = "Seoul"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "01:39:dd:e1:19:bb:32:0d:fb:9f:5d:ef:e3:f7:12:45"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_17CCECC181ED65A357EDF3B01DF62CC9 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-24"
      version             = "1.0"

      hash                = "2fc13abe0d83b451a7a7fb55630c629a8b2d0b3197e66204434fd7ce52f5162c"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "AMCERT,LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "17:cc:ec:c1:81:ed:65:a3:57:ed:f3:b0:1d:f6:2c:c9"
      cert_thumbprint     = "993C2D2CF1522ECBEE99215487EDEB6085D09931"
      cert_valid_from     = "2022-03-24"
      cert_valid_to       = "2023-03-24"

      country             = "AM"
      state               = "Erevan"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "17:cc:ec:c1:81:ed:65:a3:57:ed:f3:b0:1d:f6:2c:c9"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_20CD4BFADBEA368FB0E36AF94E5FBCCE {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-19"
      version             = "1.0"

      hash                = "3d05fee7a89dfce1ad029562fa7b84346bce12d932214cde9b26f266d53ce49c"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "FESTAP s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "20:cd:4b:fa:db:ea:36:8f:b0:e3:6a:f9:4e:5f:bc:ce"
      cert_thumbprint     = "9FC1B14D7BE09D11034B550D7FEA246ACFD3C490"
      cert_valid_from     = "2020-11-19"
      cert_valid_to       = "2021-11-19"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "20:cd:4b:fa:db:ea:36:8f:b0:e3:6a:f9:4e:5f:bc:ce"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_282A8A04073ECED658B9770BDA8C0D28 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-22"
      version             = "1.0"

      hash                = "45fff4489cc037313de8edf3589515197c184579658921fb06eb6fd4e860253e"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "OOO Betamaynd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "28:2a:8a:04:07:3e:ce:d6:58:b9:77:0b:da:8c:0d:28"
      cert_thumbprint     = "6F3224C70658F915B4EA29E80EE9633CBE48D795"
      cert_valid_from     = "2021-07-22"
      cert_valid_to       = "2022-07-22"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "28:2a:8a:04:07:3e:ce:d6:58:b9:77:0b:da:8c:0d:28"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_4659FA5FC1E0397DF79FD6A4083D93B0 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-02-28"
      version             = "1.0"

      hash                = "10240e8eafe3db72419c91f5344f2bc414e79c199153b5b6a1bd753788d6fd4d"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "Incuber Services LLP"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "46:59:fa:5f:c1:e0:39:7d:f7:9f:d6:a4:08:3d:93:b0"
      cert_thumbprint     = "7445BDC877315ED36FB18A4FD0F345DC29FEEAAD"
      cert_valid_from     = "2023-02-28"
      cert_valid_to       = "2024-02-28"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "46:59:fa:5f:c1:e0:39:7d:f7:9f:d6:a4:08:3d:93:b0"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_54CD7AE1C27F1421136ED25088F4979A {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-22"
      version             = "1.0"

      hash                = "f987e604cea843136237baea2181b45467bbbf2155fdd7c51350dfa84ec051cc"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "ABBYMAJUTA LTD LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "54:cd:7a:e1:c2:7f:14:21:13:6e:d2:50:88:f4:97:9a"
      cert_thumbprint     = "ACDE047C3D7B22F87D0E6D07FE0A3B734AD5F8AC"
      cert_valid_from     = "2021-03-22"
      cert_valid_to       = "2022-03-22"

      country             = "GB"
      state               = "Cambridgeshire"
      locality            = "Peterborough"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "54:cd:7a:e1:c2:7f:14:21:13:6e:d2:50:88:f4:97:9a"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_5EF27FC51EE80B30430947C9967DB440 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-30"
      version             = "1.0"

      hash                = "79b98dc1721e0714219f12fcd5683d532c49ec6147a2e8b1efe94edc7148f839"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "AMCERT,LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "5e:f2:7f:c5:1e:e8:0b:30:43:09:47:c9:96:7d:b4:40"
      cert_thumbprint     = "9232B1D2BC069AEE6194B24C73117DF993BFB7A5"
      cert_valid_from     = "2021-11-30"
      cert_valid_to       = "2022-11-30"

      country             = "AM"
      state               = "Erevan"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "5e:f2:7f:c5:1e:e8:0b:30:43:09:47:c9:96:7d:b4:40"
      )
}

rule MAL_Compromised_Cert_RedLineStealer_Sectigo_634E16E38F12E9A71ACA08E4C6B2DBB9 {
   meta:
      description         = "Detects RedLineStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-19"
      version             = "1.0"

      hash                = "e95d92772e18190dbde834744c74aa2ab7fda3b01e1ca839fabb8a4285b4e148"
      malware             = "RedLineStealer"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "AUTO RESPONSE LTD CYF"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "63:4e:16:e3:8f:12:e9:a7:1a:ca:08:e4:c6:b2:db:b9"
      cert_thumbprint     = "93A416ECF173B744C3C0E5E45C8FB23BF01FA387"
      cert_valid_from     = "2021-03-19"
      cert_valid_to       = "2022-03-19"

      country             = "GB"
      state               = "???"
      locality            = "Cardiff"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "63:4e:16:e3:8f:12:e9:a7:1a:ca:08:e4:c6:b2:db:b9"
      )
}

rule MAL_Compromised_Cert_RedLine_Sectigo_14148CADC21B517295AC8AB7A3839B14 {
   meta:
      description         = "Detects RedLine with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-26"
      version             = "1.0"

      hash                = "95d977f2a9f6db1776ed9bbd124f0e3ce58bf84031f92816de02bc5593bb6c33"
      malware             = "RedLine"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "AHMADI MOHAMMAD ZAHER"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "14:14:8c:ad:c2:1b:51:72:95:ac:8a:b7:a3:83:9b:14"
      cert_thumbprint     = "788CD9D9A54B675BF594F2EB393A8533D198E210"
      cert_valid_from     = "2024-02-26"
      cert_valid_to       = "2025-02-25"

      country             = "US"
      state               = "Texas"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "14:14:8c:ad:c2:1b:51:72:95:ac:8a:b7:a3:83:9b:14"
      )
}

rule MAL_Compromised_Cert_Redline_Sectigo_6F3442C728DC9E9D63EB5F1EEC64C197 {
   meta:
      description         = "Detects Redline with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-04"
      version             = "1.0"

      hash                = "b59559d59598e17f3897a4deb855a133f0e0f99df4692f8d8bc5982fc5b4ca7f"
      malware             = "Redline"
      malware_type        = "Infostealer"
      malware_notes       = "A malware as a service infostealer: https://www.proofpoint.com/us/blog/threat-insight/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign"

      signer              = "KusderQounm Venitnet Futurkresl Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "6f:34:42:c7:28:dc:9e:9d:63:eb:5f:1e:ec:64:c1:97"
      cert_thumbprint     = "B52DDB58C551AFEE980F6ADD8F8162BC4E65F837"
      cert_valid_from     = "2024-03-04"
      cert_valid_to       = "2025-03-04"

      country             = "CN"
      state               = "福建省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91350205MA356BHE2L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "6f:34:42:c7:28:dc:9e:9d:63:eb:5f:1e:ec:64:c1:97"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_Certum_775C51ADC14BD815BCCCF18D79853432 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-17"
      version             = "1.0"

      hash                = "a681f4e8aff080bfbfeead57c1d44c7dc4165fe18fb72f3e22cea7b7e06a44f8"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Quanzhou Diancheng Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "77:5c:51:ad:c1:4b:d8:15:bc:cc:f1:8d:79:85:34:32"
      cert_thumbprint     = "D686B825DC006A20A55C03579B1AB0007E8372DF"
      cert_valid_from     = "2024-10-17"
      cert_valid_to       = "2025-10-17"

      country             = "CN"
      state               = "Fujian"
      locality            = "Quanzhou"
      email               = "???"
      rdn_serial_number   = "91350502315458956U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "77:5c:51:ad:c1:4b:d8:15:bc:cc:f1:8d:79:85:34:32"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_GlobalSign_42D32D175B852FD2FF104B2B {
   meta:
      description         = "Detects RemcosRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-23"
      version             = "1.0"

      hash                = "07b05ce1a411871e69f2c93b636659b677fcb545b4c05b6641d362b04138704f"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MILIO LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "42:d3:2d:17:5b:85:2f:d2:ff:10:4b:2b"
      cert_thumbprint     = "32145EE7FD51879BB6507CF6975A0EA43973BFF8"
      cert_valid_from     = "2025-03-23"
      cert_valid_to       = "2026-02-20"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "42:d3:2d:17:5b:85:2f:d2:ff:10:4b:2b"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_GlobalSign_7CC47A19B9258F9A884585C5 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-06"
      version             = "1.0"

      hash                = "6493d8528b5aca043772c1f657125bcebc0cf762efc69b7e3c99b2f4a3095726"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC CiTyAr GROUP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7c:c4:7a:19:b9:25:8f:9a:88:45:85:c5"
      cert_thumbprint     = "A2F30B8E19DDF63A86DA92FD40B08898B485756A"
      cert_valid_from     = "2025-05-06"
      cert_valid_to       = "2026-05-07"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1137746413507"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7c:c4:7a:19:b9:25:8f:9a:88:45:85:c5"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_SSL_com_009D9EDAE470A7D76B8B0F1792232D83 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-24"
      version             = "1.0"

      hash                = "8337a4fa2d982a4b4a544b71715c8d79a97278113b887a7fcce111719e0fba4a"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Annett Holdings, Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "00:9d:9e:da:e4:70:a7:d7:6b:8b:0f:17:92:23:2d:83"
      cert_thumbprint     = "FB0B1115DF46E050E3DE833233730180987ED386"
      cert_valid_from     = "2025-07-24"
      cert_valid_to       = "2026-07-18"

      country             = "US"
      state               = "Iowa"
      locality            = "Des Moines"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "00:9d:9e:da:e4:70:a7:d7:6b:8b:0f:17:92:23:2d:83"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_SSL_com_046917F4480EDE664C7765F3CA2083D3 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-13"
      version             = "1.0"

      hash                = "5907944373d327917b8bbac448b56548206c30da715d2a400318dda0a46906a8"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hi Resolution Software Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "04:69:17:f4:48:0e:de:66:4c:77:65:f3:ca:20:83:d3"
      cert_thumbprint     = "0C7F9FB37FC85C15E6702F7A9A1FE85ACCAB1BBB"
      cert_valid_from     = "2025-08-13"
      cert_valid_to       = "2026-08-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "04:69:17:f4:48:0e:de:66:4c:77:65:f3:ca:20:83:d3"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_SSL_com_0BA7695FB86C69EAB5B4D16DB3C6EB1D {
   meta:
      description         = "Detects RemcosRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-18"
      version             = "1.0"

      hash                = "05badedbfa2ca6164741b2b475ed60ea405a97e40ef9a4108bdb8bd115c318da"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Annett Holdings, Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0b:a7:69:5f:b8:6c:69:ea:b5:b4:d1:6d:b3:c6:eb:1d"
      cert_thumbprint     = "A6E91D18B354BB1BBFA7E1EBEDFB0981040FAE17"
      cert_valid_from     = "2025-07-18"
      cert_valid_to       = "2026-07-18"

      country             = "US"
      state               = "Iowa"
      locality            = "Des Moines"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0b:a7:69:5f:b8:6c:69:ea:b5:b4:d1:6d:b3:c6:eb:1d"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_SSL_com_1AE11848B7BB66B86BF6D39539BB649C {
   meta:
      description         = "Detects RemcosRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-16"
      version             = "1.0"

      hash                = "094cb617763cd4a9672c42624f4d665bc0bc0956ad875b134ee29659805ac135"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ОсОО ГлобалГудс Сапплай"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1a:e1:18:48:b7:bb:66:b8:6b:f6:d3:95:39:bb:64:9c"
      cert_thumbprint     = "18B241ECEA51925C92BF1ECB31C076231C9D5790"
      cert_valid_from     = "2025-04-16"
      cert_valid_to       = "2026-04-16"

      country             = "KG"
      state               = "???"
      locality            = "Bishkek"
      email               = "???"
      rdn_serial_number   = "192750-3301-OOO"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1a:e1:18:48:b7:bb:66:b8:6b:f6:d3:95:39:bb:64:9c"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_SSL_com_3CC9EF0DFC14DB49966F02998B6932FB {
   meta:
      description         = "Detects RemcosRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-09"
      version             = "1.0"

      hash                = "e91506f978e3e9224e8ee589b23f1ad380cae00e40ec460970f5b0f5c6ebba8a"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE & MARKETING SOLUTION LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3c:c9:ef:0d:fc:14:db:49:96:6f:02:99:8b:69:32:fb"
      cert_thumbprint     = "12F4B0D9735DC169079573BF34A898381017653A"
      cert_valid_from     = "2024-12-09"
      cert_valid_to       = "2025-12-09"

      country             = "GB"
      state               = "???"
      locality            = "Swansea"
      email               = "???"
      rdn_serial_number   = "12846100"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3c:c9:ef:0d:fc:14:db:49:96:6f:02:99:8b:69:32:fb"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_SSL_com_54BFAC4E3C2EA108E9CE1E0C10DA8B5A {
   meta:
      description         = "Detects RemcosRAT with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-02"
      version             = "1.0"

      hash                = "420a4e1575bdbc22b947155465046eab0fefa4ab3490b1b63270b198fabaf8ad"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RASYS Software AB"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "54:bf:ac:4e:3c:2e:a1:08:e9:ce:1e:0c:10:da:8b:5a"
      cert_thumbprint     = "62309F28C2DC95B3BFC41B652923DEC475396321"
      cert_valid_from     = "2025-06-02"
      cert_valid_to       = "2026-06-02"

      country             = "SE"
      state               = "Dalarna County"
      locality            = "Mora"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "54:bf:ac:4e:3c:2e:a1:08:e9:ce:1e:0c:10:da:8b:5a"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_Sectigo_0082CB93593B658100CDD7A00C874287F2 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-30"
      version             = "1.0"

      hash                = "75250cab773991fd76bf14b8c397b2f143100cf5b13f3213528167e43409a537"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sportsonline24 B.V."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:82:cb:93:59:3b:65:81:00:cd:d7:a0:0c:87:42:87:f2"
      cert_thumbprint     = "39F27161BF3E8DDCB1AFB98822348EB28398F34B"
      cert_valid_from     = "2020-10-30"
      cert_valid_to       = "2021-10-30"

      country             = "NL"
      state               = "???"
      locality            = "Bloemendaal"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:82:cb:93:59:3b:65:81:00:cd:d7:a0:0c:87:42:87:f2"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_Sectigo_00FECC3B3C675F7FFD7DE22507F3FDACD7 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-11-25"
      version             = "1.0"

      hash                = "3d4ffcd1cd594f452ad1c374933eea8dd36d21a6d01372cc7f1afc636d26fa72"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gromit Electronics Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:fe:cc:3b:3c:67:5f:7f:fd:7d:e2:25:07:f3:fd:ac:d7"
      cert_thumbprint     = "B505C82DDDE0F9D2AE5E14956A504B4346581BBF"
      cert_valid_from     = "2022-11-25"
      cert_valid_to       = "2023-11-25"

      country             = "GB"
      state               = "Gloucestershire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:fe:cc:3b:3c:67:5f:7f:fd:7d:e2:25:07:f3:fd:ac:d7"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_Sectigo_0A55C15F733BF1633E9FFAE8A6E3B37D {
   meta:
      description         = "Detects RemcosRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-30"
      version             = "1.0"

      hash                = "d4acc0dd3b974dde3fce2ec192c8013e8ec975a71cd6ea9d805cc1992a5930ec"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Osnova OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "0a:55:c1:5f:73:3b:f1:63:3e:9f:fa:e8:a6:e3:b3:7d"
      cert_thumbprint     = "591F68885FC805A10996262C93AAB498C81F3010"
      cert_valid_from     = "2020-10-30"
      cert_valid_to       = "2021-10-30"

      country             = "RU"
      state               = "???"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "0a:55:c1:5f:73:3b:f1:63:3e:9f:fa:e8:a6:e3:b3:7d"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_Sectigo_1614EF66B2C4B886E71A93DD34869F48 {
   meta:
      description         = "Detects RemcosRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-31"
      version             = "1.0"

      hash                = "818bd67db5fe30f5cfdab861f996f30fa20427e3e1aa65ffe6d98f6c7af7558d"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SHIRT AND CUFF LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "16:14:ef:66:b2:c4:b8:86:e7:1a:93:dd:34:86:9f:48"
      cert_thumbprint     = "8C83C0DF901B2DEBEC74DBA17696D89E3428786D"
      cert_valid_from     = "2022-05-31"
      cert_valid_to       = "2023-05-31"

      country             = "GB"
      state               = "Berkshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "16:14:ef:66:b2:c4:b8:86:e7:1a:93:dd:34:86:9f:48"
      )
}

rule MAL_Compromised_Cert_RemcosRAT_Sectigo_5294F0F841F29855E33A18402421949A {
   meta:
      description         = "Detects RemcosRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-11-07"
      version             = "1.0"

      hash                = "538b607c03aa2d0960c396529399921f957f421a3ca084d140316e2ee21889cc"
      malware             = "RemcosRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Integrated Plotting Solutions Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "52:94:f0:f8:41:f2:98:55:e3:3a:18:40:24:21:94:9a"
      cert_thumbprint     = "7747F957A70822B5FBC2274495742FC33607B09F"
      cert_valid_from     = "2022-11-07"
      cert_valid_to       = "2023-11-07"

      country             = "GB"
      state               = "Sheffield"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "52:94:f0:f8:41:f2:98:55:e3:3a:18:40:24:21:94:9a"
      )
}

rule MAL_Compromised_Cert_Remcos_GlobalSign_32D05E78573EFED7E2B30A3C {
   meta:
      description         = "Detects Remcos with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "df668ebc65fd0035faed898755e4dd1ee61f76f58b6a49448f6489765e1fbc2a"
      malware             = "Remcos"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THANH LIEM ENVIRONMENT COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "32:d0:5e:78:57:3e:fe:d7:e2:b3:0a:3c"
      cert_thumbprint     = "6E12E4302CD228FD138C6412EF48B93D81FDCFA0"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2026-03-15"

      country             = "VN"
      state               = "Hà Nam"
      locality            = "Hà Nam"
      email               = "???"
      rdn_serial_number   = "0700463959"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "32:d0:5e:78:57:3e:fe:d7:e2:b3:0a:3c"
      )
}

rule MAL_Compromised_Cert_RemoteManipulator_Sectigo_00CA4822E6905AA4FCA9E28523F04F14A3 {
   meta:
      description         = "Detects RemoteManipulator with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-02"
      version             = "1.0"

      hash                = "c1fe973ec51d405df053a593909e50a2f6929e95966557e0b5188861ca983c56"
      malware             = "RemoteManipulator"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ELISTREID, OOO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ca:48:22:e6:90:5a:a4:fc:a9:e2:85:23:f0:4f:14:a3"
      cert_thumbprint     = "35CED9662401F10FA92282E062A8B5588E0C674D"
      cert_valid_from     = "2021-03-02"
      cert_valid_to       = "2022-03-02"

      country             = "RU"
      state               = "???"
      locality            = "Saint-Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ca:48:22:e6:90:5a:a4:fc:a9:e2:85:23:f0:4f:14:a3"
      )
}

rule MAL_Compromised_Cert_RemoteManipulator_Sectigo_00ECE6CBF67DC41635A5E5D075F286AF23 {
   meta:
      description         = "Detects RemoteManipulator with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-22"
      version             = "1.0"

      hash                = "6dda990d8073fee71cedeabd622f6d7a9be6fb2e696bda71e7b709f1c08f5e36"
      malware             = "RemoteManipulator"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THRANE AGENTUR ApS"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ec:e6:cb:f6:7d:c4:16:35:a5:e5:d0:75:f2:86:af:23"
      cert_thumbprint     = "979D470B4E782EF6BE34DED465988FB089302204"
      cert_valid_from     = "2020-10-22"
      cert_valid_to       = "2021-10-22"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Klampenborg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ec:e6:cb:f6:7d:c4:16:35:a5:e5:d0:75:f2:86:af:23"
      )
}

rule MAL_Compromised_Cert_RemoteManipulator_Sectigo_7DDD3796A427B42F2E52D7C7AF0CA54F {
   meta:
      description         = "Detects RemoteManipulator with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-10"
      version             = "1.0"

      hash                = "ddca8f9d05aa07e903b71aa9823252962f91d0a192b79e346f8a51f39fb9212d"
      malware             = "RemoteManipulator"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO Fobos"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7d:dd:37:96:a4:27:b4:2f:2e:52:d7:c7:af:0c:a5:4f"
      cert_thumbprint     = "B5CD5A485DEE4A82F34C98B3F108579E8501FDEA"
      cert_valid_from     = "2021-02-10"
      cert_valid_to       = "2022-02-10"

      country             = "RU"
      state               = "???"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7d:dd:37:96:a4:27:b4:2f:2e:52:d7:c7:af:0c:a5:4f"
      )
}

rule MAL_Compromised_Cert_ResidentialProxyInstaller_DigiCert_0A8AAD8C6E69D0EA3072E6EEA5FBD468 {
   meta:
      description         = "Detects ResidentialProxyInstaller with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-20"
      version             = "1.0"

      hash                = "cad92559e7848f000ca084aa6e5434a2eafedd2bc2e5ff06a13b724bfd447359"
      malware             = "ResidentialProxyInstaller"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Agora International Agency Bilisim Hizmetleri Limited Sirketi"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0a:8a:ad:8c:6e:69:d0:ea:30:72:e6:ee:a5:fb:d4:68"
      cert_thumbprint     = "cb26fe91f122ae7a0873085a5bf6de9361fa124fe1c57cd1e2e942fc991cc52c"
      cert_valid_from     = "2023-09-20"
      cert_valid_to       = "2026-08-31"

      country             = "TR"
      state               = "İstanbul"
      locality            = "Kadıköy"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0a:8a:ad:8c:6e:69:d0:ea:30:72:e6:ee:a5:fb:d4:68"
      )
}

rule MAL_Compromised_Cert_ResidentialProxyInstaller_GoGetSSL_0B902CA1B6CA4C44CF6D10B8BBAD35B2 {
   meta:
      description         = "Detects ResidentialProxyInstaller with compromised cert (GoGetSSL)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-27"
      version             = "1.0"

      hash                = "157ddc5859b7950e7c44573a06837aae1fd86379e7b27fdd0d14617bc7947b4f"
      malware             = "ResidentialProxyInstaller"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Agora International Agency Bilisim Hizmetleri Limited Sirketi"
      cert_issuer_short   = "GoGetSSL"
      cert_issuer         = "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1"
      cert_serial         = "0b:90:2c:a1:b6:ca:4c:44:cf:6d:10:b8:bb:ad:35:b2"
      cert_thumbprint     = "e4a3e1a46b794116f5e1427fa7ff4b0e2bde6983"
      cert_valid_from     = "2024-06-27"
      cert_valid_to       = "2027-06-26"

      country             = "TR"
      state               = "İstanbul"
      locality            = "Kadıköy"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1" and
         sig.serial == "0b:90:2c:a1:b6:ca:4c:44:cf:6d:10:b8:bb:ad:35:b2"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_Certum_2361E281F00886DC14DF3B7B57DAAFFE {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-19"
      version             = "1.0"

      hash                = "79212a76f167cf5628a51517f503531daf063d04f0aa5e115b5671121d1ac052"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Qujing Minsi E-commerce Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "23:61:e2:81:f0:08:86:dc:14:df:3b:7b:57:da:af:fe"
      cert_thumbprint     = "49F0B27799AE6EB4E8E20C269AC4A52D7CD0A58F"
      cert_valid_from     = "2025-03-19"
      cert_valid_to       = "2026-03-19"

      country             = "CN"
      state               = "Yunnan"
      locality            = "Qujing"
      email               = "???"
      rdn_serial_number   = "91530302MAC23MFW4X"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "23:61:e2:81:f0:08:86:dc:14:df:3b:7b:57:da:af:fe"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_Certum_33252E4F8965178EC4D35289247A427F {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-26"
      version             = "1.0"

      hash                = "14e9e9fcbe3b729634542e7aee4b3e63b9ccdba39bc87885b6e338bad168aba5"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Shandong Yunlu Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "33:25:2e:4f:89:65:17:8e:c4:d3:52:89:24:7a:42:7f"
      cert_thumbprint     = "8337D3D842EDDAFB0085CBB7C044D8CA6AAB932C"
      cert_valid_from     = "2024-07-26"
      cert_valid_to       = "2025-07-26"

      country             = "CN"
      state               = "Shandong"
      locality            = "Jinan"
      email               = "???"
      rdn_serial_number   = "91370102MA3NHYDYX4"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "33:25:2e:4f:89:65:17:8e:c4:d3:52:89:24:7a:42:7f"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_Certum_55DF56C531FC278E7D8D6D42029C3D81 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-20"
      version             = "1.0"

      hash                = "b37a0a7ff6ad23dc71339f86ffa4223327dfcb015d24c32e74cf4ac8a272d1a8"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "沈阳海颖网络科技信息咨询有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "55:df:56:c5:31:fc:27:8e:7d:8d:6d:42:02:9c:3d:81"
      cert_thumbprint     = "2F97799141972D08C59F68D1C7BCB9B2B07132FB"
      cert_valid_from     = "2024-12-20"
      cert_valid_to       = "2025-12-20"

      country             = "CN"
      state               = "Liaoning"
      locality            = "Shenyang"
      email               = "???"
      rdn_serial_number   = "91210106MA10YN4A4Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "55:df:56:c5:31:fc:27:8e:7d:8d:6d:42:02:9c:3d:81"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_Certum_585EFDA35CFE245E41EBB2D47043C5DC {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-13"
      version             = "1.0"

      hash                = "ff6fcdd0e22270484451763d71f31f244b6805ed288f2310fb5d924309176852"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Fuzhou Gulou Haosenzi E-commerce Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "58:5e:fd:a3:5c:fe:24:5e:41:eb:b2:d4:70:43:c5:dc"
      cert_thumbprint     = "066692E80D1F62F86CD773B055425C79D854F5A0"
      cert_valid_from     = "2024-08-13"
      cert_valid_to       = "2025-08-13"

      country             = "CN"
      state               = "Fujian"
      locality            = "Fuzhou"
      email               = "???"
      rdn_serial_number   = "91350102MA8T626L6C"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "58:5e:fd:a3:5c:fe:24:5e:41:eb:b2:d4:70:43:c5:dc"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_0287DE9AFD1FE6CB92053B30 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-11"
      version             = "1.0"

      hash                = "545812664008d0b35cf61c15c79526b1d5d05aef886a3f85c9056570fbf13933"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "MOTTO IMPEX LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "02:87:de:9a:fd:1f:e6:cb:92:05:3b:30"
      cert_thumbprint     = "8A0D7827D9E04C872F022847D519871E1569A5F4"
      cert_valid_from     = "2025-07-11"
      cert_valid_to       = "2026-07-12"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "yogeshpatel.motto@gmail.com"
      rdn_serial_number   = "UDYAM-BR-30-0046322"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "02:87:de:9a:fd:1f:e6:cb:92:05:3b:30"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_05993A1B5CEB150F61FE31B2 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-06"
      version             = "1.0"

      hash                = "c50326e6b68e807eaf188f95ff6e2a17df11efbfd0936395b452946085b83fcd"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "MekoGuard Bytemin Information Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "05:99:3a:1b:5c:eb:15:0f:61:fe:31:b2"
      cert_thumbprint     = "281C3D9BFAB4B699BEB0AC7F46D21D5367FDC309"
      cert_valid_from     = "2024-02-06"
      cert_valid_to       = "2025-02-06"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Foshan"
      email               = "???"
      rdn_serial_number   = "91440605MACR7QA22Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "05:99:3a:1b:5c:eb:15:0f:61:fe:31:b2"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_10C11E651FF7C708C318664F {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-16"
      version             = "1.0"

      hash                = "8ce0c633472eeb3259a48bdc0997dfdbf3911d07d30f43e8bc08ad406c9a4020"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Hebei YiLuoDuo Import and Export Trade Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "10:c1:1e:65:1f:f7:c7:08:c3:18:66:4f"
      cert_thumbprint     = "7292EEDE289822C228606F1C8C18E7404E59E33A"
      cert_valid_from     = "2024-05-16"
      cert_valid_to       = "2025-05-17"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130108MA07PFJ284"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "10:c1:1e:65:1f:f7:c7:08:c3:18:66:4f"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_1AF0A44396DD57AC87ECB79D {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-15"
      version             = "1.0"

      hash                = "fac7f1a54eef98830ecbd25fef364695b8afd9e255dcc19702dac84ee526c5ca"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Lion Software, LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1a:f0:a4:43:96:dd:57:ac:87:ec:b7:9d"
      cert_thumbprint     = "A243692CD9205CFE32BEEF144B7D84350F3AA0E6"
      cert_valid_from     = "2024-10-15"
      cert_valid_to       = "2025-10-16"

      country             = "US"
      state               = "Alabama"
      locality            = "Centre"
      email               = "???"
      rdn_serial_number   = "000-541-240"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1a:f0:a4:43:96:dd:57:ac:87:ec:b7:9d"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_2C2E778927A4B2AB24D0130E {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-25"
      version             = "1.0"

      hash                = "bd403309f8f43fc34d64917720f55c1dbcc50f250f1210bc8dec6c704d4ed461"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "HA NOI TROPICAL ARCHIETECTURE COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2c:2e:77:89:27:a4:b2:ab:24:d0:13:0e"
      cert_thumbprint     = "B5AB41E0B831205309D6E74C1A2109AE20413BCB"
      cert_valid_from     = "2024-07-25"
      cert_valid_to       = "2025-07-23"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "???"
      rdn_serial_number   = "0104861814"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2c:2e:77:89:27:a4:b2:ab:24:d0:13:0e"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_2F94A1516E8A182B148F994A {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-09"
      version             = "1.0"

      hash                = "6b8013ce46162259cdfd2e9c74e43ec72209b5b96e2cc5e051a17687da42e35d"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "ООО НЕВА КЕРАМИКС"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2f:94:a1:51:6e:8a:18:2b:14:8f:99:4a"
      cert_thumbprint     = "4645E8244D0240FED60A8923999340F10F363EA5"
      cert_valid_from     = "2024-12-09"
      cert_valid_to       = "2025-12-10"

      country             = "RU"
      state               = "Санкт-Петербург"
      locality            = "Санкт-Петербург"
      email               = "Clearnds2011@mail.ru"
      rdn_serial_number   = "1147847357217"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2f:94:a1:51:6e:8a:18:2b:14:8f:99:4a"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_332985D1583AA93BF6DF0FFD {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-07"
      version             = "1.0"

      hash                = "42735792cc7e76b7439751d4aa673d5bd61d100f8d4de42c9084db46e2a1dbf1"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "THINH HA TRADE & TRANSPORT COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 CodeSigning CA 2020"
      cert_serial         = "33:29:85:d1:58:3a:a9:3b:f6:df:0f:fd"
      cert_thumbprint     = "35EABD502F8EDD37DD62B3C598167BF60E0226D5"
      cert_valid_from     = "2025-03-07"
      cert_valid_to       = "2026-03-08"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 CodeSigning CA 2020" and
         sig.serial == "33:29:85:d1:58:3a:a9:3b:f6:df:0f:fd"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_3B7EAC8B20F3EDCB557300BE {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "aec4e5e79e5690c6f8f97334da9aa9898fb5ea68c6458efee70a45a88863c925"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "LLC Service Stroy TK"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3b:7e:ac:8b:20:f3:ed:cb:55:73:00:be"
      cert_thumbprint     = "3F6BE09D1813092FD3AC7D3C28D3600343426976"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-18"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3b:7e:ac:8b:20:f3:ed:cb:55:73:00:be"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_424DAE86E4D976F2EC31FA76 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-17"
      version             = "1.0"

      hash                = "9de12a0eecc54548338319c106bb77ca5496c1aedc293d22dc994eb61b9dd984"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Reviihuray Communication Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "42:4d:ae:86:e4:d9:76:f2:ec:31:fa:76"
      cert_thumbprint     = "CA76DA81C13B8722F4D076E6D1FD39574F22AD66"
      cert_valid_from     = "2024-05-17"
      cert_valid_to       = "2025-05-16"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130108MA09RXE44W"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "42:4d:ae:86:e4:d9:76:f2:ec:31:fa:76"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_53EFF7D7C3CB4266E8B75E6B {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-03"
      version             = "1.0"

      hash                = "b1fa0c62e07f9ad0a625fd1474a197c1d687b985714c3d697981f5fbe4993266"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Hebei Kangsheng Agricultural Science & Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "53:ef:f7:d7:c3:cb:42:66:e8:b7:5e:6b"
      cert_thumbprint     = "39CA684447AADD97E2C237D5543BB198E00CB6C8"
      cert_valid_from     = "2025-01-03"
      cert_valid_to       = "2026-01-04"

      country             = "CN"
      state               = "Hebei"
      locality            = "Hengshui"
      email               = "???"
      rdn_serial_number   = "91131101059447675D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "53:ef:f7:d7:c3:cb:42:66:e8:b7:5e:6b"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_5502C16C26DE07B5F0F3F238 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-15"
      version             = "1.0"

      hash                = "e2672f52404bf6cc190fac2218dc8a8424c112c71db9b9db94e7f14fa5e9d238"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "HANSHA ENGICON PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "55:02:c1:6c:26:de:07:b5:f0:f3:f2:38"
      cert_thumbprint     = "61DFABE4069BB465C161B889151538F9F759B2C7"
      cert_valid_from     = "2025-07-15"
      cert_valid_to       = "2026-07-16"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "hanshaengicon@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "55:02:c1:6c:26:de:07:b5:f0:f3:f2:38"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_5CF47C5F8A6B09AD2C71EEB9 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-20"
      version             = "1.0"

      hash                = "e0e0b3d2890053cbdf84d6c3177e267d8f767f4b2b6d6e5fb2de5860b0a09ee2"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "AJMERA FAB INDIA PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:f4:7c:5f:8a:6b:09:ad:2c:71:ee:b9"
      cert_thumbprint     = "4D5557739E78C96707F793213ECA3D3BCA232C5C"
      cert_valid_from     = "2025-03-20"
      cert_valid_to       = "2026-03-21"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "gittapod.42@gmail.com"
      rdn_serial_number   = "U74999RJ2016PTC056595"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:f4:7c:5f:8a:6b:09:ad:2c:71:ee:b9"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_5F1ACCF94D11EA65CDCF5141 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-08"
      version             = "1.0"

      hash                = "8bdd5af6605a576e7a2e561cb2624b30b7c0afb349a76a8cc80bdb6f994fa773"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Shantou Matching Trade Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5f:1a:cc:f9:4d:11:ea:65:cd:cf:51:41"
      cert_thumbprint     = "C5E19C953193B15F6C7CC1BB72D8DBD261FC5BB8"
      cert_valid_from     = "2024-05-08"
      cert_valid_to       = "2025-05-09"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shantou"
      email               = "???"
      rdn_serial_number   = "91440500MA4WEUU96H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5f:1a:cc:f9:4d:11:ea:65:cd:cf:51:41"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_GlobalSign_7EA850C5676DE6B09C0C3FFC {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-18"
      version             = "1.0"

      hash                = "73ce9b07e5cf79583ee18bd1472569a2edb609cf361f5ddb38b1b839056e94d9"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "EzDistract MicroLeague Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:a8:50:c5:67:6d:e6:b0:9c:0c:3f:fc"
      cert_thumbprint     = "94E8ECDF676564945E0CC02F5D7B54A6567458C7"
      cert_valid_from     = "2024-10-18"
      cert_valid_to       = "2025-10-19"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA6B62U07Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:a8:50:c5:67:6d:e6:b0:9c:0c:3f:fc"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_Microsoft_330001EFD3950B5F85A713731500000001EFD3 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-04"
      version             = "1.0"

      hash                = "22e286bfba3b106995c722b918908fcd1ee424bfc8e0a12c2f22f1344a2fcf75"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "志超 柴"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:01:ef:d3:95:0b:5f:85:a7:13:73:15:00:00:00:01:ef:d3"
      cert_thumbprint     = "518DDE0276C68C5CB5A2E9B085D5146FD7908AFD"
      cert_valid_from     = "2025-03-04"
      cert_valid_to       = "2025-03-07"

      country             = "CN"
      state               = "???"
      locality            = "平南"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:01:ef:d3:95:0b:5f:85:a7:13:73:15:00:00:00:01:ef:d3"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_00E1911FCBC51E02B812F1C133297827 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-08"
      version             = "1.0"

      hash                = "72893e08228f628e1b6f23db775182038bb7a6862ac1d6d9f62a4926dd193fc3"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "It-Rex Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "00:e1:91:1f:cb:c5:1e:02:b8:12:f1:c1:33:29:78:27"
      cert_thumbprint     = "4E26CAE8B53F3185945BE3740D2321601ED00A81"
      cert_valid_from     = "2025-04-08"
      cert_valid_to       = "2026-04-08"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "3254547-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "00:e1:91:1f:cb:c5:1e:02:b8:12:f1:c1:33:29:78:27"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_084374CC276E43AC90AFFA80B1EF7C38 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "e2f944cbcda22e6fd727f93514d11a7885f4bae6c6c5f33630e737b7c861907e"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Traitsense ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "08:43:74:cc:27:6e:43:ac:90:af:fa:80:b1:ef:7c:38"
      cert_thumbprint     = "8536E25936E97B6BDC9591AEECC0E3D5FC1F5BCD"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2026-01-13"

      country             = "DK"
      state               = "???"
      locality            = "Agerskov"
      email               = "???"
      rdn_serial_number   = "37751391"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "08:43:74:cc:27:6e:43:ac:90:af:fa:80:b1:ef:7c:38"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_28FBE6D6D3A6370559D3D4A074D78318 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-28"
      version             = "1.0"

      hash                = "a451cbfe093830cd4d907d10bc0f27ea51da53ece5456af2fe6b3b24d3df163e"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "IT HR SYSTEMS SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "28:fb:e6:d6:d3:a6:37:05:59:d3:d4:a0:74:d7:83:18"
      cert_thumbprint     = "7BE3F3210CFD173ED35F584F17B8CA76196433AA"
      cert_valid_from     = "2025-08-28"
      cert_valid_to       = "2026-08-28"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "28:fb:e6:d6:d3:a6:37:05:59:d3:d4:a0:74:d7:83:18"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_2BFF416B9301F8432BDF41C91F53251A {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-10"
      version             = "1.0"

      hash                = "4c21b40c94fcd13b60b99ef1e4f372126a86e6f526c6cc134f205794c4357bd7"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Biodime Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2b:ff:41:6b:93:01:f8:43:2b:df:41:c9:1f:53:25:1a"
      cert_thumbprint     = "15C93C32EC1C18838B5B9D7A9D3E8F694A395306"
      cert_valid_from     = "2024-05-10"
      cert_valid_to       = "2025-05-03"

      country             = "GB"
      state               = "???"
      locality            = "Kirkintilloch"
      email               = "???"
      rdn_serial_number   = "SC663866"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2b:ff:41:6b:93:01:f8:43:2b:df:41:c9:1f:53:25:1a"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_3D514DDBCFB84255F2424AE9530FBF6A {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-28"
      version             = "1.0"

      hash                = "8bedd04e21578832c2e63bc28f20ebdd2c4b1b5a34e7740804b844ecc394d351"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Phoenix Ornamentals Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "3d:51:4d:db:cf:b8:42:55:f2:42:4a:e9:53:0f:bf:6a"
      cert_thumbprint     = "4D4521CECE024D2B1530B619E5208518374E189F"
      cert_valid_from     = "2023-07-28"
      cert_valid_to       = "2024-07-27"

      country             = "GB"
      state               = "???"
      locality            = "Aylesford"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "3d:51:4d:db:cf:b8:42:55:f2:42:4a:e9:53:0f:bf:6a"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_4C3BDCE63AA1C18EB276CC8FFDF8DE8F {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-02"
      version             = "1.0"

      hash                = "bd55d845fcb90f645c601090498ca056647b91d82e39081e41b15495ffd530ff"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Hunan Kangcai Business Services Partnership Enterprise (Limited)"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4c:3b:dc:e6:3a:a1:c1:8e:b2:76:cc:8f:fd:f8:de:8f"
      cert_thumbprint     = "27281E474CF6D0125D0EC55DD158173D4682226B"
      cert_valid_from     = "2024-02-02"
      cert_valid_to       = "2025-01-28"

      country             = "CN"
      state               = "Hunan"
      locality            = "Changsha"
      email               = "???"
      rdn_serial_number   = "91430103MA4QMCCB7K"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4c:3b:dc:e6:3a:a1:c1:8e:b2:76:cc:8f:fd:f8:de:8f"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_534F46E63E0FF143119ACA722330B8A7 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-12"
      version             = "1.0"

      hash                = "221bb9c2702a2081a8dc5722ffaf81d1f9fab4de3d93794fe8becd1a12013931"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "GOLORY VISIONS PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:4f:46:e6:3e:0f:f1:43:11:9a:ca:72:23:30:b8:a7"
      cert_thumbprint     = "F79B4CBA32560BC0A46FBA364085C84000F7F3CB"
      cert_valid_from     = "2025-09-12"
      cert_valid_to       = "2026-09-12"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:4f:46:e6:3e:0f:f1:43:11:9a:ca:72:23:30:b8:a7"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_5620CB4E2216D472159087AAB6485186 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-18"
      version             = "1.0"

      hash                = "314653180866938ffb3e125a8e8b3e3c4e4c06159ea3a8343fc083fbf45c776e"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Atlas Care Homes Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "56:20:cb:4e:22:16:d4:72:15:90:87:aa:b6:48:51:86"
      cert_thumbprint     = "BD5D24BB7161FD8104FC82A566B0BCE95CA6689D"
      cert_valid_from     = "2024-12-18"
      cert_valid_to       = "2025-12-18"

      country             = "GB"
      state               = "???"
      locality            = "Newcastle-Upon-Tyne"
      email               = "???"
      rdn_serial_number   = "09273411"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "56:20:cb:4e:22:16:d4:72:15:90:87:aa:b6:48:51:86"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_5A5B405B1DF708C4C08C6180DFBA9BAD {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-27"
      version             = "1.0"

      hash                = "12e4124bf790bced8b0cff6506511bc15e8b65fd31fc2f13697ce899f6ad9b69"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "CodeVue OÜ"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5a:5b:40:5b:1d:f7:08:c4:c0:8c:61:80:df:ba:9b:ad"
      cert_thumbprint     = "24CB257143B9AB51B623147FAC060676636E259E"
      cert_valid_from     = "2023-09-27"
      cert_valid_to       = "2024-09-26"

      country             = "EE"
      state               = "Harju County"
      locality            = "Tallinn"
      email               = "???"
      rdn_serial_number   = "16820165"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5a:5b:40:5b:1d:f7:08:c4:c0:8c:61:80:df:ba:9b:ad"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_5FDEBACCA778B81C231DE0C162CCC104 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-15"
      version             = "1.0"

      hash                = "2e338036cf49cf618430ab452a87b5a748a5443ad093ff6b49a71d0cf5af373b"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "GALAXY HOMES LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5f:de:ba:cc:a7:78:b8:1c:23:1d:e0:c1:62:cc:c1:04"
      cert_thumbprint     = "B407912B0421E763505C91C0F0AAC02D850F930C"
      cert_valid_from     = "2025-09-15"
      cert_valid_to       = "2026-09-15"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5f:de:ba:cc:a7:78:b8:1c:23:1d:e0:c1:62:cc:c1:04"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_60BC12FFBC578B9115527E428D8B59CA {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-25"
      version             = "1.0"

      hash                = "a0c594d583540ce214a3c6d2a1f25ac912c476f3e806ffb98d2a8cd3e4beba3c"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Cloudeya Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "60:bc:12:ff:bc:57:8b:91:15:52:7e:42:8d:8b:59:ca"
      cert_thumbprint     = "AD64CF2DD5BBE512E898F01FA2E99331F85CDB0B"
      cert_valid_from     = "2024-07-25"
      cert_valid_to       = "2025-07-25"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "12442044"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "60:bc:12:ff:bc:57:8b:91:15:52:7e:42:8d:8b:59:ca"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_66811A7CBD25555F23EA3B1DA3391DCF {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-19"
      version             = "1.0"

      hash                = "b1e8e75ea54ea3e9a3297250489f26f6d5d1f950e75686b31359accc928bc4af"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "COBBLED STREETS EDUTECH PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "66:81:1a:7c:bd:25:55:5f:23:ea:3b:1d:a3:39:1d:cf"
      cert_thumbprint     = "A2A79252FE95836BC4F8EE7128AF88F00FBF13A4"
      cert_valid_from     = "2025-09-19"
      cert_valid_to       = "2026-09-19"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "66:81:1a:7c:bd:25:55:5f:23:ea:3b:1d:a3:39:1d:cf"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_6811D075FB2BF13F59C9A797B0D3EBF9 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-25"
      version             = "1.0"

      hash                = "77ce108cd1d6751faaf043706a37af1c59fd1d087efeb1cfe5d22ae395566b5b"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "LED LIGHT SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "68:11:d0:75:fb:2b:f1:3f:59:c9:a7:97:b0:d3:eb:f9"
      cert_thumbprint     = "2C547FCCE1000372134A0B6FE475861C8DA1AC7B"
      cert_valid_from     = "2024-01-25"
      cert_valid_to       = "2025-01-24"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000567855"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "68:11:d0:75:fb:2b:f1:3f:59:c9:a7:97:b0:d3:eb:f9"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_72FD654308155944BDAD4E0054F37E57 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-14"
      version             = "1.0"

      hash                = "5723793f48e3688ef7417f0f1cd7d76ae5635782e6b3f21a5b6937c7bfa6e583"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "It-Rex Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "72:fd:65:43:08:15:59:44:bd:ad:4e:00:54:f3:7e:57"
      cert_thumbprint     = "ED2BE232B85F1048839C45CD2B7F885F7E2D0B2F"
      cert_valid_from     = "2025-04-14"
      cert_valid_to       = "2026-04-13"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "3254547-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "72:fd:65:43:08:15:59:44:bd:ad:4e:00:54:f3:7e:57"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_SSL_com_7A2A5D0296453B1D8FFF99EB0E59D344 {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-12"
      version             = "1.0"

      hash                = "00848302a30a81a8d4101d5ac28250e09ecfed315510b6c78a99d158676b12c1"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Pinkou (SH) Culture Communication Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:2a:5d:02:96:45:3b:1d:8f:ff:99:eb:0e:59:d3:44"
      cert_thumbprint     = "A918B378A3559D19C9D9400FF8441EB86990D309"
      cert_valid_from     = "2024-03-12"
      cert_valid_to       = "2025-03-11"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310115MA1H8Y2K79"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:2a:5d:02:96:45:3b:1d:8f:ff:99:eb:0e:59:d3:44"
      )
}

rule MAL_Compromised_Cert_Rhadamanthys_Sectigo_008A9959F536A0036F49A2143317562D3F {
   meta:
      description         = "Detects Rhadamanthys with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-24"
      version             = "1.0"

      hash                = "5ffb8425cda8783801a4898b6d6db1f8398962af554b1371021d372e2358039b"
      malware             = "Rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Redstrikevn Company Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:8a:99:59:f5:36:a0:03:6f:49:a2:14:33:17:56:2d:3f"
      cert_thumbprint     = "4D36C5325245186319D22BB933EE4C9289FAC559"
      cert_valid_from     = "2025-01-24"
      cert_valid_to       = "2026-01-16"

      country             = "VN"
      state               = "Ho Chi Minh"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "0318798119"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:8a:99:59:f5:36:a0:03:6f:49:a2:14:33:17:56:2d:3f"
      )
}

rule MAL_Compromised_Cert_RomCom_DigiCert_071D4C6EB644BCF348FA54890038C4F2 {
   meta:
      description         = "Detects RomCom with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-07"
      version             = "1.0"

      hash                = "0cae3b04919050963b4413a43d10fcd7ea4b3f332234ee6c65dcceee7a0833e5"
      malware             = "RomCom"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "XRYUS TECHNOLOGIES CORPORATION"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "07:1d:4c:6e:b6:44:bc:f3:48:fa:54:89:00:38:c4:f2"
      cert_thumbprint     = "53F8A124BFCF5A42924272F25854D26E82D21C37"
      cert_valid_from     = "2025-04-07"
      cert_valid_to       = "2027-04-07"

      country             = "JP"
      state               = "Tokyo"
      locality            = "Minato-ku"
      email               = "???"
      rdn_serial_number   = "2900-01-095356"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "07:1d:4c:6e:b6:44:bc:f3:48:fa:54:89:00:38:c4:f2"
      )
}

rule MAL_Compromised_Cert_RomCom_GlobalSign_2B36039344664935BC7DB613 {
   meta:
      description         = "Detects RomCom with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-11"
      version             = "1.0"

      hash                = "d99788669cdc088c8935d64961332d5ad5cfee4fd71ff1f2115078f4340a6a99"
      malware             = "RomCom"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "APPRAISAL PHARMACEUTICALS (OPC) PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2b:36:03:93:44:66:49:35:bc:7d:b6:13"
      cert_thumbprint     = "5238C4815C13F9D26AD6FA46AEC6CC55671CB16E"
      cert_valid_from     = "2025-02-11"
      cert_valid_to       = "2026-02-12"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "jonathanfowler47@gmail.com"
      rdn_serial_number   = "U24232RJ2014OPC046207"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2b:36:03:93:44:66:49:35:bc:7d:b6:13"
      )
}

rule MAL_Compromised_Cert_RomCom_GlobalSign_4A7325EC71926414AC77540D {
   meta:
      description         = "Detects RomCom with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-22"
      version             = "1.0"

      hash                = "3c8b7034c015aed1c0c1d287dc5a8fe3871fa5def570f4cef43e1411de864e86"
      malware             = "RomCom"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangzhou VW Science and Technology Ltd. Co"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4a:73:25:ec:71:92:64:14:ac:77:54:0d"
      cert_thumbprint     = "24BD135B92A95C0E7F9967F6372BBE4BC99D9F84"
      cert_valid_from     = "2024-11-22"
      cert_valid_to       = "2025-11-23"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101MA59Q6R47Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4a:73:25:ec:71:92:64:14:ac:77:54:0d"
      )
}

rule MAL_Compromised_Cert_RomCom_GlobalSign_657F953C21CEAF3FE145DC95 {
   meta:
      description         = "Detects RomCom with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-20"
      version             = "1.0"

      hash                = "8b683ed0d1cd0139093e21889be077d0e4e50e7adaf638b56e2077df5c6eda4b"
      malware             = "RomCom"
      malware_type        = "Backdoor"
      malware_notes       = "The malware is often disguised as a PDF and will launch an unrelated application when ran. See this for more details: https://www.bridewell.com/insights/blogs/detail/operation-deceptive-prospect-romcom-targeting-uk-organisations-through-customer-feedback-portals"

      signer              = "GMC CONSTRUCTION AND TRADING COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 CodeSigning CA 2020"
      cert_serial         = "65:7f:95:3c:21:ce:af:3f:e1:45:dc:95"
      cert_thumbprint     = "C8CBB1EAAE2FD97FA811ECE21655E2CB96510255"
      cert_valid_from     = "2025-02-20"
      cert_valid_to       = "2026-02-21"

      country             = "VN"
      state               = "Ninh Binh"
      locality            = "Ninh Binh"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 CodeSigning CA 2020" and
         sig.serial == "65:7f:95:3c:21:ce:af:3f:e1:45:dc:95"
      )
}

rule MAL_Compromised_Cert_RomCom_Sectigo_00A05C0D563E8BC37162732DE6E1BFBF5C {
   meta:
      description         = "Detects RomCom with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-20"
      version             = "1.0"

      hash                = "be5327cc54087eceb1c61e09bc5153a811f6b0f13114d4ede45860794fe52c6f"
      malware             = "RomCom"
      malware_type        = "Backdoor"
      malware_notes       = "The malware is often disguised as a PDF and will launch an unrelated application when ran. See this for more details: https://www.bridewell.com/insights/blogs/detail/operation-deceptive-prospect-romcom-targeting-uk-organisations-through-customer-feedback-portals"

      signer              = "Qian'an Chengshuo Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:a0:5c:0d:56:3e:8b:c3:71:62:73:2d:e6:e1:bf:bf:5c"
      cert_thumbprint     = "BC16D3ADAE71054EFD1536BBF1A040D76EC26218"
      cert_valid_from     = "2025-10-20"
      cert_valid_to       = "2026-10-20"

      country             = "CN"
      state               = "Hebei Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:a0:5c:0d:56:3e:8b:c3:71:62:73:2d:e6:e1:bf:bf:5c"
      )
}

rule MAL_Compromised_Cert_RomCom_Sectigo_139BB9E4E70F91743F2A87099507FE92 {
   meta:
      description         = "Detects RomCom with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-14"
      version             = "1.0"

      hash                = "8c2def9d3346a1f96b43c8a915d9585e742351b05a1887b2ec4293712eb64af7"
      malware             = "RomCom"
      malware_type        = "Backdoor"
      malware_notes       = "The malware is often disguised as a PDF and will launch an unrelated application when ran. See this for more details: https://www.bridewell.com/insights/blogs/detail/operation-deceptive-prospect-romcom-targeting-uk-organisations-through-customer-feedback-portals"

      signer              = "Mianyang Zhishuo Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "13:9b:b9:e4:e7:0f:91:74:3f:2a:87:09:95:07:fe:92"
      cert_thumbprint     = "EA27F933184E7F4398166F950C6E9541C332F7EC"
      cert_valid_from     = "2025-11-14"
      cert_valid_to       = "2026-11-14"

      country             = "CN"
      state               = "Sichuan Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "13:9b:b9:e4:e7:0f:91:74:3f:2a:87:09:95:07:fe:92"
      )
}

rule MAL_Compromised_Cert_RoningLoader_Certum_12260D4CCD0095A20C7042FE011E65C2 {
   meta:
      description         = "Detects RoningLoader with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-03"
      version             = "1.0"

      hash                = "2515b546125d20013237aeadec5873e6438ada611347035358059a77a32c54f5"
      malware             = "RoningLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kunming Wuqi E-commerce Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "12:26:0d:4c:cd:00:95:a2:0c:70:42:fe:01:1e:65:c2"
      cert_thumbprint     = "3E5F2C4C90F5283F35568CE15B0F1DBAF1FE146D"
      cert_valid_from     = "2025-02-03"
      cert_valid_to       = "2026-02-03"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangfan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "12:26:0d:4c:cd:00:95:a2:0c:70:42:fe:01:1e:65:c2"
      )
}

rule MAL_Compromised_Cert_RuRAT_GlobalSign_169E403F96ABB9EDC19B6F97 {
   meta:
      description         = "Detects RuRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-16"
      version             = "1.0"

      hash                = "18f25ebdcacc82ab01f4d53151cd575ec1f21cfd2eda5539eb1af9a9dec139ba"
      malware             = "RuRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Netzsh Scientific Instruments TRADING(Shanghai) Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "16:9e:40:3f:96:ab:b9:ed:c1:9b:6f:97"
      cert_thumbprint     = "DCB505B5FDFA36CC1EC4F6E15EAB6B9DA5C6B2B8"
      cert_valid_from     = "2024-08-16"
      cert_valid_to       = "2025-08-17"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "9131011579706617XN"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "16:9e:40:3f:96:ab:b9:ed:c1:9b:6f:97"
      )
}

rule MAL_Compromised_Cert_RuRAT_GlobalSign_4738770035AF376F4700929E {
   meta:
      description         = "Detects RuRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-19"
      version             = "1.0"

      hash                = "3f01b255f64dae77e6bdeaf917fe88c0bad973fbda6e785ccd5bfca9637c6870"
      malware             = "RuRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guang Zhou Uitin Electronic Tech. Ltm Co.,"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:38:77:00:35:af:37:6f:47:00:92:9e"
      cert_thumbprint     = "5AC3640132EE86B9F812FE04A67D05F2A7188F04"
      cert_valid_from     = "2025-03-19"
      cert_valid_to       = "2026-03-20"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440115MA59AMXP30"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:38:77:00:35:af:37:6f:47:00:92:9e"
      )
}

rule MAL_Compromised_Cert_RustyStealer_Certum_1616F14FBA9C87AB97AD25861EE7A9DC {
   meta:
      description         = "Detects RustyStealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-27"
      version             = "1.0"

      hash                = "0b44a1854f9dc2eab5625dffc1ceb17b1e89773c9ee04802a2f40dfd834dec2c"
      malware             = "RustyStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hangzhou Rongyi Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "16:16:f1:4f:ba:9c:87:ab:97:ad:25:86:1e:e7:a9:dc"
      cert_thumbprint     = "DCC865C6DD9EA2318439F207ACBC2AC0797FB51B"
      cert_valid_from     = "2024-09-27"
      cert_valid_to       = "2025-09-27"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "91330185MA280YDY16"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "16:16:f1:4f:ba:9c:87:ab:97:ad:25:86:1e:e7:a9:dc"
      )
}

rule MAL_Compromised_Cert_RustyStealer_GlobalSign_4132BA96E2D9FEEB537DA74C {
   meta:
      description         = "Detects RustyStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-03"
      version             = "1.0"

      hash                = "31a8a2762b42a1fe4be2aed9d112a169f791bd86a85e68d738aea51312096442"
      malware             = "RustyStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FUTURICO LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:32:ba:96:e2:d9:fe:eb:53:7d:a7:4c"
      cert_thumbprint     = "CFF9E5FEE264DD58DBD6A3165322807248D3A1B2"
      cert_valid_from     = "2024-09-03"
      cert_valid_to       = "2025-09-04"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700385536"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:32:ba:96:e2:d9:fe:eb:53:7d:a7:4c"
      )
}

rule MAL_Compromised_Cert_RustyStealer_GlobalSign_6447DE04ACBF7F648E82D18D {
   meta:
      description         = "Detects RustyStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-09"
      version             = "1.0"

      hash                = "41a83781c26f0f875faffbc013fbf74c0c7e6b63dccb194e2f486fb8619dd76c"
      malware             = "RustyStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FUJI FURUKAWA E&C (VIETNAM) CO.,LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:47:de:04:ac:bf:7f:64:8e:82:d1:8d"
      cert_thumbprint     = "05AF075F792DA8DA1A2E6CC72CAA93ED8C533029"
      cert_valid_from     = "2024-10-09"
      cert_valid_to       = "2025-10-10"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "quaysangkk231@gmail.com"
      rdn_serial_number   = "0300569478"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:47:de:04:ac:bf:7f:64:8e:82:d1:8d"
      )
}

rule MAL_Compromised_Cert_Rusty_Stealer_Certum_4AEA2FD2D3DD61D454B29A9035C7443E {
   meta:
      description         = "Detects Rusty Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-30"
      version             = "1.0"

      hash                = "f30c42b1c2db8a07a893df67858f4479c4e4fba80b564a3d03463c73363b0905"
      malware             = "Rusty Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xiamen Huixiantong Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "4a:ea:2f:d2:d3:dd:61:d4:54:b2:9a:90:35:c7:44:3e"
      cert_thumbprint     = "B0D949125202A88EF756E702FF910631B5E1C674"
      cert_valid_from     = "2024-09-30"
      cert_valid_to       = "2025-09-30"

      country             = "CN"
      state               = "Fujian"
      locality            = "Xiamen"
      email               = "???"
      rdn_serial_number   = "91350211MA31JF8419"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "4a:ea:2f:d2:d3:dd:61:d4:54:b2:9a:90:35:c7:44:3e"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_GlobalSign_42A8D0AF488FDE4A8C95A2FC {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-26"
      version             = "1.0"

      hash                = "c7f2c2b2c0f2c6cfad2b8e23c5ab3eea6545c93614491f79ea328e5f3622e3b4"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NOBIS LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "42:a8:d0:af:48:8f:de:4a:8c:95:a2:fc"
      cert_thumbprint     = "7CE89347A41A1DA066EACD8FA06645495F12D973"
      cert_valid_from     = "2025-02-26"
      cert_valid_to       = "2026-02-18"

      country             = "RU"
      state               = "Moscow Oblast"
      locality            = "Vidnoye"
      email               = "???"
      rdn_serial_number   = "1105003003390"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "42:a8:d0:af:48:8f:de:4a:8c:95:a2:fc"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_GlobalSign_65B9DBD2477639223438D313 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-07"
      version             = "1.0"

      hash                = "72679e118a9e644211b44a57b8824ba44e23f977dfd5a00894cd300805b3e20b"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Euro Derma Cosmetics"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:b9:db:d2:47:76:39:22:34:38:d3:13"
      cert_thumbprint     = "B3646CC2569FA997954105804BAF0E7AE9D6FD58"
      cert_valid_from     = "2025-03-07"
      cert_valid_to       = "2026-03-08"

      country             = "KG"
      state               = "Bishkek"
      locality            = "Bishkek"
      email               = "???"
      rdn_serial_number   = "210568-3301-OOO"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:b9:db:d2:47:76:39:22:34:38:d3:13"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_SSL_com_23A573F885C71A52D7A6E3217596CDF9 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-06"
      version             = "1.0"

      hash                = "e8335db8f6d238699304e5d50e5499c84316bf25aaec46ec04be7a7b2bcd6cba"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Brys Software Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "23:a5:73:f8:85:c7:1a:52:d7:a6:e3:21:75:96:cd:f9"
      cert_thumbprint     = "F1E4B850544670D058ADA7A668A614D27B548BF7"
      cert_valid_from     = "2024-09-06"
      cert_valid_to       = "2025-09-06"

      country             = "GB"
      state               = "England"
      locality            = "Gateshead"
      email               = "???"
      rdn_serial_number   = "09335379"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "23:a5:73:f8:85:c7:1a:52:d7:a6:e3:21:75:96:cd:f9"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_SSL_com_2CFCA0AE011D8FAC818AB52E4EB52FD3 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "ad1e0acfc98d0e095abc1ab0c510042f51ea2e50974f517cb178612c2a456acd"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFT POWER SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2c:fc:a0:ae:01:1d:8f:ac:81:8a:b5:2e:4e:b5:2f:d3"
      cert_thumbprint     = "FE9704017678BD4F30A707A3AED4ED9D30410C45"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2026-05-09"

      country             = "PL"
      state               = "dolnośląskie"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2c:fc:a0:ae:01:1d:8f:ac:81:8a:b5:2e:4e:b5:2f:d3"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_SSL_com_43C1C231A7CFD9FA996C53B85EF6BFB4 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-05"
      version             = "1.0"

      hash                = "716a87bcb87a4180d00904072a2c6e8c0e495b66cad88d5002f57b93ac214235"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DIGITAL OUTDOOR SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "43:c1:c2:31:a7:cf:d9:fa:99:6c:53:b8:5e:f6:bf:b4"
      cert_thumbprint     = "9F31E7BA8883A747D660519FCC6FF5202442783C"
      cert_valid_from     = "2025-05-05"
      cert_valid_to       = "2026-05-05"

      country             = "PL"
      state               = "Lesser Poland Voivodeship"
      locality            = "Nowy Targ"
      email               = "???"
      rdn_serial_number   = "0000268851"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "43:c1:c2:31:a7:cf:d9:fa:99:6c:53:b8:5e:f6:bf:b4"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_SSL_com_53ABAB13428612102D8F6C07F39BBE53 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-27"
      version             = "1.0"

      hash                = "b11005923c12dcb5e7f5a84ca99891a4c7e5b4c9080c5de14ffc6c6a42c4fafd"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Finish IT OY"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:ab:ab:13:42:86:12:10:2d:8f:6c:07:f3:9b:be:53"
      cert_thumbprint     = "FDB5194E127D5EEBF64E74CE92317B87A31259BE"
      cert_valid_from     = "2025-03-27"
      cert_valid_to       = "2026-03-27"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "3086529-1"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:ab:ab:13:42:86:12:10:2d:8f:6c:07:f3:9b:be:53"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_SSL_com_54CE1FF00CA796639FBC0556619B3B93 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-24"
      version             = "1.0"

      hash                = "d3650780da767130efa079252782fe5a70d18b702a6c2b7bd643479c750e6ea8"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "QENTRA SOFTWARE LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "54:ce:1f:f0:0c:a7:96:63:9f:bc:05:56:61:9b:3b:93"
      cert_thumbprint     = "FBA9E20D4B3A4777AA086AA2C9483554398CED88"
      cert_valid_from     = "2025-07-24"
      cert_valid_to       = "2026-07-24"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "54:ce:1f:f0:0c:a7:96:63:9f:bc:05:56:61:9b:3b:93"
      )
}

rule MAL_Compromised_Cert_Rusty_Traffer_SSL_com_7F55C2FDE07D9A27B4BFDA0775DD7301 {
   meta:
      description         = "Detects Rusty Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-10"
      version             = "1.0"

      hash                = "928040d5f16f0bdba85d5b16121a99aa03e0547e48ea92b10aa6bb9bc050692e"
      malware             = "Rusty Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FORMTECH MAKER SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7f:55:c2:fd:e0:7d:9a:27:b4:bf:da:07:75:dd:73:01"
      cert_thumbprint     = "8E928A6DA83C2C32EBB92888F592AA385710D3A6"
      cert_valid_from     = "2025-07-10"
      cert_valid_to       = "2026-07-10"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Gniechowice"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7f:55:c2:fd:e0:7d:9a:27:b4:bf:da:07:75:dd:73:01"
      )
}

rule MAL_Compromised_Cert_Ryuk_DigiCert_01CF0B0F01B20B70BFAA69722979EF5C {
   meta:
      description         = "Detects Ryuk with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-12-27"
      version             = "1.0"

      hash                = "a9643eb83d509ad4eac20a2a89d8571f8d781979ad078e89f5b75b4bcb16f65e"
      malware             = "Ryuk"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PET PLUS PTY LTD"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "01:cf:0b:0f:01:b2:0b:70:bf:aa:69:72:29:79:ef:5c"
      cert_thumbprint     = "77FEB93900C2C699441F6117A7B3DE1CF3165074"
      cert_valid_from     = "2019-12-27"
      cert_valid_to       = "2021-01-06"

      country             = "AU"
      state               = "New South Wales"
      locality            = "LANE COVE"
      email               = "???"
      rdn_serial_number   = "000 343 457"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "01:cf:0b:0f:01:b2:0b:70:bf:aa:69:72:29:79:ef:5c"
      )
}

rule MAL_Compromised_Cert_Ryuk_Sectigo_31D852F5FCA1A5966B5ED08A14825C54 {
   meta:
      description         = "Detects Ryuk with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-04"
      version             = "1.0"

      hash                = "05e06709523fd798da963c2c24254de0fcca6c57e1052996798ecc74ff43b41f"
      malware             = "Ryuk"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BBT KLA d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "31:d8:52:f5:fc:a1:a5:96:6b:5e:d0:8a:14:82:5c:54"
      cert_thumbprint     = "A657B8F2EFEA32E6A1D46894764B7A4F82AD0B56"
      cert_valid_from     = "2021-02-04"
      cert_valid_to       = "2022-02-04"

      country             = "SI"
      state               = "???"
      locality            = "Maribor"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "31:d8:52:f5:fc:a1:a5:96:6b:5e:d0:8a:14:82:5c:54"
      )
}

rule MAL_Compromised_Cert_SSH_TUNNEL_SEO_SSL_com_20DFF37F2C4782F05B9A5D98296107AC {
   meta:
      description         = "Detects SSH_TUNNEL_SEO with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-18"
      version             = "1.0"

      hash                = "c16f0bc298ccf19b6b38c8f4741cce81214cc3f0c00e70042ecd98e444bf4675"
      malware             = "SSH_TUNNEL_SEO"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Business Advice & Support LLP"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "20:df:f3:7f:2c:47:82:f0:5b:9a:5d:98:29:61:07:ac"
      cert_thumbprint     = "B972DA26C6ADEF9A4B09F0ADA4C544CC53DA5599"
      cert_valid_from     = "2024-06-18"
      cert_valid_to       = "2025-06-18"

      country             = "GB"
      state               = "England"
      locality            = "Calne"
      email               = "???"
      rdn_serial_number   = "OC429523"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "20:df:f3:7f:2c:47:82:f0:5b:9a:5d:98:29:61:07:ac"
      )
}

rule MAL_Compromised_Cert_SYSTEMBC_SSL_com_23D2CAAE31B75460ACDBD1B42D6E7743 {
   meta:
      description         = "Detects SYSTEMBC with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-15"
      version             = "1.0"

      hash                = "24b6ddd3028c28d0a13da0354333d19cbc8fd12d4351f083c8cb3a93ec3ae793"
      malware             = "SYSTEMBC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guizhou Qi'ang Kangyuan Rosa Roxburghii Development Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "23:d2:ca:ae:31:b7:54:60:ac:db:d1:b4:2d:6e:77:43"
      cert_thumbprint     = "B55DAD8DA97FA6AF0272102ED0E55E76E753FD04"
      cert_valid_from     = "2024-06-15"
      cert_valid_to       = "2025-06-14"

      country             = "CN"
      state               = "Guizhou"
      locality            = "Qiannan Buyi and Miao Autonomous Prefecture"
      email               = "???"
      rdn_serial_number   = "91522730MA6DJY9R40"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "23:d2:ca:ae:31:b7:54:60:ac:db:d1:b4:2d:6e:77:43"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_DigiCert_08FA393DD84ABD186267BF979A4F2690 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-17"
      version             = "1.0"

      hash                = "284958ad33d336ba2560d40126bf2927d1be0533a5ff3638f3ddab16f31c79c8"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NEKO KITTYS LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "08:fa:39:3d:d8:4a:bd:18:62:67:bf:97:9a:4f:26:90"
      cert_thumbprint     = "79BD2E8609049FA9AD6B49B7E9C020C19708E54B"
      cert_valid_from     = "2025-07-17"
      cert_valid_to       = "2026-07-16"

      country             = "US"
      state               = "Wyoming"
      locality            = "Sheridan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "08:fa:39:3d:d8:4a:bd:18:62:67:bf:97:9a:4f:26:90"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_DigiCert_0BDA674CF2E047F94E18FA1DA5356AEA {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-22"
      version             = "1.0"

      hash                = "41849f9995d6ee46154e2b3ad48c64546c14de8e47930819335893c319ea3dab"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Brave Exhibits Inc"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0b:da:67:4c:f2:e0:47:f9:4e:18:fa:1d:a5:35:6a:ea"
      cert_thumbprint     = "1C59C9C28A403EC8B34C469D90C969DB25B423CC"
      cert_valid_from     = "2025-10-22"
      cert_valid_to       = "2026-10-21"

      country             = "US"
      state               = "Colorado"
      locality            = "Denver"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0b:da:67:4c:f2:e0:47:f9:4e:18:fa:1d:a5:35:6a:ea"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_GlobalSign_0DB1B701C9F6B3F37385CD38 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-10"
      version             = "1.0"

      hash                = "c229afdd9825d36095c0e0cbaceb2c052d26230cc8a3d453229c69d83d6cf00f"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HORIZON TAX & ACCOUNTING, L.L.C."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0d:b1:b7:01:c9:f6:b3:f3:73:85:cd:38"
      cert_thumbprint     = "0D20A96C9AF631F16C08163ACF894000E1FD325C"
      cert_valid_from     = "2025-07-10"
      cert_valid_to       = "2026-07-11"

      country             = "US"
      state               = "Arizona"
      locality            = "Phoenix"
      email               = "???"
      rdn_serial_number   = "L13325562"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0d:b1:b7:01:c9:f6:b3:f3:73:85:cd:38"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_GlobalSign_3F639FE6C6390AE939EAA74E {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-21"
      version             = "1.0"

      hash                = "e6a4f2de6f4e37b2a25beeeefb60ecb5af8f204c6d42c46ee885dec38f313d36"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ChasingFire Dream Technologies Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3f:63:9f:e6:c6:39:0a:e9:39:ea:a7:4e"
      cert_thumbprint     = "81E43EF1CC71E144A9C01BCFA88C39126F9995BE"
      cert_valid_from     = "2025-03-21"
      cert_valid_to       = "2026-03-22"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "91420115MA4L020L06"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3f:63:9f:e6:c6:39:0a:e9:39:ea:a7:4e"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_GlobalSign_6BD6A96F96CA98B8AA31A211 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-17"
      version             = "1.0"

      hash                = "cf1f6af7cdcb59ef2f657258818b676b339766570be08891bd67cbdb93e708ca"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Abalini"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6b:d6:a9:6f:96:ca:98:b8:aa:31:a2:11"
      cert_thumbprint     = "2CC0D87D5552CD37A7CB309B3ABE797E52347607"
      cert_valid_from     = "2025-03-17"
      cert_valid_to       = "2026-03-18"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6b:d6:a9:6f:96:ca:98:b8:aa:31:a2:11"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_GoGetSSL_04AE390F73E5981D11D127316F62BD4B {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (GoGetSSL)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-29"
      version             = "1.0"

      hash                = "464b3f10df5c6353b2c84ff3191726de03bcb56642471b0898fb0cb8cffa7fb2"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Johnathan Hunter"
      cert_issuer_short   = "GoGetSSL"
      cert_issuer         = "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1"
      cert_serial         = "04:ae:39:0f:73:e5:98:1d:11:d1:27:31:6f:62:bd:4b"
      cert_thumbprint     = "72D3BF7BAFD1F6FB348179C250657EBBDFD6FBD3"
      cert_valid_from     = "2025-07-29"
      cert_valid_to       = "2026-07-28"

      country             = "US"
      state               = "Louisiana"
      locality            = "Marrero"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1" and
         sig.serial == "04:ae:39:0f:73:e5:98:1d:11:d1:27:31:6f:62:bd:4b"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_SSL_com_087711DDF512753346533330D4E96B11 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "3a594ae541ed9700b27fda06d70f83c5f9a6f048d6f08b735d6fcb4b36e49fa6"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Kamal Hoyte"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "08:77:11:dd:f5:12:75:33:46:53:33:30:d4:e9:6b:11"
      cert_thumbprint     = "996CF92B4B761087A8D8B1A6AC0048B32BCB4B8F"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-10"

      country             = "US"
      state               = "New York"
      locality            = "Freeport"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "08:77:11:dd:f5:12:75:33:46:53:33:30:d4:e9:6b:11"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_SSL_com_0F8DC8622C70E54B356DACB17F17056D {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "1123b5a545aa5b29d529c4259633b314519029802855534b3afb3a14dd90d223"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Luchian Software Consulting, Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0f:8d:c8:62:2c:70:e5:4b:35:6d:ac:b1:7f:17:05:6d"
      cert_thumbprint     = "D594E77231259667D6D20D738BF32B8B1D81AED0"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-07-30"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0f:8d:c8:62:2c:70:e5:4b:35:6d:ac:b1:7f:17:05:6d"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_SSL_com_2E833BA760E021C8C7EE72FA6EE6046F {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-28"
      version             = "1.0"

      hash                = "315cf861344efad52397b22e35fc103a1111508497b49554fcc138646a2a7129"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cx Software Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2e:83:3b:a7:60:e0:21:c8:c7:ee:72:fa:6e:e6:04:6f"
      cert_thumbprint     = "23E5884A1489075C121DBC03BF6C718878109576"
      cert_valid_from     = "2025-05-28"
      cert_valid_to       = "2026-02-04"

      country             = "PL"
      state               = "Województwo wielkopolskie"
      locality            = "Poznań"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2e:83:3b:a7:60:e0:21:c8:c7:ee:72:fa:6e:e6:04:6f"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_SSL_com_5D0F3064FC92CC703EF200CA9C344F56 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-03"
      version             = "1.0"

      hash                = "a8cbffeb05c4d8f9f6d8a091b393c9dfdcd34305bc218588911f98f335116eda"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "jmutanen software Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5d:0f:30:64:fc:92:cc:70:3e:f2:00:ca:9c:34:4f:56"
      cert_thumbprint     = "7B4DC3ABE54BD12C68D053F7CA414006B6AAADE5"
      cert_valid_from     = "2025-03-03"
      cert_valid_to       = "2026-03-03"

      country             = "FI"
      state               = "Central Finland"
      locality            = "Jyväskylä"
      email               = "???"
      rdn_serial_number   = "2728936-9"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5d:0f:30:64:fc:92:cc:70:3e:f2:00:ca:9c:34:4f:56"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_SSL_com_5DA955203B5097CDF48468F2FD76EBA9 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-08"
      version             = "1.0"

      hash                = "a22675c9778b13172e932f28b17647ae80abb4bd95b6f47898a01f2da81ac18e"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Neurogenx LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5d:a9:55:20:3b:50:97:cd:f4:84:68:f2:fd:76:eb:a9"
      cert_thumbprint     = "BD064BAF13517C969B1C939BE7B7A14074B1ACA5"
      cert_valid_from     = "2025-09-08"
      cert_valid_to       = "2026-09-08"

      country             = "US"
      state               = "California"
      locality            = "Sacramento"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5d:a9:55:20:3b:50:97:cd:f4:84:68:f2:fd:76:eb:a9"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_SSL_com_779D697C260E9987B6A6C4121DAC808A {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-05"
      version             = "1.0"

      hash                = "929a13cab29a6bb548e02e836af860a92eba8f9d490e390f49398a967034fb7c"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "VELKA ENGINEERING LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "77:9d:69:7c:26:0e:99:87:b6:a6:c4:12:1d:ac:80:8a"
      cert_thumbprint     = "8031410747D5C91A2A92B45C8FC40C63322A79A0"
      cert_valid_from     = "2024-11-05"
      cert_valid_to       = "2025-11-05"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "C.47693"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "77:9d:69:7c:26:0e:99:87:b6:a6:c4:12:1d:ac:80:8a"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_Sectigo_00D703B2786230CDC702B125CA3C29C593 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-26"
      version             = "1.0"

      hash                = "89ff68d2f4790bc23a3cd8860c9aa5c055ef2d133ae4de62d655ab778774f407"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PANTALACCI ESSINDI EDANG (ESSINDI MICKAEL)"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:d7:03:b2:78:62:30:cd:c7:02:b1:25:ca:3c:29:c5:93"
      cert_thumbprint     = "87AB152DA67F15F7133B104668A71718C3C84DA1"
      cert_valid_from     = "2025-11-26"
      cert_valid_to       = "2026-11-26"

      country             = "FR"
      state               = "Ile-de-France"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "792 801 896"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:d7:03:b2:78:62:30:cd:c7:02:b1:25:ca:3c:29:c5:93"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_Sectigo_4E3DC08BA3B230C5968A4C8B6B1B3C64 {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-09"
      version             = "1.0"

      hash                = "88bcc4eacf3c0dd26c57dfdd42da085eeff0bcc4c1106eceeba466c0a05fc1e5"
      malware             = "ScreenConnectLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CÔNG TY TNHH XB FLOW TECHNOLOGIES"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "4e:3d:c0:8b:a3:b2:30:c5:96:8a:4c:8b:6b:1b:3c:64"
      cert_thumbprint     = "24FEB829E1A0DD9AB71B7EF485CB1F026BCBFE9F"
      cert_valid_from     = "2025-12-09"
      cert_valid_to       = "2027-01-08"

      country             = "VN"
      state               = "Quảng Trị"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "3101145367"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "4e:3d:c0:8b:a3:b2:30:c5:96:8a:4c:8b:6b:1b:3c:64"
      )
}

rule MAL_Compromised_Cert_ScreenConnectLoader_Sectigo_5886E0F4BAA836E9231BA6F8F965E51D {
   meta:
      description         = "Detects ScreenConnectLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-22"
      version             = "1.0"

      hash                = "ddfd45fd76607ba94debe6255019c8ceaaa1417ff3af3ca15cec029cc065750b"
      malware             = "ScreenConnectLoader"
      malware_type        = "Remote access tool"
      malware_notes       = "The malware executes powershell to send information about the infection to Telegram and then drops and executes an installer for ScreenConnect https://tria.ge/251217-nz5dlswqhr/behavioral1"

      signer              = "Taiyuan Tataomi Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "58:86:e0:f4:ba:a8:36:e9:23:1b:a6:f8:f9:65:e5:1d"
      cert_thumbprint     = "A4BD88661CF293FBC29B6648C0EC1AC5FC32DB37"
      cert_valid_from     = "2025-08-22"
      cert_valid_to       = "2026-08-22"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91140105MADC8HF4XN"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "58:86:e0:f4:ba:a8:36:e9:23:1b:a6:f8:f9:65:e5:1d"
      )
}

rule MAL_Compromised_Cert_ScreenConnect_Phishing_GlobalSign_60D16EC97ED649E7E625BAE7 {
   meta:
      description         = "Detects ScreenConnect Phishing with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-04"
      version             = "1.0"

      hash                = "d651a7fd457ea621020c81b58a4b2fb35ddeb7eb06237d31d49314150ad9f88a"
      malware             = "ScreenConnect Phishing"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BUSHMAN AND CERRITO, PLLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:d1:6e:c9:7e:d6:49:e7:e6:25:ba:e7"
      cert_thumbprint     = "B3186D5A2AC2617FAA23C8B0D187649C71FCDAE8"
      cert_valid_from     = "2025-08-04"
      cert_valid_to       = "2026-08-05"

      country             = "US"
      state               = "Michigan"
      locality            = "Farmington Hills"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:d1:6e:c9:7e:d6:49:e7:e6:25:ba:e7"
      )
}

rule MAL_Compromised_Cert_ScreenConnect_Phishing_Verokey_0126669732ACEC9B2FD03AE3C0C4F6D0 {
   meta:
      description         = "Detects ScreenConnect Phishing with compromised cert (Verokey)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-19"
      version             = "1.0"

      hash                = "45d72b8c68d7c80833c08fd87dc11b60b277098df860f1d4f509fb561fa29e32"
      malware             = "ScreenConnect Phishing"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Babaian tech LLC."
      cert_issuer_short   = "Verokey"
      cert_issuer         = "Verokey High Assurance Secure Code EV"
      cert_serial         = "01:26:66:97:32:ac:ec:9b:2f:d0:3a:e3:c0:c4:f6:d0"
      cert_thumbprint     = "A4177F522638026FEDE55003DFC5475F890DF43A"
      cert_valid_from     = "2025-08-19"
      cert_valid_to       = "2026-08-18"

      country             = "US"
      state               = "Delaware"
      locality            = "Dover"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Verokey High Assurance Secure Code EV" and
         sig.serial == "01:26:66:97:32:ac:ec:9b:2f:d0:3a:e3:c0:c4:f6:d0"
      )
}

rule MAL_Compromised_Cert_SearchLoader_Microsoft_3300054397AC0F8252829D630F000000054397 {
   meta:
      description         = "Detects SearchLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-15"
      version             = "1.0"

      hash                = "d67d1628ff5ea924c25c8056446a8143e1171fab7e30dddb24aca3255dad8817"
      malware             = "SearchLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hamilton Vision and Eye Care, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:43:97:ac:0f:82:52:82:9d:63:0f:00:00:00:05:43:97"
      cert_thumbprint     = "6E6737BDAE88C4D9C2F245C38E6D1008BFB166F5"
      cert_valid_from     = "2025-11-15"
      cert_valid_to       = "2025-11-18"

      country             = "US"
      state               = "Alabama"
      locality            = "HAMILTON"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:43:97:ac:0f:82:52:82:9d:63:0f:00:00:00:05:43:97"
      )
}

rule MAL_Compromised_Cert_SearchLoader_Microsoft_33000621BC3C359A50E123AB850000000621BC {
   meta:
      description         = "Detects SearchLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-13"
      version             = "1.0"

      hash                = "cb8053c819c587f3e81b0201d27d686ccdd3ca042cb4c2ed50b84e7f2ee2232f"
      malware             = "SearchLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hamilton Vision and Eye Care, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:21:bc:3c:35:9a:50:e1:23:ab:85:00:00:00:06:21:bc"
      cert_thumbprint     = "40CDBA5439F8E4F5D637EE19754D32E97EEA4EFD"
      cert_valid_from     = "2025-11-13"
      cert_valid_to       = "2025-11-16"

      country             = "US"
      state               = "Alabama"
      locality            = "HAMILTON"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:21:bc:3c:35:9a:50:e1:23:ab:85:00:00:00:06:21:bc"
      )
}

rule MAL_Compromised_Cert_SearchLoader_Microsoft_3300066CC50AEC31F33A55EF36000000066CC5 {
   meta:
      description         = "Detects SearchLoader with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-25"
      version             = "1.0"

      hash                = "98153ac06f5570ee6b94ed63c0eecda41b54e6e36a3a9f33ab466e5b2d421a4a"
      malware             = "SearchLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Linkus Corporation"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:6c:c5:0a:ec:31:f3:3a:55:ef:36:00:00:00:06:6c:c5"
      cert_thumbprint     = "4DFDE1C4FAABBEB26732FD3A967C8977BBCB8A36"
      cert_valid_from     = "2025-11-25"
      cert_valid_to       = "2025-11-28"

      country             = "US"
      state               = "Colorado"
      locality            = "Brighton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:6c:c5:0a:ec:31:f3:3a:55:ef:36:00:00:00:06:6c:c5"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_Certum_024B1DD68B7FA3CE48EF3EAD0D966BAA {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-13"
      version             = "1.0"

      hash                = "28907701949c43559e5dfe1fed791b19bfa9f7009a171945dcd4d4b49f9cddd2"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Beijing Hairun Hongyuan Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "02:4b:1d:d6:8b:7f:a3:ce:48:ef:3e:ad:0d:96:6b:aa"
      cert_thumbprint     = "D439421448315B3813E783F8F9D6FBDFA6CE5A2F"
      cert_valid_from     = "2024-09-13"
      cert_valid_to       = "2025-09-13"

      country             = "CN"
      state               = "Beijing"
      locality            = "Beijing"
      email               = "???"
      rdn_serial_number   = "91110115596071474K"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "02:4b:1d:d6:8b:7f:a3:ce:48:ef:3e:ad:0d:96:6b:aa"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_Certum_225D2E2D7D56B7348DEA176284E1C06D {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-04"
      version             = "1.0"

      hash                = "4f1c363f78622203140d886f70ac33ed626ff870d389be55c5d212f5113a6eaa"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "BVD Software Inc."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "22:5d:2e:2d:7d:56:b7:34:8d:ea:17:62:84:e1:c0:6d"
      cert_thumbprint     = "13B86D9114768942433F2E01896283792CBDB205"
      cert_valid_from     = "2024-07-04"
      cert_valid_to       = "2025-07-04"

      country             = "CA"
      state               = "???"
      locality            = "Richmond Hill"
      email               = "???"
      rdn_serial_number   = "952412-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "22:5d:2e:2d:7d:56:b7:34:8d:ea:17:62:84:e1:c0:6d"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_Certum_529DA3EA8D3FDD03C4BA1ACF5729E0CE {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-17"
      version             = "1.0"

      hash                = "8fa9074cd74cbcedc44b12999dbc5f4e51ea82caa24be18b073686229f1f9db8"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Open Source Developer, Martijn Laan"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "52:9d:a3:ea:8d:3f:dd:03:c4:ba:1a:cf:57:29:e0:ce"
      cert_thumbprint     = "2514B6114FBBD66B24E6D171B428464B903C33D9"
      cert_valid_from     = "2024-04-17"
      cert_valid_to       = "2025-04-17"

      country             = "NL"
      state               = "Noord-Holland"
      locality            = "Aalsmeer"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "52:9d:a3:ea:8d:3f:dd:03:c4:ba:1a:cf:57:29:e0:ce"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_27356F6B781B07D6F52FF68F {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-05"
      version             = "1.0"

      hash                = "4c3f5a22c67195cf75cc79b4351cca3ae91a56e39769874ef22f11fc61834dfd"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "MANH THAO NGUYEN COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "27:35:6f:6b:78:1b:07:d6:f5:2f:f6:8f"
      cert_thumbprint     = "34fcec32f1579ad142b2f456c1c4e13dad9ffd2016500fe9e510c14d3bf50de7"
      cert_valid_from     = "2024-12-05"
      cert_valid_to       = "2025-12-06"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "EleonoraLipseyetu32@gmail.com"
      rdn_serial_number   = "0700863851"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "27:35:6f:6b:78:1b:07:d6:f5:2f:f6:8f"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_31DD1657628844151529CBBD {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-17"
      version             = "1.0"

      hash                = "383af7126e2e28748b4b75c66cc3406933a935931185d37b672a033cb193a26c"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "LLC YUSAL"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "31:dd:16:57:62:88:44:15:15:29:cb:bd"
      cert_thumbprint     = "C54D949A1005756186AA150C94071F3CAA4ECAE9"
      cert_valid_from     = "2025-01-17"
      cert_valid_to       = "2026-01-18"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "ysul569@mail.ru"
      rdn_serial_number   = "1196313074726"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "31:dd:16:57:62:88:44:15:15:29:cb:bd"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_3790CF6A4249C71C54A5D812 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-06"
      version             = "1.0"

      hash                = "d864a359e3a19182e72109fe75408d21b10215938e8be4098c4dbbc8ce0b7c7c"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Hebei Qianyuan Biopharmaceutical Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "37:90:cf:6a:42:49:c7:1c:54:a5:d8:12"
      cert_thumbprint     = "F2EA1DD98D1AF0F9044C24B266475A5C61C6A658"
      cert_valid_from     = "2024-06-06"
      cert_valid_to       = "2025-06-07"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130123MA09YCKA2U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "37:90:cf:6a:42:49:c7:1c:54:a5:d8:12"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_3B17B73A15A48A30DD2EDC71 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-06"
      version             = "1.0"

      hash                = "bcff246f0739ed98f8aa615d256e7e00bc1cb24c8cabaea609b25c3f050c7805"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Brave Pragmatic Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3b:17:b7:3a:15:a4:8a:30:dd:2e:dc:71"
      cert_thumbprint     = "4BDBF5954EDE0FF642960B7A8601D962F6B3D8CD"
      cert_valid_from     = "2024-08-06"
      cert_valid_to       = "2025-08-07"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101MA9URAWW0Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3b:17:b7:3a:15:a4:8a:30:dd:2e:dc:71"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_43EDF2C9F4C308552B60F9D0 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-12"
      version             = "1.0"

      hash                = "a4ef61a4c32010e87894ad322b87d9f24b9b64c20da5b8b53a1545bbcd16e810"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Connect Computing Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "43:ed:f2:c9:f4:c3:08:55:2b:60:f9:d0"
      cert_thumbprint     = "05A5E0424BA80160D6F77760C974A602A56DBCE4"
      cert_valid_from     = "2024-12-12"
      cert_valid_to       = "2025-12-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "1086757-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "43:ed:f2:c9:f4:c3:08:55:2b:60:f9:d0"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_59F9E96B40B905D435FB78C4 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-29"
      version             = "1.0"

      hash                = "dc1975e63bec91355246e3b9376b7915749e5240b17e3741047ab69487fdef07"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "ATOLL LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "59:f9:e9:6b:40:b9:05:d4:35:fb:78:c4"
      cert_thumbprint     = "4E9854568C0EE98C5C70F9E211A0DE2E4A4016A3"
      cert_valid_from     = "2025-01-29"
      cert_valid_to       = "2026-01-30"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700776828"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "59:f9:e9:6b:40:b9:05:d4:35:fb:78:c4"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_GlobalSign_60EE7F8ECC9BF3C102DA3677 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-01"
      version             = "1.0"

      hash                = "645e557e03904aca48c1e0467a94de924a8359b6e5a98354a6e44aa2abeba84a"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "LLC Yusal"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:ee:7f:8e:cc:9b:f3:c1:02:da:36:77"
      cert_thumbprint     = "D7DEC238BE024974778DAA4070394B21A9D40D83"
      cert_valid_from     = "2025-02-01"
      cert_valid_to       = "2026-01-30"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1196313074726"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:ee:7f:8e:cc:9b:f3:c1:02:da:36:77"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_SSL_com_18F563F306288E4EFAEB3077F99F234A {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-07"
      version             = "1.0"

      hash                = "27b1281daa3529ce465df70b5436c5ea3413cd054f4b9ecabbfdf278f1a109b4"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Capsule Software"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "18:f5:63:f3:06:28:8e:4e:fa:eb:30:77:f9:9f:23:4a"
      cert_thumbprint     = "DBD7FA9C157B0440336D479CFEAD517CE2BB6655"
      cert_valid_from     = "2025-01-07"
      cert_valid_to       = "2026-01-07"

      country             = "FR"
      state               = "Occitania"
      locality            = "Montpellier"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "18:f5:63:f3:06:28:8e:4e:fa:eb:30:77:f9:9f:23:4a"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_SSL_com_4C46DCF5B0C4357F05806830DBA932FD {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-18"
      version             = "1.0"

      hash                = "fe40afb158e24c1896776fe3bdef33d2bb85ae67cf7b115f309d2535fc2a6afd"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "TRADE TRUST LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "4c:46:dc:f5:b0:c4:35:7f:05:80:68:30:db:a9:32:fd"
      cert_thumbprint     = "FEA61825376A364886B5236EFCB3EDD1B23E9441"
      cert_valid_from     = "2024-11-18"
      cert_valid_to       = "2025-11-18"

      country             = "UA"
      state               = "???"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "37058412"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "4c:46:dc:f5:b0:c4:35:7f:05:80:68:30:db:a9:32:fd"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_SSL_com_666EABB70B4BFCCA1E0DE0BF3256CB4B {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-07"
      version             = "1.0"

      hash                = "8da2ad369527e360b5d4e3970b9340ba81831dd37f4852a5d8a82bfa03d63886"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Prospere Software Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "66:6e:ab:b7:0b:4b:fc:ca:1e:0d:e0:bf:32:56:cb:4b"
      cert_thumbprint     = "474C70712413735AF91AE7383A1F7FA918229457"
      cert_valid_from     = "2025-01-07"
      cert_valid_to       = "2026-01-07"

      country             = "PL"
      state               = "Podkarpackie Voivodeship"
      locality            = "Rzeszów"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "66:6e:ab:b7:0b:4b:fc:ca:1e:0d:e0:bf:32:56:cb:4b"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_SSL_com_6F80EC3395E1E11086F3349C54447A3F {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-25"
      version             = "1.0"

      hash                = "605573bb6ca5ff1331a45f5250d74f1c620cc7101d7d89a958278065092c6f4a"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Nightmoon Software"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "6f:80:ec:33:95:e1:e1:10:86:f3:34:9c:54:44:7a:3f"
      cert_thumbprint     = "4DE4CB6AD4FB48B3146064B666369F8C33F90C4B"
      cert_valid_from     = "2024-11-25"
      cert_valid_to       = "2025-11-25"

      country             = "FR"
      state               = "Île-de-France"
      locality            = "Paris"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "6f:80:ec:33:95:e1:e1:10:86:f3:34:9c:54:44:7a:3f"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_SSL_com_71F122B17613E367D58FFCD08DEA6AF4 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-20"
      version             = "1.0"

      hash                = "aebfc3d84cf3a4e825aea9e2ea1853e622142223d3b4d66dcd6b753ddce1244a"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Mosak Soft Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "71:f1:22:b1:76:13:e3:67:d5:8f:fc:d0:8d:ea:6a:f4"
      cert_thumbprint     = "320ECD6F82F874CDC0CDD2EAEF8164298E9943F9"
      cert_valid_from     = "2024-08-20"
      cert_valid_to       = "2025-08-20"

      country             = "NZ"
      state               = "Auckland Region"
      locality            = "Auckland"
      email               = "???"
      rdn_serial_number   = "8177681"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "71:f1:22:b1:76:13:e3:67:d5:8f:fc:d0:8d:ea:6a:f4"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_SSL_com_7B6CACE36104A90BFF22224F0AFDB52D {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-03"
      version             = "1.0"

      hash                = "6cb35e6d5e3dc675d2b2fac2e86012d3da4134b213169ef26481c4eb2f90845a"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "Shanghai Cabo Paint Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7b:6c:ac:e3:61:04:a9:0b:ff:22:22:4f:0a:fd:b5:2d"
      cert_thumbprint     = "C7276BCA5CC66922B0C03076FCC62DF4D1E7983D"
      cert_valid_from     = "2024-06-03"
      cert_valid_to       = "2025-06-02"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310115607394704N"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7b:6c:ac:e3:61:04:a9:0b:ff:22:22:4f:0a:fd:b5:2d"
      )
}

rule MAL_Compromised_Cert_SecTopRAT_ArechClient2_Sectigo_6F3442C728DC9E9D63EB5F1EEC64C197 {
   meta:
      description         = "Detects SecTopRAT,ArechClient2 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-04"
      version             = "1.0"

      hash                = "cfa3aa39deeb3f6676492660c22c6e47429f8dc19b39310c526528e960aa5541"
      malware             = "SecTopRAT,ArechClient2"
      malware_type        = "Remote access tool"
      malware_notes       = ""

      signer              = "KusderQounm Venitnet Futurkresl Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "6f:34:42:c7:28:dc:9e:9d:63:eb:5f:1e:ec:64:c1:97"
      cert_thumbprint     = "B52DDB58C551AFEE980F6ADD8F8162BC4E65F837"
      cert_valid_from     = "2024-03-04"
      cert_valid_to       = "2025-03-04"

      country             = "CN"
      state               = "福建省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91350205MA356BHE2L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "6f:34:42:c7:28:dc:9e:9d:63:eb:5f:1e:ec:64:c1:97"
      )
}

rule MAL_Compromised_Cert_ServHelper_Sectigo_44FE73F320AA8B7B4F5CA910AA22333A {
   meta:
      description         = "Detects ServHelper with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-04"
      version             = "1.0"

      hash                = "b436fbb05650df4facc948f49ee619c4825e747c373f2d461d5a1c26b0c7aa15"
      malware             = "ServHelper"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Alpeks LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "44:fe:73:f3:20:aa:8b:7b:4f:5c:a9:10:aa:22:33:3a"
      cert_thumbprint     = "E952EB51416AB15C0A38B64A32348ED40B675043"
      cert_valid_from     = "2021-05-04"
      cert_valid_to       = "2022-05-04"

      country             = "RU"
      state               = "???"
      locality            = "Sankt-Peterburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "44:fe:73:f3:20:aa:8b:7b:4f:5c:a9:10:aa:22:33:3a"
      )
}

rule MAL_Compromised_Cert_Servhelper_Sectigo_00EDE6CFBF9FA18337B0FDB49C1F693020 {
   meta:
      description         = "Detects Servhelper with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-04-11"
      version             = "1.0"

      hash                = "fd2516f5a8dd9eaddac65f4bd8ae4ed6cba9e115ebe88c3f6d2f5e2cdd5e20a6"
      malware             = "Servhelper"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "START ARCHITECTURE LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:ed:e6:cf:bf:9f:a1:83:37:b0:fd:b4:9c:1f:69:30:20"
      cert_thumbprint     = "A99B52E0999990C2EB24D1309DE7D4E522937080"
      cert_valid_from     = "2019-04-11"
      cert_valid_to       = "2020-04-10"

      country             = "GB"
      state               = "WARWICK"
      locality            = "WARWICK"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:ed:e6:cf:bf:9f:a1:83:37:b0:fd:b4:9c:1f:69:30:20"
      )
}

rule MAL_Compromised_Cert_Shadowladder_SSL_com_0E02FA85AB77FE9E40A12927E5994951 {
   meta:
      description         = "Detects Shadowladder with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "591ffe7ef58214b0b82d5d68930d7c0efc68048fb97ac05c069969a6f3b2830e"
      malware             = "Shadowladder"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JVR-Soft Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0e:02:fa:85:ab:77:fe:9e:40:a1:29:27:e5:99:49:51"
      cert_thumbprint     = "7D0830A1C4C3400A18F02DE48F7472B04752075C"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-21"

      country             = "FI"
      state               = "Etelä-Pohjanmaa"
      locality            = "Hyllykallio"
      email               = "???"
      rdn_serial_number   = "1014971-4"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0e:02:fa:85:ab:77:fe:9e:40:a1:29:27:e5:99:49:51"
      )
}

rule MAL_Compromised_Cert_Shiotob_Sectigo_0085E1AF2BE0F380E5A5D11513DDF45FC6 {
   meta:
      description         = "Detects Shiotob with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-01"
      version             = "1.0"

      hash                = "93aa642ec749cc6b093b90d06d9a87843c76d3a8406620c8296a97515ea9954a"
      malware             = "Shiotob"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Makke Digital Works"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:85:e1:af:2b:e0:f3:80:e5:a5:d1:15:13:dd:f4:5f:c6"
      cert_thumbprint     = "D66181CC42B1C9B7A7B480FB5A38CD38ADD04FCF"
      cert_valid_from     = "2020-09-01"
      cert_valid_to       = "2021-09-01"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:85:e1:af:2b:e0:f3:80:e5:a5:d1:15:13:dd:f4:5f:c6"
      )
}

rule MAL_Compromised_Cert_Silence_Sectigo_7D27332C3CB3A382A4FD232C5C66A2 {
   meta:
      description         = "Detects Silence with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-17"
      version             = "1.0"

      hash                = "2d50b03a92445ba53ae147d0b97c494858c86a56fe037c44bc0edabb902420f7"
      malware             = "Silence"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MALVINA RECRUITMENT LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "7d:27:33:2c:3c:b3:a3:82:a4:fd:23:2c:5c:66:a2"
      cert_thumbprint     = "1F37FD71AC5AF2F206B0E995C251A7FDAA0D6E99"
      cert_valid_from     = "2022-06-17"
      cert_valid_to       = "2023-06-17"

      country             = "GB"
      state               = "London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "7d:27:33:2c:3c:b3:a3:82:a4:fd:23:2c:5c:66:a2"
      )
}

rule MAL_Compromised_Cert_SmokedHam_GlobalSign_5C5A8861E945052570898682 {
   meta:
      description         = "Detects SmokedHam with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-07"
      version             = "1.0"

      hash                = "1b7cffb25778e9fd9c6e5f2622e6bd7a05dfd721aef908bcc4b16ccda1a74d23"
      malware             = "SmokedHam"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sinyoo Technology (Wuxi) Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:5a:88:61:e9:45:05:25:70:89:86:82"
      cert_thumbprint     = "C6A2C0667553F13446381D8075AFBE4905031C1B"
      cert_valid_from     = "2025-02-07"
      cert_valid_to       = "2026-02-08"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Wuxi"
      email               = "???"
      rdn_serial_number   = "91320214MA23M0M621"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:5a:88:61:e9:45:05:25:70:89:86:82"
      )
}

rule MAL_Compromised_Cert_SmokedHam_GlobalSign_74E3872F1704AB1FA55B715B {
   meta:
      description         = "Detects SmokedHam with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "cab3047a253eb1bef57d4cc2318ca840b3e40658265609291d98cf42092b2416"
      malware             = "SmokedHam"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai GAIN STARS Trading Company Limited"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "74:e3:87:2f:17:04:ab:1f:a5:5b:71:5b"
      cert_thumbprint     = "0C57941579689D70233E8872BED60C11412903A3"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-18"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310115667837474D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "74:e3:87:2f:17:04:ab:1f:a5:5b:71:5b"
      )
}

rule MAL_Compromised_Cert_SmokedHam_SSL_com_0F491FD7CE3703C5E761665D57C565DB {
   meta:
      description         = "Detects SmokedHam with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-16"
      version             = "1.0"

      hash                = "e9b15ced5ae1cc9f93b91f7e23beff15f2801a475cced0ef826653f3b3a89dcc"
      malware             = "SmokedHam"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "COMPETENT SAFETY SERVICES PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0f:49:1f:d7:ce:37:03:c5:e7:61:66:5d:57:c5:65:db"
      cert_thumbprint     = "D40D44DE02EECF260C11AAF6AB59F5159A9BD308"
      cert_valid_from     = "2025-10-16"
      cert_valid_to       = "2026-10-16"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0f:49:1f:d7:ce:37:03:c5:e7:61:66:5d:57:c5:65:db"
      )
}

rule MAL_Compromised_Cert_SmokedHam_Sectigo_066295A2AC93A8EAB2696CB8798E0C33 {
   meta:
      description         = "Detects SmokedHam with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-15"
      version             = "1.0"

      hash                = "abad3e70da1afa3c8a34ee02e658004e254bc140caf873d6a62d8deeeb9d934d"
      malware             = "SmokedHam"
      malware_type        = "Backdoor"
      malware_notes       = "The malware masquerades as an administrative tool. When executed, it downloads and decrypts additional payloads: https://medium.com/trac-labs/who-ordered-the-smokedham-backdoor-delicacies-in-the-wild-87f51e2e5bd2"

      signer              = "Chengdu Jiameini Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "06:62:95:a2:ac:93:a8:ea:b2:69:6c:b8:79:8e:0c:33"
      cert_thumbprint     = "80AD2ED74647C2E129DCD310B76A613BC4C36E84"
      cert_valid_from     = "2025-10-15"
      cert_valid_to       = "2026-10-15"

      country             = "CN"
      state               = "Sichuan Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "06:62:95:a2:ac:93:a8:ea:b2:69:6c:b8:79:8e:0c:33"
      )
}

rule MAL_Compromised_Cert_SnipBot_GlobalSign_0BC777F88DDF5F3CE479452F {
   meta:
      description         = "Detects SnipBot with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-07"
      version             = "1.0"

      hash                = "0be3116a3edc063283f3693591c388eec67801cdd140a90c4270679e01677501"
      malware             = "SnipBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ARION LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0b:c7:77:f8:8d:df:5f:3c:e4:79:45:2f"
      cert_thumbprint     = "55AA40DEA5621F0C0FBC8B9DD8066FF2290A7E82"
      cert_valid_from     = "2024-05-07"
      cert_valid_to       = "2025-05-08"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "arion.ooo@rambler.ru"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0b:c7:77:f8:8d:df:5f:3c:e4:79:45:2f"
      )
}

rule MAL_Compromised_Cert_SnipBot_GlobalSign_209B10989A2B18672B29C1C8 {
   meta:
      description         = "Detects SnipBot with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-25"
      version             = "1.0"

      hash                = "5b30a5b71ef795e07c91b7a43b3c1113894a82ddffc212a2fa71eebc078f5118"
      malware             = "SnipBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KHAROS LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "20:9b:10:98:9a:2b:18:67:2b:29:c1:c8"
      cert_thumbprint     = "38FAAB8CE29D79CA90AA64179C559F683245D774"
      cert_valid_from     = "2024-01-25"
      cert_valid_to       = "2025-01-25"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "20:9b:10:98:9a:2b:18:67:2b:29:c1:c8"
      )
}

rule MAL_Compromised_Cert_SnipBot_GlobalSign_299B8CD6809BEB7AFE6AA1CE {
   meta:
      description         = "Detects SnipBot with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-15"
      version             = "1.0"

      hash                = "57e59b156a3ff2a3333075baef684f49c63069d296b3b036ced9ed781fd42312"
      malware             = "SnipBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CC Byg og Udlejning ApS"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "29:9b:8c:d6:80:9b:eb:7a:fe:6a:a1:ce"
      cert_thumbprint     = "01CC86D610C1DBA8C070137B54AE0791EF804419"
      cert_valid_from     = "2024-03-15"
      cert_valid_to       = "2025-03-16"

      country             = "DK"
      state               = "Aalborg"
      locality            = "Vodskov"
      email               = "anders.lykke@ccbu.dk"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "29:9b:8c:d6:80:9b:eb:7a:fe:6a:a1:ce"
      )
}

rule MAL_Compromised_Cert_SnipBot_GlobalSign_3B0E3879266F3BC98225B390 {
   meta:
      description         = "Detects SnipBot with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-02"
      version             = "1.0"

      hash                = "5c71601717bed14da74980ad554ad35d751691b2510653223c699e1f006195b8"
      malware             = "SnipBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hangzhou Yueju Apparel Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3b:0e:38:79:26:6f:3b:c9:82:25:b3:90"
      cert_thumbprint     = "2EAB64A4EAF37060D27620A822DF2E1F18AC28F6"
      cert_valid_from     = "2024-04-02"
      cert_valid_to       = "2025-04-03"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3b:0e:38:79:26:6f:3b:c9:82:25:b3:90"
      )
}

rule MAL_Compromised_Cert_SnipBot_GlobalSign_691ED2236CCA78D180F29DFD {
   meta:
      description         = "Detects SnipBot with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-06"
      version             = "1.0"

      hash                = "cfb1e3cc05d575b86db6c85267a52d8f1e6785b106797319a72dd6d19b4dc317"
      malware             = "SnipBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "COSMART LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "69:1e:d2:23:6c:ca:78:d1:80:f2:9d:fd"
      cert_thumbprint     = "8c8a043f51bb8d59182fb268c0db2f1b9d876dbe"
      cert_valid_from     = "2023-12-06"
      cert_valid_to       = "2024-11-07"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "69:1e:d2:23:6c:ca:78:d1:80:f2:9d:fd"
      )
}

rule MAL_Compromised_Cert_Socks5systemz_SSL_com_4E2CE404AEF344EBB3B87654F2C98422 {
   meta:
      description         = "Detects Socks5systemz with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-14"
      version             = "1.0"

      hash                = "22aee22dda57ee1891a90019d4e84a173c73dcdc12f74d0064c6439fb4f4c81d"
      malware             = "Socks5systemz"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Max Biotech Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4e:2c:e4:04:ae:f3:44:eb:b3:b8:76:54:f2:c9:84:22"
      cert_thumbprint     = "5A6D836E89DE99ADEF95667B3A921B7DA044B3F8"
      cert_valid_from     = "2024-03-14"
      cert_valid_to       = "2025-03-14"

      country             = "GB"
      state               = "???"
      locality            = "Caterham"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4e:2c:e4:04:ae:f3:44:eb:b3:b8:76:54:f2:c9:84:22"
      )
}

rule MAL_Compromised_Cert_Sodinokibi_Sectigo_08D4DC90047B8470CCAF3924DFBD8B5F {
   meta:
      description         = "Detects Sodinokibi with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-23"
      version             = "1.0"

      hash                = "0496ca57e387b10dfdac809de8a4e039f68e8d66535d5d19ec76d39f7d0a4402"
      malware             = "Sodinokibi"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OOO Dibies"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "08:d4:dc:90:04:7b:84:70:cc:af:39:24:df:bd:8b:5f"
      cert_thumbprint     = "FE5AEB5935504D636E95096DDEA1D724CB2C8123"
      cert_valid_from     = "2021-04-23"
      cert_valid_to       = "2022-04-23"

      country             = "RU"
      state               = "???"
      locality            = "St. Petersburg"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "08:d4:dc:90:04:7b:84:70:cc:af:39:24:df:bd:8b:5f"
      )
}

rule MAL_Compromised_Cert_SoftwareCloud_Microsoft_330004352678CC1E8ABD94DB1C000000043526 {
   meta:
      description         = "Detects SoftwareCloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-24"
      version             = "1.0"

      hash                = "14999e35f0c04d70efcaaa0d898f1869021c71ab6663ddce6a5ed38249d0182f"
      malware             = "SoftwareCloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "SOFTWARE DESIGN SERVICES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:04:35:26:78:cc:1e:8a:bd:94:db:1c:00:00:00:04:35:26"
      cert_thumbprint     = "646A384DBF8099E728C71A98DA4D845679A139F5"
      cert_valid_from     = "2025-06-24"
      cert_valid_to       = "2025-06-27"

      country             = "US"
      state               = "New York"
      locality            = "Wallkill"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:04:35:26:78:cc:1e:8a:bd:94:db:1c:00:00:00:04:35:26"
      )
}

rule MAL_Compromised_Cert_SoftwareCloud_V2_GlobalSign_24CFDFAC551B761D796E6F40 {
   meta:
      description         = "Detects SoftwareCloud V2 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-29"
      version             = "1.0"

      hash                = "5626a3ac004ec2b1e075fa74e25188d7e30438b089b79bf93774fa1a3dd1dbfe"
      malware             = "SoftwareCloud V2"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "VRIKSH ADVISORS PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "24:cf:df:ac:55:1b:76:1d:79:6e:6f:40"
      cert_thumbprint     = "D14CF121D80F13CBADB623EC419510D1691C5102"
      cert_valid_from     = "2025-07-29"
      cert_valid_to       = "2026-07-30"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "aashish.vrikshadvisors@gmail.com"
      rdn_serial_number   = "U74120DL2008PTC181602"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "24:cf:df:ac:55:1b:76:1d:79:6e:6f:40"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330002AF381AAD80145EB45EE000000002AF38 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-01"
      version             = "1.0"

      hash                = "8bbef77fe39bd8c943243e13d92f30e1b65f01b57902473af53a5621bd7df029"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "El Web Development Ltd"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:02:af:38:1a:ad:80:14:5e:b4:5e:e0:00:00:00:02:af:38"
      cert_thumbprint     = "ABCF0879BFB55D10A5620A39B15A219FD937B6C1"
      cert_valid_from     = "2025-05-01"
      cert_valid_to       = "2025-05-04"

      country             = "GB"
      state               = "???"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:02:af:38:1a:ad:80:14:5e:b4:5e:e0:00:00:00:02:af:38"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330002DF7595879A9999F2306B00000002DF75 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-14"
      version             = "1.0"

      hash                = "7768c7a632653d7c4cdf98db18a342536f046f20ed96259c59bdbdcd77fc8b53"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Mayra Software, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:02:df:75:95:87:9a:99:99:f2:30:6b:00:00:00:02:df:75"
      cert_thumbprint     = "D3E0744037E0D39D4F425A2E703B3DA1162928C1"
      cert_valid_from     = "2025-05-14"
      cert_valid_to       = "2025-05-17"

      country             = "US"
      state               = "Missouri"
      locality            = "Saint Charles"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:02:df:75:95:87:9a:99:99:f2:30:6b:00:00:00:02:df:75"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330002E0A058BFA02E8C1B09A900000002E0A0 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-13"
      version             = "1.0"

      hash                = "9794fc55b2fc94fed0ae3ab774c5bffec4ef4a477e670d598e3323d5df116ffc"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Mayra Software, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:e0:a0:58:bf:a0:2e:8c:1b:09:a9:00:00:00:02:e0:a0"
      cert_thumbprint     = "F539B4E7AA9486EDF160F4ED15C3D77B67283DCE"
      cert_valid_from     = "2025-05-13"
      cert_valid_to       = "2025-05-16"

      country             = "US"
      state               = "Missouri"
      locality            = "Saint Charles"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:e0:a0:58:bf:a0:2e:8c:1b:09:a9:00:00:00:02:e0:a0"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330002E6C11CDD113F485DE83C00000002E6C1 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-15"
      version             = "1.0"

      hash                = "b724dba5af1f13d3d01cdae83f75946153ca18f5d7da16ec97070d3a6bd4b9f8"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Mayra Software, LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:e6:c1:1c:dd:11:3f:48:5d:e8:3c:00:00:00:02:e6:c1"
      cert_thumbprint     = "E2E5893AE8851B62B517882D9C6886947819F7DC"
      cert_valid_from     = "2025-05-15"
      cert_valid_to       = "2025-05-18"

      country             = "US"
      state               = "Missouri"
      locality            = "Saint Charles"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:e6:c1:1c:dd:11:3f:48:5d:e8:3c:00:00:00:02:e6:c1"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330002E8E08097DA774663EF6900000002E8E0 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-17"
      version             = "1.0"

      hash                = "1dbfa2c095b27207fe912398f53f06a3f72b904b3f89bda93fe6e316da6414c5"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:02:e8:e0:80:97:da:77:46:63:ef:69:00:00:00:02:e8:e0"
      cert_thumbprint     = "A3A4B968B73B9554FAA235AE727B5A4A9CB243C3"
      cert_valid_from     = "2025-05-17"
      cert_valid_to       = "2025-05-20"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:02:e8:e0:80:97:da:77:46:63:ef:69:00:00:00:02:e8:e0"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330002F0241B84F150B7CB168E00000002F024 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-18"
      version             = "1.0"

      hash                = "2c8530fdece9bd09453fbdd189823aa6fcdf0b23496ac6950fbdf95e41ea444b"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:f0:24:1b:84:f1:50:b7:cb:16:8e:00:00:00:02:f0:24"
      cert_thumbprint     = "BEC9ED54C1BA4A5D5E9A50DD084B57D342E0A2E9"
      cert_valid_from     = "2025-05-18"
      cert_valid_to       = "2025-05-21"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:f0:24:1b:84:f1:50:b7:cb:16:8e:00:00:00:02:f0:24"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330003058784DB376DA2248929000000030587 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-29"
      version             = "1.0"

      hash                = "2a175377b452d24abc1c0483bdf98ea6a44e0420db40a797bbd5f6599505c6aa"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:05:87:84:db:37:6d:a2:24:89:29:00:00:00:03:05:87"
      cert_thumbprint     = "22A121FFD35765085BE0B38029407B942F0F285A"
      cert_valid_from     = "2025-05-29"
      cert_valid_to       = "2025-06-01"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:05:87:84:db:37:6d:a2:24:89:29:00:00:00:03:05:87"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_3300031611E4BA9F20E932640D000000031611 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-02"
      version             = "1.0"

      hash                = "bc7f2575b0029107f170d24e21750dd1edc31b763bd0721d2b36a0b7c61dfc51"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:16:11:e4:ba:9f:20:e9:32:64:0d:00:00:00:03:16:11"
      cert_thumbprint     = "1CF1C847ECAEF7982EB5CB639AA96CB78B14ACF6"
      cert_valid_from     = "2025-06-02"
      cert_valid_to       = "2025-06-05"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:16:11:e4:ba:9f:20:e9:32:64:0d:00:00:00:03:16:11"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_3300031D13E2A2EDDA7B811D4C000000031D13 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-05"
      version             = "1.0"

      hash                = "6d0a738e24d53927a2070930222aaedec619f3ef22691d2fc37253a7163a45c7"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:1d:13:e2:a2:ed:da:7b:81:1d:4c:00:00:00:03:1d:13"
      cert_thumbprint     = "63EDBFA95EFBC778D67408868A356AEE46D5227A"
      cert_valid_from     = "2025-06-05"
      cert_valid_to       = "2025-06-08"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:1d:13:e2:a2:ed:da:7b:81:1d:4c:00:00:00:03:1d:13"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_33000325820F4C14B2DEEC01B4000000032582 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-06"
      version             = "1.0"

      hash                = "2ef83dbf97a533ff27e32dd81471db5e9f0a8c2910f1854c161e22aa8d9a7722"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:25:82:0f:4c:14:b2:de:ec:01:b4:00:00:00:03:25:82"
      cert_thumbprint     = "BD1B8C5029BEA29EB58A22190D6181CED9A31114"
      cert_valid_from     = "2025-06-06"
      cert_valid_to       = "2025-06-09"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:25:82:0f:4c:14:b2:de:ec:01:b4:00:00:00:03:25:82"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_3300034A34A1F69D8624B367CE000000034A34 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "06a09302c3d5e0ec99a94c13b05a599b5042a6a37e2c28cb7b44921bbed63af7"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "FRONTERA SOFTWARE LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:4a:34:a1:f6:9d:86:24:b3:67:ce:00:00:00:03:4a:34"
      cert_thumbprint     = "F89A5B8C8803AD685D2693B69119563BC909ACD3"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2025-06-15"

      country             = "US"
      state               = "New York"
      locality            = "BROOKLYN"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:4a:34:a1:f6:9d:86:24:b3:67:ce:00:00:00:03:4a:34"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_3300039A19B6113A899F2279F7000000039A19 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-16"
      version             = "1.0"

      hash                = "9216137b680651f7780e26151cf0925177f1553248a7f886d9a62c3e29e6c1ce"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "CASCO ASSOCIATES, INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:03:9a:19:b6:11:3a:89:9f:22:79:f7:00:00:00:03:9a:19"
      cert_thumbprint     = "06A9B0919F86A26C35B84C05613DF6F2CAEEF92E"
      cert_valid_from     = "2025-07-16"
      cert_valid_to       = "2025-07-19"

      country             = "US"
      state               = "New York"
      locality            = "Manhasset"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:03:9a:19:b6:11:3a:89:9f:22:79:f7:00:00:00:03:9a:19"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330003C4CB7D52A9E30D0FC9D900000003C4CB {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-22"
      version             = "1.0"

      hash                = "8684805bfce8298df37e3dcc8ec001b4480e3d4e64e19535e8bc1f8796e27d9c"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:03:c4:cb:7d:52:a9:e3:0d:0f:c9:d9:00:00:00:03:c4:cb"
      cert_thumbprint     = "188C609CCDC98D8D8CFBC35A413756C7C2A9DFB7"
      cert_valid_from     = "2025-05-22"
      cert_valid_to       = "2025-05-25"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:03:c4:cb:7d:52:a9:e3:0d:0f:c9:d9:00:00:00:03:c4:cb"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330003DCEFA192F3BAF4B80B7600000003DCEF {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-28"
      version             = "1.0"

      hash                = "950cdbcbf7024cc600e5e2023ba21210aae506b89786dd6406359df2e01a33af"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Gaduha Technologies Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:03:dc:ef:a1:92:f3:ba:f4:b8:0b:76:00:00:00:03:dc:ef"
      cert_thumbprint     = "EBE2990928EC847E5D5D0FB006E3D61121CF51FC"
      cert_valid_from     = "2025-05-28"
      cert_valid_to       = "2025-05-31"

      country             = "US"
      state               = "Texas"
      locality            = "Irving"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:03:dc:ef:a1:92:f3:ba:f4:b8:0b:76:00:00:00:03:dc:ef"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_3300040608C6D56BDE7466A0B4000000040608 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-15"
      version             = "1.0"

      hash                = "0750a3fd8946a79ebd9d7279b523383764032185b2e617b932b1d8a8d1f3219c"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "FRONTERA SOFTWARE LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:04:06:08:c6:d5:6b:de:74:66:a0:b4:00:00:00:04:06:08"
      cert_thumbprint     = "3C8E7FABCFC78AEDC996CC605FFB96B64ECF60CB"
      cert_valid_from     = "2025-06-15"
      cert_valid_to       = "2025-06-18"

      country             = "US"
      state               = "New York"
      locality            = "BROOKLYN"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:04:06:08:c6:d5:6b:de:74:66:a0:b4:00:00:00:04:06:08"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_33000422EDF474C1C6875343EE0000000422ED {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "e2509fc3c350814cfd532b412f7483b43ac8c4a08a35c6a83051856fe95f82fc"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "SOFTWARE DESIGN SERVICES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:04:22:ed:f4:74:c1:c6:87:53:43:ee:00:00:00:04:22:ed"
      cert_thumbprint     = "1562A12483EB66D657C5F35A79A25E0D45323B60"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2025-06-28"

      country             = "US"
      state               = "New York"
      locality            = "Wallkill"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:04:22:ed:f4:74:c1:c6:87:53:43:ee:00:00:00:04:22:ed"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_3300042BCCEE9EB937D70838E7000000042BCC {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-23"
      version             = "1.0"

      hash                = "bceb8c72c0430797652796514207685c65a182d8285b76b91d219121e7d7e815"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "SOFTWARE DESIGN SERVICES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:04:2b:cc:ee:9e:b9:37:d7:08:38:e7:00:00:00:04:2b:cc"
      cert_thumbprint     = "C1905C62D0B91E1450BD1A24172B4075184F6525"
      cert_valid_from     = "2025-06-23"
      cert_valid_to       = "2025-06-26"

      country             = "US"
      state               = "New York"
      locality            = "Wallkill"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:04:2b:cc:ee:9e:b9:37:d7:08:38:e7:00:00:00:04:2b:cc"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_Microsoft_330004419D7A2C680ABC8CCA3300000004419D {
   meta:
      description         = "Detects Softwarecloud with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-27"
      version             = "1.0"

      hash                = "6fb166efdc068e50b6cb3b18a23d71f21d334bf1e15818cf218677d6cc49fef0"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "SOFTWARE DESIGN SERVICES LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:04:41:9d:7a:2c:68:0a:bc:8c:ca:33:00:00:00:04:41:9d"
      cert_thumbprint     = "2CD009049167DC70AAB8AD71B834ED60B9202ABB"
      cert_valid_from     = "2025-06-27"
      cert_valid_to       = "2025-06-30"

      country             = "US"
      state               = "New York"
      locality            = "Wallkill"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:04:41:9d:7a:2c:68:0a:bc:8c:ca:33:00:00:00:04:41:9d"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_SSL_com_1846DA228F4D8488025ACB3A9D5E99D8 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "662de27500ad4310febb0d2fa962fe902aa89d1f91215ddf0f694161faa4e174"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "JUST CREATE SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "18:46:da:22:8f:4d:84:88:02:5a:cb:3a:9d:5e:99:d8"
      cert_thumbprint     = "E13C309ED10E0618FD6E7A510E5ECA9262C2B031"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2026-06-03"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "18:46:da:22:8f:4d:84:88:02:5a:cb:3a:9d:5e:99:d8"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_SSL_com_34D3F03F4594AF3324E51BF37535AFE8 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "6ac730c099d7ff078c39fe3147ba51e52c22a9f99a8979c7f013509de732244c"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Callicrates GmbH"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "34:d3:f0:3f:45:94:af:33:24:e5:1b:f3:75:35:af:e8"
      cert_thumbprint     = "22AD904CB0DCE63662E8A2C245C7EFE82893612A"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-21"

      country             = "AT"
      state               = "Vienna"
      locality            = "Vienna"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "34:d3:f0:3f:45:94:af:33:24:e5:1b:f3:75:35:af:e8"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_SSL_com_4F0659FE1BF2E22EDEC456C9794BF440 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-27"
      version             = "1.0"

      hash                = "f80ab5dd208678cbd0c9b1da522fa179cb67cad263ea69e878a62fa97478fcb1"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Chip It Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4f:06:59:fe:1b:f2:e2:2e:de:c4:56:c9:79:4b:f4:40"
      cert_thumbprint     = "017DA1710A71ABF8BA0620F3058CDD745771F4F2"
      cert_valid_from     = "2025-06-27"
      cert_valid_to       = "2026-06-27"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4f:06:59:fe:1b:f2:e2:2e:de:c4:56:c9:79:4b:f4:40"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_SSL_com_677AEFDF767972B5C6F083ADD9B258E9 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-02"
      version             = "1.0"

      hash                = "73b69c8ecc07569617d494171529a8f6259948eeea75e4df986042daa4ca3412"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "Quantum Green Solutions ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "67:7a:ef:df:76:79:72:b5:c6:f0:83:ad:d9:b2:58:e9"
      cert_thumbprint     = "707AB6D991A3011EC1D7761D86C0F79C98832506"
      cert_valid_from     = "2025-07-02"
      cert_valid_to       = "2026-07-02"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Copenhagen"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "67:7a:ef:df:76:79:72:b5:c6:f0:83:ad:d9:b2:58:e9"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_SSL_com_6C897CD96B9ED39CD2D217E14D0F9357 {
   meta:
      description         = "Detects Softwarecloud with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "13d62ccd7bf9244576bbc40674185bc7c126b2665e4ffdb9c8956bf993a332e4"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "IT OFFICE PARK SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6c:89:7c:d9:6b:9e:d3:9c:d2:d2:17:e1:4d:0f:93:57"
      cert_thumbprint     = "CB7D00CEB541D02270E98FECA7B836533D8CB617"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2026-05-09"

      country             = "PL"
      state               = "Lublin Voivodeship"
      locality            = "Lublin"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6c:89:7c:d9:6b:9e:d3:9c:d2:d2:17:e1:4d:0f:93:57"
      )
}

rule MAL_Compromised_Cert_Softwarecloud_SSL_com_700B215E33D4D6E0613324E8DCEFE4FF {
   meta:
      description         = "Detects Softwarecloud with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-10"
      version             = "1.0"

      hash                = "c9a72e7dd2dfe74bec0e37d4cf301ad3141c4adcc2097abf25ca3a156d456e0d"
      malware             = "Softwarecloud"
      malware_type        = "Unknown"
      malware_notes       = "This malware is part of a campaign of inauthentic software. More research is likely needed: https://x.com/andrewdanis/status/1919585650413629680?s=20"

      signer              = "DECISION CONSULTANT SOLUTIONS LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "70:0b:21:5e:33:d4:d6:e0:61:33:24:e8:dc:ef:e4:ff"
      cert_thumbprint     = "E28CE0005497D24BB9FCFDD622AD2A5C6838FE9D"
      cert_valid_from     = "2025-03-10"
      cert_valid_to       = "2026-03-10"

      country             = "GB"
      state               = "???"
      locality            = "Hull"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "70:0b:21:5e:33:d4:d6:e0:61:33:24:e8:dc:ef:e4:ff"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_0291C35AB6F0EC2F79C8F1CE5F37E776 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-08"
      version             = "1.0"

      hash                = "8447b77cc4b708ed9f68d0d71dd79f5e66fe27fedd081dcc1339b6d35c387725"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "OOO Ruvents"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "02:91:c3:5a:b6:f0:ec:2f:79:c8:f1:ce:5f:37:e7:76"
      cert_thumbprint     = "64272B0A1025EF13F3A7806E9A326B8FB7619B17"
      cert_valid_from     = "2021-02-08"
      cert_valid_to       = "2022-02-08"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1147746160320"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "02:91:c3:5a:b6:f0:ec:2f:79:c8:f1:ce:5f:37:e7:76"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_092A8190ED1DEA673F505593BED137D4 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-26"
      version             = "1.0"

      hash                = "bbfae2ab644c8d0f1ba82b01032b1962c43855cc6716193ce872ac16cda166df"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SMARTYUNITI OOO"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "09:2a:81:90:ed:1d:ea:67:3f:50:55:93:be:d1:37:d4"
      cert_thumbprint     = "2C44BA1A57FD7C40785D3CFEA9919C0D50BB50D9"
      cert_valid_from     = "2020-11-26"
      cert_valid_to       = "2021-11-26"

      country             = "RU"
      state               = "St. Petersburg"
      locality            = "St. Petersburg"
      email               = "???"
      rdn_serial_number   = "1147847039383"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "09:2a:81:90:ed:1d:ea:67:3f:50:55:93:be:d1:37:d4"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_22B71B4E1DFFAF027DAD91DE93DD4E00 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-21"
      version             = "1.0"

      hash                = "18aeff0a97dfd33b6f0664f43ecafd18511af559002072f680a4e5929a9c7e4f"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "APPS HORIZON"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "22:b7:1b:4e:1d:ff:af:02:7d:ad:91:de:93:dd:4e:00"
      cert_thumbprint     = "08D3A8CE50220C140708317EE89AAF475795A4FB"
      cert_valid_from     = "2022-09-21"
      cert_valid_to       = "2023-09-21"

      country             = "FR"
      state               = "PARIS"
      locality            = "PARIS"
      email               = "???"
      rdn_serial_number   = "824789283"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "22:b7:1b:4e:1d:ff:af:02:7d:ad:91:de:93:dd:4e:00"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_2782171DABF21DBB7C0A155C38BC1FFB {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-06-17"
      version             = "1.0"

      hash                = "5af99cfc85db7d386c951c76581433cf9bf82eafa775daef93d8bde38a5d6afc"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Bauder Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "27:82:17:1d:ab:f2:1d:bb:7c:0a:15:5c:38:bc:1f:fb"
      cert_thumbprint     = "D83F9E57DA1CE7AC1A6EC5BF2AEDCCE1430E8FFC"
      cert_valid_from     = "2021-06-17"
      cert_valid_to       = "2022-06-17"

      country             = "GB"
      state               = "Norfolk"
      locality            = "Norwich"
      email               = "???"
      rdn_serial_number   = "01466215"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "27:82:17:1d:ab:f2:1d:bb:7c:0a:15:5c:38:bc:1f:fb"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_36FF674EB305E99C35565FA301D5C4B0 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-02"
      version             = "1.0"

      hash                = "8e06c31285911c936425921ccf9f20107160174acd602cc7f2dd8ca677e8956d"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "OOO Sistema"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "36:ff:67:4e:b3:05:e9:9c:35:56:5f:a3:01:d5:c4:b0"
      cert_thumbprint     = "C301843CA390AED52C4C6D59EF3D125400F186FB"
      cert_valid_from     = "2020-12-02"
      cert_valid_to       = "2021-12-02"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1127747243062"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "36:ff:67:4e:b3:05:e9:9c:35:56:5f:a3:01:d5:c4:b0"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_3CDBD09436B29CB127FCFB1823EE9A9A {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-02-05"
      version             = "1.0"

      hash                = "28b41fbae3fec855c2f4779dde8d4e990d3e5ceede80a89bcf420a59459d84b8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "FORMICA Solution a.s."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "3c:db:d0:94:36:b2:9c:b1:27:fc:fb:18:23:ee:9a:9a"
      cert_thumbprint     = "CD868D85C7FA7A55C568ECD4B3F835D9D0486266"
      cert_valid_from     = "2021-02-05"
      cert_valid_to       = "2022-02-05"

      country             = "CZ"
      state               = "???"
      locality            = "Čestlice"
      email               = "???"
      rdn_serial_number   = "04668855"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "3c:db:d0:94:36:b2:9c:b1:27:fc:fb:18:23:ee:9a:9a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_5A364C4957D93406F76321C2316F42F0 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-08-24"
      version             = "1.0"

      hash                = "4e7f9e963408d0744d58a933d904996d43aa5f065fe12a6b9cbace6a527932a7"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Board Game Bucket Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5a:36:4c:49:57:d9:34:06:f7:63:21:c2:31:6f:42:f0"
      cert_thumbprint     = "2FB8ED066E8457F2D9A32087339D4C95F3DF7BE8"
      cert_valid_from     = "2022-08-24"
      cert_valid_to       = "2023-08-24"

      country             = "GB"
      state               = "Greater London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "11430692"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5a:36:4c:49:57:d9:34:06:f7:63:21:c2:31:6f:42:f0"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_5EBFBF4B22271CE3E174938BBA664980 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-02"
      version             = "1.0"

      hash                = "b10e90ffd7b0bec744d7de5d65e1c71a213aafae0c9fb897ce97c8496725af2b"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "A13 Software Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5e:bf:bf:4b:22:27:1c:e3:e1:74:93:8b:ba:66:49:80"
      cert_thumbprint     = "93D60434FC41BCB357AA842E9BE5D7ACE8A0B0C7"
      cert_valid_from     = "2022-09-02"
      cert_valid_to       = "2023-09-02"

      country             = "GB"
      state               = "Greater London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "14307326"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5e:bf:bf:4b:22:27:1c:e3:e1:74:93:8b:ba:66:49:80"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_61B237AEF2F478344BB2DFF63A6368A2 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-20"
      version             = "1.0"

      hash                = "5da219f776810a42d8c8e26989f420ece92e87b6279e3bb39dc9627ad0b7f909"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Crowded Out Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "61:b2:37:ae:f2:f4:78:34:4b:b2:df:f6:3a:63:68:a2"
      cert_thumbprint     = "01A98A25CCDF4A7DE975F10801B0AE0099C9138A"
      cert_valid_from     = "2022-09-20"
      cert_valid_to       = "2023-09-20"

      country             = "GB"
      state               = "???"
      locality            = "Hildenborough"
      email               = "???"
      rdn_serial_number   = "11908098"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "61:b2:37:ae:f2:f4:78:34:4b:b2:df:f6:3a:63:68:a2"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_69FDC58EC3C51276598AE539541FE236 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-09-12"
      version             = "1.0"

      hash                = "336e2f4cd131ca8c6ebf87fe23ac876a119992e24b5f84d5bbf7b6fcf5c43a5d"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "DataIntegra s.r.o."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "69:fd:c5:8e:c3:c5:12:76:59:8a:e5:39:54:1f:e2:36"
      cert_thumbprint     = "FFCE9C760C6C7B16F248976F7D5E69AE79AF2DF2"
      cert_valid_from     = "2022-09-12"
      cert_valid_to       = "2023-09-12"

      country             = "SK"
      state               = "Žilinský kraj"
      locality            = "Liptovské Sliače"
      email               = "???"
      rdn_serial_number   = "50270796"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "69:fd:c5:8e:c3:c5:12:76:59:8a:e5:39:54:1f:e2:36"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_6BE642576DDB9D7631CF2DFCE425CC9F {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-12-01"
      version             = "1.0"

      hash                = "2d3dcb25a63f0df5a3033bea79cffce04e748133c3f80722033eb8adccc6d13d"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Cloud Estates London Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "6b:e6:42:57:6d:db:9d:76:31:cf:2d:fc:e4:25:cc:9f"
      cert_thumbprint     = "56D79CEB82432BD6E4EBE56779049DE806A2D3B4"
      cert_valid_from     = "2020-12-01"
      cert_valid_to       = "2021-12-01"

      country             = "GB"
      state               = "London"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "10476674"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "6b:e6:42:57:6d:db:9d:76:31:cf:2d:fc:e4:25:cc:9f"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_6CE7A0C62F27FA98F78853E1AD11173F {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-26"
      version             = "1.0"

      hash                = "e531f0ecc9731fc8ffc22f8bc24d7ef1f09a3d8cff3f1369e0010ea173eb593a"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "D&K ENGINEERING"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing CA SHA2"
      cert_serial         = "6c:e7:a0:c6:2f:27:fa:98:f7:88:53:e1:ad:11:17:3f"
      cert_thumbprint     = "638DC7CD59F1D634C19E4FC2C41B38AE08A1D2E5"
      cert_valid_from     = "2021-05-26"
      cert_valid_to       = "2022-05-26"

      country             = "US"
      state               = "California"
      locality            = "SAN DIEGO"
      email               = "???"
      rdn_serial_number   = "799638700"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing CA SHA2" and
         sig.serial == "6c:e7:a0:c6:2f:27:fa:98:f7:88:53:e1:ad:11:17:3f"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Certum_6E44FCEDD49F22F7A28CECC99104F61A {
   meta:
      description         = "Detects SolarMarker with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-05"
      version             = "1.0"

      hash                = "373b8a34d4dc77de66e36f69cbf2cd2e232b78606092961bc59bfd6a70fbf565"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "M-Trans Maciej Caban"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "6e:44:fc:ed:d4:9f:22:f7:a2:8c:ec:c9:91:04:f6:1a"
      cert_thumbprint     = "C678DCC9D7DA9BDCB75236CB9FA84346AE42704A"
      cert_valid_from     = "2023-01-05"
      cert_valid_to       = "2024-01-05"

      country             = "PL"
      state               = "???"
      locality            = "Skierniewice"
      email               = "???"
      rdn_serial_number   = "389470690"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "6e:44:fc:ed:d4:9f:22:f7:a2:8c:ec:c9:91:04:f6:1a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_029331118B3CBFFD93410BCE02AC3211 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-20"
      version             = "1.0"

      hash                = "add7cdf9d10a61d354f6235cc5b8576208df03afc67df767687092b6cee66df7"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Lunar Industrial Software, Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "02:93:31:11:8b:3c:bf:fd:93:41:0b:ce:02:ac:32:11"
      cert_thumbprint     = "80485F2DC8DA7855DD624C7124F0AD95A0F7EBCB"
      cert_valid_from     = "2022-07-20"
      cert_valid_to       = "2023-07-18"

      country             = "US"
      state               = "Wyoming"
      locality            = "Cheyenne"
      email               = "???"
      rdn_serial_number   = "2008-000555102"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "02:93:31:11:8b:3c:bf:fd:93:41:0b:ce:02:ac:32:11"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_03AD977571E5079C2AD3846D61CE6E54 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-28"
      version             = "1.0"

      hash                = "96512386ea92612cd3c09c377f6a62e1df7a940ce4e46ca5562d75a1017413c9"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Plus 5 XP Corporation"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "03:ad:97:75:71:e5:07:9c:2a:d3:84:6d:61:ce:6e:54"
      cert_thumbprint     = "DA4A8327B3ED583671F7CE38F615482B4B0A5C15"
      cert_valid_from     = "2024-05-28"
      cert_valid_to       = "2025-05-07"

      country             = "CA"
      state               = "Quebec"
      locality            = "Montreal"
      email               = "???"
      rdn_serial_number   = "1083756-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "03:ad:97:75:71:e5:07:9c:2a:d3:84:6d:61:ce:6e:54"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_04926FF6AAC88D45447E23ADC38D34E5 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-10"
      version             = "1.0"

      hash                = "ab7489ecce8cbd41191d4e63e741d679d95bfb77b01a55285abf65f3337918f8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Dynamic Digital Marketing Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "04:92:6f:f6:aa:c8:8d:45:44:7e:23:ad:c3:8d:34:e5"
      cert_thumbprint     = "150776149EEBBEAEA7853F5BED7BE6940A1626CC"
      cert_valid_from     = "2022-03-10"
      cert_valid_to       = "2023-03-17"

      country             = "CA"
      state               = "Ontario"
      locality            = "Gloucester"
      email               = "???"
      rdn_serial_number   = "3277735"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "04:92:6f:f6:aa:c8:8d:45:44:7e:23:ad:c3:8d:34:e5"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_04C57B9205B4533656B302990A86D113 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-27"
      version             = "1.0"

      hash                = "9c699540819d96bfe614049cf31abc8b850bc3f74b19654a06db75fc0ac6db8f"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Tevora Business Solutions, Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Global G3 Code Signing ECC SHA384 2021 CA1"
      cert_serial         = "04:c5:7b:92:05:b4:53:36:56:b3:02:99:0a:86:d1:13"
      cert_thumbprint     = "8D2ACCFDF5149F337C227D2E893DA2151494A692"
      cert_valid_from     = "2022-04-27"
      cert_valid_to       = "2024-03-21"

      country             = "US"
      state               = "California"
      locality            = "Laguna Hills"
      email               = "???"
      rdn_serial_number   = "C2498653"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Global G3 Code Signing ECC SHA384 2021 CA1" and
         sig.serial == "04:c5:7b:92:05:b4:53:36:56:b3:02:99:0a:86:d1:13"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0524906F41BB30C9FEA7C91CECDF5BFA {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-04-19"
      version             = "1.0"

      hash                = "7c213efd427bc3a594a4d794cbb40b63ce8a3e3dc19312011cb7ddbf60811da1"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Snowi Tech Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:24:90:6f:41:bb:30:c9:fe:a7:c9:1c:ec:df:5b:fa"
      cert_thumbprint     = "BCFB608BE12E70321AD6D1360C3EFB8BBD85240E"
      cert_valid_from     = "2022-04-19"
      cert_valid_to       = "2023-04-28"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "1286838-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:24:90:6f:41:bb:30:c9:fe:a7:c9:1c:ec:df:5b:fa"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_055561A0C693BE9239850D8053149DF5 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-19"
      version             = "1.0"

      hash                = "057aa4a06395c384a2a9d29f499b410ac1da6fc2c10aa61908eea3e67a32b872"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "TOV \"SELT MOTO\""
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:55:61:a0:c6:93:be:92:39:85:0d:80:53:14:9d:f5"
      cert_thumbprint     = "9B4FC6429F8FB28ABFF5EF891153E470D2B6F505"
      cert_valid_from     = "2023-04-19"
      cert_valid_to       = "2024-04-18"

      country             = "UA"
      state               = "???"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45073828"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:55:61:a0:c6:93:be:92:39:85:0d:80:53:14:9d:f5"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_055C02563838CEA7452A07111BBA010D {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-28"
      version             = "1.0"

      hash                = "29014a3438c174c2e7377168adf62080e7566e1664c1b639e454a9ad961b5fde"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Verbtronic Digital Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:5c:02:56:38:38:ce:a7:45:2a:07:11:1b:ba:01:0d"
      cert_thumbprint     = "6A5CC3062EF8CB193381E51C34C0467A0F1C9405"
      cert_valid_from     = "2022-05-28"
      cert_valid_to       = "2023-05-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "1247352-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:5c:02:56:38:38:ce:a7:45:2a:07:11:1b:ba:01:0d"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_05634456DBEDB3556CA8415E64815C5D {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-28"
      version             = "1.0"

      hash                = "1d4ab34baa9e5c2cc73ec2788ca8d849befe8c0ef5d8fdd5b7a4bed5de6ebaff"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Walden Intertech Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:63:44:56:db:ed:b3:55:6c:a8:41:5e:64:81:5c:5d"
      cert_thumbprint     = "7352ED799D09FCCA265CF22A3313D4CF2343D7FD"
      cert_valid_from     = "2022-03-28"
      cert_valid_to       = "2023-03-29"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Vancouver"
      email               = "???"
      rdn_serial_number   = "1267304-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:63:44:56:db:ed:b3:55:6c:a8:41:5e:64:81:5c:5d"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_05BB162F6EFE852B7BD4712FD737A61E {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-08-12"
      version             = "1.0"

      hash                = "770658cdc73ef874c0f4daedb014daea71b5c179c1474ecd6d373d89ac45b48c"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Wellpro Impact Solutions Oy"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "05:bb:16:2f:6e:fe:85:2b:7b:d4:71:2f:d7:37:a6:1e"
      cert_thumbprint     = "1D43DDBC621D92B35E3059FC0D4F0CCEAABB51D6"
      cert_valid_from     = "2021-08-12"
      cert_valid_to       = "2022-08-10"

      country             = "FI"
      state               = "???"
      locality            = "Jyväskylä"
      email               = "???"
      rdn_serial_number   = "3227015-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "05:bb:16:2f:6e:fe:85:2b:7b:d4:71:2f:d7:37:a6:1e"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_061051FF2A8AFAB10347A6F1FF08ECB6 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-27"
      version             = "1.0"

      hash                = "1197067d50dd5dd5af12e715e2cc00c0ba1ff738173928bbcfbbad1ee0a52f21"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "TACHOPARTS SP Z O O"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "06:10:51:ff:2a:8a:fa:b1:03:47:a6:f1:ff:08:ec:b6"
      cert_thumbprint     = "8C80793530C12BD6E248E3DF12DB31402B247B5E"
      cert_valid_from     = "2020-11-27"
      cert_valid_to       = "2021-12-01"

      country             = "PL"
      state               = "DOLNOŚLĄSKIE"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "0000654526"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "06:10:51:ff:2a:8a:fa:b1:03:47:a6:f1:ff:08:ec:b6"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0636769AA66BF4317A772F5FE23CE085 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-27"
      version             = "1.0"

      hash                = "f1974ba6905ffb380edf9bad7c799b31c4d3668fd80d87691ca885ee18d551dc"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "IDS-Software Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:36:76:9a:a6:6b:f4:31:7a:77:2f:5f:e2:3c:e0:85"
      cert_thumbprint     = "E0391E2E949896F60EA3CC30FC23AB704C16FFE2"
      cert_valid_from     = "2022-06-27"
      cert_valid_to       = "2023-06-23"

      country             = "IE"
      state               = "???"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "694990"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:36:76:9a:a6:6b:f4:31:7a:77:2f:5f:e2:3c:e0:85"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_06487A92B1D912B79F2291C0D3820F2C {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-10-04"
      version             = "1.0"

      hash                = "a8b1ff391ff0937a12b63d34b6a8326bf5058e0a2ac9ae5306ed8d708f1e6e44"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Soto Manufacturing SRL"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:48:7a:92:b1:d9:12:b7:9f:22:91:c0:d3:82:0f:2c"
      cert_thumbprint     = "AEE8241A17357D5713C451406BA4D3FBDCC1E25F"
      cert_valid_from     = "2021-10-04"
      cert_valid_to       = "2023-08-04"

      country             = "RO"
      state               = "???"
      locality            = "CUGIR"
      email               = "???"
      rdn_serial_number   = "J01/119/2017"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:48:7a:92:b1:d9:12:b7:9f:22:91:c0:d3:82:0f:2c"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_064893F1B9414DCA47F5B83A018D938D {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-08"
      version             = "1.0"

      hash                = "f61f2dc8346f3777b4210ecc84ec55a909666a38796124172317007041a17030"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Stratos Digital Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:48:93:f1:b9:41:4d:ca:47:f5:b8:3a:01:8d:93:8d"
      cert_thumbprint     = "F4A1423AF3BCE54A419E6148E6D1AFD537687932"
      cert_valid_from     = "2021-09-08"
      cert_valid_to       = "2022-09-08"

      country             = "IE"
      state               = "???"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "702708"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:48:93:f1:b9:41:4d:ca:47:f5:b8:3a:01:8d:93:8d"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_065C065ABC9FF9A3C719AD656ABEC485 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-09"
      version             = "1.0"

      hash                = "08e055a874ff5c2dcd27eb973b991fcbcd20d2ab6e3baa183f004f5f22c4f9e8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SijuThomas Consulting Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:5c:06:5a:bc:9f:f9:a3:c7:19:ad:65:6a:be:c4:85"
      cert_thumbprint     = "25248B19256907D8761B890E088C23247009DEB6"
      cert_valid_from     = "2022-06-09"
      cert_valid_to       = "2023-06-01"

      country             = "CA"
      state               = "Ontario"
      locality            = "Brampton"
      email               = "???"
      rdn_serial_number   = "1006125-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:5c:06:5a:bc:9f:f9:a3:c7:19:ad:65:6a:be:c4:85"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_068D0AB0A8356C79919FE07391362873 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-08-15"
      version             = "1.0"

      hash                = "0404db80657a603605b3c0128269a1d7eea2b4e0a17b7a3f48ddc0640248f2c0"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Vespero s. r. o."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:8d:0a:b0:a8:35:6c:79:91:9f:e0:73:91:36:28:73"
      cert_thumbprint     = "F3FA0E4E972FF770E13D9080A8F812AF1D06AA56"
      cert_valid_from     = "2021-08-15"
      cert_valid_to       = "2022-08-13"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "53 957 440"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:8d:0a:b0:a8:35:6c:79:91:9f:e0:73:91:36:28:73"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_06FA27A121CC82230C3013EE634B6C62 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-02-18"
      version             = "1.0"

      hash                = "2f7287a8b0c612801e77de6c2f37e22e0a67579f203a0aaf40095bf6ff70e6ee"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Zimmi Consulting Inc"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "06:fa:27:a1:21:cc:82:23:0c:30:13:ee:63:4b:6c:62"
      cert_thumbprint     = "BA256F3716A5613B2DDA5F2DBD36ABC9AC321583"
      cert_valid_from     = "2022-02-18"
      cert_valid_to       = "2023-02-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "1005078-4"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "06:fa:27:a1:21:cc:82:23:0c:30:13:ee:63:4b:6c:62"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_075D421B06BDB8CF2E01A79D07F094F1 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-17"
      version             = "1.0"

      hash                = "92279e087fea81889e228bf4032ff3765ecfbb9231ffb8e8d63662e22300599b"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Stream Synergy Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "07:5d:42:1b:06:bd:b8:cf:2e:01:a7:9d:07:f0:94:f1"
      cert_thumbprint     = "42E4AC1EA0E50803C152A1E498A847B54B9595DE"
      cert_valid_from     = "2022-05-17"
      cert_valid_to       = "2023-06-06"

      country             = "CA"
      state               = "Ontario"
      locality            = "Markham"
      email               = "???"
      rdn_serial_number   = "1300793-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "07:5d:42:1b:06:bd:b8:cf:2e:01:a7:9d:07:f0:94:f1"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_08063F7043D2981C5A9A8E7769875262 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-22"
      version             = "1.0"

      hash                = "5e2d71794b574e880880b771fd2011f16a5eb1346b731caacdac0d80bfc0c0a1"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Hillcoe Software Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "08:06:3f:70:43:d2:98:1c:5a:9a:8e:77:69:87:52:62"
      cert_thumbprint     = "5E89FADECABA7EB9582F9DFCAC63B3783BD5FC9D"
      cert_valid_from     = "2022-06-22"
      cert_valid_to       = "2023-06-21"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "1204212-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "08:06:3f:70:43:d2:98:1c:5a:9a:8e:77:69:87:52:62"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0839DC3E884FD7B0F441F0A5378ACFC0 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-03"
      version             = "1.0"

      hash                = "b1620fbd2194bc09812c01134b7f60292cfbabd26f1360ecb04c1f66cb2dd4f5"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SN Pelletier Consulting Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "08:39:dc:3e:88:4f:d7:b0:f4:41:f0:a5:37:8a:cf:c0"
      cert_thumbprint     = "B3989A6B973C0DEEDDDC240A58E3E53D71560FD6"
      cert_valid_from     = "2021-09-03"
      cert_valid_to       = "2022-08-24"

      country             = "CA"
      state               = "Quebec"
      locality            = "Marston"
      email               = "???"
      rdn_serial_number   = "1000745-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "08:39:dc:3e:88:4f:d7:b0:f4:41:f0:a5:37:8a:cf:c0"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0883DB137021B51F3A2A08A76A4BC066 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-28"
      version             = "1.0"

      hash                = "11543f09c416237d92090cebbefafdb2f03cec72a6f3fdedf8afe3c315181b5a"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Divertida Creative Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "08:83:db:13:70:21:b5:1f:3a:2a:08:a7:6a:4b:c0:66"
      cert_thumbprint     = "C049731B453AB96F0D81D02392C9FC57257E647D"
      cert_valid_from     = "2021-07-28"
      cert_valid_to       = "2022-07-27"

      country             = "IE"
      state               = "???"
      locality            = "Dublin"
      email               = "???"
      rdn_serial_number   = "700013"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "08:83:db:13:70:21:b5:1f:3a:2a:08:a7:6a:4b:c0:66"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0A54C60487D8384EDCE981814BE767CB {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-10-31"
      version             = "1.0"

      hash                = "0abe73a746671028db3ef2ba3ea8bea059888fc177d76a11e34cd1f075b24b69"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Decapolis Consulting Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0a:54:c6:04:87:d8:38:4e:dc:e9:81:81:4b:e7:67:cb"
      cert_thumbprint     = "BB800B7DE9E457D670303AF12E1940C732CC5975"
      cert_valid_from     = "2021-10-31"
      cert_valid_to       = "2022-10-24"

      country             = "CA"
      state               = "Ontario"
      locality            = "Oakville"
      email               = "???"
      rdn_serial_number   = "1000934-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0a:54:c6:04:87:d8:38:4e:dc:e9:81:81:4b:e7:67:cb"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0B446CBB7D80181261507B59A57D35B8 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-07-08"
      version             = "1.0"

      hash                = "0c8d4cfd455bf5f799b4b4bf748eefc7cabe940363fe55dd71f881f7607c3bf3"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "MD Management SARL"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0b:44:6c:bb:7d:80:18:12:61:50:7b:59:a5:7d:35:b8"
      cert_thumbprint     = "2D0B2B9FABF063AD38810FC1191DBA59EE1E86CE"
      cert_valid_from     = "2021-07-08"
      cert_valid_to       = "2022-07-11"

      country             = "BE"
      state               = "???"
      locality            = "Brussels"
      email               = "???"
      rdn_serial_number   = "0769.336.296"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0b:44:6c:bb:7d:80:18:12:61:50:7b:59:a5:7d:35:b8"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0BE38632E9FB3C60CD21B13DDAE65AAD {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-08"
      version             = "1.0"

      hash                = "9fcdb329122b918110be82e8040386798f1a0c28ad1d103bf06e5df6ec820aca"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Ameri Mode Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0b:e3:86:32:e9:fb:3c:60:cd:21:b1:3d:da:e6:5a:ad"
      cert_thumbprint     = "F6A5A43F2695A978EF786F0A79E759D5C5DC78F0"
      cert_valid_from     = "2024-05-08"
      cert_valid_to       = "2025-05-07"

      country             = "CA"
      state               = "Quebec"
      locality            = "Montreal"
      email               = "???"
      rdn_serial_number   = "780727-9"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0b:e3:86:32:e9:fb:3c:60:cd:21:b1:3d:da:e6:5a:ad"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0C6B875DE4F598244A6D6751ABFBDFBD {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-08-26"
      version             = "1.0"

      hash                = "f268491d2f7e9ab562a239ec56c4b38d669a7bd88181efb0bd89e450c68dd421"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Full Stack s. r. o."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0c:6b:87:5d:e4:f5:98:24:4a:6d:67:51:ab:fb:df:bd"
      cert_thumbprint     = "160A9CF7400D11BEFFD349F47136264EE56B6686"
      cert_valid_from     = "2021-08-26"
      cert_valid_to       = "2022-08-24"

      country             = "SK"
      state               = "???"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "53 958 748"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0c:6b:87:5d:e4:f5:98:24:4a:6d:67:51:ab:fb:df:bd"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0C761FB29DA396BDCCE9850E32EEB8D9 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-02"
      version             = "1.0"

      hash                = "6c59f4f268f1ce1d85cdf9169e81464bb950ec572ea1e3ab9cc4ff4a75589435"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Table Ronde 1155 Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0c:76:1f:b2:9d:a3:96:bd:cc:e9:85:0e:32:ee:b8:d9"
      cert_thumbprint     = "94A71D5BE515AB0F700B2F0DBFFD9175DAFFE450"
      cert_valid_from     = "2024-05-02"
      cert_valid_to       = "2025-05-04"

      country             = "CA"
      state               = "Quebec"
      locality            = "Saint- Laurent"
      email               = "???"
      rdn_serial_number   = "1292530-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0c:76:1f:b2:9d:a3:96:bd:cc:e9:85:0e:32:ee:b8:d9"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0D6D1BA122C0E6586352D55D246D07A0 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-06-10"
      version             = "1.0"

      hash                = "6d1a637ee2263dc7918b886a8a1878fb73a000510bc6f42e0c59669487c46e82"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "G & D Consulting, LLC."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:6d:1b:a1:22:c0:e6:58:63:52:d5:5d:24:6d:07:a0"
      cert_thumbprint     = "5000EC2761F1B555F28482A142B4336A2DE8C36E"
      cert_valid_from     = "2022-06-10"
      cert_valid_to       = "2023-05-10"

      country             = "US"
      state               = "Georgia"
      locality            = "Columbus"
      email               = "???"
      rdn_serial_number   = "18040852"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:6d:1b:a1:22:c0:e6:58:63:52:d5:5d:24:6d:07:a0"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0DD8B5184BF2BD3342498F8AFCF78FD9 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-08-21"
      version             = "1.0"

      hash                = "b3d5baeef9ba35109bd270f5ec27e15cf691217dd591b29ae83ebd07989af947"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Aero IT ApS"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:d8:b5:18:4b:f2:bd:33:42:49:8f:8a:fc:f7:8f:d9"
      cert_thumbprint     = "13F62A113F36D508594FE4ECC4C66B377AF5362B"
      cert_valid_from     = "2021-08-21"
      cert_valid_to       = "2022-08-19"

      country             = "DK"
      state               = "???"
      locality            = "Hørsholm"
      email               = "???"
      rdn_serial_number   = "42586781"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:d8:b5:18:4b:f2:bd:33:42:49:8f:8a:fc:f7:8f:d9"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0E6A6A2DF3B07B2438A0C96EF4413167 {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-04-07"
      version             = "1.0"

      hash                = "e99896598b6c6df29735f4c0f08c99ff49275cba850c81c1249e865b6f4f8ba8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Trinode Software Oy"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "0e:6a:6a:2d:f3:b0:7b:24:38:a0:c9:6e:f4:41:31:67"
      cert_thumbprint     = "89EC5F7D5CC45309E8C0BC4B2038324A6E2F1279"
      cert_valid_from     = "2021-04-07"
      cert_valid_to       = "2022-04-11"

      country             = "FI"
      state               = "???"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "3199637-3"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "0e:6a:6a:2d:f3:b0:7b:24:38:a0:c9:6e:f4:41:31:67"
      )
}

rule MAL_Compromised_Cert_SolarMarker_DigiCert_0E9D7A2348CE1EB34FF6D61A86244DEE {
   meta:
      description         = "Detects SolarMarker with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-03-24"
      version             = "1.0"

      hash                = "2d72b1e256c6b483684ff9268be5318a7294490c7f05a07e025f54a4cadd2f2e"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "BizIncorp Online Limited"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0e:9d:7a:23:48:ce:1e:b3:4f:f6:d6:1a:86:24:4d:ee"
      cert_thumbprint     = "EA451EB228001C7EB52B508534956EA09EA12D3E"
      cert_valid_from     = "2022-03-24"
      cert_valid_to       = "2023-04-07"

      country             = "CA"
      state               = "Alberta"
      locality            = "Edmonton"
      email               = "???"
      rdn_serial_number   = "1281288-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0e:9d:7a:23:48:ce:1e:b3:4f:f6:d6:1a:86:24:4d:ee"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Entrust_192776242ED08D537676143D67B5D23A {
   meta:
      description         = "Detects SolarMarker with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-18"
      version             = "1.0"

      hash                = "5bccb6950b0aad0956ab9a0eb02e503fc613d4744b9f396fdbcb2fd965e69542"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Gurung Solutions Ltd"
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "19:27:76:24:2e:d0:8d:53:76:76:14:3d:67:b5:d2:3a"
      cert_thumbprint     = "F32C6501BAC6AF92DC18B60801B506CB986B2B80"
      cert_valid_from     = "2023-01-18"
      cert_valid_to       = "2024-01-18"

      country             = "GB"
      state               = "???"
      locality            = "Edgware"
      email               = "???"
      rdn_serial_number   = "12359207"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "19:27:76:24:2e:d0:8d:53:76:76:14:3d:67:b5:d2:3a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_0CF35922B751266769123CB9 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-24"
      version             = "1.0"

      hash                = "315d36da6305f267f36216733590babcbcb405c4fc88935d2f3a7bf610cf98fe"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SMART AC VIET NAM TM & DV JOINT STOCK COMPANY"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:f3:59:22:b7:51:26:67:69:12:3c:b9"
      cert_thumbprint     = "C07079D74187CBD6C3462DED3AE9CC57A52B788A"
      cert_valid_from     = "2024-05-24"
      cert_valid_to       = "2025-05-25"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "???"
      rdn_serial_number   = "0110012801"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:f3:59:22:b7:51:26:67:69:12:3c:b9"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_1139DBB02776FA0F0C0DF30B {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-09-04"
      version             = "1.0"

      hash                = "62cc290842868cf7de7c9e75c150ac58acc33e33cd26f12e4fa614408453c549"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ITM LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign Extended Validation CodeSigning CA - SHA256 - G3"
      cert_serial         = "11:39:db:b0:27:76:fa:0f:0c:0d:f3:0b"
      cert_thumbprint     = "215A9C6D7758F1885051BA63BE51127AF7ECAA41"
      cert_valid_from     = "2020-09-04"
      cert_valid_to       = "2021-09-05"

      country             = "RU"
      state               = "Krasnodar Krai"
      locality            = "Krasnodar"
      email               = "???"
      rdn_serial_number   = "1142311001744"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign Extended Validation CodeSigning CA - SHA256 - G3" and
         sig.serial == "11:39:db:b0:27:76:fa:0f:0c:0d:f3:0b"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_11B61750E45083AE450F8EC7 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-11-15"
      version             = "1.0"

      hash                = "be1d635e6325a67ea4cbab84066e56e76a28c7c5ca26abdf466860cf11010e1f"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Jiazhou Education & Consulting Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "11:b6:17:50:e4:50:83:ae:45:0f:8e:c7"
      cert_thumbprint     = "F6149648C93494A65FFD4E8664147E79AAA051E8"
      cert_valid_from     = "2022-11-15"
      cert_valid_to       = "2023-11-10"

      country             = "CA"
      state               = "Ontario"
      locality            = "Waterloo"
      email               = "???"
      rdn_serial_number   = "1005614-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "11:b6:17:50:e4:50:83:ae:45:0f:8e:c7"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_16BA6FBAAF80A4239EB27A18 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-04"
      version             = "1.0"

      hash                = "5abc14737cb65a1e645bd5a2e3301b0e3e1e861a184034a6cc67ce57ee38f448"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SCHPITZE ApS"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "16:ba:6f:ba:af:80:a4:23:9e:b2:7a:18"
      cert_thumbprint     = "99CB34D467DC6EE27E34F23BF9B8404156264F95"
      cert_valid_from     = "2023-10-04"
      cert_valid_to       = "2024-10-04"

      country             = "DK"
      state               = "Gentofte"
      locality            = "Hellerup"
      email               = "thomas.bojsen.schmidt@schpitze.com"
      rdn_serial_number   = "34690804"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "16:ba:6f:ba:af:80:a4:23:9e:b2:7a:18"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_182010E6F30A0FDCC3F1BD44 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-20"
      version             = "1.0"

      hash                = "59b1140b830a98ad213d6e92abd8329d3485cb530143c2ad7cff70362c4c181d"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "LAABAI LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "18:20:10:e6:f3:0a:0f:dc:c3:f1:bd:44"
      cert_thumbprint     = "74B954DACFB6A43782F82C7ED3A2DFA3244E3543"
      cert_valid_from     = "2023-06-20"
      cert_valid_to       = "2024-06-20"

      country             = "GB"
      state               = "Wales"
      locality            = "Bargoed"
      email               = "???"
      rdn_serial_number   = "11455947"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "18:20:10:e6:f3:0a:0f:dc:c3:f1:bd:44"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_1D36C4F439D651503589318F {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-02"
      version             = "1.0"

      hash                = "cce973b40f864284f2226213f1989c45861d89fd62eb0e311e880f5d017e23b2"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "REDWOOD MARKETING SOLUTIONS INC."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1d:36:c4:f4:39:d6:51:50:35:89:31:8f"
      cert_thumbprint     = "78AC9124F9664BEC9D35D80B4F081B42CC0ED487"
      cert_valid_from     = "2022-05-02"
      cert_valid_to       = "2023-05-03"

      country             = "CA"
      state               = "Ontario"
      locality            = "Grimsby"
      email               = "Williams.A@redwood-canada.com"
      rdn_serial_number   = "1005446-1"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1d:36:c4:f4:39:d6:51:50:35:89:31:8f"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_20758F91D61AA738C7D8C03D {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-31"
      version             = "1.0"

      hash                = "e89360d7d77e6979d54dc567cee54ac6128b8ed9250bc3164c5e77c43cd8a647"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "RUBEZH LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "20:75:8f:91:d6:1a:a7:38:c7:d8:c0:3d"
      cert_thumbprint     = "B34163285DB484E5C2FFBFE56D3A08265AA950BC"
      cert_valid_from     = "2023-07-31"
      cert_valid_to       = "2024-07-31"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1237700057946"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "20:75:8f:91:d6:1a:a7:38:c7:d8:c0:3d"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_34D1F82D6B7BAE4075CEEEB7 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-10-27"
      version             = "1.0"

      hash                = "834c6ba26f460e98e9abad308eb261e2f23125d006573ec67b438d62eeabee60"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "JYL Business Solutions Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:d1:f8:2d:6b:7b:ae:40:75:ce:ee:b7"
      cert_thumbprint     = "8D51D068E8EEF6AD1B111DAB77C433451235F052"
      cert_valid_from     = "2022-10-27"
      cert_valid_to       = "2023-10-28"

      country             = "CA"
      state               = "Ontario"
      locality            = "Woodbridge"
      email               = "???"
      rdn_serial_number   = "1007047-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:d1:f8:2d:6b:7b:ae:40:75:ce:ee:b7"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_3FAC2FCD5CDFBDE7E9EF0C51 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-20"
      version             = "1.0"

      hash                = "90a377b69113082ec2789371e02043277fbf8595a6f1f7cd1c6a70493381ab80"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "FASTIDIOUS ACCOUNTANTS LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3f:ac:2f:cd:5c:df:bd:e7:e9:ef:0c:51"
      cert_thumbprint     = "471D77405809AFB4DFBFE9A74FAD917721219957"
      cert_valid_from     = "2023-06-20"
      cert_valid_to       = "2024-06-20"

      country             = "GB"
      state               = "Scotland"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "SC711342"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3f:ac:2f:cd:5c:df:bd:e7:e9:ef:0c:51"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_52F5172C4B2C258F5E33B71C {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-12"
      version             = "1.0"

      hash                = "c6fda8a049ebd7872358acfa2505f226e931e0f71090c19412e7b6d0a1c6e129"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "CHILL ANAESTHESIA LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "52:f5:17:2c:4b:2c:25:8f:5e:33:b7:1c"
      cert_thumbprint     = "02D7035E70CE7BA8E3EB973B32B4C43E8EDA2CC5"
      cert_valid_from     = "2023-07-12"
      cert_valid_to       = "2024-07-12"

      country             = "GB"
      state               = "England"
      locality            = "Bristol"
      email               = "???"
      rdn_serial_number   = "12149989"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "52:f5:17:2c:4b:2c:25:8f:5e:33:b7:1c"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_59BAF421EC167DA76C9ADE31 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-10"
      version             = "1.0"

      hash                = "1160da03685be4abedafa4f03b02cdf3f3242bc1d6985187acf281f5c7e46168"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Repeat Business Ltd"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "59:ba:f4:21:ec:16:7d:a7:6c:9a:de:31"
      cert_thumbprint     = "E04AD07474D36464419F5C94FC0857F267362CAA"
      cert_valid_from     = "2023-07-10"
      cert_valid_to       = "2024-07-10"

      country             = "GB"
      state               = "London"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "14044303"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "59:ba:f4:21:ec:16:7d:a7:6c:9a:de:31"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_65654FEAF83C48513D968826 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-04"
      version             = "1.0"

      hash                = "3e99b59df79d1ab9ff7386e209d9135192661042bcdf44dde85ff4687ff57d01"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "PRIVATE SECURITY ORGANIZATION BARK LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign Extended Validation CodeSigning CA - SHA256 - G3"
      cert_serial         = "65:65:4f:ea:f8:3c:48:51:3d:96:88:26"
      cert_thumbprint     = "3CF8740A9D201C771CAE0D3E975725C8FC66160C"
      cert_valid_from     = "2020-08-04"
      cert_valid_to       = "2021-04-29"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "e.peskova@gepardt.ru"
      rdn_serial_number   = "1167746707138"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign Extended Validation CodeSigning CA - SHA256 - G3" and
         sig.serial == "65:65:4f:ea:f8:3c:48:51:3d:96:88:26"
      )
}

rule MAL_Compromised_Cert_SolarMarker_GlobalSign_6C4ED4D7E425DD681FA71F59 {
   meta:
      description         = "Detects SolarMarker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-24"
      version             = "1.0"

      hash                = "a13278be27e4b0c38d7102496f3d4fcfb31cf710389edee244a4c5dd40055c4f"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "MORYS LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6c:4e:d4:d7:e4:25:dd:68:1f:a7:1f:59"
      cert_thumbprint     = "40F9FBB664B23C52FD766376B48B543E798C3AC5"
      cert_valid_from     = "2023-05-24"
      cert_valid_to       = "2024-05-24"

      country             = "RU"
      state               = "Leningrad Oblast"
      locality            = "Murino"
      email               = "???"
      rdn_serial_number   = "1234700011391"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6c:4e:d4:d7:e4:25:dd:68:1f:a7:1f:59"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_0915E7AD8C2B57E11D65AFC9E497D252 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-11"
      version             = "1.0"

      hash                = "b55b93ec2e7b962840adfacb4e6007c620f6e7fc9a1289825b44b1376a5cc081"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Ветох\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "09:15:e7:ad:8c:2b:57:e1:1d:65:af:c9:e4:97:d2:52"
      cert_thumbprint     = "5B6F1EC184C2421EE80FCA729DF45DB815064A3B"
      cert_valid_from     = "2023-09-11"
      cert_valid_to       = "2024-09-10"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45226750"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "09:15:e7:ad:8c:2b:57:e1:1d:65:af:c9:e4:97:d2:52"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_0EF9DCEF244E302160FEB44B41E24F1F {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-05"
      version             = "1.0"

      hash                = "55da66e72382877954b3d050a9ca5e4daad614d5b0c788e61187184b7352e768"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "TRACK PROJECT SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0e:f9:dc:ef:24:4e:30:21:60:fe:b4:4b:41:e2:4f:1f"
      cert_thumbprint     = "782FDCD807051B0B48E690F2AAC1B6F58A48828A"
      cert_valid_from     = "2024-04-05"
      cert_valid_to       = "2025-04-05"

      country             = "PL"
      state               = "Malopolskie"
      locality            = "Krakow"
      email               = "???"
      rdn_serial_number   = "0000570348"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0e:f9:dc:ef:24:4e:30:21:60:fe:b4:4b:41:e2:4f:1f"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_11BB96AF61D33B7097E13E0C41DCF747 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-24"
      version             = "1.0"

      hash                = "48d7f595d98bbe45cf34f1ba7280a89c27e59de9b17fdfd8bc5d6d1cf817c321"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "D&J BROWN IDIOMAS LTDA"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "11:bb:96:af:61:d3:3b:70:97:e1:3e:0c:41:dc:f7:47"
      cert_thumbprint     = "F524AE15C6FF2D630158E2619930D230CDCFB337"
      cert_valid_from     = "2023-08-24"
      cert_valid_to       = "2024-08-09"

      country             = "BR"
      state               = "São Paulo"
      locality            = "Indaiatuba"
      email               = "???"
      rdn_serial_number   = "40.461.953/0001-71"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "11:bb:96:af:61:d3:3b:70:97:e1:3e:0c:41:dc:f7:47"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_14ECD44C98C3DF27FCC699DC70E32C7A {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-11-02"
      version             = "1.0"

      hash                = "f799e7e81b66cf7d787abc864ed82c3dc5fd2aa95c9f3d24a39c79a3741d37c1"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Daxon Digital Services Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "14:ec:d4:4c:98:c3:df:27:fc:c6:99:dc:70:e3:2c:7a"
      cert_thumbprint     = "84F120783C24B1300ADD782414901503AF2F964A"
      cert_valid_from     = "2022-11-02"
      cert_valid_to       = "2023-10-20"

      country             = "US"
      state               = "Florida"
      locality            = "West Palm Beach"
      email               = "???"
      rdn_serial_number   = "P22000068942"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "14:ec:d4:4c:98:c3:df:27:fc:c6:99:dc:70:e3:2c:7a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_1550D13FAFBA5857AA657751CCFB6BEC {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-09"
      version             = "1.0"

      hash                = "4f349e005eb9cebef10044b3f4aa181ea75cf9c107fb0683931397b2ea06a86d"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "BAAAD KITTY LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:50:d1:3f:af:ba:58:57:aa:65:77:51:cc:fb:6b:ec"
      cert_thumbprint     = "460D117585E29A630CC701BD1DDF091BB7E73722"
      cert_valid_from     = "2023-08-09"
      cert_valid_to       = "2024-08-08"

      country             = "GB"
      state               = "???"
      locality            = "St. Albans"
      email               = "???"
      rdn_serial_number   = "11809951"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:50:d1:3f:af:ba:58:57:aa:65:77:51:cc:fb:6b:ec"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_157EF6D6D74883FE50765D9DA9E11C69 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-07"
      version             = "1.0"

      hash                = "6c89c09213a79a917a97f4531b9ef01da8feee805d2d3b7de92a831dbec9a7e6"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Тотоп\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "15:7e:f6:d6:d7:48:83:fe:50:76:5d:9d:a9:e1:1c:69"
      cert_thumbprint     = "BD6904484A52B6F0779D957C12C0E57B3546BA20"
      cert_valid_from     = "2023-12-07"
      cert_valid_to       = "2024-12-06"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45213322"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "15:7e:f6:d6:d7:48:83:fe:50:76:5d:9d:a9:e1:1c:69"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_19C82A677E106CC31FC9BA4B660CECFB {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-12-14"
      version             = "1.0"

      hash                = "c249477d921abc7aefb41f46c489c215f807a5d9a9aa68c426295304895eaf10"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Gajanan Consulting Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "19:c8:2a:67:7e:10:6c:c3:1f:c9:ba:4b:66:0c:ec:fb"
      cert_thumbprint     = "7D2B6E2904206DA8734E02F34DFFCEB833D934DC"
      cert_valid_from     = "2022-12-14"
      cert_valid_to       = "2023-12-14"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "1008676-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "19:c8:2a:67:7e:10:6c:c3:1f:c9:ba:4b:66:0c:ec:fb"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_1C633276C70754EEE95F71369090E72E {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-16"
      version             = "1.0"

      hash                = "250fe7be536bb8674dd7e0e7c4de2ca1e3311ed657181d950dda6590a3bded51"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Айтипути\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1c:63:32:76:c7:07:54:ee:e9:5f:71:36:90:90:e7:2e"
      cert_thumbprint     = "527F3B9655590D119DA9629CFC408251E185394F"
      cert_valid_from     = "2023-08-16"
      cert_valid_to       = "2024-08-15"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45324891"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1c:63:32:76:c7:07:54:ee:e9:5f:71:36:90:90:e7:2e"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_1F53605ED1F00A604E5FEB198FE3C4CC {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-08"
      version             = "1.0"

      hash                = "8f536b3f85b999cf0a899de83523c8fea56647e6be6880fbbc7856e1cb802902"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "AAA AUTO SERVICES LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1f:53:60:5e:d1:f0:0a:60:4e:5f:eb:19:8f:e3:c4:cc"
      cert_thumbprint     = "B63A2EEFF477EC805D9E784E63827BE5397212D5"
      cert_valid_from     = "2023-09-08"
      cert_valid_to       = "2024-09-07"

      country             = "GB"
      state               = "???"
      locality            = "Chorley"
      email               = "???"
      rdn_serial_number   = "07853928"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1f:53:60:5e:d1:f0:0a:60:4e:5f:eb:19:8f:e3:c4:cc"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_2151496E74F30C019E232B48369F3F1D {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-14"
      version             = "1.0"

      hash                = "4cb0a000097880a2e0a945005f4acba541df8d2ffd7a34afcbd88e404dcbba71"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"ЛефІ\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "21:51:49:6e:74:f3:0c:01:9e:23:2b:48:36:9f:3f:1d"
      cert_thumbprint     = "73FEE151165DFFD1207FCE1B0BD94157EB787A11"
      cert_valid_from     = "2023-11-14"
      cert_valid_to       = "2024-11-13"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45284985"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "21:51:49:6e:74:f3:0c:01:9e:23:2b:48:36:9f:3f:1d"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_2352CE593F487633E8C7C819FABF9C74 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-14"
      version             = "1.0"

      hash                = "e38b838995dfe3df7419264d3a02877fe8239e691b2bcd18b843afe8c7f9961e"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"ТОРГОВИЙ ДІМ КБ СТІЛ\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "23:52:ce:59:3f:48:76:33:e8:c7:c8:19:fa:bf:9c:74"
      cert_thumbprint     = "AC0380618B3ABA28892F886062ADFF1F554C5B1A"
      cert_valid_from     = "2023-08-14"
      cert_valid_to       = "2024-08-13"

      country             = "UA"
      state               = "Дніпропетровська"
      locality            = "Нікополь"
      email               = "???"
      rdn_serial_number   = "44326353"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "23:52:ce:59:3f:48:76:33:e8:c7:c8:19:fa:bf:9c:74"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_235A083100CDC9C67691B31B1E958A0E {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-08-24"
      version             = "1.0"

      hash                = "a2ebd484b939b5c5bd273de83e56e46b56d250e144b6d467e89d1df4a26c4ee8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Databytes Software Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "23:5a:08:31:00:cd:c9:c6:76:91:b3:1b:1e:95:8a:0e"
      cert_thumbprint     = "19617F89E0E4754976A4BAA471B538893B042D40"
      cert_valid_from     = "2022-08-24"
      cert_valid_to       = "2023-08-24"

      country             = "GB"
      state               = "???"
      locality            = "Cookstown"
      email               = "???"
      rdn_serial_number   = "NI653695"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "23:5a:08:31:00:cd:c9:c6:76:91:b3:1b:1e:95:8a:0e"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_27987C7E3C455F499B18AFD03B3CBBDF {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-30"
      version             = "1.0"

      hash                = "ce8c2fc7e49bc791f10b5022a0d353debb620d11b4f7add4c2215771250b34eb"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Блу Сейл Комодіті\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "27:98:7c:7e:3c:45:5f:49:9b:18:af:d0:3b:3c:bb:df"
      cert_thumbprint     = "949F349032F495EC682A1D6A58D892ED9145A2ED"
      cert_valid_from     = "2023-08-30"
      cert_valid_to       = "2024-08-29"

      country             = "UA"
      state               = "???"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "45224266"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "27:98:7c:7e:3c:45:5f:49:9b:18:af:d0:3b:3c:bb:df"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_295C8F66D4D6F2FE513D4800A88A00D2 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-11"
      version             = "1.0"

      hash                = "b68a65e9f8cb6aff77c8d1973e60063de53ca052ee6c98919c96decf5ef705a8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Трейдинг Комфорт\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "29:5c:8f:66:d4:d6:f2:fe:51:3d:48:00:a8:8a:00:d2"
      cert_thumbprint     = "6BDC8E5A1739BFF3F4FD0E866A281823DBED967B"
      cert_valid_from     = "2023-11-11"
      cert_valid_to       = "2024-11-09"

      country             = "UA"
      state               = "Zhytomyr Oblast"
      locality            = "Zhytomyr"
      email               = "???"
      rdn_serial_number   = "45291589"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "29:5c:8f:66:d4:d6:f2:fe:51:3d:48:00:a8:8a:00:d2"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_29B93DF5BD68A809F5C81D223A03C8EF {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-12"
      version             = "1.0"

      hash                = "32e0c3db78cdeaa026b8b9ed9c3e4f599eb5d9cb4184aaacae8ec94a0c1be438"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Чеб\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "29:b9:3d:f5:bd:68:a8:09:f5:c8:1d:22:3a:03:c8:ef"
      cert_thumbprint     = "D593CC3E922DA5C4B9EF4075A9212C0B698046E6"
      cert_valid_from     = "2023-09-12"
      cert_valid_to       = "2024-09-11"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Novomoskovsk Raion"
      email               = "???"
      rdn_serial_number   = "45285135"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "29:b9:3d:f5:bd:68:a8:09:f5:c8:1d:22:3a:03:c8:ef"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_2A17239F25F18AA969D76DEC4722598D {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-18"
      version             = "1.0"

      hash                = "a24bc1178a53b6afb67d802a2adb2ab48a9f203e9c6da756323a3178b0b6d02c"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Гемінг сапорт\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2a:17:23:9f:25:f1:8a:a9:69:d7:6d:ec:47:22:59:8d"
      cert_thumbprint     = "54A87FD5519B87CAEFFF72A1EF8C14E734E733E0"
      cert_valid_from     = "2023-10-18"
      cert_valid_to       = "2024-10-17"

      country             = "UA"
      state               = "Kiev"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "45190735"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2a:17:23:9f:25:f1:8a:a9:69:d7:6d:ec:47:22:59:8d"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_2A57BA9291CC7575CB304870EACDF208 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-09"
      version             = "1.0"

      hash                = "f88a27309d2915e04cd8ccac850db250f214ade9ce0fe38029f0214283ebb5c4"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"локкерс\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2a:57:ba:92:91:cc:75:75:cb:30:48:70:ea:cd:f2:08"
      cert_thumbprint     = "3409E59F9197D8FD48470533D4FC517BAA3DD212"
      cert_valid_from     = "2023-11-09"
      cert_valid_to       = "2024-11-08"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro Raion"
      email               = "???"
      rdn_serial_number   = "45321657"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2a:57:ba:92:91:cc:75:75:cb:30:48:70:ea:cd:f2:08"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_2C18DB497B7FB347A85769E628C4DD00 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-02"
      version             = "1.0"

      hash                = "a75819503eadb1816eee8884801d11ea7e8d1257ead704bca2aea42afe5edada"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Дефи\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2c:18:db:49:7b:7f:b3:47:a8:57:69:e6:28:c4:dd:00"
      cert_thumbprint     = "8F0F2B6D0C3FC9D8B6B978A7B8F74DA8D6F8EE8C"
      cert_valid_from     = "2023-10-02"
      cert_valid_to       = "2024-10-01"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45273271"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2c:18:db:49:7b:7f:b3:47:a8:57:69:e6:28:c4:dd:00"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_4313DE25D720C619AE59B4A612947FE2 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-29"
      version             = "1.0"

      hash                = "0dc32f351d59be068455286148d1c654287e5538e5429d12a014b0a6f9970efd"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SPECIALIST TECHNICIANS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "43:13:de:25:d7:20:c6:19:ae:59:b4:a6:12:94:7f:e2"
      cert_thumbprint     = "A232F94AD3C7FF530E09EB70A4EC9C8C9C0FF1D7"
      cert_valid_from     = "2023-09-29"
      cert_valid_to       = "2024-09-28"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "14518456"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "43:13:de:25:d7:20:c6:19:ae:59:b4:a6:12:94:7f:e2"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_4331B82FB98E900AAFE89579EF607E6E {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-26"
      version             = "1.0"

      hash                = "bd6d8c48c1faad08dc110393275243acb0f5c7c8884d8c6663d2538cced4ad8e"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Bau Yannis GmbH"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "43:31:b8:2f:b9:8e:90:0a:af:e8:95:79:ef:60:7e:6e"
      cert_thumbprint     = "3B44F0365EC584E68579DC3B1C2B0B88FD952CE3"
      cert_valid_from     = "2023-09-26"
      cert_valid_to       = "2024-09-25"

      country             = "CH"
      state               = "Solothurn"
      locality            = "Grenchen"
      email               = "???"
      rdn_serial_number   = "CHE-166.264.872"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "43:31:b8:2f:b9:8e:90:0a:af:e8:95:79:ef:60:7e:6e"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_43D0D946C75986936AE17F987E429BC0 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-16"
      version             = "1.0"

      hash                = "dd2e32461bc4ee417a49566db06f29cf84aef11577c9648f4b3f62ac0edf354e"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Гого\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "43:d0:d9:46:c7:59:86:93:6a:e1:7f:98:7e:42:9b:c0"
      cert_thumbprint     = "66EB1188ED0CDC9308F24CA898C3FF455E3E26F5"
      cert_valid_from     = "2023-10-16"
      cert_valid_to       = "2024-10-15"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45219429"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "43:d0:d9:46:c7:59:86:93:6a:e1:7f:98:7e:42:9b:c0"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_45948EF79A0B586E27414708C0BDDD2A {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-15"
      version             = "1.0"

      hash                = "817debed45f7f3e0e95da4df3476b58ba0dc3ff7552473c66abd94646fddc962"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "R J DATSON LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "45:94:8e:f7:9a:0b:58:6e:27:41:47:08:c0:bd:dd:2a"
      cert_thumbprint     = "7C27F48DEBABD296AF63311503E75866E788A76F"
      cert_valid_from     = "2023-09-15"
      cert_valid_to       = "2024-09-14"

      country             = "GB"
      state               = "???"
      locality            = "Newmarket"
      email               = "???"
      rdn_serial_number   = "08960413"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "45:94:8e:f7:9a:0b:58:6e:27:41:47:08:c0:bd:dd:2a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_46C453AF07ED90364AEF8EB7EA959CFA {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-15"
      version             = "1.0"

      hash                = "4788925332fc6128c895b0e0736a1d7d90e3891f2abb456523cbf0c1ced7d1e2"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Heart Craft Brewery s. r. o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "46:c4:53:af:07:ed:90:36:4a:ef:8e:b7:ea:95:9c:fa"
      cert_thumbprint     = "56ECF072A9C4872B186254B30CEC2469166E4D63"
      cert_valid_from     = "2024-03-15"
      cert_valid_to       = "2025-03-15"

      country             = "SK"
      state               = "Bratislava Region"
      locality            = "Bratislava"
      email               = "???"
      rdn_serial_number   = "51 278 278"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "46:c4:53:af:07:ed:90:36:4a:ef:8e:b7:ea:95:9c:fa"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_4949E243E0DFC150577BFEB9D722C185 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-03"
      version             = "1.0"

      hash                = "a0114420ff98f4f09df676527add4ccaaf4326b4bd0c87b153d1ea71adf50022"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "LAABAI LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "49:49:e2:43:e0:df:c1:50:57:7b:fe:b9:d7:22:c1:85"
      cert_thumbprint     = "B70F2672E4C5231FAE9069969BF8EC1219228078"
      cert_valid_from     = "2023-08-03"
      cert_valid_to       = "2024-08-01"

      country             = "GB"
      state               = "???"
      locality            = "Bargoed"
      email               = "???"
      rdn_serial_number   = "11455947"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "49:49:e2:43:e0:df:c1:50:57:7b:fe:b9:d7:22:c1:85"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_4A8EDE8C9A2A4D6E4E715914F57625FE {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-01"
      version             = "1.0"

      hash                = "9d215743885b4f6d937deb0975c1b4b7a771d2d1c67a958b18f28383756bafc2"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Ред Драгон Девелоп\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4a:8e:de:8c:9a:2a:4d:6e:4e:71:59:14:f5:76:25:fe"
      cert_thumbprint     = "CEAC5151942E41A43CA361CB52F2F3B9842CA186"
      cert_valid_from     = "2023-09-01"
      cert_valid_to       = "2024-08-31"

      country             = "UA"
      state               = "???"
      locality            = "Zhytomyr"
      email               = "???"
      rdn_serial_number   = "45226834"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4a:8e:de:8c:9a:2a:4d:6e:4e:71:59:14:f5:76:25:fe"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_50940364ABB9A9A36B3D76920AE4BA99 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-08-30"
      version             = "1.0"

      hash                = "a82a9e1f6667350808a19219d586d10bcea85cf73b67024d8c58366981fe4993"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Game Warriors Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "50:94:03:64:ab:b9:a9:a3:6b:3d:76:92:0a:e4:ba:99"
      cert_thumbprint     = "F1BABD3CDCA991FB45744D04751E98DF0FACB1DF"
      cert_valid_from     = "2022-08-30"
      cert_valid_to       = "2023-08-30"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "12348358"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "50:94:03:64:ab:b9:a9:a3:6b:3d:76:92:0a:e4:ba:99"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_582754520B29E5E364C2EA504C4E33FF {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-14"
      version             = "1.0"

      hash                = "a31d955304360eade30679137269659a9c7b1e53aecb2eb7e616a4ad0f91c655"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Гейм Трейд\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "58:27:54:52:0b:29:e5:e3:64:c2:ea:50:4c:4e:33:ff"
      cert_thumbprint     = "E9A61165463CEE5B9F502E78C52539CBF128DAE9"
      cert_valid_from     = "2023-11-14"
      cert_valid_to       = "2024-11-13"

      country             = "UA"
      state               = "Kiev"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "45350408"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "58:27:54:52:0b:29:e5:e3:64:c2:ea:50:4c:4e:33:ff"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_58367738B9503A2AA9CFC771B3C19E11 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-22"
      version             = "1.0"

      hash                = "fbef401c6a7ad24640f6b6583aa0d0fa02aa895c47ab08e68b0e6e312d1b42a5"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "SLIM DOG SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "58:36:77:38:b9:50:3a:2a:a9:cf:c7:71:b3:c1:9e:11"
      cert_thumbprint     = "BBE2C16616548CFBC0C78789DCB186653DC8DF2E"
      cert_valid_from     = "2023-12-22"
      cert_valid_to       = "2024-12-21"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000491343"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "58:36:77:38:b9:50:3a:2a:a9:cf:c7:71:b3:c1:9e:11"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_5A472CA5C4DDFFA6493FAFDCF135F4B0 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-26"
      version             = "1.0"

      hash                = "2db7438e5b4298ce068006ef96f729fd0bb4863e856425215ad9e77f807562e0"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "HOLDING MEDICAL GROUP KATOWICE SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5a:47:2c:a5:c4:dd:ff:a6:49:3f:af:dc:f1:35:f4:b0"
      cert_thumbprint     = "287819474F99798A56472A6E4FCAD3FD5A048757"
      cert_valid_from     = "2023-12-26"
      cert_valid_to       = "2024-12-25"

      country             = "PL"
      state               = "???"
      locality            = "Katowice"
      email               = "???"
      rdn_serial_number   = "0000829859"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5a:47:2c:a5:c4:dd:ff:a6:49:3f:af:dc:f1:35:f4:b0"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_5A76082854191C938CCF735EDD4CF55A {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-10-25"
      version             = "1.0"

      hash                = "af1f2b516ede83cf2699ba54113ce7a7d81d17040588746a19a1fa2ea41175d6"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Softindex Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5a:76:08:28:54:19:1c:93:8c:cf:73:5e:dd:4c:f5:5a"
      cert_thumbprint     = "DFA83E459316D496FDB1BCD7E78A15D489A4F1C6"
      cert_valid_from     = "2022-10-25"
      cert_valid_to       = "2023-09-22"

      country             = "GB"
      state               = "???"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "14080111"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5a:76:08:28:54:19:1c:93:8c:cf:73:5e:dd:4c:f5:5a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_5BA900D7A761EE27C27998C8B9B4FA70 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-14"
      version             = "1.0"

      hash                = "394fa8af1348cbcf3d9beae6dc8b6afb24c6b96bcc3be52601a5b84f9adf007c"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "OOO LEVELAP"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5b:a9:00:d7:a7:61:ee:27:c2:79:98:c8:b9:b4:fa:70"
      cert_thumbprint     = "EDEBF26E6CAD49A8F48A11EFF6BFC13266FF6872"
      cert_valid_from     = "2021-09-14"
      cert_valid_to       = "2022-09-14"

      country             = "RU"
      state               = "???"
      locality            = "St. Petersburg"
      email               = "???"
      rdn_serial_number   = "1117847087819"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5b:a9:00:d7:a7:61:ee:27:c2:79:98:c8:b9:b4:fa:70"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_610D58E503B2328D6CB6DF7BA7606F98 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-16"
      version             = "1.0"

      hash                = "21646416f656f7b4da74214f2a33bc19733bdd30525381ceb66bb87a6ceb32d6"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "BELLANN BOARD & PACKAGING CO.LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "61:0d:58:e5:03:b2:32:8d:6c:b6:df:7b:a7:60:6f:98"
      cert_thumbprint     = "F8C4EDE315C5CA98B13BF67EB6DEA79FFD00DFB6"
      cert_valid_from     = "2023-08-16"
      cert_valid_to       = "2024-08-15"

      country             = "GB"
      state               = "???"
      locality            = "Burnley"
      email               = "???"
      rdn_serial_number   = "06368556"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "61:0d:58:e5:03:b2:32:8d:6c:b6:df:7b:a7:60:6f:98"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_6ADA64000BBAF0497538A2BF1938F2BA {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-06"
      version             = "1.0"

      hash                = "9dc4e8a0d45b04b1b4bc2df2a16aa37e5597624feed3b53a9c5ca2929a2fb6c3"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Оноп\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6a:da:64:00:0b:ba:f0:49:75:38:a2:bf:19:38:f2:ba"
      cert_thumbprint     = "96450C6F02D7E314EE2A20330D01E6A502325033"
      cert_valid_from     = "2023-11-06"
      cert_valid_to       = "2024-11-05"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Dnipro"
      email               = "???"
      rdn_serial_number   = "45364405"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6a:da:64:00:0b:ba:f0:49:75:38:a2:bf:19:38:f2:ba"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_6CDA1A0D2917A790C24B0F3FBDD9F7EB {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-06-07"
      version             = "1.0"

      hash                = "d4debb62f43fb37f8ad0968499d2d48d3cfad20f4ed20d8b3fe9e4759fd95d68"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Austin Software Company LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6c:da:1a:0d:29:17:a7:90:c2:4b:0f:3f:bd:d9:f7:eb"
      cert_thumbprint     = "EB2463B6461F009034605620FF9AE2494A8FE5C8"
      cert_valid_from     = "2023-06-07"
      cert_valid_to       = "2024-06-05"

      country             = "US"
      state               = "California"
      locality            = "Palm Desert"
      email               = "???"
      rdn_serial_number   = "7306616"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6c:da:1a:0d:29:17:a7:90:c2:4b:0f:3f:bd:d9:f7:eb"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_6FE721C3DDBD2774D03DCEA44A26A78A {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-09-29"
      version             = "1.0"

      hash                = "1e7914f799371cbc8560bc52203d3531bb20cb4f6092158c76a4842dbf85dabc"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "OOO ENDI"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6f:e7:21:c3:dd:bd:27:74:d0:3d:ce:a4:4a:26:a7:8a"
      cert_thumbprint     = "BC346A6BF6B6D53A69A742A4245A43320980B1C0"
      cert_valid_from     = "2021-09-29"
      cert_valid_to       = "2022-09-29"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1097847161631"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6f:e7:21:c3:dd:bd:27:74:d0:3d:ce:a4:4a:26:a7:8a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_71B5F261CB3D4563B9C7119FF093C098 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-26"
      version             = "1.0"

      hash                = "1252f2bf3817714a8303f7e448930d6d4f797a70ec7effc80f2b1db5e49b9077"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Optimus"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "71:b5:f2:61:cb:3d:45:63:b9:c7:11:9f:f0:93:c0:98"
      cert_thumbprint     = "CFAAD6EA7F64D7665F8FE68AC24198E35FBF2CB9"
      cert_valid_from     = "2021-05-26"
      cert_valid_to       = "2022-10-16"

      country             = "RU"
      state               = "Novosibirsk Oblast"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "1195476035897"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "71:b5:f2:61:cb:3d:45:63:b9:c7:11:9f:f0:93:c0:98"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_74FFF77F8BEB817FD3826F6EFF8F0C7A {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-19"
      version             = "1.0"

      hash                = "777cb8aae1e77e841b4981965198f62e60e55a4f910120980dc5ad997ab71fb5"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"РЕОВГУЦ\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "74:ff:f7:7f:8b:eb:81:7f:d3:82:6f:6e:ff:8f:0c:7a"
      cert_thumbprint     = "7E0D8019997F318C1A6EFAF056068182CCFB0F7B"
      cert_valid_from     = "2023-09-19"
      cert_valid_to       = "2024-09-18"

      country             = "UA"
      state               = "Kharkiv Oblast"
      locality            = "Balakliya"
      email               = "???"
      rdn_serial_number   = "45285334"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "74:ff:f7:7f:8b:eb:81:7f:d3:82:6f:6e:ff:8f:0c:7a"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_77AE3B91E2B86DE3D5929B8AEC1C83DC {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-19"
      version             = "1.0"

      hash                = "820eda2078723e7f1c09d0e6d3641ea822c2b36c981cb5bfa4e445733664c087"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Софт Енжін юа\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "77:ae:3b:91:e2:b8:6d:e3:d5:92:9b:8a:ec:1c:83:dc"
      cert_thumbprint     = "592FCE66E13CEAAB64900F31278D9332B2F2C007"
      cert_valid_from     = "2023-09-19"
      cert_valid_to       = "2024-09-18"

      country             = "UA"
      state               = "Zhytomyr Oblast"
      locality            = "Zhytomyr"
      email               = "???"
      rdn_serial_number   = "45310779"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "77:ae:3b:91:e2:b8:6d:e3:d5:92:9b:8a:ec:1c:83:dc"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_7A885053853B73FAC66797D4DA68E94E {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-11"
      version             = "1.0"

      hash                = "65569db0dceb1c06be2a2cccedfef1447d14ec6d6f3d5ce28c4997c45c4991a8"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "TOV RT RUNA"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:88:50:53:85:3b:73:fa:c6:67:97:d4:da:68:e9:4e"
      cert_thumbprint     = "F5324F7D7383D03530958E94A468DAA00F80087E"
      cert_valid_from     = "2023-07-11"
      cert_valid_to       = "2024-07-10"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Kamianske"
      email               = "???"
      rdn_serial_number   = "44925256"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:88:50:53:85:3b:73:fa:c6:67:97:d4:da:68:e9:4e"
      )
}

rule MAL_Compromised_Cert_SolarMarker_SSL_com_7C8A13BFC595B0DCE94BD5A1B390BA99 {
   meta:
      description         = "Detects SolarMarker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-22"
      version             = "1.0"

      hash                = "39102fb7bb6a74a9c8cb6d46419f9015b381199ea8524c1376672b30fffd69d2"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "ТОВ \"Трафік Девелоп ЮА\""
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7c:8a:13:bf:c5:95:b0:dc:e9:4b:d5:a1:b3:90:ba:99"
      cert_thumbprint     = "F400439D02442BDAED6138647641627694712A83"
      cert_valid_from     = "2023-09-22"
      cert_valid_to       = "2024-09-21"

      country             = "UA"
      state               = "Rivne Oblast"
      locality            = "Rivne"
      email               = "???"
      rdn_serial_number   = "45405980"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7c:8a:13:bf:c5:95:b0:dc:e9:4b:d5:a1:b3:90:ba:99"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Sectigo_00B66CF27F736D8CE85BEB1EBF0CA7DEE3 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-18"
      version             = "1.0"

      hash                = "278ec8f7a0cd969ebb84e72f60f19bb6f6fd6f7268ebe68245c46e6de2a43cf1"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "九江绿洲环境技术有限公司"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b6:6c:f2:7f:73:6d:8c:e8:5b:eb:1e:bf:0c:a7:de:e3"
      cert_thumbprint     = "13463D6E9AE08847E00EE54DF25497A545525698"
      cert_valid_from     = "2023-05-18"
      cert_valid_to       = "2024-05-17"

      country             = "CN"
      state               = "江西省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91360429MA3AECHY7X"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b6:6c:f2:7f:73:6d:8c:e8:5b:eb:1e:bf:0c:a7:de:e3"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Sectigo_2D88C0AF1FE2609961C171213C03BD23 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-10"
      version             = "1.0"

      hash                = "42788ef63efc2e74f7695cc618706e9f149a713b3241458503bf81290d8163ac"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Zhuzhou Lizhong Precision Manufacturing Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "2d:88:c0:af:1f:e2:60:99:61:c1:71:21:3c:03:bd:23"
      cert_thumbprint     = "161A40889C28EBEDDADCDBD1EBCD29012540B927"
      cert_valid_from     = "2023-05-10"
      cert_valid_to       = "2024-05-09"

      country             = "CN"
      state               = "湖南省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91430200MA4L50L717"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "2d:88:c0:af:1f:e2:60:99:61:c1:71:21:3c:03:bd:23"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Sectigo_3821DCACA66A5C5176B921B4D9ED4C97 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-22"
      version             = "1.0"

      hash                = "7853518d97bf86211ce0193fcdc8e484615204e97d417386651aa6bbfe686eea"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "BUL D'EVASION"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "38:21:dc:ac:a6:6a:5c:51:76:b9:21:b4:d9:ed:4c:97"
      cert_thumbprint     = "033A6CABA166D80B96E33B1CDD68EDE7487284B6"
      cert_valid_from     = "2022-07-22"
      cert_valid_to       = "2023-07-22"

      country             = "FR"
      state               = "Auvergne-Rhône-Alpes"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "38:21:dc:ac:a6:6a:5c:51:76:b9:21:b4:d9:ed:4c:97"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Sectigo_5DD4A4D405BE799614F437693B0F2929 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-10"
      version             = "1.0"

      hash                = "13a1bead1187cbc6072c410501a417b812e82f1bbbf6a93deaab26ae5ea67628"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "Changzhou Daqian Freighting Service Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "5d:d4:a4:d4:05:be:79:96:14:f4:37:69:3b:0f:29:29"
      cert_thumbprint     = "8A7E0A1D10FBE17FD470364EE131B3BDA1381555"
      cert_valid_from     = "2023-08-10"
      cert_valid_to       = "2024-08-09"

      country             = "CN"
      state               = "江苏省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91320411137518732Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "5d:d4:a4:d4:05:be:79:96:14:f4:37:69:3b:0f:29:29"
      )
}

rule MAL_Compromised_Cert_SolarMarker_Sectigo_7E68FA2E528364E694D06200A418EF68 {
   meta:
      description         = "Detects SolarMarker with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-05"
      version             = "1.0"

      hash                = "5ef62c7d66c9f9470658e647afd257cbc087056ec07b4eafd7879682701cd05a"
      malware             = "SolarMarker"
      malware_type        = "Remote access tool"
      malware_notes       = "A remote access tool active 2020-2023. Installs a VNC client to perform on-device-fraud."

      signer              = "C.T.M. d.o.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "7e:68:fa:2e:52:83:64:e6:94:d0:62:00:a4:18:ef:68"
      cert_thumbprint     = "8B5C3016639149FFA34DCF63FA0C30254A7FF178"
      cert_valid_from     = "2020-11-05"
      cert_valid_to       = "2021-11-05"

      country             = "SI"
      state               = "???"
      locality            = "Liubliana"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "7e:68:fa:2e:52:83:64:e6:94:d0:62:00:a4:18:ef:68"
      )
}

rule MAL_Compromised_Cert_SpectreRAT_Certum_341DFC31CA4BDBB1824E254BCD5B59E0 {
   meta:
      description         = "Detects SpectreRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-10"
      version             = "1.0"

      hash                = "84499164a4848a100a22361f38d36ddaea66d01d2e68580271692f9a6fc2a570"
      malware             = "SpectreRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xi'an Jiashi Xinnuo Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "34:1d:fc:31:ca:4b:db:b1:82:4e:25:4b:cd:5b:59:e0"
      cert_thumbprint     = "C2016ABA9447FCB75B03F158B31EAC7D76262377"
      cert_valid_from     = "2024-05-10"
      cert_valid_to       = "2025-05-10"

      country             = "CN"
      state               = "Shaanxi"
      locality            = "Xian"
      email               = "???"
      rdn_serial_number   = "91610113MA6TYLT60X"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "34:1d:fc:31:ca:4b:db:b1:82:4e:25:4b:cd:5b:59:e0"
      )
}

rule MAL_Compromised_Cert_SpectreRAT_Certum_711C937222514293ED01A76BC877B203 {
   meta:
      description         = "Detects SpectreRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-23"
      version             = "1.0"

      hash                = "bbbfdf66e9c773bcad95c6cd2e89a596620f417175de712269689b08f2643a40"
      malware             = "SpectreRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Weimao Network Technology Co., Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "71:1c:93:72:22:51:42:93:ed:01:a7:6b:c8:77:b2:03"
      cert_thumbprint     = "63F84B5AE10552D7CF22D740F9C44F0FA9D029AE"
      cert_valid_from     = "2024-05-23"
      cert_valid_to       = "2025-05-23"

      country             = "CN"
      state               = "Anhui"
      locality            = "Hefei"
      email               = "???"
      rdn_serial_number   = "91340100083694107X"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "71:1c:93:72:22:51:42:93:ed:01:a7:6b:c8:77:b2:03"
      )
}

rule MAL_Compromised_Cert_SpectreRAT_GlobalSign_0C6D55B6A19AC5AD3052EF24 {
   meta:
      description         = "Detects SpectreRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-31"
      version             = "1.0"

      hash                = "94827a4ab543972eacee8e610ec94d8469de43fe8dc0302015f1c587b158025d"
      malware             = "SpectreRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JauiInderte Agiletron Information Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:6d:55:b6:a1:9a:c5:ad:30:52:ef:24"
      cert_thumbprint     = "D0C7D82E733D076804E5DFF6FB93069D2F9CB192"
      cert_valid_from     = "2024-01-31"
      cert_valid_to       = "2025-01-31"

      country             = "CN"
      state               = "Anhui"
      locality            = "Wuhu"
      email               = "???"
      rdn_serial_number   = "91340222MA2MXM3F23"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:6d:55:b6:a1:9a:c5:ad:30:52:ef:24"
      )
}

rule MAL_Compromised_Cert_Spyder_SSL_com_72F3D28CC3666D4C5B2C7E915E0A2C5F {
   meta:
      description         = "Detects Spyder with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-14"
      version             = "1.0"

      hash                = "2f21da16f2e697a95deb0f89575c1ea2594a78ef5d76a038638c8f1b651d4ae5"
      malware             = "Spyder"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Haru Creative Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "72:f3:d2:8c:c3:66:6d:4c:5b:2c:7e:91:5e:0a:2c:5f"
      cert_thumbprint     = "50BF88F2362777F0E3DAC40E51F28DA18B03C059"
      cert_valid_from     = "2025-02-14"
      cert_valid_to       = "2026-02-14"

      country             = "FI"
      state               = "Pirkanmaa"
      locality            = "Tampere"
      email               = "???"
      rdn_serial_number   = "3195241-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "72:f3:d2:8c:c3:66:6d:4c:5b:2c:7e:91:5e:0a:2c:5f"
      )
}

rule MAL_Compromised_Cert_StealC_GlobalSign_1C8065E6FC5E7D5370B937B1 {
   meta:
      description         = "Detects StealC with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-29"
      version             = "1.0"

      hash                = "19588db4bc98090955e95c3bef81c946fa593c7e3d2aa3dfbf57b213b7e16360"
      malware             = "StealC"
      malware_type        = "Infostealer"
      malware_notes       = "A popular and customizable infostealler that can also function as a loader: https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1/"

      signer              = "TECH SOLUTIONS BHAM INC."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1c:80:65:e6:fc:5e:7d:53:70:b9:37:b1"
      cert_thumbprint     = "392CA9AE72072971CC24384B4E009C40F657862F"
      cert_valid_from     = "2024-10-29"
      cert_valid_to       = "2025-10-30"

      country             = "US"
      state               = "Alabama"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "000-826-105"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1c:80:65:e6:fc:5e:7d:53:70:b9:37:b1"
      )
}

rule MAL_Compromised_Cert_StealC_GlobalSign_64D320BA7835B7EABB35090B {
   meta:
      description         = "Detects StealC with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-23"
      version             = "1.0"

      hash                = "bc2bc7928859d26e604daed7b33666700b36b34e04987c172f5bca7e62deb97b"
      malware             = "StealC"
      malware_type        = "Infostealer"
      malware_notes       = "A popular and customizable infostealler that can also function as a loader: https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1/"

      signer              = "LLC Private security company SHCHIT-A"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:d3:20:ba:78:35:b7:ea:bb:35:09:0b"
      cert_thumbprint     = "095432D2CB45882288E1E7B4832E5AA572A39408"
      cert_valid_from     = "2025-05-23"
      cert_valid_to       = "2026-05-24"

      country             = "RU"
      state               = "Moscow Oblast"
      locality            = "Lytkarino"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:d3:20:ba:78:35:b7:ea:bb:35:09:0b"
      )
}

rule MAL_Compromised_Cert_StealC_Microsoft_330005639B7F8EE84875A4851500000005639B {
   meta:
      description         = "Detects StealC with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-22"
      version             = "1.0"

      hash                = "83322f93f2b3489c9414317e11e66927d35475ba77a537c012180f3b55a85e1c"
      malware             = "StealC"
      malware_type        = "Infostealer"
      malware_notes       = "A popular and customizable infostealler that can also function as a loader: https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1/"

      signer              = "Marker Hill Construction Inc"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:63:9b:7f:8e:e8:48:75:a4:85:15:00:00:00:05:63:9b"
      cert_thumbprint     = "35F6DEED2594DF4FAAD2CD664EEEEBC00BC181A6"
      cert_valid_from     = "2025-11-22"
      cert_valid_to       = "2025-11-25"

      country             = "US"
      state               = "Colorado"
      locality            = "Denver"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:63:9b:7f:8e:e8:48:75:a4:85:15:00:00:00:05:63:9b"
      )
}

rule MAL_Compromised_Cert_StealC_SSL_com_3950CAACF6BC64F75CA24F8B294AD41B {
   meta:
      description         = "Detects StealC with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-03"
      version             = "1.0"

      hash                = "1044130f4116b9432b2e6046184687b57a1680c572e83da8f59899b3284997e2"
      malware             = "StealC"
      malware_type        = "Infostealer"
      malware_notes       = "A popular and customizable infostealler that can also function as a loader: https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1/"

      signer              = "Perito IT Consulting Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "39:50:ca:ac:f6:bc:64:f7:5c:a2:4f:8b:29:4a:d4:1b"
      cert_thumbprint     = "0D9E698C56D039A2D41481A1473F84D39C294D7B"
      cert_valid_from     = "2025-09-03"
      cert_valid_to       = "2026-09-03"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "39:50:ca:ac:f6:bc:64:f7:5c:a2:4f:8b:29:4a:d4:1b"
      )
}

rule MAL_Compromised_Cert_StealC_Sectigo_00DA89A851C5BDAC75CCD75F257D967584 {
   meta:
      description         = "Detects StealC with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-26"
      version             = "1.0"

      hash                = "b8a874e4883d21fd03434c97cf5d5a80b9085924760c273483a9f7723c864e0a"
      malware             = "StealC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KrsuoJohce MonovaTech Information Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:da:89:a8:51:c5:bd:ac:75:cc:d7:5f:25:7d:96:75:84"
      cert_thumbprint     = "B882F3F37C0ED6AF37EB39CB9A835DBC87202AA5"
      cert_valid_from     = "2025-09-26"
      cert_valid_to       = "2026-09-26"

      country             = "CN"
      state               = "Shandong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91370203MA3N99947C"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:da:89:a8:51:c5:bd:ac:75:cc:d7:5f:25:7d:96:75:84"
      )
}

rule MAL_Compromised_Cert_Stealc_HijackLoader_GlobalSign_3A352958B8D4FDAFE1C6B8E8 {
   meta:
      description         = "Detects Stealc, HijackLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-16"
      version             = "1.0"

      hash                = "393943bd4908cb8da49927fee8ddc6d7f14cc0948e77988e32f3cdd74c5ae118"
      malware             = "Stealc, HijackLoader"
      malware_type        = "Infostealer"
      malware_notes       = "A popular and customizable infostealler that can also function as a loader: https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1/"

      signer              = "UTTAM AGRITECH PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3a:35:29:58:b8:d4:fd:af:e1:c6:b8:e8"
      cert_thumbprint     = "5e253b7620940a7d4ec389daa83be219b290f887874da6aa4dc02260ae27e715"
      cert_valid_from     = "2025-07-16"
      cert_valid_to       = "2026-07-17"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "uttamagritechindia@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3a:35:29:58:b8:d4:fd:af:e1:c6:b8:e8"
      )
}

rule MAL_Compromised_Cert_Stealer5000_GlobalSign_47858D45CE2829FA3B600737 {
   meta:
      description         = "Detects Stealer5000 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-08"
      version             = "1.0"

      hash                = "57b6429db74ea920d0cb7fd2e70437d20a688e6e91feb4f117aebae912431f77"
      malware             = "Stealer5000"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Stanki 96"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:85:8d:45:ce:28:29:fa:3b:60:07:37"
      cert_thumbprint     = "BDB91CBA7D916FE09B14647CAD74D3396E0CC618"
      cert_valid_from     = "2025-07-08"
      cert_valid_to       = "2026-07-09"

      country             = "RU"
      state               = "Sverdlovsk Oblast"
      locality            = "Yekaterinburg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:85:8d:45:ce:28:29:fa:3b:60:07:37"
      )
}

rule MAL_Compromised_Cert_Stealer5000_SSL_com_59ABFE373E657805504B83D792EA951B {
   meta:
      description         = "Detects Stealer5000 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "b75f706e64f1cfb417f5d02dad09fd5b808a2dfc3237c06b4709fe16b1442511"
      malware             = "Stealer5000"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IT Alasin Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "59:ab:fe:37:3e:65:78:05:50:4b:83:d7:92:ea:95:1b"
      cert_thumbprint     = "13683C65EF9D2705B6EFE6CFE4F9122241A98F30"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2026-06-12"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Vantaa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "59:ab:fe:37:3e:65:78:05:50:4b:83:d7:92:ea:95:1b"
      )
}

rule MAL_Compromised_Cert_StormKitty_GlobalSign_0ACEC169CBF3FD565620FCB4 {
   meta:
      description         = "Detects StormKitty with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-19"
      version             = "1.0"

      hash                = "f84f4785d00356bf51a3ca9643dbbe3f778e9032fa365511732b5f4b9838e0a1"
      malware             = "StormKitty"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hefei Zaxue Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0a:ce:c1:69:cb:f3:fd:56:56:20:fc:b4"
      cert_thumbprint     = "B670D67D1A8CCDDDB1BA518718DCA85074832D40"
      cert_valid_from     = "2025-05-19"
      cert_valid_to       = "2026-05-20"

      country             = "CN"
      state               = "Anhui"
      locality            = "Hefei"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0a:ce:c1:69:cb:f3:fd:56:56:20:fc:b4"
      )
}

rule MAL_Compromised_Cert_SystemBC_GlobalSign_45C03D0AF72D5526BA65E57E {
   meta:
      description         = "Detects SystemBC with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-23"
      version             = "1.0"

      hash                = "c69ab262ac3f73277c4b9a777a408f57feb618e2e00bc2e66e8d97274083c742"
      malware             = "SystemBC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AESUMON SOFTWARE Incorporated"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "45:c0:3d:0a:f7:2d:55:26:ba:65:e5:7e"
      cert_thumbprint     = "F3D17D0531B802F20713CA2704873545D8209B6C"
      cert_valid_from     = "2024-09-23"
      cert_valid_to       = "2025-09-24"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "1091701-0"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "45:c0:3d:0a:f7:2d:55:26:ba:65:e5:7e"
      )
}

rule MAL_Compromised_Cert_SystemBC_SSL_com_53E1F226CB77574F8FBEB5682DA091BB {
   meta:
      description         = "Detects SystemBC with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-31"
      version             = "1.0"

      hash                = "b778857f8ecf2ec65eee77cd14acb1fbae86a26764a360e4d0717b7795d155cb"
      malware             = "SystemBC"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "OdyLab Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:e1:f2:26:cb:77:57:4f:8f:be:b5:68:2d:a0:91:bb"
      cert_thumbprint     = "AE21518CD94CB73660AF05347BEFD3837AF1B4ED"
      cert_valid_from     = "2022-05-31"
      cert_valid_to       = "2023-05-31"

      country             = "US"
      state               = "Florida"
      locality            = "Brandon"
      email               = "???"
      rdn_serial_number   = "P22000028161"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:e1:f2:26:cb:77:57:4f:8f:be:b5:68:2d:a0:91:bb"
      )
}

rule MAL_Compromised_Cert_TA455_SSL_com_2848CDE84DCF101BBF54EAB1D5F3C55E {
   meta:
      description         = "Detects TA455 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-09"
      version             = "1.0"

      hash                = "0e4ff052250ade1edaab87de194e87a9afeff903695799bcbc3571918b131100"
      malware             = "TA455"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Insight Digital B.V."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "28:48:cd:e8:4d:cf:10:1b:bf:54:ea:b1:d5:f3:c5:5e"
      cert_thumbprint     = "639D1C9473B7B289CEE9853A991A8B55A8B36168"
      cert_valid_from     = "2025-07-09"
      cert_valid_to       = "2026-07-09"

      country             = "NL"
      state               = "South Holland"
      locality            = "Groot-Ammers"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "28:48:cd:e8:4d:cf:10:1b:bf:54:ea:b1:d5:f3:c5:5e"
      )
}

rule MAL_Compromised_Cert_TA455_SSL_com_39E43998EBB35F6D2D513A668C6A85F6 {
   meta:
      description         = "Detects TA455 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-16"
      version             = "1.0"

      hash                = "129a40e38ef075c7d33d8517b268eb023093c765a32e406b58f39fab6cc6a040"
      malware             = "TA455"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Flyland Software"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "39:e4:39:98:eb:b3:5f:6d:2d:51:3a:66:8c:6a:85:f6"
      cert_thumbprint     = "E2BD13F8E92144DFC6944DA1EF02EE6838A30F6A"
      cert_valid_from     = "2025-04-16"
      cert_valid_to       = "2026-04-16"

      country             = "FR"
      state               = "???"
      locality            = "Paris"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "39:e4:39:98:eb:b3:5f:6d:2d:51:3a:66:8c:6a:85:f6"
      )
}

rule MAL_Compromised_Cert_TA455_SSL_com_3A4848ACF4654C8A3FCD604E7F7DEDB0 {
   meta:
      description         = "Detects TA455 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-16"
      version             = "1.0"

      hash                = "d2db5b9b554470f5e9ad26f37b6b3f4f3dae336b3deea3f189933d007c17e3d8"
      malware             = "TA455"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sevenfeet Software AB"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "3a:48:48:ac:f4:65:4c:8a:3f:cd:60:4e:7f:7d:ed:b0"
      cert_thumbprint     = "D0DAAB3064E766CD74321FFF8D1714E94EB7AABD"
      cert_valid_from     = "2025-05-16"
      cert_valid_to       = "2026-05-16"

      country             = "SE"
      state               = "Stockholm"
      locality            = "Sundbyberg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "3a:48:48:ac:f4:65:4c:8a:3f:cd:60:4e:7f:7d:ed:b0"
      )
}

rule MAL_Compromised_Cert_TA455_SSL_com_6DBDE1AECCDA080A37740F49F6FF69AC {
   meta:
      description         = "Detects TA455 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-24"
      version             = "1.0"

      hash                = "3b58fd0c0ef8a42226be4d26a64235da059986ec7f5990d5c50d47b7a6cfadcd"
      malware             = "TA455"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RGC Digital AB"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "6d:bd:e1:ae:cc:da:08:0a:37:74:0f:49:f6:ff:69:ac"
      cert_thumbprint     = "9CC577B29B87E50C2C3917F8DF1628FE8579F067"
      cert_valid_from     = "2025-06-24"
      cert_valid_to       = "2026-06-24"

      country             = "SE"
      state               = "Stockholm County"
      locality            = "Stockholm"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "6d:bd:e1:ae:cc:da:08:0a:37:74:0f:49:f6:ff:69:ac"
      )
}

rule MAL_Compromised_Cert_TA455_SSL_com_6FC5AE16744B71647A822C46313615E8 {
   meta:
      description         = "Detects TA455 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "cf0c50670102e7fc6499e8d912ce1f5bd389fad5358d5cae53884593c337ac2e"
      malware             = "TA455"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Metriq Cloud Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6f:c5:ae:16:74:4b:71:64:7a:82:2c:46:31:36:15:e8"
      cert_thumbprint     = "E7DC7ADE3CD0AF5220E11871F5853C3C7F3E2482"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2026-03-14"

      country             = "PL"
      state               = "Silesian Voivodeship"
      locality            = "Katowice"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6f:c5:ae:16:74:4b:71:64:7a:82:2c:46:31:36:15:e8"
      )
}

rule MAL_Compromised_Cert_TA505_Sectigo_00B8164F7143E1A313003AB0C834562F1F {
   meta:
      description         = "Detects TA505 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-25"
      version             = "1.0"

      hash                = "c79957ca77f6355fb02b9a0d9d2a4c86bca3d6fd53afbf03d6e981da5bb43689"
      malware             = "TA505"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ekitai Data Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:b8:16:4f:71:43:e1:a3:13:00:3a:b0:c8:34:56:2f:1f"
      cert_thumbprint     = "8BEBDCDD636C7172C3AA79B0F1F31311C61A3232"
      cert_valid_from     = "2020-08-25"
      cert_valid_to       = "2021-08-25"

      country             = "CA"
      state               = "Ontario"
      locality            = "Thornhill"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:b8:16:4f:71:43:e1:a3:13:00:3a:b0:c8:34:56:2f:1f"
      )
}

rule MAL_Compromised_Cert_TA505_Sectigo_00F454F2FDC800B3454059D8889BD73D67 {
   meta:
      description         = "Detects TA505 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-25"
      version             = "1.0"

      hash                = "e58b80e4738dc03f5aa82d3a40a6d2ace0d7c7cfd651f1dd10df76d43d8c0eb3"
      malware             = "TA505"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BEAUTY CORP SRL"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:f4:54:f2:fd:c8:00:b3:45:40:59:d8:88:9b:d7:3d:67"
      cert_thumbprint     = "2B560FABC34E0DB81DAE1443B1C4929EEF820266"
      cert_valid_from     = "2021-05-25"
      cert_valid_to       = "2024-05-24"

      country             = "RO"
      state               = "???"
      locality            = "Botosani"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:f4:54:f2:fd:c8:00:b3:45:40:59:d8:88:9b:d7:3d:67"
      )
}

rule MAL_Compromised_Cert_TA505_Sectigo_3AFE693728F8406054A613F6736F89E3 {
   meta:
      description         = "Detects TA505 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-07"
      version             = "1.0"

      hash                = "d98bdf3508763fe0df177ef696f5bf8de7ff7c7dc68bb04a14a95ec28528c3f9"
      malware             = "TA505"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ROB ALDERMAN FITNESS LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "3a:fe:69:37:28:f8:40:60:54:a6:13:f6:73:6f:89:e3"
      cert_thumbprint     = "89528E9005A635BCEE8DA5539E71C5FC4F839F50"
      cert_valid_from     = "2020-08-07"
      cert_valid_to       = "2023-08-07"

      country             = "GB"
      state               = "BRISTOL"
      locality            = "BRISTOL"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "3a:fe:69:37:28:f8:40:60:54:a6:13:f6:73:6f:89:e3"
      )
}

rule MAL_Compromised_Cert_TA505_Sectigo_4929AB561C812AF93DDB9758B545F546 {
   meta:
      description         = "Detects TA505 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-07-09"
      version             = "1.0"

      hash                = "026e25a18dae7bae363c4cba43b129164e0b2f21ada7b471a0c6a3238b7c1057"
      malware             = "TA505"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Everything Wow s.r.o."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "49:29:ab:56:1c:81:2a:f9:3d:db:97:58:b5:45:f5:46"
      cert_thumbprint     = "C1E5574C891683C1FA811105049DCB67993F527E"
      cert_valid_from     = "2020-07-09"
      cert_valid_to       = "2021-07-09"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "Praha"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "49:29:ab:56:1c:81:2a:f9:3d:db:97:58:b5:45:f5:46"
      )
}

rule MAL_Compromised_Cert_TA505_Sectigo_51AEAD5A9AB2D841B449FA82DE3A8A00 {
   meta:
      description         = "Detects TA505 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-08-05"
      version             = "1.0"

      hash                = "89a9f09823152d3c5cbe29c667618e128fc8c0677ecec217fb7c2ccae75a7bf2"
      malware             = "TA505"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Corsair Software Solution Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "51:ae:ad:5a:9a:b2:d8:41:b4:49:fa:82:de:3a:8a:00"
      cert_thumbprint     = "56D8BEAC4650E4A25F0C7D338FE12A8285C1D388"
      cert_valid_from     = "2020-08-05"
      cert_valid_to       = "2021-08-05"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "51:ae:ad:5a:9a:b2:d8:41:b4:49:fa:82:de:3a:8a:00"
      )
}

rule MAL_Compromised_Cert_TamperedChef_GlobalSign_4BC8E9DA91CB67F9EA1B6079 {
   meta:
      description         = "Detects TamperedChef with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-10"
      version             = "1.0"

      hash                = "e32d6b2b38b11db56ae5bce0d5e5413578a62960aa3fab48553f048c4d5f91f0"
      malware             = "TamperedChef"
      malware_type        = "Backdoor"
      malware_notes       = "This malware was distributed as a calendar application. The calendar contained special encoding to facilitate encoded communication. This malware was believed to be a continuation of the TamperedChef campaign which used hidden characters in recipes. See https://www.guidepointsecurity.com/blog/ai-exposes-homoglyph-hustle/ for more information"

      signer              = "CROWN SKY LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4b:c8:e9:da:91:cb:67:f9:ea:1b:60:79"
      cert_thumbprint     = "154E1074C5850560AFD0F4F6F06993B1680CF034"
      cert_valid_from     = "2025-01-10"
      cert_valid_to       = "2026-01-11"

      country             = "UA"
      state               = "Kyiv"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4b:c8:e9:da:91:cb:67:f9:ea:1b:60:79"
      )
}

rule MAL_Compromised_Cert_Tech_Scam_malware_Microsoft_3300011FFA6AB4FB5E91C30BC5000000011FFA {
   meta:
      description         = "Detects Tech Scam malware with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-14"
      version             = "1.0"

      hash                = "0c3f5f7bed8efbb6b1de3e804d22397a8bdf442b83962444970855fc9606c9f5"
      malware             = "Tech Scam malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Adbuz"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:01:1f:fa:6a:b4:fb:5e:91:c3:0b:c5:00:00:00:01:1f:fa"
      cert_thumbprint     = "3D2AC00067E901D8BCC52308D234D4956C4E102A"
      cert_valid_from     = "2024-11-14"
      cert_valid_to       = "2024-11-17"

      country             = "IN"
      state               = "Delhi"
      locality            = "New Delhi"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:01:1f:fa:6a:b4:fb:5e:91:c3:0b:c5:00:00:00:01:1f:fa"
      )
}

rule MAL_Compromised_Cert_Telegram_Clipper_SSL_com_439064F1E1F400AF733C8F86FDFF1EA4 {
   meta:
      description         = "Detects Telegram Clipper with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-28"
      version             = "1.0"

      hash                = "e14e835f7eb8c3fa4322de27d9f40fecae82d98790f52316633591eb5915f40f"
      malware             = "Telegram Clipper"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wolf-Rudiger Kotte"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "43:90:64:f1:e1:f4:00:af:73:3c:8f:86:fd:ff:1e:a4"
      cert_thumbprint     = "2906290A31F6D55F6B5BB516E71409FB19F0672D"
      cert_valid_from     = "2025-10-28"
      cert_valid_to       = "2026-10-27"

      country             = "DE"
      state               = "Saxony"
      locality            = "Dresden"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "43:90:64:f1:e1:f4:00:af:73:3c:8f:86:fd:ff:1e:a4"
      )
}

rule MAL_Compromised_Cert_TerraStealerV2_SSL_com_343C7C502BDCE06C9F3C6551C9D0A451 {
   meta:
      description         = "Detects TerraStealerV2 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-23"
      version             = "1.0"

      hash                = "f2df0ab04e6d4fd2e12a3931545ee77a3217e3b099edfe4d5ec8e4a2749853a2"
      malware             = "TerraStealerV2"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "STERLING SPIRITS COMPANY LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "34:3c:7c:50:2b:dc:e0:6c:9f:3c:65:51:c9:d0:a4:51"
      cert_thumbprint     = "3B6B92AE3EC1CB49095713DDC3806914F9C0CE1A"
      cert_valid_from     = "2024-12-23"
      cert_valid_to       = "2025-12-23"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2010/25485"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "34:3c:7c:50:2b:dc:e0:6c:9f:3c:65:51:c9:d0:a4:51"
      )
}

rule MAL_Compromised_Cert_TerraStealer_SSL_com_343C7C502BDCE06C9F3C6551C9D0A451 {
   meta:
      description         = "Detects TerraStealer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-23"
      version             = "1.0"

      hash                = "4b6fa036aceb1e2149848ff46c4e1a6a89eee3b7d59769634ce9127fdaa96234"
      malware             = "TerraStealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "STERLING SPIRITS COMPANY LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "34:3c:7c:50:2b:dc:e0:6c:9f:3c:65:51:c9:d0:a4:51"
      cert_thumbprint     = "3B6B92AE3EC1CB49095713DDC3806914F9C0CE1A"
      cert_valid_from     = "2024-12-23"
      cert_valid_to       = "2025-12-23"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2010/25485"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "34:3c:7c:50:2b:dc:e0:6c:9f:3c:65:51:c9:d0:a4:51"
      )
}

rule MAL_Compromised_Cert_Traffer_Certum_53FDE4C245E86ABDF6194CA2EBBFB35F {
   meta:
      description         = "Detects Traffer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-07"
      version             = "1.0"

      hash                = "65a97735e27b6f493c47b1ccdafbf94065e09448e4a9e51b0dbc1d4e7b22c3c0"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nanjing Bangqiao Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "53:fd:e4:c2:45:e8:6a:bd:f6:19:4c:a2:eb:bf:b3:5f"
      cert_thumbprint     = "248C1A34A639DC481C7A7C28AF6C78578481050D"
      cert_valid_from     = "2025-08-07"
      cert_valid_to       = "2026-08-07"

      country             = "CN"
      state               = "江苏省"
      locality            = "南京市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "53:fd:e4:c2:45:e8:6a:bd:f6:19:4c:a2:eb:bf:b3:5f"
      )
}

rule MAL_Compromised_Cert_Traffer_GlobalSign_3A352958B8D4FDAFE1C6B8E8 {
   meta:
      description         = "Detects Traffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-16"
      version             = "1.0"

      hash                = "99b8ad6a13f701f9fb9e4a2279c6f724cf6bb9476246c9b77626c3db90522071"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UTTAM AGRITECH PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3a:35:29:58:b8:d4:fd:af:e1:c6:b8:e8"
      cert_thumbprint     = "908BB7F8704C44FCDE95D602E2C4DA3077304255"
      cert_valid_from     = "2025-07-16"
      cert_valid_to       = "2026-07-17"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "uttamagritechindia@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3a:35:29:58:b8:d4:fd:af:e1:c6:b8:e8"
      )
}

rule MAL_Compromised_Cert_Traffer_GlobalSign_7A72DDC4BCA8E1D810B258B3 {
   meta:
      description         = "Detects Traffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-30"
      version             = "1.0"

      hash                = "9b9c91e22566b658bcfefc8c463c74934d9bb5585b4516173407ba7f8ae9863a"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chengdu Jinyuan Qiming Network Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7a:72:dd:c4:bc:a8:e1:d8:10:b2:58:b3"
      cert_thumbprint     = "2D510C174453E38F5541161A77966DDECB042AF2"
      cert_valid_from     = "2025-06-30"
      cert_valid_to       = "2026-07-01"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7a:72:dd:c4:bc:a8:e1:d8:10:b2:58:b3"
      )
}

rule MAL_Compromised_Cert_Traffer_GlobalSign_7FE807E8EDAF5EF32235D7C2 {
   meta:
      description         = "Detects Traffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-03"
      version             = "1.0"

      hash                = "258f786dcb85b0d409d1da7ceced6384cca843036a1e648e191753695dd780cf"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MAKUENI AGENCIES LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7f:e8:07:e8:ed:af:5e:f3:22:35:d7:c2"
      cert_thumbprint     = "7784C34D3730124B89914C6A6BACDBB2A0939487"
      cert_valid_from     = "2025-02-03"
      cert_valid_to       = "2026-02-04"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2014/130160"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7f:e8:07:e8:ed:af:5e:f3:22:35:d7:c2"
      )
}

rule MAL_Compromised_Cert_Traffer_Mystix_SSL_com_084374CC276E43AC90AFFA80B1EF7C38 {
   meta:
      description         = "Detects Traffer (Mystix) with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "8651f126047222ca0273f9d0000681538a5847f7e4a45f62af497f934df014e1"
      malware             = "Traffer (Mystix)"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Traitsense ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "08:43:74:cc:27:6e:43:ac:90:af:fa:80:b1:ef:7c:38"
      cert_thumbprint     = "8536E25936E97B6BDC9591AEECC0E3D5FC1F5BCD"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2026-01-13"

      country             = "DK"
      state               = "???"
      locality            = "Agerskov"
      email               = "???"
      rdn_serial_number   = "37751391"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "08:43:74:cc:27:6e:43:ac:90:af:fa:80:b1:ef:7c:38"
      )
}

rule MAL_Compromised_Cert_Traffer_Mystix_SSL_com_1C43266C48484EB97557A588CFB2DC8E {
   meta:
      description         = "Detects Traffer (Mystix) with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-22"
      version             = "1.0"

      hash                = "76a11b90a7b90b2771a287826703e9af026249bff53e8779bd5ed7170f56ec68"
      malware             = "Traffer (Mystix)"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "A man did it OY"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1c:43:26:6c:48:48:4e:b9:75:57:a5:88:cf:b2:dc:8e"
      cert_thumbprint     = "8E84C5F39DD603E6B2B37E554130E5CFEEE678CE"
      cert_valid_from     = "2025-04-22"
      cert_valid_to       = "2026-04-22"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Klaukkala"
      email               = "???"
      rdn_serial_number   = "2952655-9"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1c:43:26:6c:48:48:4e:b9:75:57:a5:88:cf:b2:dc:8e"
      )
}

rule MAL_Compromised_Cert_Traffer_Mystix_SSL_com_5A556CE629496645BC608E4ED4D8C392 {
   meta:
      description         = "Detects Traffer (Mystix) with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-11"
      version             = "1.0"

      hash                = "624b6745c4d05ddcad0d60f2e169942b5575c5c423491260feb296db9b8ca9c8"
      malware             = "Traffer (Mystix)"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tim Instruments, OSOO"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5a:55:6c:e6:29:49:66:45:bc:60:8e:4e:d4:d8:c3:92"
      cert_thumbprint     = "FAF55093400CE870E055A5A6B1D1F1168D37F5F9"
      cert_valid_from     = "2025-04-11"
      cert_valid_to       = "2026-04-11"

      country             = "KG"
      state               = "???"
      locality            = "Bishkek"
      email               = "???"
      rdn_serial_number   = "31416881"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5a:55:6c:e6:29:49:66:45:bc:60:8e:4e:d4:d8:c3:92"
      )
}

rule MAL_Compromised_Cert_Traffer_SSL_com_09F47115283E8B0E17A5DD5C7EE7FCC8 {
   meta:
      description         = "Detects Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-09"
      version             = "1.0"

      hash                = "b62c954dbf527bd56e7b0660be3588cb9e361a3c22ee5677dc6ed9b0de1c97b1"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HARD - TOOLS C&C SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "09:f4:71:15:28:3e:8b:0e:17:a5:dd:5c:7e:e7:fc:c8"
      cert_thumbprint     = "33F63D4D1D932E7BBD625A6E1275305F79ECD82D"
      cert_valid_from     = "2025-06-09"
      cert_valid_to       = "2026-06-09"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Siedlce"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "09:f4:71:15:28:3e:8b:0e:17:a5:dd:5c:7e:e7:fc:c8"
      )
}

rule MAL_Compromised_Cert_Traffer_SSL_com_16E9DC8270A3A9AC9B58DE5EC7B056CB {
   meta:
      description         = "Detects Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-26"
      version             = "1.0"

      hash                = "b2031f5c2190f474165e58b28619030f4ec5e780a431bbe9941340fc348ff4d1"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BAG IT PTY LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "16:e9:dc:82:70:a3:a9:ac:9b:58:de:5e:c7:b0:56:cb"
      cert_thumbprint     = "839FAF8B95803A3639D27A7EA1D57C56C764D251"
      cert_valid_from     = "2025-05-26"
      cert_valid_to       = "2026-05-26"

      country             = "AU"
      state               = "New South Wales"
      locality            = "Sydney"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "16:e9:dc:82:70:a3:a9:ac:9b:58:de:5e:c7:b0:56:cb"
      )
}

rule MAL_Compromised_Cert_Traffer_SSL_com_425BAAE83C0A911C727A6C5714F16CA8 {
   meta:
      description         = "Detects Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-05"
      version             = "1.0"

      hash                = "cd03e9300bb9b923e4af97cde2b2b896272d803b74e42c6234f57610788053b9"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JUST MAX SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "42:5b:aa:e8:3c:0a:91:1c:72:7a:6c:57:14:f1:6c:a8"
      cert_thumbprint     = "5637D3DD966E8335F62B87ED8825D355C37C6D29"
      cert_valid_from     = "2025-05-05"
      cert_valid_to       = "2026-05-05"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warsaw"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "42:5b:aa:e8:3c:0a:91:1c:72:7a:6c:57:14:f1:6c:a8"
      )
}

rule MAL_Compromised_Cert_Traffer_SSL_com_6672D114EC2AB8101DCAFCCB0FCF56D6 {
   meta:
      description         = "Detects Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-16"
      version             = "1.0"

      hash                = "46e6e4d2e67b95c2e37c2dc43aeb857cf2cf1a350591881454e6cc5b83a88116"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Miralys Communications Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "66:72:d1:14:ec:2a:b8:10:1d:ca:fc:cb:0f:cf:56:d6"
      cert_thumbprint     = "70111568B476021235D68332E06A8BFA4CCA8EBE"
      cert_valid_from     = "2025-09-16"
      cert_valid_to       = "2026-09-12"

      country             = "CA"
      state               = "Quebec"
      locality            = "Québec"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "66:72:d1:14:ec:2a:b8:10:1d:ca:fc:cb:0f:cf:56:d6"
      )
}

rule MAL_Compromised_Cert_Traffer_SSL_com_75A5A24642FCFDABE71A318AA28AA5BF {
   meta:
      description         = "Detects Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-14"
      version             = "1.0"

      hash                = "875c1a2a1971d3f406c77195f9643a26514047e0d403b49d1a6345e2826f83ee"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IT POLONIA SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "75:a5:a2:46:42:fc:fd:ab:e7:1a:31:8a:a2:8a:a5:bf"
      cert_thumbprint     = "FDFF8EA213A4E794D6871C380AE25075D051B1B5"
      cert_valid_from     = "2025-05-14"
      cert_valid_to       = "2026-05-14"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "75:a5:a2:46:42:fc:fd:ab:e7:1a:31:8a:a2:8a:a5:bf"
      )
}

rule MAL_Compromised_Cert_Traffer_SSL_com_7BC02CACE5CED69F028420070DE45873 {
   meta:
      description         = "Detects Traffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-13"
      version             = "1.0"

      hash                = "c91645a923a96e4f03687f51e6569e448a10fd8d5493e451cbe2d94eedb36578"
      malware             = "Traffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DIG TECH SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7b:c0:2c:ac:e5:ce:d6:9f:02:84:20:07:0d:e4:58:73"
      cert_thumbprint     = "09FD02E91ED02CFD57C31248944F24AFDF11CEC0"
      cert_valid_from     = "2025-06-13"
      cert_valid_to       = "2026-06-13"

      country             = "PL"
      state               = "Silesian Voivodeship"
      locality            = "Ruda Śląska"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7b:c0:2c:ac:e5:ce:d6:9f:02:84:20:07:0d:e4:58:73"
      )
}

rule MAL_Compromised_Cert_TransferLoader_GlobalSign_05DF1C7B2BCB141609A58A27 {
   meta:
      description         = "Detects TransferLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-27"
      version             = "1.0"

      hash                = "21a262cab858944181d01b1bdeba51c8f4dab8e4f064a12c614eb89c294d94c5"
      malware             = "TransferLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was disguised as a resume and a PDF. It uses a PDF as a decoy. See this blog for more details on the malware family: https://www.zscaler.com/blogs/security-research/technical-analysis-transferloader"

      signer              = "LLC Okrasheno"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "05:df:1c:7b:2b:cb:14:16:09:a5:8a:27"
      cert_thumbprint     = "3055ED9CE7BEFBD520146CE08AE4DE65EA826A2D"
      cert_valid_from     = "2025-05-27"
      cert_valid_to       = "2026-05-28"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "05:df:1c:7b:2b:cb:14:16:09:a5:8a:27"
      )
}

rule MAL_Compromised_Cert_TransferLoader_Sectigo_2D1DC3C2E0B0682AB3594E5237DD7C23 {
   meta:
      description         = "Detects TransferLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-22"
      version             = "1.0"

      hash                = "ca4890fb8c7b69bb75b522746e2e96ce8b4459ff1fa25c679bc13f1183230b70"
      malware             = "TransferLoader"
      malware_type        = "Initial access tool"
      malware_notes       = "This malware was disguised as a resume and a PDF. It uses a PDF as a decoy. See this blog for more details on the malware family: https://www.zscaler.com/blogs/security-research/technical-analysis-transferloader"

      signer              = "Dongguan Yingping Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "2d:1d:c3:c2:e0:b0:68:2a:b3:59:4e:52:37:dd:7c:23"
      cert_thumbprint     = "7440B35E9B9E3140A702AA5A182A7D1869F73462"
      cert_valid_from     = "2025-10-22"
      cert_valid_to       = "2027-01-20"

      country             = "CN"
      state               = "Guangdong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "2d:1d:c3:c2:e0:b0:68:2a:b3:59:4e:52:37:dd:7c:23"
      )
}

rule MAL_Compromised_Cert_TrickBot_DigiCert_082023879112289BF351D297CC8EFCFC {
   meta:
      description         = "Detects TrickBot with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-11-11"
      version             = "1.0"

      hash                = "1689b812aa652c7ac24aa9e71ef5bba8b2dde899b64da8b7df083d5c5c830746"
      malware             = "TrickBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "STA-R TOV"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "08:20:23:87:91:12:28:9b:f3:51:d2:97:cc:8e:fc:fc"
      cert_thumbprint     = "C6EEA9DFCF7146D075A724588DCF4A00A9C50565"
      cert_valid_from     = "2019-11-11"
      cert_valid_to       = "2020-11-18"

      country             = "UA"
      state               = "Dnipropetrovsk Oblast"
      locality            = "Kryvyi Rih"
      email               = "???"
      rdn_serial_number   = "39768949"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "08:20:23:87:91:12:28:9b:f3:51:d2:97:cc:8e:fc:fc"
      )
}

rule MAL_Compromised_Cert_TrickBot_Sectigo_00AFC5522898143AAFAAB7FD52304CF00C {
   meta:
      description         = "Detects TrickBot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-05-31"
      version             = "1.0"

      hash                = "84175ba73a6a59496e2d020d05a120e9e8e94ac3a4fdea8fc381acda452bb991"
      malware             = "TrickBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "YAN CHING LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "00:af:c5:52:28:98:14:3a:af:aa:b7:fd:52:30:4c:f0:0c"
      cert_thumbprint     = "10232012CCD37D90EAD875CCD64414D87DE329A5"
      cert_valid_from     = "2021-05-31"
      cert_valid_to       = "2022-05-31"

      country             = "GB"
      state               = "North Humberside"
      locality            = "HULL"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "00:af:c5:52:28:98:14:3a:af:aa:b7:fd:52:30:4c:f0:0c"
      )
}

rule MAL_Compromised_Cert_TrojanNetExtender_GlobalSign_1CB4DC9635AA0A7F6D3A985B {
   meta:
      description         = "Detects TrojanNetExtender with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "d883c067f060e0f9643667d83ff7bc55a218151df600b18991b50a4ead513364"
      malware             = "TrojanNetExtender"
      malware_type        = "Trojan"
      malware_notes       = "This was a trojanized VPN client pushed through advertising. Per SonicWall, the malware would send the user's configuration to the attacker : https://www.sonicwall.com/blog/threat-actors-modify-and-re-create-commercial-software-to-steal-users-information"

      signer              = "CITYLIGHT MEDIA PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1c:b4:dc:96:35:aa:0a:7f:6d:3a:98:5b"
      cert_thumbprint     = "A01D612409D9839CCCD24174D31A183C6913EBB6"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-22"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "???"
      rdn_serial_number   = "U74999RJ2020PTC072674"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1c:b4:dc:96:35:aa:0a:7f:6d:3a:98:5b"
      )
}

rule MAL_Compromised_Cert_TrojanNetExtender_GlobalSign_2A687CED2A903566E1EA421C {
   meta:
      description         = "Detects TrojanNetExtender with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-06"
      version             = "1.0"

      hash                = "f7420e3210cec73b40102208bfeb6ea07be84c3fa7aa0f4cb809c68323e7c4c2"
      malware             = "TrojanNetExtender"
      malware_type        = "Trojan"
      malware_notes       = "This was a trojanized VPN client pushed through advertising. Per SonicWall, the malware would send the user's configuration to the attacker : https://www.sonicwall.com/blog/threat-actors-modify-and-re-create-commercial-software-to-steal-users-information"

      signer              = "MOHAN ENTERPRISES (RAJASTHAN) PVT LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2a:68:7c:ed:2a:90:35:66:e1:ea:42:1c"
      cert_thumbprint     = "61E52B4F0312500CF72D6A14B304205C4F9CBB22"
      cert_valid_from     = "2025-08-06"
      cert_valid_to       = "2026-08-07"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "mohanmohitrana@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2a:68:7c:ed:2a:90:35:66:e1:ea:42:1c"
      )
}

rule MAL_Compromised_Cert_TrojanNetExtender_Microsoft_330003D0E5F6C1943A350E542100000003D0E5 {
   meta:
      description         = "Detects TrojanNetExtender with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-31"
      version             = "1.0"

      hash                = "9dbbe4cc89ef76681e435843bb77addc31349a30a5c13059bf0221ca2df75dee"
      malware             = "TrojanNetExtender"
      malware_type        = "Trojan"
      malware_notes       = "This was a trojanized VPN client pushed through advertising. Per SonicWall, the malware would send the user's configuration to the attacker : https://www.sonicwall.com/blog/threat-actors-modify-and-re-create-commercial-software-to-steal-users-information"

      signer              = "ACQUISITEX IMMOBILIER INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:03:d0:e5:f6:c1:94:3a:35:0e:54:21:00:00:00:03:d0:e5"
      cert_thumbprint     = "2872C9B66D5B115E531BA99BCC1D69DDD6872FFC"
      cert_valid_from     = "2025-07-31"
      cert_valid_to       = "2025-08-03"

      country             = "CA"
      state               = "Québec"
      locality            = "Montréal"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:03:d0:e5:f6:c1:94:3a:35:0e:54:21:00:00:00:03:d0:e5"
      )
}

rule MAL_Compromised_Cert_TrojanPuTTy_GlobalSign_7F422097F4E947783EFBDF7D {
   meta:
      description         = "Detects TrojanPuTTy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "650d8b95e4fe29336c53d3d4b7d67375743cf9a32fe7630447cd48a7682e06f8"
      malware             = "TrojanPuTTy"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PUSHYAMITR SECURITY SERVICE PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7f:42:20:97:f4:e9:47:78:3e:fb:df:7d"
      cert_thumbprint     = "39700A1B0CCFA238054E1C6D96298A8E9158D8E6"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-26"

      country             = "IN"
      state               = "Bihar"
      locality            = "Muzaffarpur"
      email               = "dhirajpss2018@gmail.com"
      rdn_serial_number   = "U74999BR2018PTC037680"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7f:42:20:97:f4:e9:47:78:3e:fb:df:7d"
      )
}

rule MAL_Compromised_Cert_Trojan_Banker_GlobalSign_6A7B1E613F855E13416DF15F {
   meta:
      description         = "Detects Trojan_Banker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-19"
      version             = "1.0"

      hash                = "b8086bb67c64728a5043f670920d37b6e37ae69d75f0dc50cd142aa99196a710"
      malware             = "Trojan_Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TNH99 VIET NAM JOINT STOCK COMPANY"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6a:7b:1e:61:3f:85:5e:13:41:6d:f1:5f"
      cert_thumbprint     = "A2DCC193BFDF1E678F6E903C8B10311BCBA2997D"
      cert_valid_from     = "2024-08-19"
      cert_valid_to       = "2025-08-20"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "???"
      rdn_serial_number   = "0108300979"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6a:7b:1e:61:3f:85:5e:13:41:6d:f1:5f"
      )
}

rule MAL_Compromised_Cert_Trojan_Banker_SSL_com_3FE13C520C9758C4A4A7084862E2C191 {
   meta:
      description         = "Detects Trojan_Banker with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-11-03"
      version             = "1.0"

      hash                = "c679fa9ed7bc1fb3d574ad5b38b0a06717a8861cdd82ae8adb61d7f1242a7bd1"
      malware             = "Trojan_Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SIA GSM design"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3f:e1:3c:52:0c:97:58:c4:a4:a7:08:48:62:e2:c1:91"
      cert_thumbprint     = "3CC34712BC3881634197D75216B99B99FBFE567A"
      cert_valid_from     = "2023-11-03"
      cert_valid_to       = "2024-11-02"

      country             = "LV"
      state               = "Ādažu pagasts"
      locality            = "Ādaži"
      email               = "???"
      rdn_serial_number   = "40203258355"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3f:e1:3c:52:0c:97:58:c4:a4:a7:08:48:62:e2:c1:91"
      )
}

rule MAL_Compromised_Cert_Trojan_DigiCert_0144C41E1909E7332C5BA64F0042EE86 {
   meta:
      description         = "Detects Trojan with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-23"
      version             = "1.0"

      hash                = "90465f4f59fc9fb29d12d44765712ce97c3f9cb9067ee33c2d6f2abf88c87190"
      malware             = "Trojan"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangxi Yunao Network Technology Co. Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "01:44:c4:1e:19:09:e7:33:2c:5b:a6:4f:00:42:ee:86"
      cert_thumbprint     = "FE186438F2ABEF2DDA453E52E51F852147DE2E7D"
      cert_valid_from     = "2023-05-23"
      cert_valid_to       = "2024-06-14"

      country             = "CN"
      state               = "Guangxi Zhuang Autonomous Region"
      locality            = "Beihai"
      email               = "???"
      rdn_serial_number   = "91450500MAA7H9NJ04"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "01:44:c4:1e:19:09:e7:33:2c:5b:a6:4f:00:42:ee:86"
      )
}

rule MAL_Compromised_Cert_Trojan_DigiCert_0D16167519B24B5B2410B9016D5E0782 {
   meta:
      description         = "Detects Trojan with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-05-30"
      version             = "1.0"

      hash                = "42c3483fbf438233db25a0fbdc8636ac3e6bfe374fdd929b2c0fcbc108a45c6a"
      malware             = "Trojan"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangxi Yunao Network Technology Co., Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:16:16:75:19:b2:4b:5b:24:10:b9:01:6d:5e:07:82"
      cert_thumbprint     = "492c5d36b26fb2b1931805580f0630a6807d27cc8ac53fd4e6634e62e84ebfa9"
      cert_valid_from     = "2022-05-30"
      cert_valid_to       = "2023-05-30"

      country             = "CN"
      state               = "Guangxi"
      locality            = "Beihai"
      email               = "???"
      rdn_serial_number   = "91450500MAA7H9NJ04"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:16:16:75:19:b2:4b:5b:24:10:b9:01:6d:5e:07:82"
      )
}

rule MAL_Compromised_Cert_Trojan_Win64_Zapchast_ffs_Certum_33C6CBB8827B6F181A449D2027A94E45 {
   meta:
      description         = "Detects Trojan.Win64.Zapchast.ffs with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-27"
      version             = "1.0"

      hash                = "6de97e8d1fce40daaa3453d5ec1a74741b7139f160a02dca235c62be1aaf08f9"
      malware             = "Trojan.Win64.Zapchast.ffs"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Capybara Technology Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "33:c6:cb:b8:82:7b:6f:18:1a:44:9d:20:27:a9:4e:45"
      cert_thumbprint     = "937b9ea609fa9f33a542ebb196733740509c7c720bd72f5e16c9d1921f32ef57"
      cert_valid_from     = "2025-04-27"
      cert_valid_to       = "2026-04-27"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "33:c6:cb:b8:82:7b:6f:18:1a:44:9d:20:27:a9:4e:45"
      )
}

rule MAL_Compromised_Cert_TrojanizedDiskView_GlobalSign_022A5CB6AEA27E2274822449 {
   meta:
      description         = "Detects TrojanizedDiskView with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-02"
      version             = "1.0"

      hash                = "2d9aa7d032f1bce7932c36e2b164c90badc68080e2e917e4cd24266f504cbfa1"
      malware             = "TrojanizedDiskView"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC GlobalGoods Supply"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "02:2a:5c:b6:ae:a2:7e:22:74:82:24:49"
      cert_thumbprint     = "137A346A7DF9273EAE3D1C92AA1CF7925125D79F"
      cert_valid_from     = "2025-04-02"
      cert_valid_to       = "2026-04-03"

      country             = "KG"
      state               = "Bishkek"
      locality            = "Bishkek"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "02:2a:5c:b6:ae:a2:7e:22:74:82:24:49"
      )
}

rule MAL_Compromised_Cert_TrojanizedTrading_GlobalSign_6968631F56D94F189DA04A7A {
   meta:
      description         = "Detects TrojanizedTrading with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "168002d1fd7f71fce5a08fb1b1fdeac1a8afec8a5f3465245ba87ccc9b2b6a37"
      malware             = "TrojanizedTrading"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chengdu Pengliang Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "69:68:63:1f:56:d9:4f:18:9d:a0:4a:7a"
      cert_thumbprint     = "0286243AF1F58A6ECDEC75EE9D380681556B06DD"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2026-06-13"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "69:68:63:1f:56:d9:4f:18:9d:a0:4a:7a"
      )
}

rule MAL_Compromised_Cert_TrueBot_Sectigo_00BE2F22C152BB218B898C4029056816A9 {
   meta:
      description         = "Detects TrueBot with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-02-13"
      version             = "1.0"

      hash                = "c0f8aeeb2d11c6e751ee87c40ee609aceb1c1036706a5af0d3d78738b6cc4125"
      malware             = "TrueBot"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Marts GmbH"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:be:2f:22:c1:52:bb:21:8b:89:8c:40:29:05:68:16:a9"
      cert_thumbprint     = "85FE11E799609306516D82E026D4BAEF4C1E9AD3"
      cert_valid_from     = "2023-02-13"
      cert_valid_to       = "2024-02-13"

      country             = "AT"
      state               = "Steiermark"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:be:2f:22:c1:52:bb:21:8b:89:8c:40:29:05:68:16:a9"
      )
}

rule MAL_Compromised_Cert_TurboFixPDF_Sectigo_00AF1989410F0529DD265B60481F4A1405 {
   meta:
      description         = "Detects TurboFixPDF with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-19"
      version             = "1.0"

      hash                = "d799cc1713932e9748ec9d293f831d150e1e345c0e58279cd7c3e49c35e667be"
      malware             = "TurboFixPDF"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DataX Engine LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:af:19:89:41:0f:05:29:dd:26:5b:60:48:1f:4a:14:05"
      cert_thumbprint     = "2DF81AB14A5794F22722983AB3D8E8D7D643908B"
      cert_valid_from     = "2024-07-19"
      cert_valid_to       = "2025-07-19"

      country             = "US"
      state               = "Delaware"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:af:19:89:41:0f:05:29:dd:26:5b:60:48:1f:4a:14:05"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_3C192FDE50CE091695FEC747 {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-26"
      version             = "1.0"

      hash                = "ddc4e905066f11ac1703175c5fe3d0a76b337a7083f27107484baa5feb855778"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "BINARYPI TECH INC."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3c:19:2f:de:50:ce:09:16:95:fe:c7:47"
      cert_thumbprint     = "fe6bb6ca2d79762bb663b9aa96277188ce5fa3b3a50ec1ee39a6b5bdd070dc58"
      cert_valid_from     = "2024-12-26"
      cert_valid_to       = "2025-12-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "1138775-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3c:19:2f:de:50:ce:09:16:95:fe:c7:47"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_3EF13BB6830AE946A66559D4 {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-04"
      version             = "1.0"

      hash                = "db5cc6b8d0384176adc1349733e516cd17bbd4d29de8cb96f7ccfa5cd6a5199f"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "PURPLE SALES LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3e:f1:3b:b6:83:0a:e9:46:a6:65:59:d4"
      cert_thumbprint     = "83754BA05B499A26C2699DB7250ADABCE0269DFD"
      cert_valid_from     = "2025-08-04"
      cert_valid_to       = "2026-08-05"

      country             = "IN"
      state               = "West Bengal"
      locality            = "Kolkata"
      email               = "purplegroupindia@gmail.com"
      rdn_serial_number   = "AAN-1168"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3e:f1:3b:b6:83:0a:e9:46:a6:65:59:d4"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_4169E1D8BB961B8815ADA210 {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-07"
      version             = "1.0"

      hash                = "7e05b76b877e2cf8d191877c490daee1030c75d8fc1bb1428f78e8880890e046"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "COMPAÑIA DE DESARROLLO DE VEHICULOS Y BICICLETAS ELECTRICAS SL"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "41:69:e1:d8:bb:96:1b:88:15:ad:a2:10"
      cert_thumbprint     = "E677C66C44403DFB15FB3415C6EBC9E2F9A8BA37"
      cert_valid_from     = "2025-08-07"
      cert_valid_to       = "2026-08-08"

      country             = "ES"
      state               = "Málaga"
      locality            = "Málaga"
      email               = "???"
      rdn_serial_number   = "B93271294"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "41:69:e1:d8:bb:96:1b:88:15:ad:a2:10"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_5B71AF90AE6F6C6424BBFB1B {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-05"
      version             = "1.0"

      hash                = "ef2d8f433a896575442c13614157261b32dd4b2a1210aca3be601d301feb1fef"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Fukoku TOKAI(Shanghai) Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5b:71:af:90:ae:6f:6c:64:24:bb:fb:1b"
      cert_thumbprint     = "94EEBFC9A334B52FE42535DD0F2D4B052FB3D3D5"
      cert_valid_from     = "2024-11-05"
      cert_valid_to       = "2025-11-06"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "dev@fukokutokai.com"
      rdn_serial_number   = "91310000566556497T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5b:71:af:90:ae:6f:6c:64:24:bb:fb:1b"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_6386FDF30F59906C2AADCAF1 {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-26"
      version             = "1.0"

      hash                = "d7ba2559c546275420c9ae4a7640af759cee72a10266f9db6f6846a61979f288"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "LLC Grayauto"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "63:86:fd:f3:0f:59:90:6c:2a:ad:ca:f1"
      cert_thumbprint     = "8735CD67B734549F57104C77524CBD8B3E5963ED"
      cert_valid_from     = "2025-03-26"
      cert_valid_to       = "2026-03-27"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "63:86:fd:f3:0f:59:90:6c:2a:ad:ca:f1"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_7B1CBB403DB37D45ABC2C210 {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "83db121492b9df5dfb359c830d0adb7deb9107fbf0101ba7ae4c0a863b0bd723"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "MSSM UJJAWAL NIDHI LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7b:1c:bb:40:3d:b3:7d:45:ab:c2:c2:10"
      cert_thumbprint     = "BD3359A19103FBD64678451D2C77E0982BC5B828"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-07-31"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "ujjawalnidhi.abhi@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7b:1c:bb:40:3d:b3:7d:45:ab:c2:c2:10"
      )
}

rule MAL_Compromised_Cert_UNK_50_GlobalSign_7DF689782340B9095FC6A73D {
   meta:
      description         = "Detects UNK-50 with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-11"
      version             = "1.0"

      hash                = "517b5e0180f10c4fd3e546834a0309cebba804cc0f7273aab7cbd66b20ee2d63"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Service LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7d:f6:89:78:23:40:b9:09:5f:c6:a7:3d"
      cert_thumbprint     = "5392FAFF652E01DF1551AE5B7A82423F0F7341BE"
      cert_valid_from     = "2025-06-11"
      cert_valid_to       = "2026-06-12"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7d:f6:89:78:23:40:b9:09:5f:c6:a7:3d"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300042A880AF0AFCEF7498CA3000000042A88 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-29"
      version             = "1.0"

      hash                = "f8abde1581a8686dedab6c5de941fd344af5dbc501709832ffceafd968c5c392"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "OTHENTIKA VOYAGE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:2a:88:0a:f0:af:ce:f7:49:8c:a3:00:00:00:04:2a:88"
      cert_thumbprint     = "149F587D46EB743E0965EC1292F260A4B0DD60B3"
      cert_valid_from     = "2025-08-29"
      cert_valid_to       = "2025-09-01"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Bruno-de-Montarville"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:2a:88:0a:f0:af:ce:f7:49:8c:a3:00:00:00:04:2a:88"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330004A0A3B16BF9CAEF47D9E900000004A0A3 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-03"
      version             = "1.0"

      hash                = "43761d77921f37c8f8730610186eac17d18aaacc4ad51ec512e25ca953bb3426"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:a0:a3:b1:6b:f9:ca:ef:47:d9:e9:00:00:00:04:a0:a3"
      cert_thumbprint     = "E2369456FAD836C20E3E6E431C289FF3E91E6854"
      cert_valid_from     = "2025-10-03"
      cert_valid_to       = "2025-10-06"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:a0:a3:b1:6b:f9:ca:ef:47:d9:e9:00:00:00:04:a0:a3"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330004A8FCDD16B3741E8F880300000004A8FC {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-05"
      version             = "1.0"

      hash                = "ac3ae76eef76ee71fa460c2846da5efd0d9eb76ccb32c192d60d611040d411aa"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:a8:fc:dd:16:b3:74:1e:8f:88:03:00:00:00:04:a8:fc"
      cert_thumbprint     = "9CD750DD107519B4C856C18011FB7ECF681C8B1E"
      cert_valid_from     = "2025-10-05"
      cert_valid_to       = "2025-10-08"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:a8:fc:dd:16:b3:74:1e:8f:88:03:00:00:00:04:a8:fc"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330004D6BAE7BC440382EB85AB00000004D6BA {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-15"
      version             = "1.0"

      hash                = "d51fba7506ff0417aede5f557fea570ca7cdcd789e2b0c224478434e89665474"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:d6:ba:e7:bc:44:03:82:eb:85:ab:00:00:00:04:d6:ba"
      cert_thumbprint     = "0DE8CB37B36AE5B167077C7EBE31301093961FCB"
      cert_valid_from     = "2025-10-15"
      cert_valid_to       = "2025-10-18"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:d6:ba:e7:bc:44:03:82:eb:85:ab:00:00:00:04:d6:ba"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330004E5855BA4C7024078696F00000004E585 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-19"
      version             = "1.0"

      hash                = "bea1aed8853dbf86cc03a6abb90949a93e26dd7b09bbf5b2bf2d3fc065a2ef95"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:04:e5:85:5b:a4:c7:02:40:78:69:6f:00:00:00:04:e5:85"
      cert_thumbprint     = "E09327FC7CFC577B001469177FE25F4057B2F72A"
      cert_valid_from     = "2025-10-19"
      cert_valid_to       = "2025-10-22"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:04:e5:85:5b:a4:c7:02:40:78:69:6f:00:00:00:04:e5:85"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330004F5200F8DFBA556AFDD5800000004F520 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-22"
      version             = "1.0"

      hash                = "20b82125c723e607546cf07356a86cdc40b079320f6f18e21a1a4ad52df86c45"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "OTHENTIKA VOYAGE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:04:f5:20:0f:8d:fb:a5:56:af:dd:58:00:00:00:04:f5:20"
      cert_thumbprint     = "5EEFFDD7BAD01107A67010B1913A1A838EFF895C"
      cert_valid_from     = "2025-08-22"
      cert_valid_to       = "2025-08-25"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Bruno-de-Montarville"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:04:f5:20:0f:8d:fb:a5:56:af:dd:58:00:00:00:04:f5:20"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330004FFBC4979498CDBFDF3BB00000004FFBC {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-23"
      version             = "1.0"

      hash                = "e9e53a0f3111e1217c088807f667b3a926b7d7ede12dc124ae814b19e92b001f"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "DIGI-FUTURE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:04:ff:bc:49:79:49:8c:db:fd:f3:bb:00:00:00:04:ff:bc"
      cert_thumbprint     = "A8E0F8825C651C68A491C2E9D6E0362D56003316"
      cert_valid_from     = "2025-10-23"
      cert_valid_to       = "2025-10-26"

      country             = "CA"
      state               = "Ontario"
      locality            = "OSHAWA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:04:ff:bc:49:79:49:8c:db:fd:f3:bb:00:00:00:04:ff:bc"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_33000502FDCEA835A43AC1E0940000000502FD {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-24"
      version             = "1.0"

      hash                = "5dae3f4a93f253c363d98b7f6873a5a3f250e763682bef06ca4fc2d84ae82189"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:02:fd:ce:a8:35:a4:3a:c1:e0:94:00:00:00:05:02:fd"
      cert_thumbprint     = "C49C6B531C60F7EA8579FBA34A16EF16E82E097F"
      cert_valid_from     = "2025-10-24"
      cert_valid_to       = "2025-10-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:02:fd:ce:a8:35:a4:3a:c1:e0:94:00:00:00:05:02:fd"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300050381CFFB7CC9298CFA06000000050381 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-24"
      version             = "1.0"

      hash                = "aae2923d1e8207e22b4a1d80b8ef6e0892a5a936b1a6eaab524f889f84751383"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "DIGI-FUTURE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:03:81:cf:fb:7c:c9:29:8c:fa:06:00:00:00:05:03:81"
      cert_thumbprint     = "95D89A34564A2A7953B9B457E5E98C9C77622D72"
      cert_valid_from     = "2025-10-24"
      cert_valid_to       = "2025-10-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "OSHAWA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:03:81:cf:fb:7c:c9:29:8c:fa:06:00:00:00:05:03:81"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_33000516EAAA0A5669159912530000000516EA {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-01"
      version             = "1.0"

      hash                = "483c35e6be39edb99e21bd9f496c7d644651c7fda5a1ec66c95ea22ff82475a5"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "DIGI-FUTURE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:16:ea:aa:0a:56:69:15:99:12:53:00:00:00:05:16:ea"
      cert_thumbprint     = "84949E65AFB428195932CB57BBF255F20BDD59AC"
      cert_valid_from     = "2025-11-01"
      cert_valid_to       = "2025-11-04"

      country             = "CA"
      state               = "Ontario"
      locality            = "OSHAWA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:16:ea:aa:0a:56:69:15:99:12:53:00:00:00:05:16:ea"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300052571A94F9EB520095835000000052571 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-24"
      version             = "1.0"

      hash                = "9b53444640115a6ee3eca9da396a65bf3bbb59d565a849ab014a011445136af1"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "OTHENTIKA VOYAGE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:25:71:a9:4f:9e:b5:20:09:58:35:00:00:00:05:25:71"
      cert_thumbprint     = "225336777EE8F95AE4DB293A090AF72CC8FCCEFF"
      cert_valid_from     = "2025-08-24"
      cert_valid_to       = "2025-08-27"

      country             = "CA"
      state               = "Québec"
      locality            = "Saint-Bruno-de-Montarville"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:25:71:a9:4f:9e:b5:20:09:58:35:00:00:00:05:25:71"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300052E8E560CED4283A99362000000052E8E {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-08"
      version             = "1.0"

      hash                = "87874daf50126287e8127bf27f9d69c79bf260594324b12ff1cda393df77dea8"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "DIGI-FUTURE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:2e:8e:56:0c:ed:42:83:a9:93:62:00:00:00:05:2e:8e"
      cert_thumbprint     = "6EC8D8698AB8AA9869E0FEDED2EA167BAFDEDB1B"
      cert_valid_from     = "2025-11-08"
      cert_valid_to       = "2025-11-11"

      country             = "CA"
      state               = "Ontario"
      locality            = "OSHAWA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:2e:8e:56:0c:ed:42:83:a9:93:62:00:00:00:05:2e:8e"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_33000533704E59FA6459994230000000053370 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-28"
      version             = "1.0"

      hash                = "4ab1ab98fee5f786837afa7d8aadc0245cbf133e4b3eb74974b564b8d972868b"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "BLUE STONE REALTIES INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:33:70:4e:59:fa:64:59:99:42:30:00:00:00:05:33:70"
      cert_thumbprint     = "2FC01A1C41017B346BCE390528BE4CD0A1EB65F3"
      cert_valid_from     = "2025-08-28"
      cert_valid_to       = "2025-08-31"

      country             = "CA"
      state               = "Québec"
      locality            = "Montréal"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:33:70:4e:59:fa:64:59:99:42:30:00:00:00:05:33:70"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_33000536BE6C7D73B4A2FC97EF0000000536BE {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-14"
      version             = "1.0"

      hash                = "a0ae809ca1cb6cc1ef508bc1c9627c076761ac2a3cf3993fa9e63862a17d05b1"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "JAMES BARRIERE FOUNDATION FOR THE UNDERPRIVILEGED"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:36:be:6c:7d:73:b4:a2:fc:97:ef:00:00:00:05:36:be"
      cert_thumbprint     = "B5C9A1498A887067A8E8F3EC1B5BBC75D7227F3E"
      cert_valid_from     = "2025-11-14"
      cert_valid_to       = "2025-11-17"

      country             = "CA"
      state               = "Québec"
      locality            = "MONTREAL"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:36:be:6c:7d:73:b4:a2:fc:97:ef:00:00:00:05:36:be"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330005750BD2CF0F3CFC3D4FC300000005750B {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-13"
      version             = "1.0"

      hash                = "5fbee3b9e0286e54981bb7794d72b6a3e96a57eed1f7d2f8b4fcd6eb7a1a6df1"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "AUTOMOBILITY ENTERPRISES INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:75:0b:d2:cf:0f:3c:fc:3d:4f:c3:00:00:00:05:75:0b"
      cert_thumbprint     = "A1114DF146F9B0CEAB4B995E6F25B959EE7001AE"
      cert_valid_from     = "2025-09-13"
      cert_valid_to       = "2025-09-16"

      country             = "CA"
      state               = "Ontario"
      locality            = "Windsor"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:75:0b:d2:cf:0f:3c:fc:3d:4f:c3:00:00:00:05:75:0b"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330005807C36352DBA0F6900A000000005807C {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-29"
      version             = "1.0"

      hash                = "1dd4039f737b824e838aea6d13126b18377fda239777e5c38c1bc3b409ad07a9"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JAMES BARRIERE FOUNDATION FOR THE UNDERPRIVILEGED"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:80:7c:36:35:2d:ba:0f:69:00:a0:00:00:00:05:80:7c"
      cert_thumbprint     = "EA31234FDD415B49086C0CD8BBD3D9950E997AAB"
      cert_valid_from     = "2025-11-29"
      cert_valid_to       = "2025-12-02"

      country             = "CA"
      state               = "Québec"
      locality            = "MONTREAL"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:80:7c:36:35:2d:ba:0f:69:00:a0:00:00:00:05:80:7c"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330005A844DE10AEE66D4A060700000005A844 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-07"
      version             = "1.0"

      hash                = "39f9674b361e83875a551bd09a49d0cc152c7fcb70f3a62970cf13a4871b97b6"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Next-Gen Supplements Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:a8:44:de:10:ae:e6:6d:4a:06:07:00:00:00:05:a8:44"
      cert_thumbprint     = "392794012DAF0A5BA34BD91426BA274860FE19A8"
      cert_valid_from     = "2025-12-07"
      cert_valid_to       = "2025-12-10"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:a8:44:de:10:ae:e6:6d:4a:06:07:00:00:00:05:a8:44"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330005C28FC1E398D5899CAFC500000005C28F {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-15"
      version             = "1.0"

      hash                = "559ebdf59f0eaa0f17bcb82750df2d8376020308fe4c89cbe23bcd159cd93a11"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Next-Gen Supplements Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 02"
      cert_serial         = "33:00:05:c2:8f:c1:e3:98:d5:89:9c:af:c5:00:00:00:05:c2:8f"
      cert_thumbprint     = "89812B1AC6AC642AD2E2DF529BAC86A2B340696C"
      cert_valid_from     = "2025-12-15"
      cert_valid_to       = "2025-12-18"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 02" and
         sig.serial == "33:00:05:c2:8f:c1:e3:98:d5:89:9c:af:c5:00:00:00:05:c2:8f"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330005CF0655374B893F5E81FB00000005CF06 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-14"
      version             = "1.0"

      hash                = "5d89855c2ee1067ea43cba8ec65053695aa1cb846a31fbfd6a8e33b6ff62d3fb"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "IGNITE ARTIST MOVEMENT"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:cf:06:55:37:4b:89:3f:5e:81:fb:00:00:00:05:cf:06"
      cert_thumbprint     = "5C9647F9D94F3518B1A5514692AEA422CDFEAAD9"
      cert_valid_from     = "2025-10-14"
      cert_valid_to       = "2025-10-17"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:cf:06:55:37:4b:89:3f:5e:81:fb:00:00:00:05:cf:06"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330005F1729479FFB85A61F52300000005F172 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-25"
      version             = "1.0"

      hash                = "73aa0283c46a9a3b05a9f9480459d19eccbdec33b7ef10a341b0f0b72a4bb74f"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "DIGI-FUTURE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:f1:72:94:79:ff:b8:5a:61:f5:23:00:00:00:05:f1:72"
      cert_thumbprint     = "80AA94838683743BB712815DB5A10880A45ED2B4"
      cert_valid_from     = "2025-10-25"
      cert_valid_to       = "2025-10-28"

      country             = "CA"
      state               = "Ontario"
      locality            = "OSHAWA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:f1:72:94:79:ff:b8:5a:61:f5:23:00:00:00:05:f1:72"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300061679ED17C5D7528DF0E2000000061679 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-02"
      version             = "1.0"

      hash                = "e132be181eb9a803a95b4009de529fa1db1ccc7b8fc8b19dc17d1b9eb26bac14"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "THROGGS NECK PETS INCORPORATED"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:16:79:ed:17:c5:d7:52:8d:f0:e2:00:00:00:06:16:79"
      cert_thumbprint     = "7F67320BA860CC72D831991AC5DB81CEA0468DD1"
      cert_valid_from     = "2025-11-02"
      cert_valid_to       = "2025-11-05"

      country             = "US"
      state               = "New York"
      locality            = "BRONX"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:16:79:ed:17:c5:d7:52:8d:f0:e2:00:00:00:06:16:79"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300061C84BFC0AA8EABB74882000000061C84 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-03"
      version             = "1.0"

      hash                = "82f2ff57ddea19e800d00c31e8625c39582b483c62e35d9f83de9327e880b044"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "DIGI-FUTURE INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:1c:84:bf:c0:aa:8e:ab:b7:48:82:00:00:00:06:1c:84"
      cert_thumbprint     = "A3EF800D1C5BBEF950501DA09051D2A78B47FC00"
      cert_valid_from     = "2025-11-03"
      cert_valid_to       = "2025-11-06"

      country             = "CA"
      state               = "Ontario"
      locality            = "OSHAWA"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:1c:84:bf:c0:aa:8e:ab:b7:48:82:00:00:00:06:1c:84"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330006606869B9CF8308143BF0000000066068 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-04"
      version             = "1.0"

      hash                = "fa00db3864d8f5d471449f5df75c5006c054a474c1f62f7d9a3d6633c8d9bdf3"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Next-Gen Supplements Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:60:68:69:b9:cf:83:08:14:3b:f0:00:00:00:06:60:68"
      cert_thumbprint     = "ED7672988AA10F82D4B1E57B6FD0010FE829FBDB"
      cert_valid_from     = "2025-12-04"
      cert_valid_to       = "2025-12-07"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:60:68:69:b9:cf:83:08:14:3b:f0:00:00:00:06:60:68"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_33000672B8B19DE992389240140000000672B8 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-09"
      version             = "1.0"

      hash                = "a380fcaa1ff910f507ee16a65efba06940e62223a077e0c1e7d8ade2407a230d"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Next-Gen Supplements Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:06:72:b8:b1:9d:e9:92:38:92:40:14:00:00:00:06:72:b8"
      cert_thumbprint     = "CF72B637E6D1513555903408AA088BFB92C8713C"
      cert_valid_from     = "2025-12-09"
      cert_valid_to       = "2025-12-12"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:06:72:b8:b1:9d:e9:92:38:92:40:14:00:00:00:06:72:b8"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330006782DA6C8B6CE5664F88500000006782D {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-28"
      version             = "1.0"

      hash                = "8cb3a5a1a3ae192018049dcbf37f58678e0c21323f9ddd7e1201d695d1b1826b"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JAMES BARRIERE FOUNDATION FOR THE UNDERPRIVILEGED"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:78:2d:a6:c8:b6:ce:56:64:f8:85:00:00:00:06:78:2d"
      cert_thumbprint     = "5411F2062BBB085787A9A65C8FCEED1B47CB7061"
      cert_valid_from     = "2025-11-28"
      cert_valid_to       = "2025-12-01"

      country             = "CA"
      state               = "Québec"
      locality            = "MONTREAL"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:78:2d:a6:c8:b6:ce:56:64:f8:85:00:00:00:06:78:2d"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_3300068DF638676D7B9B83BBDE000000068DF6 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-04"
      version             = "1.0"

      hash                = "18d2b0d6570896e86fb5478acfa752d6ae0afe9e79859e2d0de27720db20184b"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THROGGS NECK PETS INCORPORATED"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:8d:f6:38:67:6d:7b:9b:83:bb:de:00:00:00:06:8d:f6"
      cert_thumbprint     = "CABAE0BE0F0343792E984FD73040EF3D86243A7D"
      cert_valid_from     = "2025-12-04"
      cert_valid_to       = "2025-12-07"

      country             = "US"
      state               = "New York"
      locality            = "BRONX"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:8d:f6:38:67:6d:7b:9b:83:bb:de:00:00:00:06:8d:f6"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330006B17881564C863F9CFE9900000006B178 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-13"
      version             = "1.0"

      hash                = "02126326250b28820ccdaf2b9c4ba2d14f6dbeff906f17ee72ba141fcf45263b"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Next-Gen Supplements Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:b1:78:81:56:4c:86:3f:9c:fe:99:00:00:00:06:b1:78"
      cert_thumbprint     = "E79D79F5CFAD917C9E411E509C325F38946F6261"
      cert_valid_from     = "2025-12-13"
      cert_valid_to       = "2025-12-16"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:b1:78:81:56:4c:86:3f:9c:fe:99:00:00:00:06:b1:78"
      )
}

rule MAL_Compromised_Cert_UNK_50_Microsoft_330006BD17074683368C2F606300000006BD17 {
   meta:
      description         = "Detects UNK-50 with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-16"
      version             = "1.0"

      hash                = "6fd3424fda119628855ed5f1efc14fc619e5eff3e229d483185e114da4c2509f"
      malware             = "UNK-50"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Next-Gen Supplements Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:bd:17:07:46:83:36:8c:2f:60:63:00:00:00:06:bd:17"
      cert_thumbprint     = "B1DFF48E7E45813C31857538E171803893D1F377"
      cert_valid_from     = "2025-12-16"
      cert_valid_to       = "2025-12-19"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = ""

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:bd:17:07:46:83:36:8c:2f:60:63:00:00:00:06:bd:17"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_0C8F7F07BE871C4C162AF019BFBA46C8 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "3ff2a50bd7bbadbf474ecea6d6094321ec0dbd0db7446b2c6d2042edb2203b16"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "SRL OXYGEN PLUS REASEARCH AD NETWORK"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "0c:8f:7f:07:be:87:1c:4c:16:2a:f0:19:bf:ba:46:c8"
      cert_thumbprint     = "42AC42F78990BA525E72BB4BB84E0E4DDC34B73B"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-25"

      country             = "MD"
      state               = "???"
      locality            = "Chisinau"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "0c:8f:7f:07:be:87:1c:4c:16:2a:f0:19:bf:ba:46:c8"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_11B1D2BBDD832C2E560EEAA79A0D75C0 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-28"
      version             = "1.0"

      hash                = "a2e0adc209c132ed579c15aed1b1d3c5ea34c4953c7ac42d6a8a4fb74d92e3c7"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "SOFTWARE VERTEX QA LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "11:b1:d2:bb:dd:83:2c:2e:56:0e:ea:a7:9a:0d:75:c0"
      cert_thumbprint     = "F0344631F727ABCF965E77FD8585DDF684D69E51"
      cert_valid_from     = "2025-04-28"
      cert_valid_to       = "2026-04-28"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "11:b1:d2:bb:dd:83:2c:2e:56:0e:ea:a7:9a:0d:75:c0"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_2397973243352DA3ED055BC1D9A5CFC6 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "b864b1fbb0fbcd561fbfce5462b43b8a49b5f1011867da509418b8068dd45c54"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Market Intelligence Systems (MIS) B.V."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "23:97:97:32:43:35:2d:a3:ed:05:5b:c1:d9:a5:cf:c6"
      cert_thumbprint     = "E2C140D2A11A8B08E2A87E1CA9C08D88158FA45B"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-07-30"

      country             = "NL"
      state               = "South Holland"
      locality            = "Dordrecht"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "23:97:97:32:43:35:2d:a3:ed:05:5b:c1:d9:a5:cf:c6"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_24D8130F15678AFE57E0A7790D170380 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-19"
      version             = "1.0"

      hash                = "927858756908b6991e7855871b54472eac676b420772048319b0d90f2599714e"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Questor IT Consulting Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "24:d8:13:0f:15:67:8a:fe:57:e0:a7:79:0d:17:03:80"
      cert_thumbprint     = "B67CE96127ECB75785E2F281C23E4681FFB0F915"
      cert_valid_from     = "2025-09-19"
      cert_valid_to       = "2026-09-19"

      country             = "CA"
      state               = "Quebec"
      locality            = "Gatineau"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "24:d8:13:0f:15:67:8a:fe:57:e0:a7:79:0d:17:03:80"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_2DDA92271964A1A6F5BB327221C2E36D {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-17"
      version             = "1.0"

      hash                = "ce19b6511fa04c0b6121fbbf208e86a74430657e4266ae806e3f897ff13cea4d"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Keravan Kirja-Info Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2d:da:92:27:19:64:a1:a6:f5:bb:32:72:21:c2:e3:6d"
      cert_thumbprint     = "96D6A605135A4092107EDE41235E5E71C1C6DC83"
      cert_valid_from     = "2025-07-17"
      cert_valid_to       = "2026-07-17"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Kerava"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2d:da:92:27:19:64:a1:a6:f5:bb:32:72:21:c2:e3:6d"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_32EA04E8D95302923AEE902AA3E4AC7C {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-05"
      version             = "1.0"

      hash                = "c879cdd5c78adddcda4f5cc6ab0878ae1511f5275bfec81a2dd6be14b0ce4c6d"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Netcoder Software Development Inc."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "32:ea:04:e8:d9:53:02:92:3a:ee:90:2a:a3:e4:ac:7c"
      cert_thumbprint     = "0DDD59EDF92361486EA1A53D96BE36517B049E83"
      cert_valid_from     = "2025-09-05"
      cert_valid_to       = "2026-09-05"

      country             = "CA"
      state               = "Quebec"
      locality            = "Montréal"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "32:ea:04:e8:d9:53:02:92:3a:ee:90:2a:a3:e4:ac:7c"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_36A89F2D5878672CAA2DF1286DAF3CDD {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-12"
      version             = "1.0"

      hash                = "3ad1c019bc45bac84fecd0cf6c66d88792aab73acb25a7bb3ee841646fec167b"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Chengdu Chenxi Mining Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "36:a8:9f:2d:58:78:67:2c:aa:2d:f1:28:6d:af:3c:dd"
      cert_thumbprint     = "6f99b34a0f0cf7d9246a5bbb820ddf9877071ef424452cbdfa65d4afe3b2084e"
      cert_valid_from     = "2024-10-12"
      cert_valid_to       = "2025-10-12"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA6AEKLP62"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "36:a8:9f:2d:58:78:67:2c:aa:2d:f1:28:6d:af:3c:dd"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_51BB990298810B66ABFC5A8F81723E58 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-12"
      version             = "1.0"

      hash                = "abec391509493b746cf8a057f9ac9304660a723bc2cd2d9e36154df4bed73ab8"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "PRZEDSIĘBIORSTWO USŁUGOWO HANDLOWE MAKER SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "51:bb:99:02:98:81:0b:66:ab:fc:5a:8f:81:72:3e:58"
      cert_thumbprint     = "CE90CF862F0E8A964664B7CD3BA80CBD19D01014"
      cert_valid_from     = "2025-07-12"
      cert_valid_to       = "2026-07-12"

      country             = "PL"
      state               = "śląskie"
      locality            = "Żory"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "51:bb:99:02:98:81:0b:66:ab:fc:5a:8f:81:72:3e:58"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_554D7BF243723DB6B45FBA7BD522DFD4 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "431c1422d417b82670cb32cded474ff956013ed6524f1e5653dbc4995e1930d2"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Hebei EWIN Enterprise Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "55:4d:7b:f2:43:72:3d:b6:b4:5f:ba:7b:d5:22:df:d4"
      cert_thumbprint     = "88ACB5F326D7D19A2EB879C1314EB88B22E94215"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-09"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "911301007524461955"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "55:4d:7b:f2:43:72:3d:b6:b4:5f:ba:7b:d5:22:df:d4"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_6DD090DA6EF020AF225D08185D884669 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-22"
      version             = "1.0"

      hash                = "96848f20bf3587b160b76c92f6eebad50377585b31d7224579ef158367f5a18c"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "SPECTRUM MS LLP"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6d:d0:90:da:6e:f0:20:af:22:5d:08:18:5d:88:46:69"
      cert_thumbprint     = "1F081D014159073582E90A7481498BC3DE88632A"
      cert_valid_from     = "2025-09-22"
      cert_valid_to       = "2026-09-22"

      country             = "IN"
      state               = "West Bengal"
      locality            = "Kolkata"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6d:d0:90:da:6e:f0:20:af:22:5d:08:18:5d:88:46:69"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_6DE73E52DF41492B72C626F1E5A7BE66 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-18"
      version             = "1.0"

      hash                = "2cbd48a458b1f09c0b5e9fd197d24f668069dee0c2a94c45497dc5f2d9260d65"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "CORTEX"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6d:e7:3e:52:df:41:49:2b:72:c6:26:f1:e5:a7:be:66"
      cert_thumbprint     = "16BFDA0CE795E2651CC94CB166D2B50313682B42"
      cert_valid_from     = "2025-07-18"
      cert_valid_to       = "2026-07-18"

      country             = "BE"
      state               = "East Flanders"
      locality            = "Lochristi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6d:e7:3e:52:df:41:49:2b:72:c6:26:f1:e5:a7:be:66"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_70D72A7A7275B85D7D7F300CC55C8656 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-30"
      version             = "1.0"

      hash                = "472e5724498c4ca71d0a10fbccfdf492530a4e2e59511e42343154cbe0fe92d0"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "FROIZINE ANNI E-CO LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "70:d7:2a:7a:72:75:b8:5d:7d:7f:30:0c:c5:5c:86:56"
      cert_thumbprint     = "F4C43F1A7A72F6FD3F925F13EDB66496302E5AC3"
      cert_valid_from     = "2025-07-30"
      cert_valid_to       = "2026-07-30"

      country             = "GB"
      state               = "Dorset"
      locality            = "Bournemouth"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "70:d7:2a:7a:72:75:b8:5d:7d:7f:30:0c:c5:5c:86:56"
      )
}

rule MAL_Compromised_Cert_UNK_50_SSL_com_71E98ECE107000F15A341F2AB90A7890 {
   meta:
      description         = "Detects UNK-50 with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-26"
      version             = "1.0"

      hash                = "92d903c00e4c59fc3b50b0ba744cb6720b7d9ac81d3c05390a81b70f1ee24ce3"
      malware             = "UNK-50"
      malware_type        = "Infostealer"
      malware_notes       = "This malware is often pushed via social media advertising fake AI applications and fake NSFW applications: https://x.com/g0njxa/status/1959989875404366284?s=20"

      signer              = "Viridian Toys Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "71:e9:8e:ce:10:70:00:f1:5a:34:1f:2a:b9:0a:78:90"
      cert_thumbprint     = "DCDFB2FFE103DB97E72916F3ABF0ACA4D95FB5C6"
      cert_valid_from     = "2025-09-26"
      cert_valid_to       = "2026-09-26"

      country             = "GB"
      state               = "Norfolk"
      locality            = "Wisbech"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "71:e9:8e:ce:10:70:00:f1:5a:34:1f:2a:b9:0a:78:90"
      )
}

rule MAL_Compromised_Cert_UNK_51_Sectigo_00D5AC27BD4F6FDF41BD91C2162EB343E1 {
   meta:
      description         = "Detects UNK-51 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-25"
      version             = "1.0"

      hash                = "01f844ca8f535c4fe372d4e6f256ad60d08e795939ce212d519e239e490c74c1"
      malware             = "UNK-51"
      malware_type        = "Remote access tool"
      malware_notes       = "Malware drops a DLL into the users Users Admin AppData Roaming Microsoft SystemCertificates directory. The DLL can set a scheduled task and contains an encrypted payload."

      signer              = "Wenzhou Feixun Internet Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:d5:ac:27:bd:4f:6f:df:41:bd:91:c2:16:2e:b3:43:e1"
      cert_thumbprint     = "47E55F48CA38C8C47CD1548B72C231E64F9B0CD5"
      cert_valid_from     = "2025-11-25"
      cert_valid_to       = "2026-11-25"

      country             = "CN"
      state               = "Zhejiang Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91330302MA2H91PU2D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:d5:ac:27:bd:4f:6f:df:41:bd:91:c2:16:2e:b3:43:e1"
      )
}

rule MAL_Compromised_Cert_UNK_51_Sectigo_54CC827FB58F4228CA4486B863292707 {
   meta:
      description         = "Detects UNK-51 with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-21"
      version             = "1.0"

      hash                = "0896adf3b2f0cdd9d7b9dead68d558b639414f11f8342073844bba682597cfba"
      malware             = "UNK-51"
      malware_type        = "Remote access tool"
      malware_notes       = "Malware drops a DLL into the users Users Admin AppData Roaming Microsoft SystemCertificates directory. The DLL can set a scheduled task and contains an encrypted payload."

      signer              = "Huizhou Hongtai Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "54:cc:82:7f:b5:8f:42:28:ca:44:86:b8:63:29:27:07"
      cert_thumbprint     = "3592A621F023128D76677F9C96F1B33A791F393B"
      cert_valid_from     = "2025-10-21"
      cert_valid_to       = "2027-01-19"

      country             = "CN"
      state               = "Guangdong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "54:cc:82:7f:b5:8f:42:28:ca:44:86:b8:63:29:27:07"
      )
}

rule MAL_Compromised_Cert_Unknown_Apple_2A7318646A5E64C0 {
   meta:
      description         = "Detects Unknown with compromised cert (Apple)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-03"
      version             = "1.0"

      hash                = "9fe25221834537c56e3514460f2c42ae0415ca40449ca7b71cebd8bd0445eefd"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IENGINEERING PRIVATE LIMITED"
      cert_issuer_short   = "Apple"
      cert_issuer         = "Apple Inc."
      cert_serial         = "2a:73:18:64:6a:5e:64:c0"
      cert_thumbprint     = "9E8EABB61C444DB5C5D44C924B03AFC9670407BC"
      cert_valid_from     = "2025-06-03"
      cert_valid_to       = "2027-02-01"

      country             = "US"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Apple Inc." and
         sig.serial == "2a:73:18:64:6a:5e:64:c0"
      )
}

rule MAL_Compromised_Cert_Unknown_Banker_GlobalSign_11D212117C7C5ACC5954C910 {
   meta:
      description         = "Detects Unknown Banker with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-29"
      version             = "1.0"

      hash                = "28be60736195f87bf7b2f34354ac0c218d26109f6315c9a8fa5c9474d2863186"
      malware             = "Unknown Banker"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE AFFAIR LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "11:d2:12:11:7c:7c:5a:cc:59:54:c9:10"
      cert_thumbprint     = "A872BE45D9552120C06E79D2A6532079AC89FD72"
      cert_valid_from     = "2024-07-29"
      cert_valid_to       = "2025-07-26"

      country             = "GB"
      state               = "Romney Marsh"
      locality            = "Dymchurch"
      email               = "admin@softwareaffairlimited.com"
      rdn_serial_number   = "09764500"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "11:d2:12:11:7c:7c:5a:cc:59:54:c9:10"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_06EFE8AF86B12D497A3610D222EA59C0 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-07"
      version             = "1.0"

      hash                = "3a4fcfc2d47067d7acf25e2a0808d9282a4c574a530b7154aba38ea8dd981789"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Open Source Developer, Zixu Wang"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "06:ef:e8:af:86:b1:2d:49:7a:36:10:d2:22:ea:59:c0"
      cert_thumbprint     = "5EE1BFB8ABE1D5656EF57138715F08379E5C0948"
      cert_valid_from     = "2025-03-07"
      cert_valid_to       = "2026-03-07"

      country             = "CN"
      state               = "Anhui"
      locality            = "Hefei"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "06:ef:e8:af:86:b1:2d:49:7a:36:10:d2:22:ea:59:c0"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_1B64B5DFEBC3144938F9DD06AA6478DF {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-02"
      version             = "1.0"

      hash                = "7d2dd19806f618dbae67470702e0536c82f331907644afd7db402c687eae0f44"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yinzhang Huang"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "1b:64:b5:df:eb:c3:14:49:38:f9:dd:06:aa:64:78:df"
      cert_thumbprint     = "0EE3059CECEF5D3CF836A7C313DC1C39502FE8D4"
      cert_valid_from     = "2024-12-02"
      cert_valid_to       = "2025-12-02"

      country             = "CN"
      state               = "广西"
      locality            = "桂林市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "1b:64:b5:df:eb:c3:14:49:38:f9:dd:06:aa:64:78:df"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_22CD8B39C5186E4CA6217F6F0EF06933 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-31"
      version             = "1.0"

      hash                = "7a090c11328347356704734060cb6ca23a3607d768decdddd90c5a73d725431e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cangzhou Chenyue Electronic Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "22:cd:8b:39:c5:18:6e:4c:a6:21:7f:6f:0e:f0:69:33"
      cert_thumbprint     = "432BBA0314FF92DC5E3988CBD46D50D2533F61C2"
      cert_valid_from     = "2024-05-31"
      cert_valid_to       = "2025-05-31"

      country             = "CN"
      state               = "Hebei"
      locality            = "Cangzhou"
      email               = "???"
      rdn_serial_number   = "91130922MA0G8AN920"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "22:cd:8b:39:c5:18:6e:4c:a6:21:7f:6f:0e:f0:69:33"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_231078283BAC1A1A90F64202E84177AD {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-16"
      version             = "1.0"

      hash                = "12eae5a374e29ad3ad55c02ca87a53b9cad91a78c000642f719e297852ba0dcc"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen Zhongxingda Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "23:10:78:28:3b:ac:1a:1a:90:f6:42:02:e8:41:77:ad"
      cert_thumbprint     = "9de58dd588fe6a464c1d21d82033881dd8c176f490838ff5be875e4f862bad8e"
      cert_valid_from     = "2024-12-16"
      cert_valid_to       = "2025-12-16"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5H14K805"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "23:10:78:28:3b:ac:1a:1a:90:f6:42:02:e8:41:77:ad"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_2782171DABF21DBB7C0A155C38BC1FFB {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-06-17"
      version             = "1.0"

      hash                = "0f069b41245d76dd228b512cc1f3bac12e656bcd1b5415c30048bfdba2f5e208"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Bauder Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "27:82:17:1d:ab:f2:1d:bb:7c:0a:15:5c:38:bc:1f:fb"
      cert_thumbprint     = "3bb2dd50469f7023a23b176ea6edd1d8ec27bb9b6a77a7031a05c11611b55db4"
      cert_valid_from     = "2021-06-17"
      cert_valid_to       = "2022-06-17"

      country             = "GB"
      state               = "Norfolk"
      locality            = "Norwich"
      email               = "???"
      rdn_serial_number   = "01466215"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "27:82:17:1d:ab:f2:1d:bb:7c:0a:15:5c:38:bc:1f:fb"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_2DE40589C464F0B18A796872F53A4BC8 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-28"
      version             = "1.0"

      hash                = "dcb76c24685fd31d5ac64851fe8e3b41a4462d882eda656fbc7faac89a763f8f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "厦门市奥裕晖奥物联网科技研究院有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "2d:e4:05:89:c4:64:f0:b1:8a:79:68:72:f5:3a:4b:c8"
      cert_thumbprint     = "FCDA0A5AD430E00D1AAB802F3634693092D71B95"
      cert_valid_from     = "2025-11-28"
      cert_valid_to       = "2026-11-28"

      country             = "CN"
      state               = "福建省"
      locality            = "厦门市"
      email               = "???"
      rdn_serial_number   = "91350206MAEAJ7AQ0G"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "2d:e4:05:89:c4:64:f0:b1:8a:79:68:72:f5:3a:4b:c8"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_318BA33F2F060636E26E971049949130 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-04"
      version             = "1.0"

      hash                = "18844d402ccdfcc6a1e7f5104ace53b62c517ac2f904dd75393fc1db0dc5af6a"
      malware             = "Unknown"
      malware_type        = "Infostealer"
      malware_notes       = "This malware contains a signed copy of Virtual Here which allows remote usage of USB devices. It was reportedly dropped from the IP 178.16.55.189 by Amadey malware."

      signer              = "Taiyuan Banmin Trading Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "31:8b:a3:3f:2f:06:06:36:e2:6e:97:10:49:94:91:30"
      cert_thumbprint     = "2E0725E64DFBB5AE4EFE9233DEEF033CCAE8F376"
      cert_valid_from     = "2025-12-04"
      cert_valid_to       = "2026-12-04"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "91140105MADDDUAN7A"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "31:8b:a3:3f:2f:06:06:36:e2:6e:97:10:49:94:91:30"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_339CD8746EF4CBB202D56AED53BFEA22 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-11"
      version             = "1.0"

      hash                = "b8f8578169a6ccbf059bc1e7cf6edeb1e5fbcd3ee0a53de617853c8f29cc351d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mianyang Yiduobao Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "33:9c:d8:74:6e:f4:cb:b2:02:d5:6a:ed:53:bf:ea:22"
      cert_thumbprint     = "9C97D603271813B6A591CEDAEA155070CB00F3AF"
      cert_valid_from     = "2025-02-11"
      cert_valid_to       = "2026-02-11"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Mianyang"
      email               = "???"
      rdn_serial_number   = "91510705MA7DJ6K762"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "33:9c:d8:74:6e:f4:cb:b2:02:d5:6a:ed:53:bf:ea:22"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_340BA8AB586FC04A7027100037082DC4 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-07"
      version             = "1.0"

      hash                = "7a90a407385c33b3f24a100fe1a882d5604cd5aff99a6a2309d915105eaebf5f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Jordan Curtis"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "34:0b:a8:ab:58:6f:c0:4a:70:27:10:00:37:08:2d:c4"
      cert_thumbprint     = "4C3CA23802D48A639C684AA97616F398850EE0DE"
      cert_valid_from     = "2025-09-07"
      cert_valid_to       = "2026-09-07"

      country             = "US"
      state               = "Texas"
      locality            = "DUNCANVILLE"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "34:0b:a8:ab:58:6f:c0:4a:70:27:10:00:37:08:2d:c4"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_36F44D0D998049FD13A86F974962E7DE {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-11"
      version             = "1.0"

      hash                = "e8a8473c1e01688d370bbb1968b6361264c56a65ddbb31f8278ac618618f4efa"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Kede Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "36:f4:4d:0d:99:80:49:fd:13:a8:6f:97:49:62:e7:de"
      cert_thumbprint     = "C8114F47D8582234E66DBF277457750CD47EAF16"
      cert_valid_from     = "2024-09-11"
      cert_valid_to       = "2025-09-11"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310120MA1JJ0UL27"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "36:f4:4d:0d:99:80:49:fd:13:a8:6f:97:49:62:e7:de"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_391BABE58A1109B9912B3596F8F8DC32 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-19"
      version             = "1.0"

      hash                = "5d1e3b113e15fc5fd4a08f41e553b8fd0eaace74b6dc034e0f6237c5e10aa737"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Songyuan Meiying Electronic Products Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "39:1b:ab:e5:8a:11:09:b9:91:2b:35:96:f8:f8:dc:32"
      cert_thumbprint     = "FB82D49AF0A77C3EF51873E9561445084BD7AE4A"
      cert_valid_from     = "2024-07-19"
      cert_valid_to       = "2025-07-19"

      country             = "CN"
      state               = "Jilin"
      locality            = "Songyuan"
      email               = "???"
      rdn_serial_number   = "91220700MA0Y47UL1G"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "39:1b:ab:e5:8a:11:09:b9:91:2b:35:96:f8:f8:dc:32"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_3CC256AED8AE1F6C0C45813BAFEB87CE {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-31"
      version             = "1.0"

      hash                = "daf28c33a9cb1d8186fc2bf78613cf4131941812e081facc2ad7d29f4af10808"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Jinan Yuejing Electronic Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "3c:c2:56:ae:d8:ae:1f:6c:0c:45:81:3b:af:eb:87:ce"
      cert_thumbprint     = "A64479F3815B4646277E862F3158B0C17485F72E"
      cert_valid_from     = "2024-07-31"
      cert_valid_to       = "2025-07-31"

      country             = "CN"
      state               = "Shandong"
      locality            = "Jinan"
      email               = "???"
      rdn_serial_number   = "91370102MA3C9D0U34"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "3c:c2:56:ae:d8:ae:1f:6c:0c:45:81:3b:af:eb:87:ce"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_3F28800AEF9A143AC2BCAC569D44788F {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-24"
      version             = "1.0"

      hash                = "9900e3bc74c9dc9886d8e5c4395700d0b1b1533f51ac763fa157a7307c333ab6"
      malware             = "Unknown"
      malware_type        = "Remote access tool"
      malware_notes       = "The malware installs a tool called Remote Manipulator System and creates a Windows Defender exclusion for the whole C drive. https://tria.ge/251208-pxs38sdz4b/behavioral2"

      signer              = "Tianjin Oudi Zhixin Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "3f:28:80:0a:ef:9a:14:3a:c2:bc:ac:56:9d:44:78:8f"
      cert_thumbprint     = "2C0F66DC2ECBEFDF0E71D3DC1A1E4476621E990D"
      cert_valid_from     = "2025-11-24"
      cert_valid_to       = "2026-11-24"

      country             = "CN"
      state               = "Tianjin"
      locality            = "Tianjin"
      email               = "???"
      rdn_serial_number   = "91120104MABX7QN37W"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "3f:28:80:0a:ef:9a:14:3a:c2:bc:ac:56:9d:44:78:8f"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_406DEF124E05689610DF34BCAED764FF {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "0a0b9338389aced675f5b68eddfb6766bc2feb1a4b2be4e7eb61ba9aa82c4d50"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen Benqi Electronic Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "40:6d:ef:12:4e:05:68:96:10:df:34:bc:ae:d7:64:ff"
      cert_thumbprint     = "BC55D25FD749078676F56B23577FDE913BFD518C"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-17"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5FAKPY62"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "40:6d:ef:12:4e:05:68:96:10:df:34:bc:ae:d7:64:ff"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_417B3A9C446891F15B00CAEB70D95CB6 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-26"
      version             = "1.0"

      hash                = "f0434db947410b795adc6a09d0da496ca07edb50ae8af72960d42ac8a89dfa29"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Quanzhou Chunsheng Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "41:7b:3a:9c:44:68:91:f1:5b:00:ca:eb:70:d9:5c:b6"
      cert_thumbprint     = "56856FF8ADE9DD49FD006C6DCF413A4C103DD079"
      cert_valid_from     = "2024-07-26"
      cert_valid_to       = "2025-07-26"

      country             = "CN"
      state               = "Fujian"
      locality            = "Quanzhou"
      email               = "???"
      rdn_serial_number   = "91350582MA8TM0LA3E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "41:7b:3a:9c:44:68:91:f1:5b:00:ca:eb:70:d9:5c:b6"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_42BC236A8370D6E230B726E0D4FB16C6 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-23"
      version             = "1.0"

      hash                = "edef0a42ef8dede49f47c763238c8caea2ccb45a9af69362c41f1d95e8a19540"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Menghu Network Technology (Beijing) Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "42:bc:23:6a:83:70:d6:e2:30:b7:26:e0:d4:fb:16:c6"
      cert_thumbprint     = "17C88198B4F3343FDDFC002BC94BD9098EC39FB2"
      cert_valid_from     = "2024-09-23"
      cert_valid_to       = "2025-09-23"

      country             = "CN"
      state               = "Beijing"
      locality            = "Beijing"
      email               = "???"
      rdn_serial_number   = "91110229MA01R14F61"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "42:bc:23:6a:83:70:d6:e2:30:b7:26:e0:d4:fb:16:c6"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_4B4E50838A7D85CA0C5EA67AE3FAAD05 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-25"
      version             = "1.0"

      hash                = "17b90db39a741357e017bdc387ad781a32dcc99d34b7f56d52ad82998634d098"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Liv Software Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "4b:4e:50:83:8a:7d:85:ca:0c:5e:a6:7a:e3:fa:ad:05"
      cert_thumbprint     = "DCEC436283F37C9A7BEE8D4E5D4374474086E4CD"
      cert_valid_from     = "2024-06-25"
      cert_valid_to       = "2025-06-25"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "13045338"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "4b:4e:50:83:8a:7d:85:ca:0c:5e:a6:7a:e3:fa:ad:05"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_4FB69AAF484B6AB16D120318552ABC33 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "9eef7a5dd156e3c63fef452f69cd04070a8856e49fc85d58a18664be48360a63"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hangzhou Haotu Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "4f:b6:9a:af:48:4b:6a:b1:6d:12:03:18:55:2a:bc:33"
      cert_thumbprint     = "DAE4E5B747145F968824A542D5FB946E386DA7F2"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-12-24"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "913301063283021923"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "4f:b6:9a:af:48:4b:6a:b1:6d:12:03:18:55:2a:bc:33"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_502F183B00B497DFC821D09DEB30526B {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-26"
      version             = "1.0"

      hash                = "24a26ac9cd209bf84831dae7d778fceb46b1e30b48454c130a6e62accdc1369e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "T H SUPPORT SERVICES LTD"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "50:2f:18:3b:00:b4:97:df:c8:21:d0:9d:eb:30:52:6b"
      cert_thumbprint     = "21297766029D043DFBA740CD5203E45171FC8EAA"
      cert_valid_from     = "2024-11-26"
      cert_valid_to       = "2025-11-26"

      country             = "GB"
      state               = "Greater Manchester"
      locality            = "Stretford"
      email               = "???"
      rdn_serial_number   = "07890919"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "50:2f:18:3b:00:b4:97:df:c8:21:d0:9d:eb:30:52:6b"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_545B84509ABF85E386011CEE69F61882 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "748149df038a771986691e3f54afea609ceb9fbfcbec92145beb586bec039e6a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Meizhou Fisherman Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "54:5b:84:50:9a:bf:85:e3:86:01:1c:ee:69:f6:18:82"
      cert_thumbprint     = "C9CC769DE207133042E6608499199D222BEFD824"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-21"

      country             = "CN"
      state               = "广东省"
      locality            = "梅州市"
      email               = "???"
      rdn_serial_number   = "91441403MA4UNLKT9A"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "54:5b:84:50:9a:bf:85:e3:86:01:1c:ee:69:f6:18:82"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_54E3B3305D1386C1172F1B8AB6FF6835 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-07"
      version             = "1.0"

      hash                = "2b587ca6eb1af162951ade0e214b856f558cc859ae1a8674646f853661704211"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yantai Guanlian Logistics Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "54:e3:b3:30:5d:13:86:c1:17:2f:1b:8a:b6:ff:68:35"
      cert_thumbprint     = "7D495C559D33D85A466ED3381FA96FA72F653E41"
      cert_valid_from     = "2024-08-07"
      cert_valid_to       = "2025-08-07"

      country             = "CN"
      state               = "Shandong"
      locality            = "Yantai"
      email               = "???"
      rdn_serial_number   = "91370611MA3TWX1N8R"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "54:e3:b3:30:5d:13:86:c1:17:2f:1b:8a:b6:ff:68:35"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_58F2E229C05C4194F7967E013F8ECE55 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-16"
      version             = "1.0"

      hash                = "cea49f52c304557f201f79ce8031a392ee8f639feadc101f0c32ddd98373f57d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangzhou Dongshui Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "58:f2:e2:29:c0:5c:41:94:f7:96:7e:01:3f:8e:ce:55"
      cert_thumbprint     = "640C80716EDF2D4628B18CFD07BED6DF2DA6EC94"
      cert_valid_from     = "2024-08-16"
      cert_valid_to       = "2025-08-16"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101MA9Y1HB49U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "58:f2:e2:29:c0:5c:41:94:f7:96:7e:01:3f:8e:ce:55"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_6116881CBADD579E680B600873B3A8E3 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-13"
      version             = "1.0"

      hash                = "0dbeb3173cf0f5551f4e118083a95bdeb4eda4189f28bf2c7ad5f3c899642912"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangdong Kenuosi IoT Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "61:16:88:1c:ba:dd:57:9e:68:0b:60:08:73:b3:a8:e3"
      cert_thumbprint     = "8939F7E15BAAD7662495E6DCCFC1D320F25F7558"
      cert_valid_from     = "2024-09-13"
      cert_valid_to       = "2025-09-13"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Dongguan"
      email               = "???"
      rdn_serial_number   = "91441900MA54J07X80"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "61:16:88:1c:ba:dd:57:9e:68:0b:60:08:73:b3:a8:e3"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_77185BFDFD072CE4944A6123C38C8001 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-08"
      version             = "1.0"

      hash                = "99f8878d408857acbba11b04d6c21153368f121fd572e0eaed1ec4823955f6e9"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chongqing Feide Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "77:18:5b:fd:fd:07:2c:e4:94:4a:61:23:c3:8c:80:01"
      cert_thumbprint     = "0BED5FE3BDC1ED5EB41F97E2F30E94884D4A596D"
      cert_valid_from     = "2025-02-08"
      cert_valid_to       = "2026-02-08"

      country             = "CN"
      state               = "Chongqing"
      locality            = "Chongqing"
      email               = "???"
      rdn_serial_number   = "91500118MA613XPC26"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "77:18:5b:fd:fd:07:2c:e4:94:4a:61:23:c3:8c:80:01"
      )
}

rule MAL_Compromised_Cert_Unknown_Certum_7DD8BDEDD9E79593FBE0C25B114670A6 {
   meta:
      description         = "Detects Unknown with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-31"
      version             = "1.0"

      hash                = "6846d9bac1b70152637998118523c5baa97f124c81036e9865d6a3b80cd031ee"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hatem Sakr"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "7d:d8:bd:ed:d9:e7:95:93:fb:e0:c2:5b:11:46:70:a6"
      cert_thumbprint     = "112D38DDFCF0FCE6C2C352598F821E1F2A7F76AC"
      cert_valid_from     = "2024-12-31"
      cert_valid_to       = "2025-12-31"

      country             = "EG"
      state               = "???"
      locality            = "Banha"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "7d:d8:bd:ed:d9:e7:95:93:fb:e0:c2:5b:11:46:70:a6"
      )
}

rule MAL_Compromised_Cert_Unknown_Codegic_0237DEA0A266364D1C9C842A97E5C33B067C2D33 {
   meta:
      description         = "Detects Unknown with compromised cert (Codegic)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-30"
      version             = "1.0"

      hash                = "ea49feb2417b506b1095ff67b609628df2d18d02ad68e1161cdf0608796923e6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "EuropesServices"
      cert_issuer_short   = "Codegic"
      cert_issuer         = "Codegic CA G2"
      cert_serial         = "02:37:de:a0:a2:66:36:4d:1c:9c:84:2a:97:e5:c3:3b:06:7c:2d:33"
      cert_thumbprint     = "2c3278570b0db8dbd676a81d628061fffe32be7c667a87f2e091949f3f6cd0b6"
      cert_valid_from     = "2025-01-30"
      cert_valid_to       = "2025-03-31"

      country             = "BR"
      state               = "???"
      locality            = "???"
      email               = "deusumars@gmail.com"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Codegic CA G2" and
         sig.serial == "02:37:de:a0:a2:66:36:4d:1c:9c:84:2a:97:e5:c3:3b:06:7c:2d:33"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0144C41E1909E7332C5BA64F0042EE86 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-23"
      version             = "1.0"

      hash                = "0c95317a3bb6ad03569cf9c717307ca1e5d3ca0ba93c39f3e28838420c0bd8f4"
      malware             = "Unknown"
      malware_type        = "Trojan"
      malware_notes       = "App gets downloaded when user is looking to download something else. Installs an AppStore like app instead and creates a service which will run a file from a temporary directory: https://app.any.run/tasks/5f68ee9f-2d9c-40e7-ac35-8560bedd36b2"

      signer              = "Guangxi Yunao Network Technology Co. Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "01:44:c4:1e:19:09:e7:33:2c:5b:a6:4f:00:42:ee:86"
      cert_thumbprint     = "FE186438F2ABEF2DDA453E52E51F852147DE2E7D"
      cert_valid_from     = "2023-05-23"
      cert_valid_to       = "2024-06-14"

      country             = "CN"
      state               = "Guangxi Zhuang Autonomous Region"
      locality            = "Beihai"
      email               = "???"
      rdn_serial_number   = "91450500MAA7H9NJ04"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "01:44:c4:1e:19:09:e7:33:2c:5b:a6:4f:00:42:ee:86"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_014A98D697B44F43DED21F18EB6AD0BA {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-11-13"
      version             = "1.0"

      hash                = "ab9bd45d65800bd2a72124f0188face3b8d79abd5d3e41d95a29383f851f9381"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hillcoe Software Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert EV Code Signing CA (SHA2)"
      cert_serial         = "01:4a:98:d6:97:b4:4f:43:de:d2:1f:18:eb:6a:d0:ba"
      cert_thumbprint     = "4DB86D367D001BE757047F35796C8A5926A7C2E5"
      cert_valid_from     = "2020-11-13"
      cert_valid_to       = "2021-11-14"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "1204212-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert EV Code Signing CA (SHA2)" and
         sig.serial == "01:4a:98:d6:97:b4:4f:43:de:d2:1f:18:eb:6a:d0:ba"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_01FD6F6E1223421F0260949FCEB36201 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-19"
      version             = "1.0"

      hash                = "18c616aad862dcd00837362a8f3c3eb2419b3a01721675ffda8b22461d37eb52"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JUST OKAY LIMITED"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "01:fd:6f:6e:12:23:42:1f:02:60:94:9f:ce:b3:62:01"
      cert_thumbprint     = "E39BE0CB221EE285BE0302F2578DE32457DF2FA0"
      cert_valid_from     = "2024-12-19"
      cert_valid_to       = "2025-12-18"

      country             = "HK"
      state               = "???"
      locality            = "Kowloon"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "01:fd:6f:6e:12:23:42:1f:02:60:94:9f:ce:b3:62:01"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_02682CEB568217E7B0DE489425B0D3C2 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-19"
      version             = "1.0"

      hash                = "e115cd3f7f9fb0d34d8ddb909da419a93ff441fd0c6a787afe9c130b03f6ff5e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "飛原數位科技有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "02:68:2c:eb:56:82:17:e7:b0:de:48:94:25:b0:d3:c2"
      cert_thumbprint     = "4D736329D5A5F9E53180EAA03D0C3621539F082D"
      cert_valid_from     = "2024-08-19"
      cert_valid_to       = "2027-08-21"

      country             = "TW"
      state               = "桃園市"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "52881336"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "02:68:2c:eb:56:82:17:e7:b0:de:48:94:25:b0:d3:c2"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0732E2A94E3F6F85A26DB09CA03FC48F {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-22"
      version             = "1.0"

      hash                = "0c58175d22b45fd06cfed62d7a9a33b1f13c049427a83904a04db9810c44eb5a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "北京华网智讯软件有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "07:32:e2:a9:4e:3f:6f:85:a2:6d:b0:9c:a0:3f:c4:8f"
      cert_thumbprint     = "0D599A8B43DB2A7C65D68E5696F7649CEEA5C60C"
      cert_valid_from     = "2024-10-22"
      cert_valid_to       = "2025-10-21"

      country             = "CN"
      state               = "北京市"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "07:32:e2:a9:4e:3f:6f:85:a2:6d:b0:9c:a0:3f:c4:8f"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_078131590A97B627AE3DD57C089E869E {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-24"
      version             = "1.0"

      hash                = "510e2f0999c2d7381fc22ee4c4bf72e0ab1bbe779e01a81095690b1bdc633ece"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Enviaolo LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "07:81:31:59:0a:97:b6:27:ae:3d:d5:7c:08:9e:86:9e"
      cert_thumbprint     = "2CAD5366B72AA3FF63587579238D5DAF9EEC147B"
      cert_valid_from     = "2024-07-24"
      cert_valid_to       = "2025-07-23"

      country             = "US"
      state               = "Oklahoma"
      locality            = "Edmond"
      email               = "???"
      rdn_serial_number   = "3513614123"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "07:81:31:59:0a:97:b6:27:ae:3d:d5:7c:08:9e:86:9e"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_09EDC1E5D49217F8C31DAD785F432080 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-23"
      version             = "1.0"

      hash                = "03889d0e551959196edef76be880e199ff8d2a2d597c10a1c70ced17f1925b2d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CÔNG TY TNHH DU LỊCH VÀ TỔ CHỨC SỰ KIỆN PROTEAM"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "09:ed:c1:e5:d4:92:17:f8:c3:1d:ad:78:5f:43:20:80"
      cert_thumbprint     = "53B2E6A6F54837E7F09958FF4254647527684B91"
      cert_valid_from     = "2025-07-23"
      cert_valid_to       = "2026-07-22"

      country             = "VN"
      state               = "Quảng Bình"
      locality            = "Đồng Hới"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "09:ed:c1:e5:d4:92:17:f8:c3:1d:ad:78:5f:43:20:80"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0A9CC40EEEB4103C26115504E22BC0AC {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-01-25"
      version             = "1.0"

      hash                = "a8af10f68d566fb3f7de1f27e354b70cde80286ca33eb4aaf3e9e048591870cb"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Beijing Jinwanwei Technology Co., Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0a:9c:c4:0e:ee:b4:10:3c:26:11:55:04:e2:2b:c0:ac"
      cert_thumbprint     = "A0A23DEAEF32755A1660CD784EAF2C72AE3D6633"
      cert_valid_from     = "2022-01-25"
      cert_valid_to       = "2025-02-19"

      country             = "CN"
      state               = "beijing"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0a:9c:c4:0e:ee:b4:10:3c:26:11:55:04:e2:2b:c0:ac"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0B886032861D9553C68F803313A98975 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-03-11"
      version             = "1.0"

      hash                = "f361f5ec213b861dc4a76eb2835d70e6739321539ad216ea5dc416c1dc026528"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Micro-Star International CO., LTD."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert SHA2 Assured ID Code Signing CA"
      cert_serial         = "0b:88:60:32:86:1d:95:53:c6:8f:80:33:13:a9:89:75"
      cert_thumbprint     = "11AB64D74470575BE416909B06204FE042EDD38C"
      cert_valid_from     = "2021-03-11"
      cert_valid_to       = "2024-06-05"

      country             = "TW"
      state               = "New Taipei City"
      locality            = "Zhonghe District"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert SHA2 Assured ID Code Signing CA" and
         sig.serial == "0b:88:60:32:86:1d:95:53:c6:8f:80:33:13:a9:89:75"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0BC0F18DA36702E302DB170D91DC9202 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2021-11-24"
      version             = "1.0"

      hash                = "173811d2b7ef473b502fac29d92c65ee2a04810aa1f9722b9dd6eeb659218531"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Foresee Consulting Inc."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0b:c0:f1:8d:a3:67:02:e3:02:db:17:0d:91:dc:92:02"
      cert_thumbprint     = "ACC694AF50E6A4AF44820B0B2D2A06615FD2F73F"
      cert_valid_from     = "2021-11-24"
      cert_valid_to       = "2022-11-23"

      country             = "CA"
      state               = "Ontario"
      locality            = "North York"
      email               = "???"
      rdn_serial_number   = "1004913-1"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0b:c0:f1:8d:a3:67:02:e3:02:db:17:0d:91:dc:92:02"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0D3D99867126E38775D7170E7F0CC571 {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-07"
      version             = "1.0"

      hash                = "acd9cb061a51e93dee4ed4834ae2d946bc9845c0a4904a12fa2a3fbf62b41cb0"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "44.211.848 NICOLAS SAMUEL DE ALMEIDA"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:3d:99:86:71:26:e3:87:75:d7:17:0e:7f:0c:c5:71"
      cert_thumbprint     = "6F7696AFA9722B8E438F0D6E2B6E6B00CAB89F14"
      cert_valid_from     = "2024-10-07"
      cert_valid_to       = "2025-10-06"

      country             = "BR"
      state               = "Minas Gerais"
      locality            = "UBERABA"
      email               = "???"
      rdn_serial_number   = "44.211.848/0001-35"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:3d:99:86:71:26:e3:87:75:d7:17:0e:7f:0c:c5:71"
      )
}

rule MAL_Compromised_Cert_Unknown_DigiCert_0E15E5500631C4E3A92EF50200E5031B {
   meta:
      description         = "Detects Unknown with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-28"
      version             = "1.0"

      hash                = "576d07cc8919c68914bf08663e0afd00d9f9fbf5263b5cccbded5d373905a296"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "C-DC LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0e:15:e5:50:06:31:c4:e3:a9:2e:f5:02:00:e5:03:1b"
      cert_thumbprint     = "A6D4E93D8656BAAB2E461E1ACEC6C8E72819AD5A"
      cert_valid_from     = "2024-10-28"
      cert_valid_to       = "2025-10-27"

      country             = "UA"
      state               = "Ivano-Frankivsk Oblast"
      locality            = "Ivano-Frankivsk"
      email               = "???"
      rdn_serial_number   = "42466506"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0e:15:e5:50:06:31:c4:e3:a9:2e:f5:02:00:e5:03:1b"
      )
}

rule MAL_Compromised_Cert_Unknown_EE_0452205181790702B219BCE761B5C52C {
   meta:
      description         = "Detects Unknown with compromised cert (EE)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-08"
      version             = "1.0"

      hash                = "d4e1b6c2cd19faf9ff1cd489491749529449304210386630167a3dec995c9b23"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "www.huixineap.com"
      cert_issuer_short   = "EE"
      cert_issuer         = "Encryption Everywhere DV TLS CA - G2"
      cert_serial         = "04:52:20:51:81:79:07:02:b2:19:bc:e7:61:b5:c5:2c"
      cert_thumbprint     = "7FCCB05B2E1786FC7E840A2E94614B1AB5A678A1"
      cert_valid_from     = "2025-04-08"
      cert_valid_to       = "2025-07-07"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Encryption Everywhere DV TLS CA - G2" and
         sig.serial == "04:52:20:51:81:79:07:02:b2:19:bc:e7:61:b5:c5:2c"
      )
}

rule MAL_Compromised_Cert_Unknown_Fakebat_Cert_SSL_com_43BD8D6AA3FECB65766396C09E9EEDEA {
   meta:
      description         = "Detects Unknown_Fakebat_Cert with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-01"
      version             = "1.0"

      hash                = "511e21b8c183fee710862aa39fe11cd87d632377b123b0ecba4e979100237f42"
      malware             = "Unknown_Fakebat_Cert"
      malware_type        = "Loader"
      malware_notes       = "This loader was sold as a service. Most frequently it was used to load an infostealer, but could easily load anything else: https://www.sekoia.io/en/glossary/fakebat/"

      signer              = "Tulip Soft Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "43:bd:8d:6a:a3:fe:cb:65:76:63:96:c0:9e:9e:ed:ea"
      cert_thumbprint     = "ED892EDC5950D96116F97900995B1CEE43A12598"
      cert_valid_from     = "2024-06-01"
      cert_valid_to       = "2025-06-01"

      country             = "GB"
      state               = "London Borough of Barking and Dagenham"
      locality            = "Dagenham"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "43:bd:8d:6a:a3:fe:cb:65:76:63:96:c0:9e:9e:ed:ea"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_00833FE041BD96B8C2940154 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-12"
      version             = "1.0"

      hash                = "1c359c389129097bfcf8fe7a4cde1c20686b76f12a9a095667b85c3c02030006"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BLACK INDIGO LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "00:83:3f:e0:41:bd:96:b8:c2:94:01:54"
      cert_thumbprint     = "9A4D87370D9184C85A98885BD928D34DC6AA38D5"
      cert_valid_from     = "2024-11-12"
      cert_valid_to       = "2025-11-13"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "???"
      rdn_serial_number   = "515530624"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "00:83:3f:e0:41:bd:96:b8:c2:94:01:54"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_00E2AEDBB52373532B5B4BFA {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-06"
      version             = "1.0"

      hash                = "0966555bd577a1a3d45655422d0d41df77eb1834b93a56288ed336593b402d0e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KVK Montage ApS"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "00:e2:ae:db:b5:23:73:53:2b:5b:4b:fa"
      cert_thumbprint     = "0AC087BD7E421C48670C5A51F3C7C78C39DF383D"
      cert_valid_from     = "2024-12-06"
      cert_valid_to       = "2025-12-07"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "Frederikssund"
      email               = "???"
      rdn_serial_number   = "32842097"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "00:e2:ae:db:b5:23:73:53:2b:5b:4b:fa"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_019BEEF41E8CE589026DB546 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "7780f4762d9526f0156f3d8b39b833ec7bc2023dc67e4940864ddb0fffe910ff"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Farfield Computing Systems Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "01:9b:ee:f4:1e:8c:e5:89:02:6d:b5:46"
      cert_thumbprint     = "B9ED6FF1ECF8DD8A44E0A0A3B2C9DC351CD72A03"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-12-25"

      country             = "CA"
      state               = "Ontario"
      locality            = "Kitchener"
      email               = "???"
      rdn_serial_number   = "860519-0"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "01:9b:ee:f4:1e:8c:e5:89:02:6d:b5:46"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_0204699A9056F9CD65B82EC2 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-28"
      version             = "1.0"

      hash                = "483e1a9c8161994b4794dd65e4cfb8b2889b3f7802613e37b4920c9fe8393443"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RAMASHISH SECURITY SERVICES PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "02:04:69:9a:90:56:f9:cd:65:b8:2e:c2"
      cert_thumbprint     = "2CF8CAF6FA656EFE8C79C24B351332C7901FABDC"
      cert_valid_from     = "2025-07-28"
      cert_valid_to       = "2026-07-29"

      country             = "IN"
      state               = "Bihar"
      locality            = "Samastipur"
      email               = "ramashish.ssindia@zohomail.in"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "02:04:69:9a:90:56:f9:cd:65:b8:2e:c2"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_04CF28D1A98360DF407FBED6 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-06"
      version             = "1.0"

      hash                = "7e6dfeb5e87453cb9999e592d76f8b5ba4bb4d0e5c6eeb6f12de03fa17801a47"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC NOVOTEK"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "04:cf:28:d1:a9:83:60:df:40:7f:be:d6"
      cert_thumbprint     = "A774E9D46CB669A2566C340D343C305AA8D8A8F2"
      cert_valid_from     = "2025-10-06"
      cert_valid_to       = "2026-07-17"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "04:cf:28:d1:a9:83:60:df:40:7f:be:d6"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_0868787EBCFA854B61CD6909 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-29"
      version             = "1.0"

      hash                = "3d8e2e52061f8b1d92487544d08a11e91c9d90a75fa7a381195618c88f0e75ed"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Tactics-N"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "08:68:78:7e:bc:fa:85:4b:61:cd:69:09"
      cert_thumbprint     = "8BF78202F72DAA0843987AA50E3ACC5D1B58756D"
      cert_valid_from     = "2025-09-29"
      cert_valid_to       = "2026-06-06"

      country             = "RU"
      state               = "Novosibirsk Oblast"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "08:68:78:7e:bc:fa:85:4b:61:cd:69:09"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_0B02515F2E732BE0C19084A8 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-02"
      version             = "1.0"

      hash                = "a399bf56687bc04707fc1cc7771725f500d5d70d4fcdfbc3462d6b1ff37b8a9d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Freshmix"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0b:02:51:5f:2e:73:2b:e0:c1:90:84:a8"
      cert_thumbprint     = "5DFBDF6BFF746A18C7A44F4F16881AE3D83FA540"
      cert_valid_from     = "2025-04-02"
      cert_valid_to       = "2026-04-03"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1187746137215"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0b:02:51:5f:2e:73:2b:e0:c1:90:84:a8"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_0FD011B4BCCCC4F86E60FAB1 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-07"
      version             = "1.0"

      hash                = "585ab6c1cdaa65c9d08decf4e1ab1cf9327f00e18d13e85e338268ccc3587aab"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "WINSTA SPORTS PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0f:d0:11:b4:bc:cc:c4:f8:6e:60:fa:b1"
      cert_thumbprint     = "CD7B93AF5A590CE793D945B40EB33F42DCB3927E"
      cert_valid_from     = "2025-03-07"
      cert_valid_to       = "2026-03-08"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "bunnyisbk47@gmail.com"
      rdn_serial_number   = "U92419RJ2021PTC078915"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0f:d0:11:b4:bc:cc:c4:f8:6e:60:fa:b1"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_10CFECD952A2D8756ED91E5A {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-15"
      version             = "1.0"

      hash                = "84f34f24a7f7852ac1c5e99ec3de6e215138d7b8a39514963dc6596945b105d8"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC GRAN"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "10:cf:ec:d9:52:a2:d8:75:6e:d9:1e:5a"
      cert_thumbprint     = "3A28A14AAAB7EAA8850141AACE5249C1871F9B02"
      cert_valid_from     = "2025-04-15"
      cert_valid_to       = "2026-04-16"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "10:cf:ec:d9:52:a2:d8:75:6e:d9:1e:5a"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_115D73560CE2DD101D5BD925 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-25"
      version             = "1.0"

      hash                = "d2f5a074c5ea4c29523cca520f52f9dae3e3ab0c900be97367613f703e4daec8"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TAU CENTAURI LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "11:5d:73:56:0c:e2:dd:10:1d:5b:d9:25"
      cert_thumbprint     = "F38B5E3A3A9807A36BC947B75BF14BC8091C83A7"
      cert_valid_from     = "2025-02-25"
      cert_valid_to       = "2026-02-26"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "contactus@taucentauriltd.com"
      rdn_serial_number   = "516234788"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "11:5d:73:56:0c:e2:dd:10:1d:5b:d9:25"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_1374AACB98D398309DC23E87 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-02"
      version             = "1.0"

      hash                = "7d0956a7271c09b26d53a3097433e72229a2785ea0f07084c902c88b954c3d5c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "The Software Experts, LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "13:74:aa:cb:98:d3:98:30:9d:c2:3e:87"
      cert_thumbprint     = "57348020810778420D356207F52F034DEB30F59F"
      cert_valid_from     = "2024-12-02"
      cert_valid_to       = "2025-12-03"

      country             = "US"
      state               = "Arizona"
      locality            = "Scottsdale"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "13:74:aa:cb:98:d3:98:30:9d:c2:3e:87"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_14B8959733633025188B7DC5 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-13"
      version             = "1.0"

      hash                = "030a8c9e64d92039e9b2b9a04337d303374964f52322a652ccda2b7080e796e6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhiya Yunke (Chengdu) Finance and Tax Service Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "14:b8:95:97:33:63:30:25:18:8b:7d:c5"
      cert_thumbprint     = "CDE26E0B01C7129ADE41702BD42204F18781109F"
      cert_valid_from     = "2025-06-13"
      cert_valid_to       = "2026-06-14"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "14:b8:95:97:33:63:30:25:18:8b:7d:c5"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_15407BBDD8FEC7611507D86E {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-07-13"
      version             = "1.0"

      hash                = "bd49ac4b03b17dd3b6ce9d30b2e88ba4b226baf9aaa9a3284b39c97b80643b96"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuhan Branch of Anhui Blade Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "15:40:7b:bd:d8:fe:c7:61:15:07:d8:6e"
      cert_thumbprint     = "C1A0706B5FE40289094E2E135CEC29979683F9CE"
      cert_valid_from     = "2023-07-13"
      cert_valid_to       = "2024-08-28"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "91420100MA7KRK4A7W"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "15:40:7b:bd:d8:fe:c7:61:15:07:d8:6e"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_15D5E222919AA7009B61CFB0 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-07"
      version             = "1.0"

      hash                = "499dfe9165ebd558b573539a7c25f5c8ddbcced110b9d4cfdc266d326c940902"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Star Channel Biological Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "15:d5:e2:22:91:9a:a7:00:9b:61:cf:b0"
      cert_thumbprint     = "8279347A7918F54AC2CB20CAA3A997F5A7793CAC"
      cert_valid_from     = "2024-06-07"
      cert_valid_to       = "2025-06-08"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310113MA1GMAT805"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "15:d5:e2:22:91:9a:a7:00:9b:61:cf:b0"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_16668BF1446C1C20F26BE641 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-10"
      version             = "1.0"

      hash                = "84a71f90d0557682833992e3388949775e979efea501a8402496828112d8b814"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FORTUNE PRINT CENTRE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "16:66:8b:f1:44:6c:1c:20:f2:6b:e6:41"
      cert_thumbprint     = "7A540E69CC7BEBAF9E6D0850176B9920F0D5D0FF"
      cert_valid_from     = "2025-01-10"
      cert_valid_to       = "2026-01-11"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "llcvulkan1@gmail.com"
      rdn_serial_number   = "PVT-RXUQBEJ"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "16:66:8b:f1:44:6c:1c:20:f2:6b:e6:41"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_16D84CA3D6CC85273B76FABE {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-21"
      version             = "1.0"

      hash                = "0b9afc9019f3074c429025e860294cb9456510609dd1dca8e8378753ade5a17e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC KHORDA"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "16:d8:4c:a3:d6:cc:85:27:3b:76:fa:be"
      cert_thumbprint     = "14F60420135014EEF51C177DE32EC6816CF2040F"
      cert_valid_from     = "2025-04-21"
      cert_valid_to       = "2026-04-22"

      country             = "RU"
      state               = "Oryol  Oblast"
      locality            = "Oryol"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "16:d8:4c:a3:d6:cc:85:27:3b:76:fa:be"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_19EB62BE9CF0E4C6A8FDA991 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-17"
      version             = "1.0"

      hash                = "8d3fbb350621ac0db0bcaeef0efd4ef8240a0fd242271a59e8b9a7d2069ff80a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tester Software Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "19:eb:62:be:9c:f0:e4:c6:a8:fd:a9:91"
      cert_thumbprint     = "0A99B6669B8AADC65A12456DF4AD8549E8084675"
      cert_valid_from     = "2025-01-17"
      cert_valid_to       = "2026-01-18"

      country             = "CN"
      state               = "Liaoning"
      locality            = "Dalian"
      email               = "???"
      rdn_serial_number   = "91210231MA107A346U"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "19:eb:62:be:9c:f0:e4:c6:a8:fd:a9:91"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_1B8B0A3044CC64E8AB3410FD {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-01-09"
      version             = "1.0"

      hash                = "510edd38e5e6ddd3fa443e05ff539fdbe934883ec31a23378a8893ed6b2c3d76"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CHING HANG INFORMATION CO., LTD."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1b:8b:0a:30:44:cc:64:e8:ab:34:10:fd"
      cert_thumbprint     = "295AE7B270230F8072862CCAF4EC98CE6CE3F65C"
      cert_valid_from     = "2023-01-09"
      cert_valid_to       = "2026-01-09"

      country             = "TW"
      state               = "Taipei"
      locality            = "Taipei"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1b:8b:0a:30:44:cc:64:e8:ab:34:10:fd"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_1D9ABA861B4A70AE4E3B400D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-13"
      version             = "1.0"

      hash                = "2ef2d5e126c0508e5a8d9d4d9fa08d60d4987b4ca401a8d2d62c89a8ef4bcc0f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ALLstore Software-Entwicklungs GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1d:9a:ba:86:1b:4a:70:ae:4e:3b:40:0d"
      cert_thumbprint     = "77443D5DB8718CBEBC953CEFF4A8795EDBFB6ABC"
      cert_valid_from     = "2024-12-13"
      cert_valid_to       = "2025-12-14"

      country             = "AT"
      state               = "Vienna"
      locality            = "Vienna"
      email               = "???"
      rdn_serial_number   = "517249k"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1d:9a:ba:86:1b:4a:70:ae:4e:3b:40:0d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_1F945C056C6E265DA3A463C5 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-02"
      version             = "1.0"

      hash                = "a0ad640511291000117b8c53b598f50a7235e77ac8c8db5b1b0ea93cca7239f4"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chengdu Lingxu Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1f:94:5c:05:6c:6e:26:5d:a3:a4:63:c5"
      cert_thumbprint     = "AD511AF5F713F129A554BD50609204D46EC726CF"
      cert_valid_from     = "2025-09-02"
      cert_valid_to       = "2026-09-03"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1f:94:5c:05:6c:6e:26:5d:a3:a4:63:c5"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_1FDB22030768A9CF31F2A96A {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-25"
      version             = "1.0"

      hash                = "37bf1269a21cba22af239e734de043f1d08d61b44414bcf63b1b9198e6a8bc87"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HOA SEN HA NAM ONE MEMBER LIMITED LIABILITIES COMPANY"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1f:db:22:03:07:68:a9:cf:31:f2:a9:6a"
      cert_thumbprint     = "A0CA753F0845B420E3F25E200B81D9936E731875"
      cert_valid_from     = "2024-11-25"
      cert_valid_to       = "2025-11-26"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "???"
      rdn_serial_number   = "0700759219"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1f:db:22:03:07:68:a9:cf:31:f2:a9:6a"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_20E91E269C6767BC49EB3D34 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-08"
      version             = "1.0"

      hash                = "512a7207048876f3d3edb588847bce9beee620675dd2a280a0efd4f08b0550d6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Bi-Test Limited Liability Company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "20:e9:1e:26:9c:67:67:bc:49:eb:3d:34"
      cert_thumbprint     = "392603E3F1D066C037F300FFF8D777856218F8E3"
      cert_valid_from     = "2025-08-08"
      cert_valid_to       = "2026-03-14"

      country             = "KG"
      state               = "Bishkek"
      locality            = "Bishkek"
      email               = "zaharmurashev@gmail.com"
      rdn_serial_number   = "207602-3301-OOO"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "20:e9:1e:26:9c:67:67:bc:49:eb:3d:34"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_23639379C01B600659A5D5B3 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-26"
      version             = "1.0"

      hash                = "56180ce6f73b08ad79fba8cf128c9851724485c5445b348eb4e67a3ae2bccd17"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LeYao Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "23:63:93:79:c0:1b:60:06:59:a5:d5:b3"
      cert_thumbprint     = "A70779EB04A174FAECEBA8CC216074ACDF872975"
      cert_valid_from     = "2024-11-26"
      cert_valid_to       = "2025-11-26"

      country             = "CN"
      state               = "Hebei"
      locality            = "Qinhuangdao"
      email               = "???"
      rdn_serial_number   = "91130302MA0G33CQ5Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "23:63:93:79:c0:1b:60:06:59:a5:d5:b3"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_238C51ADD3AC9CD0AB808018 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-21"
      version             = "1.0"

      hash                = "58c381350225859f5522f84b9d74621f254826c7a082b832f29b3fddc5c61289"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Medexpert LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "23:8c:51:ad:d3:ac:9c:d0:ab:80:80:18"
      cert_thumbprint     = "0549367AAF46C4351BDD81C3FDAAD73F49BC7E0C"
      cert_valid_from     = "2025-03-21"
      cert_valid_to       = "2026-03-22"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1227800025969"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "23:8c:51:ad:d3:ac:9c:d0:ab:80:80:18"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_24123F33DF7CA692F2F732BC {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-19"
      version             = "1.0"

      hash                = "b0da9e82ec888ecad575e2b027bad8d040180afb6116fc778531db84a3843e3c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HOUSE 2 HOME, INC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "24:12:3f:33:df:7c:a6:92:f2:f7:32:bc"
      cert_thumbprint     = "7BAFC50D7E39C58FC2BDE9A28E30CA8937EA8F58"
      cert_valid_from     = "2024-07-19"
      cert_valid_to       = "2025-07-20"

      country             = "US"
      state               = "Utah"
      locality            = "Lehi"
      email               = "???"
      rdn_serial_number   = "9481125-0142"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "24:12:3f:33:df:7c:a6:92:f2:f7:32:bc"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_245D4015C2D733804ED19990 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-01"
      version             = "1.0"

      hash                = "10f102242e0171dec27e9372899e65e50dc5e8e78f2f22b271bcfb7a40499745"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Yanex"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "24:5d:40:15:c2:d7:33:80:4e:d1:99:90"
      cert_thumbprint     = "B8D69D6100C184418E5A239E9FE9E11FD9796C9E"
      cert_valid_from     = "2025-10-01"
      cert_valid_to       = "2026-05-31"

      country             = "RU"
      state               = "Nizhny Novgorod Oblast"
      locality            = "Pochinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "24:5d:40:15:c2:d7:33:80:4e:d1:99:90"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_257C741E3A079417E0D3EA02 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-27"
      version             = "1.0"

      hash                = "ac14ed8e38f5b78ff5047d8af38b3e174ac87da526a7690fb924c7a056632600"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UCon Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "25:7c:74:1e:3a:07:94:17:e0:d3:ea:02"
      cert_thumbprint     = "8E11CC942E392D582E337382B2618F1E64349649"
      cert_valid_from     = "2025-05-27"
      cert_valid_to       = "2026-04-25"

      country             = "CN"
      state               = "GUANGDONG"
      locality            = "SHENZHEN"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "25:7c:74:1e:3a:07:94:17:e0:d3:ea:02"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_26E509E714518BA6CD16D26C {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-28"
      version             = "1.0"

      hash                = "2818c4cbba444f3c288eb543b62a2f3f20fdd29b0df5f36cdf3ed14c4ffeda11"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhiya Yunke (Chengdu) Finance and Tax Service Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "26:e5:09:e7:14:51:8b:a6:cd:16:d2:6c"
      cert_thumbprint     = "49D0D851A7B74B2E76A3FC019AE527927444CC59"
      cert_valid_from     = "2023-08-28"
      cert_valid_to       = "2024-07-28"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "26:e5:09:e7:14:51:8b:a6:cd:16:d2:6c"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_2A074CF080DFCB5586832383 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-06"
      version             = "1.0"

      hash                = "4d2a12f2232a7833b0842560d11682a25aeca95d8bca92014ce12698c2180dbe"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Changzhou Jintan Bangke Network Info. Tech. Service Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2a:07:4c:f0:80:df:cb:55:86:83:23:83"
      cert_thumbprint     = "DBA4616F360ECAE74C3FCF0AFEFF59E19FF49FD2"
      cert_valid_from     = "2023-04-06"
      cert_valid_to       = "2026-04-06"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Changzhou"
      email               = "???"
      rdn_serial_number   = "91320413MA1P3Q80X0"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2a:07:4c:f0:80:df:cb:55:86:83:23:83"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_2F95E8992D3E9AED77AB1951 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-24"
      version             = "1.0"

      hash                = "d9a9685b8afc676497ee18a0bb6775dfebb7a1ca867967530e92800ddcb309ee"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MASTER SGDN BAU GMBH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2f:95:e8:99:2d:3e:9a:ed:77:ab:19:51"
      cert_thumbprint     = "3D4909FB24D9660D6B9AD298E2A4E6F3EB642BD4"
      cert_valid_from     = "2024-09-24"
      cert_valid_to       = "2026-09-25"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "admin@mastersgdnbau.com"
      rdn_serial_number   = "612294h"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2f:95:e8:99:2d:3e:9a:ed:77:ab:19:51"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_3092CC6FE5721C75BA8613A7 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-21"
      version             = "1.0"

      hash                = "b453d7fcc518d8ade1d492c61c4d09a36672848c92083c39dfb233e412f5df55"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Territory of Comfort"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "30:92:cc:6f:e5:72:1c:75:ba:86:13:a7"
      cert_thumbprint     = "0B0A87DCBF5FC6EDAE90D3B4A8B0EDADE6C4DC1D"
      cert_valid_from     = "2025-04-21"
      cert_valid_to       = "2026-04-22"

      country             = "RU"
      state               = "Tambov Oblast"
      locality            = "Tambov"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "30:92:cc:6f:e5:72:1c:75:ba:86:13:a7"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_30A7B6A13EC200A92A763D20 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-03"
      version             = "1.0"

      hash                = "fc3471e819eafc1640b51c5c8d4bd36db60dc96d912769fa0dfd619f3ec6ff09"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Advik Tech Corporation"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "30:a7:b6:a1:3e:c2:00:a9:2a:76:3d:20"
      cert_thumbprint     = "6751696EEBB3C3D10485609FB34405DE444811F0"
      cert_valid_from     = "2024-12-03"
      cert_valid_to       = "2025-12-04"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Surrey"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "30:a7:b6:a1:3e:c2:00:a9:2a:76:3d:20"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_370651E4AD142949C35D56F8 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-05"
      version             = "1.0"

      hash                = "123be9b57daf144899eb1a6b2c4b8b536b7757dd7096cb5160964c401df11d0a"
      malware             = "Unknown"
      malware_type        = "Loader"
      malware_notes       = "Downloads a JavaScript remote access tool via a hardcoded URL."

      signer              = "LLC Tekhenergostroy"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "37:06:51:e4:ad:14:29:49:c3:5d:56:f8"
      cert_thumbprint     = "28817722CCED8931F45424627299BDBFE22F9743"
      cert_valid_from     = "2025-06-05"
      cert_valid_to       = "2026-06-06"

      country             = "RU"
      state               = "Moscow"
      locality            = "Troitsk"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "37:06:51:e4:ad:14:29:49:c3:5d:56:f8"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_379B58DB24828EE1E0E4E692 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-22"
      version             = "1.0"

      hash                = "69288eeb78f736b316e154f85755320c052fcd0706d252f47213cb49d5673382"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "STALKER LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "37:9b:58:db:24:82:8e:e1:e0:e4:e6:92"
      cert_thumbprint     = "A0C2673847F02555D5EFE92A065762CA2457848F"
      cert_valid_from     = "2023-09-22"
      cert_valid_to       = "2024-09-22"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "37:9b:58:db:24:82:8e:e1:e0:e4:e6:92"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_3E47D172255BDBB3E93C5E9D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-26"
      version             = "1.0"

      hash                = "db78fca7ed503d6fdd667e1eaa26a3a4cf2c4131b911084f2961556c50689253"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HUDDA FOODS (SMC-PRIVATE) LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3e:47:d1:72:25:5b:db:b3:e9:3c:5e:9d"
      cert_thumbprint     = "02FED651B2EADA8963E95644141336451C2337A7"
      cert_valid_from     = "2024-04-26"
      cert_valid_to       = "2025-04-27"

      country             = "PK"
      state               = "Punjab"
      locality            = "Multan"
      email               = "huddafoods@gmail.com"
      rdn_serial_number   = "0168969"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3e:47:d1:72:25:5b:db:b3:e9:3c:5e:9d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_3F9F776C22678D9B353840C1 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-04"
      version             = "1.0"

      hash                = "339433c2cedc450a1f99512423ec4d951a9ba3b8d193af3c1162b7240bc8c6ff"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ADATPARTNER Software und Systeme GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3f:9f:77:6c:22:67:8d:9b:35:38:40:c1"
      cert_thumbprint     = "6F239939B15A961431E6B84B16CF7C2BD15929B5"
      cert_valid_from     = "2024-12-04"
      cert_valid_to       = "2025-12-05"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "???"
      rdn_serial_number   = "37666t"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3f:9f:77:6c:22:67:8d:9b:35:38:40:c1"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_426072D04309CC1D1F590522 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-16"
      version             = "1.0"

      hash                = "5c4253a21c527794b0f6970a19f7aeed5d3be4cefcdf35a29ef23e6f0123cfc5"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Info Tech Globalcorp Limited"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "42:60:72:d0:43:09:cc:1d:1f:59:05:22"
      cert_thumbprint     = "5e832d219ddb0fa979838229ca5c2cbae27a11b9909a10350c78ff599f5aef3e"
      cert_valid_from     = "2024-12-16"
      cert_valid_to       = "2025-12-17"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Vancouver"
      email               = "???"
      rdn_serial_number   = "1348599-4"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "42:60:72:d0:43:09:cc:1d:1f:59:05:22"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_43EDF2C9F4C308552B60F9D0 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-12"
      version             = "1.0"

      hash                = "b134e08e8d28d46695f782e4447620e293c4909bc4751e0ab35c0d3f518d7d6c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Connect Computing Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "43:ed:f2:c9:f4:c3:08:55:2b:60:f9:d0"
      cert_thumbprint     = "05A5E0424BA80160D6F77760C974A602A56DBCE4"
      cert_valid_from     = "2024-12-12"
      cert_valid_to       = "2025-12-13"

      country             = "CA"
      state               = "Ontario"
      locality            = "Mississauga"
      email               = "???"
      rdn_serial_number   = "1086757-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "43:ed:f2:c9:f4:c3:08:55:2b:60:f9:d0"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_46393D90ECC8308EC5625790 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-22"
      version             = "1.0"

      hash                = "b4baeef3427073425583564818084425d8069919b6f45b994121c91c7c067d01"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SHINE YOUR GUTS (SMC-PRIVATE) LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "46:39:3d:90:ec:c8:30:8e:c5:62:57:90"
      cert_thumbprint     = "7894608DA0897059C0EBD03E4BA917A85579D3D9"
      cert_valid_from     = "2024-04-22"
      cert_valid_to       = "2025-04-23"

      country             = "PK"
      state               = "Punjab"
      locality            = "Lahore"
      email               = "gnazar423@gmail.com"
      rdn_serial_number   = "0146772"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "46:39:3d:90:ec:c8:30:8e:c5:62:57:90"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_4752DC1DBCB8091355C59B37 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-11"
      version             = "1.0"

      hash                = "435f44f8a3d5cc03d6a95d5295dc8a7ecf44ade26add5c9ac1f47f8a609a36dd"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TRUONG LUU THUY PHARMA COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:52:dc:1d:bc:b8:09:13:55:c5:9b:37"
      cert_thumbprint     = "889C0380C94768A7894E1C21FF8B10D26D8E07FD"
      cert_valid_from     = "2024-12-11"
      cert_valid_to       = "2025-12-12"

      country             = "VN"
      state               = "Ha Nam"
      locality            = "Ha Nam"
      email               = "kewfanghuava398@gmail.com"
      rdn_serial_number   = "0700861879"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:52:dc:1d:bc:b8:09:13:55:c5:9b:37"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_47631BDD19405E2ACD1317D9 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-05"
      version             = "1.0"

      hash                = "9df67ae1ae2272e0046305f1e7736276bb96bb61b4e0870f87481edb3ec3e84a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTWARE EDUCATIONAL SYSTEMS, LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "47:63:1b:dd:19:40:5e:2a:cd:13:17:d9"
      cert_thumbprint     = "0357E295E84C2DBDB5E717E545481E53D0E5D74E"
      cert_valid_from     = "2024-07-05"
      cert_valid_to       = "2025-07-06"

      country             = "US"
      state               = "Utah"
      locality            = "Pleasant Grove"
      email               = "???"
      rdn_serial_number   = "12830800-0160"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "47:63:1b:dd:19:40:5e:2a:cd:13:17:d9"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_48C2F340350A31E335150ED8 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-06"
      version             = "1.0"

      hash                = "096e2d456e34c5ccdbc1c846978c40c67f615a64766154b0be62d94adb935a2a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BLACKIT LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "48:c2:f3:40:35:0a:31:e3:35:15:0e:d8"
      cert_thumbprint     = "190B7DB5D9234730591F8E245EEDB2F04CAC6461"
      cert_valid_from     = "2025-09-06"
      cert_valid_to       = "2026-06-19"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "48:c2:f3:40:35:0a:31:e3:35:15:0e:d8"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_493C157B7D0D910E46E98F84 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-01"
      version             = "1.0"

      hash                = "9f19ef9764dd9abc67b439321fee86baaf9f41b53cfc071f906d88c1b32312bb"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Anhui Wansanshi Internet of Things Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:3c:15:7b:7d:0d:91:0e:46:e9:8f:84"
      cert_thumbprint     = "D15CF39DA662C071CA63CD1DA7E8E94E59513903"
      cert_valid_from     = "2025-04-01"
      cert_valid_to       = "2026-04-02"

      country             = "CN"
      state               = "Anhui"
      locality            = "Wuhu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:3c:15:7b:7d:0d:91:0e:46:e9:8f:84"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_4A6DF66704FBD9B656C11AB6 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-26"
      version             = "1.0"

      hash                = "b3afc517095d0362a32c5655f7572123e5db2e09fe24f6f917b880d6a969c682"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GOLD HARMONY LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4a:6d:f6:67:04:fb:d9:b6:56:c1:1a:b6"
      cert_thumbprint     = "47133B3C7E30C4C8C6D61E8A0AD1A8BB5D09D88A"
      cert_valid_from     = "2025-06-26"
      cert_valid_to       = "2026-06-27"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Herzliya"
      email               = "contactus@goldharmonyltd.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4a:6d:f6:67:04:fb:d9:b6:56:c1:1a:b6"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_4E37AFBE047A0E2A0F268DDA {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-04"
      version             = "1.0"

      hash                = "d8a641a419044c45be2bf1bf10d143a5848a5c341935501664a007df73776bd7"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hebei Leading Metals & Piping Industries Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4e:37:af:be:04:7a:0e:2a:0f:26:8d:da"
      cert_thumbprint     = "466257DF743A67DCDA4C5624B55BC9B0CCD95815"
      cert_valid_from     = "2024-10-04"
      cert_valid_to       = "2025-10-05"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130100320225946L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4e:37:af:be:04:7a:0e:2a:0f:26:8d:da"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5014FF60D03E76D5DE85AE15 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "b89bef3b118ba3fb9261962eaee144525ee4c5a109f5817d9172cb6e67129b42"
      malware             = "Unknown"
      malware_type        = "Remote access tool"
      malware_notes       = "File masquerades as a Notepad++ installer, sets up scheduled task named Notepad Update Scheduler, which executes the nppPlugins.dll every hour. While the malware is unknown, it appears related to 1a24a12722da65ccf119dccb51aceb1eff49de9c49310d0c7af6746b43721fec which was a fake ChatGPT installer."

      signer              = "Taiyuan Jiankang Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:14:ff:60:d0:3e:76:d5:de:85:ae:15"
      cert_thumbprint     = "E0A53A952E278BDF621480F6175CC7E4FBCBD119"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-22"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "91140106MA0M4WL26F"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:14:ff:60:d0:3e:76:d5:de:85:ae:15"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_507CDD04268BAFAC46A8E99F {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-11"
      version             = "1.0"

      hash                = "85032533512bdb54e039a85d7efffb0ff9763c91ecb514e4be57fb3de368e6c3"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tunz Entertainment Russia LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:7c:dd:04:26:8b:af:ac:46:a8:e9:9f"
      cert_thumbprint     = "FC2B2367EDF50ABE75A52982505B1C8DC93EFA79"
      cert_valid_from     = "2025-03-11"
      cert_valid_to       = "2026-03-12"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1167746444689"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:7c:dd:04:26:8b:af:ac:46:a8:e9:9f"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_51DDBD7769DBDB478B4624F6 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-01"
      version             = "1.0"

      hash                = "4dfbcca0441d00cab3298c404fbad7949979b697aa8cf685835d87a808d91d5f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UBUNTU CONSORTIUM (PTY) LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "51:dd:bd:77:69:db:db:47:8b:46:24:f6"
      cert_thumbprint     = "90B9F6BB53C963E693A178EFC4B889DA5F8390AD"
      cert_valid_from     = "2025-08-01"
      cert_valid_to       = "2026-08-02"

      country             = "ZA"
      state               = "Gauteng"
      locality            = "Benoni"
      email               = "ndulahena@outlook.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "51:dd:bd:77:69:db:db:47:8b:46:24:f6"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_524AF164B507AB0FDE7FFC46 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-31"
      version             = "1.0"

      hash                = "ae27d090d2831a9a7ffcc60af70f858cda67ef36d22b81099d9a67762717cffa"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hangzhou TOP WELL Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "52:4a:f1:64:b5:07:ab:0f:de:7f:fc:46"
      cert_thumbprint     = "14BDF31882F0C8F946FAC148D6CB9EF658F32B39"
      cert_valid_from     = "2024-10-31"
      cert_valid_to       = "2025-11-01"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "913301086829037759"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "52:4a:f1:64:b5:07:ab:0f:de:7f:fc:46"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_525DB6D9E035E547A81A3A8D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-16"
      version             = "1.0"

      hash                = "1892543959a6ff6046fc555e867582d32133b42ee4c3b2e1a35085ea4f78ba6d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOI TREE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "52:5d:b6:d9:e0:35:e5:47:a8:1a:3a:8d"
      cert_thumbprint     = "B8FB7476817DE65A446D5A7F138560AFAD883E0E"
      cert_valid_from     = "2025-04-16"
      cert_valid_to       = "2026-04-17"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2013/108876"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "52:5d:b6:d9:e0:35:e5:47:a8:1a:3a:8d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5540A29447BE69FF88CF4BB5 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-24"
      version             = "1.0"

      hash                = "2b61a06ba836e0d92594b98023dcc44dc70d93adb3f9035a28cdb24903daa75a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Canton Accomplished Peak Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "55:40:a2:94:47:be:69:ff:88:cf:4b:b5"
      cert_thumbprint     = "3E0B54445FDC9916557A4885BED0A66C42E786AF"
      cert_valid_from     = "2024-05-24"
      cert_valid_to       = "2025-05-25"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440118MACC27DX2K"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "55:40:a2:94:47:be:69:ff:88:cf:4b:b5"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_55F12B612BCF8A815165BAAB {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-19"
      version             = "1.0"

      hash                = "c75936d5da7d2856cd5642211a4dde6bdeae598d77b935762162d4b493a621d5"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yongji Xiaodong Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "55:f1:2b:61:2b:cf:8a:81:51:65:ba:ab"
      cert_thumbprint     = "DDB7EF4C785F05E6FCA4913CD4993BB757B6AD69"
      cert_valid_from     = "2025-05-19"
      cert_valid_to       = "2026-05-20"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Yuncheng"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "55:f1:2b:61:2b:cf:8a:81:51:65:ba:ab"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5608CAB7E2CE34D53ABCBB73 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-20"
      version             = "1.0"

      hash                = "92d457b286fb63d2f5ec9413fd234643448c5f8d2c0763e43ed5cf27ab47eb02"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ataleo GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:08:ca:b7:e2:ce:34:d5:3a:bc:bb:73"
      cert_thumbprint     = "BE7156BD07DD7F72521FAE4A3D6F46C48DD2CE9E"
      cert_valid_from     = "2024-12-20"
      cert_valid_to       = "2026-12-21"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "admin@ataleogmbh.com"
      rdn_serial_number   = "550807k"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:08:ca:b7:e2:ce:34:d5:3a:bc:bb:73"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5746A0AA56B4D3E03289D656 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-09"
      version             = "1.0"

      hash                = "9c8db1a4035cd61f3586dbad1e008e911256606b27be53f2eaa34c1fcfcc8129"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "FACTICA SOFTWARE INC."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "57:46:a0:aa:56:b4:d3:e0:32:89:d6:56"
      cert_thumbprint     = "16C665BBDA00A19D46B1E10F6CF1586C2ACF9778"
      cert_valid_from     = "2024-10-09"
      cert_valid_to       = "2025-10-10"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "964799-6"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "57:46:a0:aa:56:b4:d3:e0:32:89:d6:56"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_57F32049482F3C889C8BF65E {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-05"
      version             = "1.0"

      hash                = "8f88ef7c7283a8114c3f06f8012cdfde9da9403a3a66ac9c690cf673e4f70732"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hebei Prolink Import & Export Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "57:f3:20:49:48:2f:3c:88:9c:8b:f6:5e"
      cert_thumbprint     = "906669A9289B957677FE42CDD5781DF6289C4869"
      cert_valid_from     = "2025-02-05"
      cert_valid_to       = "2026-02-06"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "911301027651889229"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "57:f3:20:49:48:2f:3c:88:9c:8b:f6:5e"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_58568CBC7C8AA6BD4468CFBE {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-14"
      version             = "1.0"

      hash                = "95e8f3ce726128b1af15fab165243447cdc0007e8048965151c0769826d47eae"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nanjing Bangqiao Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "58:56:8c:bc:7c:8a:a6:bd:44:68:cf:be"
      cert_thumbprint     = "09CDEE1442AA31F470ED10E76CC0BD138B6D944F"
      cert_valid_from     = "2025-05-14"
      cert_valid_to       = "2026-05-15"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Nanjing"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "58:56:8c:bc:7c:8a:a6:bd:44:68:cf:be"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5867CAD98B5C8552F60A7BD8 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-30"
      version             = "1.0"

      hash                = "a82da08a181eafbcc779f5af962eebe04e3b973c40f90a37f42ea8d3de7fc70f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xuaony Plantain E-Commerce Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "58:67:ca:d9:8b:5c:85:52:f6:0a:7b:d8"
      cert_thumbprint     = "C23686C7F96871D88754C70138702D5DCC35AC6D"
      cert_valid_from     = "2024-03-30"
      cert_valid_to       = "2025-03-30"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "91420600MACLU7R889"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "58:67:ca:d9:8b:5c:85:52:f6:0a:7b:d8"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_594ADDB2E19E4393A541C5F6 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-08"
      version             = "1.0"

      hash                = "9d1379a5f6efdf1ce131cda5fe91fd52de836479f5bdebee3100c2bbd64bd8b2"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "武汉市芙樾琳网络科技有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "59:4a:dd:b2:e1:9e:43:93:a5:41:c5:f6"
      cert_thumbprint     = "4BF0413657EFBA125F18AF180A5D2A47E47B07E5"
      cert_valid_from     = "2025-04-08"
      cert_valid_to       = "2026-04-09"

      country             = "CN"
      state               = "湖北省"
      locality            = "武汉市"
      email               = "???"
      rdn_serial_number   = "91420116MAEEPPAC1G"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "59:4a:dd:b2:e1:9e:43:93:a5:41:c5:f6"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_599274D028BD53AF9075E4B5 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-24"
      version             = "1.0"

      hash                = "64b17e0cd6925c7c04ce2fcf8c3ace53c0cbec784e149f56e24a0921add91cf2"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GI GRAPHIC DESIGN COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "59:92:74:d0:28:bd:53:af:90:75:e4:b5"
      cert_thumbprint     = "09FE1BF3DF5AFC60C343A6F71903F656335B3DAB"
      cert_valid_from     = "2024-04-24"
      cert_valid_to       = "2025-04-25"

      country             = "VN"
      state               = "Ha Noi"
      locality            = "Ha Noi"
      email               = "???"
      rdn_serial_number   = "0109733326"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "59:92:74:d0:28:bd:53:af:90:75:e4:b5"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5A2B1F9F0E576139DEB85F99 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-30"
      version             = "1.0"

      hash                = "cc427312d340683a6ca3f7dd044ae9fce0c975d9fb73f9aa8871d975c083b954"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CITY GATE INVESTMENT NINH BINH COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5a:2b:1f:9f:0e:57:61:39:de:b8:5f:99"
      cert_thumbprint     = "7A2B75AEB62893C9DD277D855149D31CA5B0EEE5"
      cert_valid_from     = "2025-01-30"
      cert_valid_to       = "2026-01-31"

      country             = "VN"
      state               = "Ninh Bình"
      locality            = "Ninh Bình"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5a:2b:1f:9f:0e:57:61:39:de:b8:5f:99"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_5C6DA215CE8C891D2D08B7CD {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-05"
      version             = "1.0"

      hash                = "c9075edbd201388279ff4c32a3a4a85b6b0b1fd934383394f62a7131d5c6b5fb"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hebei Duxin Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5c:6d:a2:15:ce:8c:89:1d:2d:08:b7:cd"
      cert_thumbprint     = "018BB49CAC595A1D1D9560AD7C58F8277FA3043F"
      cert_valid_from     = "2025-03-05"
      cert_valid_to       = "2026-03-06"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130102MA0CK7F521"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5c:6d:a2:15:ce:8c:89:1d:2d:08:b7:cd"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_605BD85F34A3E143941C0715 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-12"
      version             = "1.0"

      hash                = "dbbc491d1ffd9d86e0f69454c1b52ff44c370e1777f332098f4e3842fd59e92e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Pingding Jiangxin Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:5b:d8:5f:34:a3:e1:43:94:1c:07:15"
      cert_thumbprint     = "429908F1BAFA42E7CDDC4527AE08F7196BF93DCF"
      cert_valid_from     = "2025-06-12"
      cert_valid_to       = "2026-06-13"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Yangquan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:5b:d8:5f:34:a3:e1:43:94:1c:07:15"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_6065FC9F4A76DE02AAF67933 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-20"
      version             = "1.0"

      hash                = "3aa52b8a33682456bae09f25591a076f45a702f1124c7fdddb83f47514ee4b19"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hibernation Holdings, LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "60:65:fc:9f:4a:76:de:02:aa:f6:79:33"
      cert_thumbprint     = "16CA86A50EF4FDB4D44FE0CB0FF463A664E959EC"
      cert_valid_from     = "2025-08-20"
      cert_valid_to       = "2026-08-21"

      country             = "US"
      state               = "New York"
      locality            = "Queens"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "60:65:fc:9f:4a:76:de:02:aa:f6:79:33"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_64C6D86074B1B30A4B8D9BB3 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-26"
      version             = "1.0"

      hash                = "ffac4fd01545cacc92fde4f8cdeb45eb3786262670a67958b85862dfcba073d7"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "UTILITY ACCESS (SMC-PRIVATE) LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:c6:d8:60:74:b1:b3:0a:4b:8d:9b:b3"
      cert_thumbprint     = "97793FF580486BBD0CE73872289F554D7A036DA5"
      cert_valid_from     = "2023-10-26"
      cert_valid_to       = "2024-10-26"

      country             = "PK"
      state               = "Punjab"
      locality            = "Multan"
      email               = "maliksabirsabir483@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:c6:d8:60:74:b1:b3:0a:4b:8d:9b:b3"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_6562890A00BB9C7A0A80695A {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-31"
      version             = "1.0"

      hash                = "66bfa4c9eae391a7770f71f80015110e7ad626335ad2c9e4c061ff179379b16a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yurisk LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:62:89:0a:00:bb:9c:7a:0a:80:69:5a"
      cert_thumbprint     = "50FA33EBD90F7FEB9FF4C1F89BCD5BDA3BD0D928"
      cert_valid_from     = "2025-03-31"
      cert_valid_to       = "2026-04-01"

      country             = "RU"
      state               = "Tula Oblast"
      locality            = "Tula"
      email               = "???"
      rdn_serial_number   = "1217100007222"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:62:89:0a:00:bb:9c:7a:0a:80:69:5a"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_65B5531094EDC0C5F3A5EB46 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-21"
      version             = "1.0"

      hash                = "10b88dc57f20704b3d3d1c7b6cebe31052ef712e0366b7feffd83c2ff5ef3131"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Code 7 Eventclothing GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:b5:53:10:94:ed:c0:c5:f3:a5:eb:46"
      cert_thumbprint     = "D229315A65A625B7ABEEF9B1C0FAF487D061B5B7"
      cert_valid_from     = "2025-02-21"
      cert_valid_to       = "2026-02-22"

      country             = "AT"
      state               = "Tirol"
      locality            = "Reutte"
      email               = "???"
      rdn_serial_number   = "310473d"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:b5:53:10:94:ed:c0:c5:f3:a5:eb:46"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_65E6B4B9104AFCF9BEE6F984 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-11"
      version             = "1.0"

      hash                = "65a1d8ca5284d70df6a0a5cbd9a69c11c87e8cf7c17483aa213c31fe544c9c9f"
      malware             = "Unknown"
      malware_type        = "Remote access tool"
      malware_notes       = "Uses a python script to prepare a .NET binary to be compiled and executed: https://tria.ge/251129-pycsmsht2e/behavioral2"

      signer              = "WILD LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "65:e6:b4:b9:10:4a:fc:f9:be:e6:f9:84"
      cert_thumbprint     = "83FDE682DB8C8C8D039F21D2ECB5F6AC9FA38E4B"
      cert_valid_from     = "2025-03-11"
      cert_valid_to       = "2026-03-12"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700481423"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "65:e6:b4:b9:10:4a:fc:f9:be:e6:f9:84"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_662DA7A7B20493E999DFBDD8 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-14"
      version             = "1.0"

      hash                = "6ae8c50e3b800a6a0bff787e1e24dbc84fb8f5138e5516ebbdc17f980b471512"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SPARROW TIDE LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "66:2d:a7:a7:b2:04:93:e9:99:df:bd:d8"
      cert_thumbprint     = "8D4FB4A66FD31E36515B5E54D48F31B7715B8AF9"
      cert_valid_from     = "2025-01-14"
      cert_valid_to       = "2026-01-15"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "support@sparowtideltd.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "66:2d:a7:a7:b2:04:93:e9:99:df:bd:d8"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_66407B43BAC0DD959F14958F {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "68fe3534c8dc0f0212a0be60668d36d6f0a41e411ad4ed8c124b7916029ea2ba"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INDU-SINO IMPEX PRIVATE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "66:40:7b:43:ba:c0:dd:95:9f:14:95:8f"
      cert_thumbprint     = "699E93BE2E3F3A64254D59A2516AFA012FFDE169"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2026-07-04"

      country             = "IN"
      state               = "Rajasthan"
      locality            = "Jaipur"
      email               = "viseshlahoty2000@rediffmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "66:40:7b:43:ba:c0:dd:95:9f:14:95:8f"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_69244B6035ED2277724A2F15 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-27"
      version             = "1.0"

      hash                = "1b173e271544684f09d4a98414fe89b137fae7a7438527e31d6ff0e160f0cf9d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PREMERA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "69:24:4b:60:35:ed:22:77:72:4a:2f:15"
      cert_thumbprint     = "01cfd115329264c5240ff1183ec80346abbf0ad87e2c4cda4325ef029dcaebcf"
      cert_valid_from     = "2024-12-27"
      cert_valid_to       = "2025-12-28"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1237700409506"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "69:24:4b:60:35:ed:22:77:72:4a:2f:15"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_698356C5673C3623754A7B32 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-16"
      version             = "1.0"

      hash                = "1fb476adf16b82864b25730f380ee59c795c74f7dbcb14a1da2d7276af593a73"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuhan Linhuizhang Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "69:83:56:c5:67:3c:36:23:75:4a:7b:32"
      cert_thumbprint     = "3B81CB00B463DF66F04FE7414B43798A060D50F2"
      cert_valid_from     = "2025-05-16"
      cert_valid_to       = "2026-05-17"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "69:83:56:c5:67:3c:36:23:75:4a:7b:32"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_6AE0A20A8E7B84C607E91D16 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-10"
      version             = "1.0"

      hash                = "f2afd7ba383aafae6ea87338ce5b50e365d05c4a0a72d7501306f11d32255dc7"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DJ Webb Investments LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6a:e0:a2:0a:8e:7b:84:c6:07:e9:1d:16"
      cert_thumbprint     = "7E5D13F73C5F23B8996CAD0EBEAFFC248C9FDE74"
      cert_valid_from     = "2025-02-10"
      cert_valid_to       = "2026-02-11"

      country             = "US"
      state               = "Alaska"
      locality            = "Anchorage"
      email               = "???"
      rdn_serial_number   = "10155897"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6a:e0:a2:0a:8e:7b:84:c6:07:e9:1d:16"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_70866B586685F4F39A5B4717 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-14"
      version             = "1.0"

      hash                = "53d60c9bff836ba832c39fecb2d57fffe594dfd0e9149b40f5c9e473bccbf34f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Chengdu Nuoxin Times Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "70:86:6b:58:66:85:f4:f3:9a:5b:47:17"
      cert_thumbprint     = "ECA96BD74FB6B22848751E254B6DC9B8E2721F96"
      cert_valid_from     = "2024-05-14"
      cert_valid_to       = "2025-07-14"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "70:86:6b:58:66:85:f4:f3:9a:5b:47:17"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_709FBBDC5826F66B39F4E670 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-13"
      version             = "1.0"

      hash                = "a562994ad72896f6112491f041bae45e0d7bd9c8809400a3071c42b336b87a39"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "meta.team1337@gmail.com"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R6 SMIME CA 2023"
      cert_serial         = "70:9f:bb:dc:58:26:f6:6b:39:f4:e6:70"
      cert_thumbprint     = "97691BA8845459205E344D5FA5AD7C9DD5F64850"
      cert_valid_from     = "2025-04-13"
      cert_valid_to       = "2026-04-14"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "meta.team1337@gmail.com"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R6 SMIME CA 2023" and
         sig.serial == "70:9f:bb:dc:58:26:f6:6b:39:f4:e6:70"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_71548998D5724DFE7ADF6F62 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-01"
      version             = "1.0"

      hash                = "2dc04e9bd4a569f4d3bd1fc5de071ec63eab97745d04b3c9e6e69fafc4191f74"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Vtorsintez"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "71:54:89:98:d5:72:4d:fe:7a:df:6f:62"
      cert_thumbprint     = "86421DFFD1593A53774B764A9926D17FB74DCCA7"
      cert_valid_from     = "2025-05-01"
      cert_valid_to       = "2026-05-02"

      country             = "RU"
      state               = "Moscow Oblast"
      locality            = "Chekhov"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "71:54:89:98:d5:72:4d:fe:7a:df:6f:62"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_727A09742933A54934F8E1DC {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-30"
      version             = "1.0"

      hash                = "c3273c47f3aafa0f8de22d1e8ca24cafca867cb42104973c0e7d823a35b062ab"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HD Communication Co.,Ltd"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "72:7a:09:74:29:33:a5:49:34:f8:e1:dc"
      cert_thumbprint     = "A12C37FCEEF41DBC11F41EA9C85E75A2AB279F20"
      cert_valid_from     = "2023-10-30"
      cert_valid_to       = "2024-12-27"

      country             = "KR"
      state               = "Seoul"
      locality            = "Geumcheon-gu"
      email               = "???"
      rdn_serial_number   = "110111-4267492"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "72:7a:09:74:29:33:a5:49:34:f8:e1:dc"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_746BFAEDF11F1BDDBA78ECE2 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-06"
      version             = "1.0"

      hash                = "fe32b577785d1bb81f90a3a0e5793d6eead1128df3fe5841860aa9a1e1ddc8be"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KRONOS LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "74:6b:fa:ed:f1:1f:1b:dd:ba:78:ec:e2"
      cert_thumbprint     = "40375B72A873FB48A64220AFF92EE33DE7C15286"
      cert_valid_from     = "2025-03-06"
      cert_valid_to       = "2026-03-07"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1247700456960"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "74:6b:fa:ed:f1:1f:1b:dd:ba:78:ec:e2"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_75519E0A2702D7D8285EDD74 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-17"
      version             = "1.0"

      hash                = "addc2ddeadc5ed50f191fdcd5400231da59517ac8dcb470a616cd408ed81a14a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MARKER LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "75:51:9e:0a:27:02:d7:d8:28:5e:dd:74"
      cert_thumbprint     = "0F5AADCB849CD128144C6F54B811406691C52CF7"
      cert_valid_from     = "2025-03-17"
      cert_valid_to       = "2026-03-18"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1097847091220"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "75:51:9e:0a:27:02:d7:d8:28:5e:dd:74"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_76E07B93480F6C547B73131A {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-25"
      version             = "1.0"

      hash                = "43c102f2db55c353e0e24fdc0e6c935093de02162e7b564f0881453058a0fdcc"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Instrtekhsnab"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "76:e0:7b:93:48:0f:6c:54:7b:73:13:1a"
      cert_thumbprint     = "9B22B51674EA7B78797B66B78C64089BFC35F9A7"
      cert_valid_from     = "2025-03-25"
      cert_valid_to       = "2026-03-26"

      country             = "RU"
      state               = "Moscow Oblast"
      locality            = "Lyubertsy"
      email               = "???"
      rdn_serial_number   = "1165027060241"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "76:e0:7b:93:48:0f:6c:54:7b:73:13:1a"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_77632688BC1B58D31BC7DF0D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-14"
      version             = "1.0"

      hash                = "d9f9584f4f071be9c5cf418cae91423c51d53ecf9924ed39b42028d1314a2edc"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AMARYLLIS SIGNAL LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "77:63:26:88:bc:1b:58:d3:1b:c7:df:0d"
      cert_thumbprint     = "02C4B0C7438F3AE718FFA47137B75151713F38EA"
      cert_valid_from     = "2025-01-14"
      cert_valid_to       = "2026-01-15"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "Tel Aviv"
      email               = "support@amarylisignal.com"
      rdn_serial_number   = "516891132"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "77:63:26:88:bc:1b:58:d3:1b:c7:df:0d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7850F4A21DE19267535C3F31 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-15"
      version             = "1.0"

      hash                = "3497025e293265e4306312d2be09e51c910d0d9f1d8642dc667c11a3a4d986b6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RAPIRA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "78:50:f4:a2:1d:e1:92:67:53:5c:3f:31"
      cert_thumbprint     = "860EF9F3FC4255C48E58A4B841C75BD58AFAFBBB"
      cert_valid_from     = "2025-09-15"
      cert_valid_to       = "2025-11-02"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "78:50:f4:a2:1d:e1:92:67:53:5c:3f:31"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_78AC5947AB494CBC9844608C {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-15"
      version             = "1.0"

      hash                = "420272ca013384b3b207692122d137e7ba58fc45f4d09741faebd55a1d1db5b4"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "X PROGRAMM LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "78:ac:59:47:ab:49:4c:bc:98:44:60:8c"
      cert_thumbprint     = "2010AF985994BDDAD5183E12C17B36DD9EA973A2"
      cert_valid_from     = "2025-08-15"
      cert_valid_to       = "2028-08-15"

      country             = "GB"
      state               = "London"
      locality            = "London"
      email               = "xprogrammltd@proton.me"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "78:ac:59:47:ab:49:4c:bc:98:44:60:8c"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_797A333FBAF7E525DDAEBC0D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-14"
      version             = "1.0"

      hash                = "5afc9b30c522545344b315c66f210f789bd0b54ad01617a6291feef466e89a7c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BSZ Group AB"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "79:7a:33:3f:ba:f7:e5:25:dd:ae:bc:0d"
      cert_thumbprint     = "878313CAFA6D0191A4D7341E0EBF8F5C0B191887"
      cert_valid_from     = "2025-01-14"
      cert_valid_to       = "2026-01-15"

      country             = "SE"
      state               = "Stockholm"
      locality            = "Södertälje"
      email               = "info@bszgroup.net"
      rdn_serial_number   = "559131-8992"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "79:7a:33:3f:ba:f7:e5:25:dd:ae:bc:0d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7A062E4104BF9633E5CDAC31 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-01-29"
      version             = "1.0"

      hash                = "8b5af508dcee04dbb7dabdffeff03726ef821182ffdb8a930af57e9e71740440"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhengzhou 403 Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7a:06:2e:41:04:bf:96:33:e5:cd:ac:31"
      cert_thumbprint     = "D2BA5AE97458151B42E0C08B248F28EB918A93CF"
      cert_valid_from     = "2024-01-29"
      cert_valid_to       = "2025-01-29"

      country             = "CN"
      state               = "Henan"
      locality            = "Zhengzhou"
      email               = "???"
      rdn_serial_number   = "91410100MADAKY554Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7a:06:2e:41:04:bf:96:33:e5:cd:ac:31"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7B6BE67DA4FA164E4659E78E {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "e4bcf2d340d092c3fe306399a1e745403a9c6296aa9a56d48b596c53fbddd845"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PEIDEI LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7b:6b:e6:7d:a4:fa:16:4e:46:59:e7:8e"
      cert_thumbprint     = "CE491F0DA64F733C369973D01A90D16529B80AB8"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2026-01-14"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "casinollc007@gmail.com"
      rdn_serial_number   = "PVT-AAACXT8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7b:6b:e6:7d:a4:fa:16:4e:46:59:e7:8e"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7BB719B90DDB66003E7C02B0 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-31"
      version             = "1.0"

      hash                = "80d66d1e0d1a342c0b3637b09ec83e86a6ce0083788c7cc3c412d5233fa4470c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "COMPRESSIVE INFRACON LLP"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7b:b7:19:b9:0d:db:66:00:3e:7c:02:b0"
      cert_thumbprint     = "9F41626EDCA4756AA5CA2A3344F52DC021400110"
      cert_valid_from     = "2025-07-31"
      cert_valid_to       = "2026-08-01"

      country             = "IN"
      state               = "Delhi"
      locality            = "Delhi"
      email               = "amit.compressiveinfra@gmail.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7b:b7:19:b9:0d:db:66:00:3e:7c:02:b0"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7C19DEA4E1DE1363A3B20192 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-08"
      version             = "1.0"

      hash                = "13e8b56bdd486f138923f66e3c6319d3d296968febfebd8224a656b559960f9e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangzhou Anfeide Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7c:19:de:a4:e1:de:13:63:a3:b2:01:92"
      cert_thumbprint     = "88b9aa3ef89279b1b2f5fd615618ff6430862fd5f1245c04a7884e19699b4eb8"
      cert_valid_from     = "2024-11-08"
      cert_valid_to       = "2025-11-09"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101MA59RW850A"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7c:19:de:a4:e1:de:13:63:a3:b2:01:92"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7C75A58852CA4C72348CF24D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-04"
      version             = "1.0"

      hash                = "3c3c8656d086505661895fbd4257802e44c2233b2d53e862c0b8320ea1a7fca5"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Bravery"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7c:75:a5:88:52:ca:4c:72:34:8c:f2:4d"
      cert_thumbprint     = "FB85AA1E12C09130035D3EB72B50EBF5CCE092C7"
      cert_valid_from     = "2025-07-04"
      cert_valid_to       = "2026-07-05"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1226100007077"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7c:75:a5:88:52:ca:4c:72:34:8c:f2:4d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7DED47100D838FC19AD72EA7 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-10"
      version             = "1.0"

      hash                = "5460adc36bb1c60e66b55a584b11a2ad2a719a12718078afbf914e3dd07611c1"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Kaizhi Invest Management Limited Co."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7d:ed:47:10:0d:83:8f:c1:9a:d7:2e:a7"
      cert_thumbprint     = "3748C2A3629574A0A4C123693E26F849F54A6ADB"
      cert_valid_from     = "2025-03-10"
      cert_valid_to       = "2026-03-11"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "9131011877712255X9"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7d:ed:47:10:0d:83:8f:c1:9a:d7:2e:a7"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7E9E39FE8C3639878172F97D {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-28"
      version             = "1.0"

      hash                = "1a24a12722da65ccf119dccb51aceb1eff49de9c49310d0c7af6746b43721fec"
      malware             = "Unknown"
      malware_type        = "Remote access tool"
      malware_notes       = "The malware launches a web browser with ChatGPT as a decoy. The malware itself pretends to be a \"GPTAI installer\" and sets a scheduled task called \"GPTAI Update Scheduler\". The malware is unknown but appears related to b89bef3b118ba3fb9261962eaee144525ee4c5a109f5817d9172cb6e67129b42 which was a fake Notepad++ installer."

      signer              = "SIA “WASD”"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:9e:39:fe:8c:36:39:87:81:72:f9:7d"
      cert_thumbprint     = "D1758376E69CFE20F4B92D66189292D4E45C625A"
      cert_valid_from     = "2025-10-28"
      cert_valid_to       = "2026-10-29"

      country             = "LV"
      state               = "Riga"
      locality            = "Riga"
      email               = "???"
      rdn_serial_number   = "42103107631"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:9e:39:fe:8c:36:39:87:81:72:f9:7d"
      )
}

rule MAL_Compromised_Cert_Unknown_GlobalSign_7FEECB43A23A6FB7DCB24F54 {
   meta:
      description         = "Detects Unknown with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-01"
      version             = "1.0"

      hash                = "bed2e803af396cf8cc937dd23ce7c198ea33a0718858cdf747293d8375b0a2df"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Eclipse Media Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7f:ee:cb:43:a2:3a:6f:b7:dc:b2:4f:54"
      cert_thumbprint     = "9DBFF2D0B16CB325748A254A9D65A6E885DC252F"
      cert_valid_from     = "2024-05-01"
      cert_valid_to       = "2027-05-02"

      country             = "PA"
      state               = "Panamá"
      locality            = "Ciudad de Panamá"
      email               = "???"
      rdn_serial_number   = "155704432-2-2021"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7f:ee:cb:43:a2:3a:6f:b7:dc:b2:4f:54"
      )
}

rule MAL_Compromised_Cert_Unknown_GoGetSSL_0C3262BDCC0D66477B27A9A9C0515675 {
   meta:
      description         = "Detects Unknown with compromised cert (GoGetSSL)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "427f5549a9f028096ac3f6b4a5fd2332d3b3037195775c27b3515ad2479b3cb9"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hoen Industries LLC"
      cert_issuer_short   = "GoGetSSL"
      cert_issuer         = "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1"
      cert_serial         = "0c:32:62:bd:cc:0d:66:47:7b:27:a9:a9:c0:51:56:75"
      cert_thumbprint     = "513407319B0B36AD6CA7F65631BF9FB71798FB36"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2026-03-05"

      country             = "US"
      state               = "Florida"
      locality            = "Palm Bay"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1" and
         sig.serial == "0c:32:62:bd:cc:0d:66:47:7b:27:a9:a9:c0:51:56:75"
      )
}

rule MAL_Compromised_Cert_Unknown_Malware_DigiCert_0DB771512AC47C37E2D0F5258177F8AE {
   meta:
      description         = "Detects Unknown Malware with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-12"
      version             = "1.0"

      hash                = "a5fc4afd2d4c753aaacd77bdfcfcbd30537c8113a7a8d9c47856366eb77e1443"
      malware             = "Unknown Malware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "深圳市创想天空科技股份有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:b7:71:51:2a:c4:7c:37:e2:d0:f5:25:81:77:f8:ae"
      cert_thumbprint     = "BF92B5F71E11A67DFB2B0979A5ACA47ADCCAD1CF"
      cert_valid_from     = "2022-07-12"
      cert_valid_to       = "2024-08-14"

      country             = "CN"
      state               = "广东省"
      locality            = "深圳市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:b7:71:51:2a:c4:7c:37:e2:d0:f5:25:81:77:f8:ae"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_330001B66C239653B84C37EA0900000001B66C {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-16"
      version             = "1.0"

      hash                = "fb2c4271b507256b7472016f29a6da068d394995dad0a9965ec8dc19b026f44c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "葛 香牛"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:01:b6:6c:23:96:53:b8:4c:37:ea:09:00:00:00:01:b6:6c"
      cert_thumbprint     = "EA75F2482ACD340FDBE627ABA3ED93E2C53CEEFA"
      cert_valid_from     = "2025-02-16"
      cert_valid_to       = "2025-02-19"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "泗阳县"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:01:b6:6c:23:96:53:b8:4c:37:ea:09:00:00:00:01:b6:6c"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_330002185604BDD6D6F3F931C7000000021856 {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-15"
      version             = "1.0"

      hash                = "10d25e100989504386b0c45dd2e563441f5b4abbc51e7df7f20bbce88132c71a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TEAM PLAYER SOLUTION LTD"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:02:18:56:04:bd:d6:d6:f3:f9:31:c7:00:00:00:02:18:56"
      cert_thumbprint     = "E815F32A1A62F193ADBE93C270C3227C8AB18BE2"
      cert_valid_from     = "2025-03-15"
      cert_valid_to       = "2025-03-18"

      country             = "GB"
      state               = "???"
      locality            = "Huntingdon"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:02:18:56:04:bd:d6:d6:f3:f9:31:c7:00:00:00:02:18:56"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_330002FD7FCCA963D75D6DF74400000002FD7F {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-13"
      version             = "1.0"

      hash                = "eddc26773927d95ab78778a259279e668f52710844f7e3eb4fbdffb5552dc4f1"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TEAM PLAYER SOLUTION LTD"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:02:fd:7f:cc:a9:63:d7:5d:6d:f7:44:00:00:00:02:fd:7f"
      cert_thumbprint     = "78400E93B1496BE07098BF42E6B3E17C63D3C2DC"
      cert_valid_from     = "2025-03-13"
      cert_valid_to       = "2025-03-16"

      country             = "GB"
      state               = "???"
      locality            = "Huntingdon"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:02:fd:7f:cc:a9:63:d7:5d:6d:f7:44:00:00:00:02:fd:7f"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_330002FF571D1CFF26094BB1F700000002FF57 {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-16"
      version             = "1.0"

      hash                = "414eeb3607eacbef7111b91a6695cb44b5256051ef4948a5d60df4cdc98946db"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "益林 陈"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:02:ff:57:1d:1c:ff:26:09:4b:b1:f7:00:00:00:02:ff:57"
      cert_thumbprint     = "A06A39E596121A5FA81850A436A80FB0AE9BEBC9"
      cert_valid_from     = "2025-03-16"
      cert_valid_to       = "2025-03-19"

      country             = "CN"
      state               = "Anhui"
      locality            = "安庆市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:02:ff:57:1d:1c:ff:26:09:4b:b1:f7:00:00:00:02:ff:57"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_33000301441BA67643DD87EF5E000000030144 {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-14"
      version             = "1.0"

      hash                = "d207830298fda267c7ea01afe5b429453587729040f525875cdd36eb4e606dc7"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TEAM PLAYER SOLUTION LTD"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:03:01:44:1b:a6:76:43:dd:87:ef:5e:00:00:00:03:01:44"
      cert_thumbprint     = "E11D7DD64E2F8CFDFC60B5B7959EC6BCE0D42B9F"
      cert_valid_from     = "2025-03-14"
      cert_valid_to       = "2025-03-17"

      country             = "GB"
      state               = "???"
      locality            = "Huntingdon"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:03:01:44:1b:a6:76:43:dd:87:ef:5e:00:00:00:03:01:44"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_330005057672A0AAC2A4B79566000000050576 {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-24"
      version             = "1.0"

      hash                = "717c2728b957a7faecb7d1ac057bb03053f6397bbc369092c493daf6d45dc67c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mainstay Crypto LLC"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:05:76:72:a0:aa:c2:a4:b7:95:66:00:00:00:05:05:76"
      cert_thumbprint     = "E3EFCCB48A282FE2091CBA889D79BF65DEF49607"
      cert_valid_from     = "2025-10-24"
      cert_valid_to       = "2025-10-27"

      country             = "US"
      state               = "New Hampshire"
      locality            = "Salem"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:05:76:72:a0:aa:c2:a4:b7:95:66:00:00:00:05:05:76"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_33000557226B80125970AC5C13000000055722 {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-16"
      version             = "1.0"

      hash                = "a0e687868361593a50b09f28cb8be4c61d00aa6335d321188399adf38b4e1b28"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Armstrong Systems & Consulting Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:05:57:22:6b:80:12:59:70:ac:5c:13:00:00:00:05:57:22"
      cert_thumbprint     = "9301B51421F536EAA703FDA3B5040BF21EAE6EB1"
      cert_valid_from     = "2025-09-16"
      cert_valid_to       = "2025-09-19"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:05:57:22:6b:80:12:59:70:ac:5c:13:00:00:00:05:57:22"
      )
}

rule MAL_Compromised_Cert_Unknown_Microsoft_3300059A6D073A00FB51C163EE000000059A6D {
   meta:
      description         = "Detects Unknown with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-24"
      version             = "1.0"

      hash                = "23bb921bc74abf3efc73cbedb9c4524ae97657dea32531f9d31228573cb5a876"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Armstrong Systems & Consulting Inc."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:05:9a:6d:07:3a:00:fb:51:c1:63:ee:00:00:00:05:9a:6d"
      cert_thumbprint     = "34B2C02EE1A6E5C936930503E43F67E9153F34FE"
      cert_valid_from     = "2025-09-24"
      cert_valid_to       = "2025-09-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "Toronto"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:05:9a:6d:07:3a:00:fb:51:c1:63:ee:00:00:00:05:9a:6d"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_026DB70F749DC993EDB96BD0D65BC394 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-09"
      version             = "1.0"

      hash                = "153b47dcff405cb891ab9c7a25d54e998760f1eb4567751d438c70cf31c10bb6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GreenLine Software Corp."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "02:6d:b7:0f:74:9d:c9:93:ed:b9:6b:d0:d6:5b:c3:94"
      cert_thumbprint     = "448172A55C7A9F547613944C9E34D1C3299EA46F"
      cert_valid_from     = "2024-08-09"
      cert_valid_to       = "2025-08-09"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "02:6d:b7:0f:74:9d:c9:93:ed:b9:6b:d0:d6:5b:c3:94"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_02AE22BD7CE3FCFA09B3C26C12B7186A {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-11"
      version             = "1.0"

      hash                = "f5b31bd394e0a3adb6bd175207b8c3ccc51850c8f2cee1149a8421736168e13e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SAVAGE CABBAGE SOFTWARE PTY LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "02:ae:22:bd:7c:e3:fc:fa:09:b3:c2:6c:12:b7:18:6a"
      cert_thumbprint     = "2506E83827CC24528284D178A5E6517456DC6B6E"
      cert_valid_from     = "2025-04-11"
      cert_valid_to       = "2026-04-11"

      country             = "AU"
      state               = "Western Australia"
      locality            = "Kelmscott"
      email               = "???"
      rdn_serial_number   = "136 400 327"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "02:ae:22:bd:7c:e3:fc:fa:09:b3:c2:6c:12:b7:18:6a"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_032D7744466225316CC99B0E088E4A3E {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-04"
      version             = "1.0"

      hash                = "eca7889b628fb20ae86772da86f6672d393bcee3ff0e7a49a2f1e4f161cf8bc4"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "JJK Software Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "03:2d:77:44:46:62:25:31:6c:c9:9b:0e:08:8e:4a:3e"
      cert_thumbprint     = "C60D447EFEFC117B6EC1499374448B79F5B57E28"
      cert_valid_from     = "2024-11-04"
      cert_valid_to       = "2025-11-04"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "03:2d:77:44:46:62:25:31:6c:c9:9b:0e:08:8e:4a:3e"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_0356033728023B0EE6F8AD545BB644BF {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-04"
      version             = "1.0"

      hash                = "0a263703a49b6220a5b05b83ce9a89528e16cd09efb3c6e7671344c8ddb5c224"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BITO LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "03:56:03:37:28:02:3b:0e:e6:f8:ad:54:5b:b6:44:bf"
      cert_thumbprint     = "121CD886BA98077648FB3C27EFAA007E268DBD57"
      cert_valid_from     = "2024-10-04"
      cert_valid_to       = "2025-10-04"

      country             = "KE"
      state               = "Nakuru County"
      locality            = "Nakuru"
      email               = "???"
      rdn_serial_number   = "CPR/2010/17797"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "03:56:03:37:28:02:3b:0e:e6:f8:ad:54:5b:b6:44:bf"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_096EE1A98CE34B25D283F67127F228E7 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-27"
      version             = "1.0"

      hash                = "6c0ba73d26d26441852b731255c5526fc4c445fca2d827018000b29467b2d24e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CREGAN SOFTWARE TESTING LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "09:6e:e1:a9:8c:e3:4b:25:d2:83:f6:71:27:f2:28:e7"
      cert_thumbprint     = "88ED2D3943328F7EB42F58E10568F31897E51785"
      cert_valid_from     = "2024-12-27"
      cert_valid_to       = "2025-12-27"

      country             = "GB"
      state               = "???"
      locality            = "Nottingham"
      email               = "???"
      rdn_serial_number   = "07502570"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "09:6e:e1:a9:8c:e3:4b:25:d2:83:f6:71:27:f2:28:e7"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_0A32E732ACC355D6DBBA321C449234A5 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-18"
      version             = "1.0"

      hash                = "ff80708b33b1b5b55e810bff263730b9f1de5fb83906bc74fd9a229776716a58"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Code2One Holding ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0a:32:e7:32:ac:c3:55:d6:db:ba:32:1c:44:92:34:a5"
      cert_thumbprint     = "D222C270D11F56674AD1775A741966CA312CC2DC"
      cert_valid_from     = "2025-04-18"
      cert_valid_to       = "2026-04-18"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Værløse"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0a:32:e7:32:ac:c3:55:d6:db:ba:32:1c:44:92:34:a5"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_10662BB03030580E746864B75F3CED46 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-07"
      version             = "1.0"

      hash                = "4a30027501fe373c48c6d484c0b4db59fc23d427814b9d512f20bcbeb4eeff4c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KABA SAFARIS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "10:66:2b:b0:30:30:58:0e:74:68:64:b7:5f:3c:ed:46"
      cert_thumbprint     = "9C4F91294F57D3F77DEC413B8995F80FA73BB313"
      cert_valid_from     = "2025-04-07"
      cert_valid_to       = "2026-04-07"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "10:66:2b:b0:30:30:58:0e:74:68:64:b7:5f:3c:ed:46"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_130E3B9CA29F3AB9F3EB6C78CEE34E7C {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-08"
      version             = "1.0"

      hash                = "b3c3cdd9e888ab607b9e146cf83cdca6b9810c2350c95ecea6b2990b9aba955a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gma Technology Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "13:0e:3b:9c:a2:9f:3a:b9:f3:eb:6c:78:ce:e3:4e:7c"
      cert_thumbprint     = "B5552BF22175AF5D4E9E54B5086B89E8913DB7B9"
      cert_valid_from     = "2024-08-08"
      cert_valid_to       = "2025-08-08"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "09959900"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "13:0e:3b:9c:a2:9f:3a:b9:f3:eb:6c:78:ce:e3:4e:7c"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_13CC954B236638C54A9A92AB999F933B {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-22"
      version             = "1.0"

      hash                = "b776bec01001adee37fcc61fb6292b832e59636825d78ad4bd90f3b6a2bbf07e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "福州隋德洛贸易有限公司"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "13:cc:95:4b:23:66:38:c5:4a:9a:92:ab:99:9f:93:3b"
      cert_thumbprint     = "7463BB75B792A99E6E8372ADEB5832C50071BA9D"
      cert_valid_from     = "2024-05-22"
      cert_valid_to       = "2027-05-22"

      country             = "CN"
      state               = "Fujian"
      locality            = "Fuzhou"
      email               = "???"
      rdn_serial_number   = "91350102MA31GBQN4D"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "13:cc:95:4b:23:66:38:c5:4a:9a:92:ab:99:9f:93:3b"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_16E03301BF83807C1755E11EAD1A8E57 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-01"
      version             = "1.0"

      hash                = "f2de89b2e066fd492d992f623819281e7f9d05519a8c1ed381c03444adb189e1"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Qingdao Xihongshi Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "16:e0:33:01:bf:83:80:7c:17:55:e1:1e:ad:1a:8e:57"
      cert_thumbprint     = "8607290B9C29339DB24FC31EE133E5514716952E"
      cert_valid_from     = "2023-12-01"
      cert_valid_to       = "2024-11-30"

      country             = "CN"
      state               = "Shandong"
      locality            = "Qingdao"
      email               = "???"
      rdn_serial_number   = "91370202MA3Q70XK8N"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "16:e0:33:01:bf:83:80:7c:17:55:e1:1e:ad:1a:8e:57"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_17AECDF77E844F5C7B34DF5B8FE14BEE {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-15"
      version             = "1.0"

      hash                = "04f62ec7e2b950bb4d0f6e961264151849a6824e12319cd4343c9ca605f33537"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hebei Yibi Solidification Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "17:ae:cd:f7:7e:84:4f:5c:7b:34:df:5b:8f:e1:4b:ee"
      cert_thumbprint     = "50363EFD8A97C55148C5D130D3C5E68FEBC747BA"
      cert_valid_from     = "2024-11-15"
      cert_valid_to       = "2025-11-14"

      country             = "CN"
      state               = "Hebei"
      locality            = "Baoding"
      email               = "???"
      rdn_serial_number   = "91130681MA07QJYB30"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "17:ae:cd:f7:7e:84:4f:5c:7b:34:df:5b:8f:e1:4b:ee"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_1B41BB98099378C08BCE8177E91EA95F {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-30"
      version             = "1.0"

      hash                = "52599407c9ae090cd6aa29ee55f1bbaa549a9b5e5fe7cd6343cb937ea5999a20"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hebei Qingyun Chemical Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1b:41:bb:98:09:93:78:c0:8b:ce:81:77:e9:1e:a9:5f"
      cert_thumbprint     = "86C4E1E5233489A64645A144B13358CB63DCDB4E"
      cert_valid_from     = "2024-08-30"
      cert_valid_to       = "2025-08-29"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "911301012360419332"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1b:41:bb:98:09:93:78:c0:8b:ce:81:77:e9:1e:a9:5f"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_1BF8761F7761C3FDB27BF20B88C21357 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-29"
      version             = "1.0"

      hash                = "97b9db9756c042500ce1947ead32734630fa3df4659ebebd07b549d7ca5c8b75"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "KEMROSE ENTERPRISES LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1b:f8:76:1f:77:61:c3:fd:b2:7b:f2:0b:88:c2:13:57"
      cert_thumbprint     = "E1AA448D29371254654C29C65A5309686ACD93D0"
      cert_valid_from     = "2024-08-29"
      cert_valid_to       = "2025-08-28"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2010/34857"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1b:f8:76:1f:77:61:c3:fd:b2:7b:f2:0b:88:c2:13:57"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_1D756840BC02CB73D573CC842D313404 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-14"
      version             = "1.0"

      hash                = "87c505ec04c3766bd881d6eb0c3a9f07106513d62ea7d0256b3927cf51e405f8"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DEVELOPMENT ASCENT LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1d:75:68:40:bc:02:cb:73:d5:73:cc:84:2d:31:34:04"
      cert_thumbprint     = "FDF4C1281360424CA15B2F3DA4E63D7C4A722A62"
      cert_valid_from     = "2024-11-14"
      cert_valid_to       = "2025-11-14"

      country             = "GB"
      state               = "???"
      locality            = "Edinburgh"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1d:75:68:40:bc:02:cb:73:d5:73:cc:84:2d:31:34:04"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2000A8C13FC22C78DA32EFEC5EB1AC61 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-13"
      version             = "1.0"

      hash                = "849abdff0d8be4a64e0d966a104df8d44548edc8d4c618ea4edcfc6ff630d45c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ionik Software Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "20:00:a8:c1:3f:c2:2c:78:da:32:ef:ec:5e:b1:ac:61"
      cert_thumbprint     = "6822CB06EA9371C10F262694B60CD49038F0D05C"
      cert_valid_from     = "2024-08-13"
      cert_valid_to       = "2025-08-06"

      country             = "GB"
      state               = "England"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "20:00:a8:c1:3f:c2:2c:78:da:32:ef:ec:5e:b1:ac:61"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_219611E14FA18CE517821CEFBA2AD1C9 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "781d7b5cacf74dd23d6a64c8ad4768abcb0c295d3ce854b58ca2091469678e26"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IT Consilium Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "21:96:11:e1:4f:a1:8c:e5:17:82:1c:ef:ba:2a:d1:c9"
      cert_thumbprint     = "D6B48E6561731361C4F35AFEE134D39B7E3D4B6B"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "3216225-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "21:96:11:e1:4f:a1:8c:e5:17:82:1c:ef:ba:2a:d1:c9"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2992406673D0AF7A74C4D63D0A1F18D5 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-27"
      version             = "1.0"

      hash                = "55a555ab3d3420d8e6f20bb22d4ed4614d6bbb2c64c30479a1673a130b06d746"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LIFECLUE SOLUTIONS PRIVATE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "29:92:40:66:73:d0:af:7a:74:c4:d6:3d:0a:1f:18:d5"
      cert_thumbprint     = "9E2D9588645D2DB1D7C52861AEA02470E99D792B"
      cert_valid_from     = "2025-08-27"
      cert_valid_to       = "2026-08-27"

      country             = "IN"
      state               = "Haryana"
      locality            = "Rewari"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "29:92:40:66:73:d0:af:7a:74:c4:d6:3d:0a:1f:18:d5"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2A9464EC86CD5747FBDED231331EE9D9 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-17"
      version             = "1.0"

      hash                = "750b9fe259311e22acbcb1d2e69e20bdf378d468f6b8fd4a0e938c8efa304768"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mushroom Software"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "2a:94:64:ec:86:cd:57:47:fb:de:d2:31:33:1e:e9:d9"
      cert_thumbprint     = "2add8dda84d748eecbd60c9ae0649c475c801b62632005b48d68c9f414f1e4e7"
      cert_valid_from     = "2025-01-17"
      cert_valid_to       = "2026-01-17"

      country             = "FR"
      state               = "Île-de-France"
      locality            = "Saint-Fargeau-Ponthierry"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "2a:94:64:ec:86:cd:57:47:fb:de:d2:31:33:1e:e9:d9"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2CA80AA74A5EC29E23713A23D5C29A68 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-04"
      version             = "1.0"

      hash                = "4779db5eb5116033e0f2e5d7fda041a4887830c778319d55b0bbbef55a6a0e7f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "WORK PRODUCT, INC."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2c:a8:0a:a7:4a:5e:c2:9e:23:71:3a:23:d5:c2:9a:68"
      cert_thumbprint     = "7612888362AD683E5366E63846A3A219C1DA250D"
      cert_valid_from     = "2024-11-04"
      cert_valid_to       = "2025-10-31"

      country             = "US"
      state               = "Colorado"
      locality            = "Golden"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2c:a8:0a:a7:4a:5e:c2:9e:23:71:3a:23:d5:c2:9a:68"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2D4B965D94FBD665EDE6488405DDEC72 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-13"
      version             = "1.0"

      hash                = "5b1530a8aeb899db804464290a486a6b0235ac608c287cb89522d652fb5d571c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Liandu Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2d:4b:96:5d:94:fb:d6:65:ed:e6:48:84:05:dd:ec:72"
      cert_thumbprint     = "CF566CFB203841F56834D2C8EB61E424AB9ADA3D"
      cert_valid_from     = "2025-06-13"
      cert_valid_to       = "2026-06-13"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2d:4b:96:5d:94:fb:d6:65:ed:e6:48:84:05:dd:ec:72"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2DFA8D6A2AC5446B93B8F15FBD1C3ED1 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-13"
      version             = "1.0"

      hash                = "496b7707e779c1aa2d22954037f5df17a0e528f4f3e97f89cbf40c795c57e36c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shantou City Pengjia Knitting Industry Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2d:fa:8d:6a:2a:c5:44:6b:93:b8:f1:5f:bd:1c:3e:d1"
      cert_thumbprint     = "E792FB73D372A1EF0E2593A478735D737BB0F29B"
      cert_valid_from     = "2024-09-13"
      cert_valid_to       = "2025-09-13"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shantou"
      email               = "???"
      rdn_serial_number   = "9144051378488590X0"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2d:fa:8d:6a:2a:c5:44:6b:93:b8:f1:5f:bd:1c:3e:d1"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2E7A3B33A57BF4F3B5F3D59473AF463C {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-14"
      version             = "1.0"

      hash                = "6ca519083401cfa60ecf35d94ccd4012a12d7d87a656e4a1a678e0a7729c49a2"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Uconfig Digital Sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2e:7a:3b:33:a5:7b:f4:f3:b5:f3:d5:94:73:af:46:3c"
      cert_thumbprint     = "54CF2850A07B4E1F4B3081DCB465FB384B140305"
      cert_valid_from     = "2025-10-14"
      cert_valid_to       = "2026-06-06"

      country             = "PL"
      state               = "Lower Silesian Voivodeship"
      locality            = "Wrocław"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2e:7a:3b:33:a5:7b:f4:f3:b5:f3:d5:94:73:af:46:3c"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_2F2E62C3A8A3A4B85C44D3DF84D6D41A {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-21"
      version             = "1.0"

      hash                = "c98f948bc2965c741c08290a8bdc81e16c8f28f267ad17eb0c42fb9a472fa1cc"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MULTIMEDIOS CORDILLERANOS SRL"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2f:2e:62:c3:a8:a3:a4:b8:5c:44:d3:df:84:d6:d4:1a"
      cert_thumbprint     = "CD4C578692C6E884980AE1C53E49800107C2D4CA"
      cert_valid_from     = "2025-07-21"
      cert_valid_to       = "2026-07-21"

      country             = "AR"
      state               = "San Juan Province"
      locality            = "San Juan"
      email               = "???"
      rdn_serial_number   = "30-71069624-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2f:2e:62:c3:a8:a3:a4:b8:5c:44:d3:df:84:d6:d4:1a"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_3094CA76D0BF4D5CA3E6F9A29C147E95 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-21"
      version             = "1.0"

      hash                = "5aac2fb148ad8ac3bf47840161acf0d111ff6898a06e2e3d2f2d544a373570c2"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Futurity Designs Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "30:94:ca:76:d0:bf:4d:5c:a3:e6:f9:a2:9c:14:7e:95"
      cert_thumbprint     = "D30FAAE824902AB96EA412D28B7D2058E0A607FD"
      cert_valid_from     = "2023-09-21"
      cert_valid_to       = "2024-09-20"

      country             = "GB"
      state               = "???"
      locality            = "Somerton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "30:94:ca:76:d0:bf:4d:5c:a3:e6:f9:a2:9c:14:7e:95"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_3148B279E3A48C7AE98E868611808C80 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-07"
      version             = "1.0"

      hash                = "5e806486ba11634d071bb202331a804c68bd2612494358408c4227ed0f14b748"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Teapot Software Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "31:48:b2:79:e3:a4:8c:7a:e9:8e:86:86:11:80:8c:80"
      cert_thumbprint     = "1D46B4FB8BAB6EC0185F4312F3ED7C31CACAEB73"
      cert_valid_from     = "2025-01-07"
      cert_valid_to       = "2026-01-07"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Vantaa"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "31:48:b2:79:e3:a4:8c:7a:e9:8e:86:86:11:80:8c:80"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_31749F1522AB3BDBCB1C05FB6806E40A {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-29"
      version             = "1.0"

      hash                = "b0ade668aef88619166dd49e3b5529dbe2e9f983b599e1d8488113a560dda23a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Super Creative Oy Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "31:74:9f:15:22:ab:3b:db:cb:1c:05:fb:68:06:e4:0a"
      cert_thumbprint     = "8FBBCDE4D167009F93F0278A18A5D943E0E2C239"
      cert_valid_from     = "2025-08-29"
      cert_valid_to       = "2026-08-29"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Espoo"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "31:74:9f:15:22:ab:3b:db:cb:1c:05:fb:68:06:e4:0a"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_345A016005DD65DAA24F6C6F86984533 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-26"
      version             = "1.0"

      hash                = "30890f2e20243d6ea815c88de1f9fd0ff9ce4f4f4a0737d4a964e875de74bfba"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOFTOLIO sp. z o.o."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "34:5a:01:60:05:dd:65:da:a2:4f:6c:6f:86:98:45:33"
      cert_thumbprint     = "F395135376359502AC2413C3D832669D608799E9"
      cert_valid_from     = "2025-03-26"
      cert_valid_to       = "2026-03-26"

      country             = "PL"
      state               = "Pomeranian Voivodeship"
      locality            = "Gdynia"
      email               = "???"
      rdn_serial_number   = "0000611933"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "34:5a:01:60:05:dd:65:da:a2:4f:6c:6f:86:98:45:33"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_37F680562CE95001419E3E6F24457D84 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-12"
      version             = "1.0"

      hash                = "0ec514bfafb165859fa07f3a06620b65c89680a901cd9ff010f7ffe7f5e875d6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "REAL GAMES DEVELOPMENT LTDA"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "37:f6:80:56:2c:e9:50:01:41:9e:3e:6f:24:45:7d:84"
      cert_thumbprint     = "C828EA8B16ACA73ACA00212A4548CF6A29FC4984"
      cert_valid_from     = "2025-02-12"
      cert_valid_to       = "2026-02-12"

      country             = "BR"
      state               = "RIO GRANDE DO NORTE"
      locality            = "PARNAMIRIM"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "37:f6:80:56:2c:e9:50:01:41:9e:3e:6f:24:45:7d:84"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_3C16154E4D7DE3DCE12A0030A213491F {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-05"
      version             = "1.0"

      hash                = "db15f45f69f863510986fb2198a8a6b3d55d8ccc8a2ed4bb30bc27bdd1bf151c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ftechnics, Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3c:16:15:4e:4d:7d:e3:dc:e1:2a:00:30:a2:13:49:1f"
      cert_thumbprint     = "8ECFB3A1CD45308C84C219A28D202290E0AF5575"
      cert_valid_from     = "2024-09-05"
      cert_valid_to       = "2025-09-14"

      country             = "US"
      state               = "New York"
      locality            = "New York"
      email               = "???"
      rdn_serial_number   = "2990613"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3c:16:15:4e:4d:7d:e3:dc:e1:2a:00:30:a2:13:49:1f"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_3C1DBC702E23FCA2729C388C0559047C {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-27"
      version             = "1.0"

      hash                = "5ed8e5d8424c289ff146535c86b21495d682d155ce2e03cdaf24b21d19239481"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INVOKESEC LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3c:1d:bc:70:2e:23:fc:a2:72:9c:38:8c:05:59:04:7c"
      cert_thumbprint     = "318970192EFF90907D07918A0FAF61A6F2D1F0AA"
      cert_valid_from     = "2025-02-27"
      cert_valid_to       = "2026-03-06"

      country             = "US"
      state               = "Utah"
      locality            = "Lehi"
      email               = "???"
      rdn_serial_number   = "13421273-0160"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3c:1d:bc:70:2e:23:fc:a2:72:9c:38:8c:05:59:04:7c"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_3C78C533A40E2049443DE9E079C14E1F {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-10"
      version             = "1.0"

      hash                = "fc939537045f4ebddfae0d3588bffdc5727cbf3dd3b1c5a5379796de3f844d98"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ali LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3c:78:c5:33:a4:0e:20:49:44:3d:e9:e0:79:c1:4e:1f"
      cert_thumbprint     = "D3CD0F6C12CBFE3A00CCAA4D58C26669D57FC671"
      cert_valid_from     = "2025-11-10"
      cert_valid_to       = "2026-07-11"

      country             = "US"
      state               = "Florida"
      locality            = "Palm City"
      email               = "???"
      rdn_serial_number   = "L24000239498"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3c:78:c5:33:a4:0e:20:49:44:3d:e9:e0:79:c1:4e:1f"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_3FEBAE41896885E91FDB20E0950C6054 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "bd21360149904ce42c6927d9c3fb482316f2537a4a7bce8b64990428e27a54ac"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ECHO INFINI SDN. BHD."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "3f:eb:ae:41:89:68:85:e9:1f:db:20:e0:95:0c:60:54"
      cert_thumbprint     = "29338264019B62D11F9C6C4B5A69B78B899B4DF6"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2027-01-13"

      country             = "MY"
      state               = "Johor"
      locality            = "Skudai"
      email               = "???"
      rdn_serial_number   = "202401031184"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "3f:eb:ae:41:89:68:85:e9:1f:db:20:e0:95:0c:60:54"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_4071BFD40B15020A57FAD20E1A50D3A7 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-14"
      version             = "1.0"

      hash                = "749d4056d5b6a0077f419e6e8c16c4655e370a5d1886695b7b65ddf547db137e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Raecomm Services Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "40:71:bf:d4:0b:15:02:0a:57:fa:d2:0e:1a:50:d3:a7"
      cert_thumbprint     = "C650164579439A7BC20B4A73F70335D67663DCEA"
      cert_valid_from     = "2023-09-14"
      cert_valid_to       = "2024-09-13"

      country             = "GB"
      state               = "England"
      locality            = "Rowlands Gill"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "40:71:bf:d4:0b:15:02:0a:57:fa:d2:0e:1a:50:d3:a7"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_4304E2AAAACA01BD7729407785C161B2 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-28"
      version             = "1.0"

      hash                = "24e265deef02a8ed892dd85a3c704d0a4fdea9d10e31c3aa4589f39fca64dd1a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ferrets Incorporated Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "43:04:e2:aa:aa:ca:01:bd:77:29:40:77:85:c1:61:b2"
      cert_thumbprint     = "2AC0CC82E2E696BDE53B6F13A8DB4CB034D9BBE5"
      cert_valid_from     = "2024-08-28"
      cert_valid_to       = "2025-08-27"

      country             = "GB"
      state               = "???"
      locality            = "Woodhall Spa"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "43:04:e2:aa:aa:ca:01:bd:77:29:40:77:85:c1:61:b2"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_48C978BAC2265C6A3E07D9F8D30FBCB3 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-22"
      version             = "1.0"

      hash                = "fbec0950cdb1fcd3193cfac31d48308fd91fb9d155ff628c2e589304df8b3222"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shiyu Bio-Tech Shijiazhuang Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "48:c9:78:ba:c2:26:5c:6a:3e:07:d9:f8:d3:0f:bc:b3"
      cert_thumbprint     = "EA84EE72931C3A07FD35B79F15407380F4241062"
      cert_valid_from     = "2024-08-22"
      cert_valid_to       = "2025-08-22"

      country             = "CN"
      state               = "Hebei"
      locality            = "Shijiazhuang"
      email               = "???"
      rdn_serial_number   = "91130182715863555Y"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "48:c9:78:ba:c2:26:5c:6a:3e:07:d9:f8:d3:0f:bc:b3"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_4C01CDAD03EB09079154E2306EA64BFB {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-18"
      version             = "1.0"

      hash                = "dcc64a3e8791dc7d343a656a67f0f9ff600ef5998f3730094a284b447cc43709"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Liuran Trading Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4c:01:cd:ad:03:eb:09:07:91:54:e2:30:6e:a6:4b:fb"
      cert_thumbprint     = "99F9E9B0AF0D8398C4FD6C52A4F8EFEDB5761853"
      cert_valid_from     = "2024-08-18"
      cert_valid_to       = "2025-08-18"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "913100005559922937"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4c:01:cd:ad:03:eb:09:07:91:54:e2:30:6e:a6:4b:fb"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_4D342A1C66BBC03F85A2CB9F1752E843 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-11"
      version             = "1.0"

      hash                = "98a8144cc73588295f749e521d89585dfcd74d808b3a010bc7bcb9def190a370"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NATIONAL CARE CONSORTIUM LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4d:34:2a:1c:66:bb:c0:3f:85:a2:cb:9f:17:52:e8:43"
      cert_thumbprint     = "49A0C82BE5047EE35E620F02D3B7D5616F17CE98"
      cert_valid_from     = "2024-12-11"
      cert_valid_to       = "2025-12-11"

      country             = "GB"
      state               = "???"
      locality            = "Nottingham"
      email               = "???"
      rdn_serial_number   = "10765210"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4d:34:2a:1c:66:bb:c0:3f:85:a2:cb:9f:17:52:e8:43"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_52690E015A8EC000D705BF0EB937D7EA {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "e2b5e92dd942c21c84a593d97483f0136abac73f21b6a7e73b53aaad78c35724"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HALO SOFTWARE LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "52:69:0e:01:5a:8e:c0:00:d7:05:bf:0e:b9:37:d7:ea"
      cert_thumbprint     = "B7F9882710AA256310BCEFA3DBE94ED1885C478E"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-12-24"

      country             = "GB"
      state               = "???"
      locality            = "Bath"
      email               = "???"
      rdn_serial_number   = "10856341"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "52:69:0e:01:5a:8e:c0:00:d7:05:bf:0e:b9:37:d7:ea"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_53878B7DF090BEB1AF673DD9B13F4FE9 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-26"
      version             = "1.0"

      hash                = "5705ba9c6c35cc9b6cfec8de204ce5e749a7794463705587015b682460e7f4e3"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Ruiyi Supply Chain Management Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:87:8b:7d:f0:90:be:b1:af:67:3d:d9:b1:3f:4f:e9"
      cert_thumbprint     = "5DED849D4FC58BFF553CFED17DE1944927F668F5"
      cert_valid_from     = "2024-11-26"
      cert_valid_to       = "2025-11-25"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310113MA1GK3AX4A"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:87:8b:7d:f0:90:be:b1:af:67:3d:d9:b1:3f:4f:e9"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_53E6BB421575CFA2BE73195FD4049955 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-30"
      version             = "1.0"

      hash                = "98ecdcc1c1f723f38bbbb3f33d870dea34eaeb2e832a6a88618104406057da51"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CAPELLO MEDIA SOLUTIONS LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "53:e6:bb:42:15:75:cf:a2:be:73:19:5f:d4:04:99:55"
      cert_thumbprint     = "AFA4DBE5B098717A926F7A28C100E87C9788BBDF"
      cert_valid_from     = "2025-06-30"
      cert_valid_to       = "2026-06-30"

      country             = "GB"
      state               = "???"
      locality            = "ALTRINCHAM"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "53:e6:bb:42:15:75:cf:a2:be:73:19:5f:d4:04:99:55"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_558687C575363293CD97EF8DBC7AAAF2 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-04"
      version             = "1.0"

      hash                = "ec0249a82e80a8856f4d50b537075f67f88a392ce20bb5fbaa18f0f069d91cd9"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yuval Ben Itzhak"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "55:86:87:c5:75:36:32:93:cd:97:ef:8d:bc:7a:aa:f2"
      cert_thumbprint     = "61d45d0d0dcdb9a585260f036664d41e702ef3c2f4ec6ef6a86217a9a329d30b"
      cert_valid_from     = "2025-09-04"
      cert_valid_to       = "2026-09-03"

      country             = "CZ"
      state               = "Praha, Hlavní město"
      locality            = "Prague"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "55:86:87:c5:75:36:32:93:cd:97:ef:8d:bc:7a:aa:f2"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_5762A43579C0117284D1A7EE91D547D4 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-21"
      version             = "1.0"

      hash                = "f0eada6645d7befc0993ebb0ff550019d13bec8bc66d3c479ffacde7d8127d82"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Đoàn Quốc Bảo Khánh"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "57:62:a4:35:79:c0:11:72:84:d1:a7:ee:91:d5:47:d4"
      cert_thumbprint     = "662E0243ADCF201DFF7CFE3665079CD9524CD97C"
      cert_valid_from     = "2025-04-21"
      cert_valid_to       = "2026-04-21"

      country             = "VN"
      state               = "Hà Tĩnh"
      locality            = "Huyện Thạch Hà"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "57:62:a4:35:79:c0:11:72:84:d1:a7:ee:91:d5:47:d4"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_579B9E221C8CC22FCF33CE826CF3737F {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-09"
      version             = "1.0"

      hash                = "8df71f5ed97d205f50b8cb87e9767faeec496dee1fbc11726bbc310d47b5eb12"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Lencall Technical Services Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "57:9b:9e:22:1c:8c:c2:2f:cf:33:ce:82:6c:f3:73:7f"
      cert_thumbprint     = "0ECBC9F0E2714A5520621C33781A7EC65805B669"
      cert_valid_from     = "2024-05-09"
      cert_valid_to       = "2025-05-09"

      country             = "GB"
      state               = "Scotland"
      locality            = "Nairn"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "57:9b:9e:22:1c:8c:c2:2f:cf:33:ce:82:6c:f3:73:7f"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_590D66DBF4CFAEC528DB3CD9079A53D1 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-23"
      version             = "1.0"

      hash                = "9d6ea8cc12e0a7143cc25df1067660717c17edce99419307a34a42987fcf26e5"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Anhui PepsiCo Information Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "59:0d:66:db:f4:cf:ae:c5:28:db:3c:d9:07:9a:53:d1"
      cert_thumbprint     = "7F401997FDA60D3EB3C4075E4F3201D0F0E6D11E"
      cert_valid_from     = "2025-09-23"
      cert_valid_to       = "2026-09-22"

      country             = "CN"
      state               = "Anhui"
      locality            = "Hefei"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "59:0d:66:db:f4:cf:ae:c5:28:db:3c:d9:07:9a:53:d1"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_5A2921F8FF4E923964AEE7F397DE65AB {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-22"
      version             = "1.0"

      hash                = "e58ded4d97b3e89176f91f007d82085aed7520ec338f605c0b0b8bce9c94a22a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Digital Online Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "5a:29:21:f8:ff:4e:92:39:64:ae:e7:f3:97:de:65:ab"
      cert_thumbprint     = "49F21B2DDBE9929CCEDB9616E67E9FC29F9B502E"
      cert_valid_from     = "2025-01-22"
      cert_valid_to       = "2026-01-22"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "5a:29:21:f8:ff:4e:92:39:64:ae:e7:f3:97:de:65:ab"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_5A5918074DE23BEC5F344BBACC7A3A90 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-26"
      version             = "1.0"

      hash                = "5e57136b6fa43c0f9c024d18d22be151e0f05be08796ae28d6f9623a07a2aa64"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THE COPY CAT LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "5a:59:18:07:4d:e2:3b:ec:5f:34:4b:ba:cc:7a:3a:90"
      cert_thumbprint     = "89A309FE672759A6DAA730C698E26B62BE093927"
      cert_valid_from     = "2025-09-26"
      cert_valid_to       = "2026-09-26"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "5a:59:18:07:4d:e2:3b:ec:5f:34:4b:ba:cc:7a:3a:90"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_61430D259BC002C2894A1DDFCBB9D7CB {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-10"
      version             = "1.0"

      hash                = "dc297aded70b0692ad0a24509e7bbec210bc0a1c7a105e99e1a8f76e3861ad34"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Just-Works ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "61:43:0d:25:9b:c0:02:c2:89:4a:1d:df:cb:b9:d7:cb"
      cert_thumbprint     = "B6186819EF589837FFB19EA29D515F87CA75D315"
      cert_valid_from     = "2025-06-10"
      cert_valid_to       = "2026-06-10"

      country             = "DK"
      state               = "Capital Region of Denmark"
      locality            = "Kongens Lyngby"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "61:43:0d:25:9b:c0:02:c2:89:4a:1d:df:cb:b9:d7:cb"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_654E843F048E3CEA550C9062AC5C5193 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-01"
      version             = "1.0"

      hash                = "f82bee604ef597b2dcd0d8f5871680fe1233c70867214ec78f050388f3b02691"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Paperbucketmdb ApS"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "65:4e:84:3f:04:8e:3c:ea:55:0c:90:62:ac:5c:51:93"
      cert_thumbprint     = "8456DDD90485387174852FCCE67241103F0E56F8"
      cert_valid_from     = "2025-04-01"
      cert_valid_to       = "2026-04-01"

      country             = "DK"
      state               = "Hovedstaden"
      locality            = "København"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "65:4e:84:3f:04:8e:3c:ea:55:0c:90:62:ac:5c:51:93"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_6604C26C7C8B116647454F000EFCA4A8 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-10"
      version             = "1.0"

      hash                = "9794c2f6949b96de153acc516d901140353ec9597d8822539a1fd1d629e12571"
      malware             = "Unknown"
      malware_type        = "Infostealer"
      malware_notes       = "The malware was disguised as a PDF. The file itself is an InnoSetup installer with a password protected payload."

      signer              = "DESKFUND BENEFIT NIDHI LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "66:04:c2:6c:7c:8b:11:66:47:45:4f:00:0e:fc:a4:a8"
      cert_thumbprint     = "CAAA615F6FFF277DF49504D4D42A291C19982C02"
      cert_valid_from     = "2025-10-10"
      cert_valid_to       = "2026-10-10"

      country             = "IN"
      state               = "Uttar Pradesh"
      locality            = "Raebareli"
      email               = "???"
      rdn_serial_number   = "UDYAM-UP-43-0159626"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "66:04:c2:6c:7c:8b:11:66:47:45:4f:00:0e:fc:a4:a8"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_69C55475FFD7B1A2474296E14C5CF8D9 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-11"
      version             = "1.0"

      hash                = "79b6e63218982c1e85a5e1798c5484e7e034cfecbe9f2da604f668fda8428af4"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "INDCARE AFRICA LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "69:c5:54:75:ff:d7:b1:a2:47:42:96:e1:4c:5c:f8:d9"
      cert_thumbprint     = "643F5BE0BC3ED89ADE028AAF7AA5D50B84C50E8F"
      cert_valid_from     = "2024-11-11"
      cert_valid_to       = "2025-11-11"

      country             = "KE"
      state               = "???"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2009/10319"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "69:c5:54:75:ff:d7:b1:a2:47:42:96:e1:4c:5c:f8:d9"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_6A90068EF19E34BCB5E23FA6C211CBD6 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-18"
      version             = "1.0"

      hash                = "1112b72f47b7d09835c276c412c83d89b072b2f0fb25a0c9e2fed7cf08b55a41"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THE COMB REIVERS LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "6a:90:06:8e:f1:9e:34:bc:b5:e2:3f:a6:c2:11:cb:d6"
      cert_thumbprint     = "5B3817E85E23BA9FD84455B18E58B44F476B5909"
      cert_valid_from     = "2025-03-18"
      cert_valid_to       = "2026-03-18"

      country             = "GB"
      state               = "???"
      locality            = "Hexham"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "6a:90:06:8e:f1:9e:34:bc:b5:e2:3f:a6:c2:11:cb:d6"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_6A93DC8D2EA289E5B5965FECD0E4304D {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-11"
      version             = "1.0"

      hash                = "6fe37a5615b3c47e4c6f7eb7eca0bdcab9e05db9a39a1b6ec83917eed7bb72ba"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Công Ty Tnhh Thương Mại Và Dich Vụ La Media"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6a:93:dc:8d:2e:a2:89:e5:b5:96:5f:ec:d0:e4:30:4d"
      cert_thumbprint     = "BC83BA97BBD2AD1B7BF363ED7B12E0AD69907EF4"
      cert_valid_from     = "2025-03-11"
      cert_valid_to       = "2026-03-11"

      country             = "VN"
      state               = "???"
      locality            = "Hà Nội"
      email               = "???"
      rdn_serial_number   = "0110305928"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6a:93:dc:8d:2e:a2:89:e5:b5:96:5f:ec:d0:e4:30:4d"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_6BEDCE92A6154B7E7E52ECE2FC8D0CC3 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-09-18"
      version             = "1.0"

      hash                = "2deeeda412c40ad515dca940916a376d187219ed09ed697b4be4879b7091ec53"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Ekb Path Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "6b:ed:ce:92:a6:15:4b:7e:7e:52:ec:e2:fc:8d:0c:c3"
      cert_thumbprint     = "9F7ADD6E169A09F23FE289D2CD1759AAB4C5FA9C"
      cert_valid_from     = "2023-09-18"
      cert_valid_to       = "2024-09-17"

      country             = "GB"
      state               = "???"
      locality            = "Northampton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "6b:ed:ce:92:a6:15:4b:7e:7e:52:ec:e2:fc:8d:0c:c3"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_6E0368FFC87F26F9D13F4412AAA3E915 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-22"
      version             = "1.0"

      hash                = "ea18b965ab43d927a1d690f395f4e2b55a15db9744f68454a86b5508b302c404"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Just Add Water Italian Pizza Bread Pasta Mix Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "6e:03:68:ff:c8:7f:26:f9:d1:3f:44:12:aa:a3:e9:15"
      cert_thumbprint     = "164375B0C85F98E23533BC584F19FF514F74686B"
      cert_valid_from     = "2024-03-22"
      cert_valid_to       = "2025-03-22"

      country             = "CA"
      state               = "Alberta"
      locality            = "Calgary"
      email               = "???"
      rdn_serial_number   = "858926-7"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "6e:03:68:ff:c8:7f:26:f9:d1:3f:44:12:aa:a3:e9:15"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_740833F89CC52CAE8CEA1984A66DBB66 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-30"
      version             = "1.0"

      hash                = "882759dd0f306ab06f597c2db3011e82eff5bb7515de5d28a20b6913fe7f5626"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ConsolHQ LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "74:08:33:f8:9c:c5:2c:ae:8c:ea:19:84:a6:6d:bb:66"
      cert_thumbprint     = "787863161875446360E7486D3CF5E34E15DC8009"
      cert_valid_from     = "2024-08-30"
      cert_valid_to       = "2025-08-30"

      country             = "GB"
      state               = "???"
      locality            = "Erith"
      email               = "???"
      rdn_serial_number   = "12800651"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "74:08:33:f8:9c:c5:2c:ae:8c:ea:19:84:a6:6d:bb:66"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_77E1B35854DFA98B9702C7F4C4FED60D {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-30"
      version             = "1.0"

      hash                = "fbd914b7d9019785d62c25ad164901752c5587c0847e32598e66fa25b6cf23cb"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "TECH SOLUTIONS BHAM INC."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "77:e1:b3:58:54:df:a9:8b:97:02:c7:f4:c4:fe:d6:0d"
      cert_thumbprint     = "8BDF9C2CC3E1D7E917DE1D0A123029066FB88DEE"
      cert_valid_from     = "2024-10-30"
      cert_valid_to       = "2025-10-30"

      country             = "US"
      state               = "Alabama"
      locality            = "Birmingham"
      email               = "???"
      rdn_serial_number   = "000-826-105"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "77:e1:b3:58:54:df:a9:8b:97:02:c7:f4:c4:fe:d6:0d"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_78911BF2BB81FCD89335539B2D06BC3D {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-06"
      version             = "1.0"

      hash                = "6eeb6689fd6cdc2cfac77a0ab6741e5ee2d56129af63d609f1365032070c9a22"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Commander Software Solutions Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "78:91:1b:f2:bb:81:fc:d8:93:35:53:9b:2d:06:bc:3d"
      cert_thumbprint     = "B203838512C07B674B4E7B76D6D8214910C0FCF0"
      cert_valid_from     = "2024-08-06"
      cert_valid_to       = "2025-08-06"

      country             = "FI"
      state               = "Varsinais-Suomi"
      locality            = "Turku"
      email               = "???"
      rdn_serial_number   = "3019213-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "78:91:1b:f2:bb:81:fc:d8:93:35:53:9b:2d:06:bc:3d"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_7A1D9DFB337DB9260B223D2D1D71A559 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-26"
      version             = "1.0"

      hash                = "2ce42584e83228377d4513d8503bcd10aa2cd4a23c4a87f1b57ef3a081361552"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sukhpreet Singh"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "7a:1d:9d:fb:33:7d:b9:26:0b:22:3d:2d:1d:71:a5:59"
      cert_thumbprint     = "AF179EDB2224E472BD9DAE781027CB3E0EC40872"
      cert_valid_from     = "2024-07-26"
      cert_valid_to       = "2025-07-26"

      country             = "IN"
      state               = "Punjab"
      locality            = "Amritsar"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "7a:1d:9d:fb:33:7d:b9:26:0b:22:3d:2d:1d:71:a5:59"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_7A562978D709B11CAC4D6FCBA14954DB {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-10"
      version             = "1.0"

      hash                = "a83dd6a6ae07843b72caf4552474ec703c13050e61ba8e78ba0a72721a0d099b"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Paul Garner Consulting Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:56:29:78:d7:09:b1:1c:ac:4d:6f:cb:a1:49:54:db"
      cert_thumbprint     = "E019D7719F55161534BB0C37DFFEFF1EF564AC31"
      cert_valid_from     = "2024-09-10"
      cert_valid_to       = "2025-09-10"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "09714891"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:56:29:78:d7:09:b1:1c:ac:4d:6f:cb:a1:49:54:db"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_7AB605B1E1AB02C04422CE5490977D20 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-16"
      version             = "1.0"

      hash                = "6c004d89d657f58f5ecf1367288e2af8e264f62429d3b7115be116403eb1b2c6"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ELLEN SOFTWARE SOLUTIONS LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:b6:05:b1:e1:ab:02:c0:44:22:ce:54:90:97:7d:20"
      cert_thumbprint     = "2BB20F82B61B7AE5A4A2526017A247792A0BFAC2"
      cert_valid_from     = "2024-12-16"
      cert_valid_to       = "2025-12-16"

      country             = "GB"
      state               = "???"
      locality            = "Bath"
      email               = "???"
      rdn_serial_number   = "11508460"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:b6:05:b1:e1:ab:02:c0:44:22:ce:54:90:97:7d:20"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_7C9920452F17D886D0C4A9339F9EB792 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-07"
      version             = "1.0"

      hash                = "d2f02dd1dd325f3cca60672ac5b3d612db39e6139e2634f41890ce7e8c92f2a7"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "IC DIGITAL SP Z O O"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7c:99:20:45:2f:17:d8:86:d0:c4:a9:33:9f:9e:b7:92"
      cert_thumbprint     = "247D0C8B88667B382141F5045BFF63263EE3306B"
      cert_valid_from     = "2025-05-07"
      cert_valid_to       = "2026-05-07"

      country             = "PL"
      state               = "Masovian Voivodeship"
      locality            = "Warszawa"
      email               = "???"
      rdn_serial_number   = "0000481231"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7c:99:20:45:2f:17:d8:86:d0:c4:a9:33:9f:9e:b7:92"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_7CDE5F584955D2C8D628B78A52D971C2 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-20"
      version             = "1.0"

      hash                = "90edf602e2da6be9a5512adce1354d79674eb41d977050d2b8d15f0eab29f090"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhongguan Biotechnology (Hunchun) Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7c:de:5f:58:49:55:d2:c8:d6:28:b7:8a:52:d9:71:c2"
      cert_thumbprint     = "AB33C3E5C1EC5AEEE951E39014563AB937735B9A"
      cert_valid_from     = "2025-03-20"
      cert_valid_to       = "2026-03-16"

      country             = "CN"
      state               = "Jilin"
      locality            = "Yanbian Prefecture"
      email               = "???"
      rdn_serial_number   = "91222404MA1468WM01"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7c:de:5f:58:49:55:d2:c8:d6:28:b7:8a:52:d9:71:c2"
      )
}

rule MAL_Compromised_Cert_Unknown_SSL_com_7D0CDDA8F234B4F4B00E0D5448B72675 {
   meta:
      description         = "Detects Unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-13"
      version             = "1.0"

      hash                = "59b483eb9fb0cab4d97e33c083bcf25f9cb5fff771aa08cec50d6dab7c6e21b4"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "EVRO DERMA KOSMETIKS, OSOO"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7d:0c:dd:a8:f2:34:b4:f4:b0:0e:0d:54:48:b7:26:75"
      cert_thumbprint     = "702A511D966AAD4A5CB63F766F7EB4837FE18B59"
      cert_valid_from     = "2025-03-13"
      cert_valid_to       = "2026-03-13"

      country             = "KG"
      state               = "???"
      locality            = "Bishkek"
      email               = "???"
      rdn_serial_number   = "210568-3301-OOO"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7d:0c:dd:a8:f2:34:b4:f4:b0:0e:0d:54:48:b7:26:75"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_009211EB6FADC4800F3FB2A49230C8FC62 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-08"
      version             = "1.0"

      hash                = "415b6d1bb78cb74a468b29e7af09e885999cfcabf2c413f3bf533c2191d4e626"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Mainstay Crypto LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:92:11:eb:6f:ad:c4:80:0f:3f:b2:a4:92:30:c8:fc:62"
      cert_thumbprint     = "C0A01D5A2401E3FBB83118A16DAEC0DBAA5B454A"
      cert_valid_from     = "2025-01-08"
      cert_valid_to       = "2026-01-08"

      country             = "US"
      state               = "New Hampshire"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:92:11:eb:6f:ad:c4:80:0f:3f:b2:a4:92:30:c8:fc:62"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_009B2D7164E12919C93E6261A52AB49EAE {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-02-14"
      version             = "1.0"

      hash                = "bcfd9c98c0a9c261f9bfcc85ccd12082f3debd460b666421b422f6639da39070"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Andres Martinez"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "00:9b:2d:71:64:e1:29:19:c9:3e:62:61:a5:2a:b4:9e:ae"
      cert_thumbprint     = "AE721B4F7130774504CE54A1948CD6BF29DFD53D"
      cert_valid_from     = "2024-02-14"
      cert_valid_to       = "2025-02-13"

      country             = "US"
      state               = "Texas"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "00:9b:2d:71:64:e1:29:19:c9:3e:62:61:a5:2a:b4:9e:ae"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00B1566A28378C598B0FAB2E42EC359F01 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-15"
      version             = "1.0"

      hash                = "a946a59d49e946a1eebfcf6ff2e8e46515380cd4668f60b265cb1a891ee0bd68"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Internet Share Media LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b1:56:6a:28:37:8c:59:8b:0f:ab:2e:42:ec:35:9f:01"
      cert_thumbprint     = "1E2DD38E14B98BB003C2BE96A7414FE747C7CCCE"
      cert_valid_from     = "2024-05-15"
      cert_valid_to       = "2025-05-15"

      country             = "US"
      state               = "Delaware"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "7634313"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b1:56:6a:28:37:8c:59:8b:0f:ab:2e:42:ec:35:9f:01"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00B38A247683D8305C63B86FF1058C1ABE {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-16"
      version             = "1.0"

      hash                = "815f48f859ead76effaa4b8ad2a1cd36b563003cbec56c5f655732e24bd20647"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yongji Xiaodong Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b3:8a:24:76:83:d8:30:5c:63:b8:6f:f1:05:8c:1a:be"
      cert_thumbprint     = "512698469C15742F325AF0D13E1E9386DDCB91F3"
      cert_valid_from     = "2025-09-16"
      cert_valid_to       = "2026-09-16"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b3:8a:24:76:83:d8:30:5c:63:b8:6f:f1:05:8c:1a:be"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00B7A7CAF4F460E829E9EC6242656E9EBC {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-14"
      version             = "1.0"

      hash                = "cd7bc397ef12fa884dd717066ab377165bbb7a335f8909ebf4d61328b1d77e6c"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shanghai Yuesong Information Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b7:a7:ca:f4:f4:60:e8:29:e9:ec:62:42:65:6e:9e:bc"
      cert_thumbprint     = "64041D7F9952E102B669690C61EFD12F77E8E497"
      cert_valid_from     = "2024-05-14"
      cert_valid_to       = "2025-05-14"

      country             = "CN"
      state               = "Shanghai Shi"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b7:a7:ca:f4:f4:60:e8:29:e9:ec:62:42:65:6e:9e:bc"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00D2AC939F9CD0551ECE4BEA6578EF29FF {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-03"
      version             = "1.0"

      hash                = "7061a3fbc6de3f2ab0eb819d9f6734718e11f69d8e30bf8bd392a9ba1dd63d50"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shandong Shangchuan Smart Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:d2:ac:93:9f:9c:d0:55:1e:ce:4b:ea:65:78:ef:29:ff"
      cert_thumbprint     = "980995C1299BF37B0330851D4B7EF27DAD7207C0"
      cert_valid_from     = "2025-10-03"
      cert_valid_to       = "2026-10-03"

      country             = "CN"
      state               = "Shandong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:d2:ac:93:9f:9c:d0:55:1e:ce:4b:ea:65:78:ef:29:ff"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00D38D292DC0439ADDA31068E2BC953FBE {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-10"
      version             = "1.0"

      hash                = "e0dc3f6155598058e276b1cb9da045ebc85e012cb4d706c17724f7afefc14058"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SORT CONSULTANCY LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:d3:8d:29:2d:c0:43:9a:dd:a3:10:68:e2:bc:95:3f:be"
      cert_thumbprint     = "6A56E83B550C647BC931D830800943A031EF02FF"
      cert_valid_from     = "2023-05-10"
      cert_valid_to       = "2024-05-10"

      country             = "GB"
      state               = "London"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:d3:8d:29:2d:c0:43:9a:dd:a3:10:68:e2:bc:95:3f:be"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00E344D9F815A547C0744F4C076954DEC2 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-04"
      version             = "1.0"

      hash                = "502f2485bf50fed52326de41cee68d08f4c0cb5fbe2383ae1f03f5bdc87d2e1e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Infinix Technologies"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:e3:44:d9:f8:15:a5:47:c0:74:4f:4c:07:69:54:de:c2"
      cert_thumbprint     = "E761EB1F9731DBF0E3995982F783F2CC95AA3D1A"
      cert_valid_from     = "2025-02-04"
      cert_valid_to       = "2026-02-04"

      country             = "IN"
      state               = "Karnataka"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "UDYAM-KR-03-0175583"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:e3:44:d9:f8:15:a5:47:c0:74:4f:4c:07:69:54:de:c2"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00E9AAD8A3D342FEE128133E0B0A3C51D0 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "b285a84fab8597de852adeadf3dcbe3f32bf40965bce789b057e987615cfaf83"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "55.604.504 Rafael Ferreira de Carvalho"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:e9:aa:d8:a3:d3:42:fe:e1:28:13:3e:0b:0a:3c:51:d0"
      cert_thumbprint     = "704ACB8A8C5F1A52843D1A509E2D5BFE7C8325D8"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2025-10-30"

      country             = "BR"
      state               = "Distrito Federal"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "55.604.504/0001-02"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:e9:aa:d8:a3:d3:42:fe:e1:28:13:3e:0b:0a:3c:51:d0"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00EA59A445C036770F1700DBC8A5BF7FF7 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-26"
      version             = "1.0"

      hash                = "31cccd7f8e7db26c12f522c0f1519ffa459fdd0120e4911c03fb2fcf2432ca00"
      malware             = "Unknown"
      malware_type        = "Adware"
      malware_notes       = "This app is PCAppStore. PCAppStore is known to be downloaded by accident by users and known to connect to a wide range of risky behaviors and network connections. While adware typically doesn't get its certificate revoked, the issuer decided to in this case. This software represents a latent risk and we recommend removing it."

      signer              = "Fast Corporate Ltd"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:ea:59:a4:45:c0:36:77:0f:17:00:db:c8:a5:bf:7f:f7"
      cert_thumbprint     = "D1EA027182B1EB2D017AE359045C048CB9B60402"
      cert_valid_from     = "2022-07-26"
      cert_valid_to       = "2023-07-26"

      country             = "IL"
      state               = "Tel Aviv"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:ea:59:a4:45:c0:36:77:0f:17:00:db:c8:a5:bf:7f:f7"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00F284A0585FC0AF0D35AEE5177A7B3442 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-08"
      version             = "1.0"

      hash                = "9a5c14f2edefa00865e0cf3d86a3df4a59e2ec24efb73cabb4c11cf605cf133a"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cockos Incorporated"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "00:f2:84:a0:58:5f:c0:af:0d:35:ae:e5:17:7a:7b:34:42"
      cert_thumbprint     = "437196059B4553CE69BC94B0225D510AA4B586F0"
      cert_valid_from     = "2025-05-08"
      cert_valid_to       = "2025-12-18"

      country             = "US"
      state               = "New York"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "00:f2:84:a0:58:5f:c0:af:0d:35:ae:e5:17:7a:7b:34:42"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00F7F4595C9FA4807AB41DACF88BAD113C {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-14"
      version             = "1.0"

      hash                = "62313b268ba0c0aa52c1e7e6822110af2b6df42761dc381dd45bbc6da487a1e2"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Plooto Star Inc"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:f7:f4:59:5c:9f:a4:80:7a:b4:1d:ac:f8:8b:ad:11:3c"
      cert_thumbprint     = "2347883329B8455D0A0F0D207A3A2279B339DFE8"
      cert_valid_from     = "2025-08-14"
      cert_valid_to       = "2026-08-14"

      country             = "US"
      state               = "Delaware"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "5767772"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:f7:f4:59:5c:9f:a4:80:7a:b4:1d:ac:f8:8b:ad:11:3c"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_00FF6F8EB16961447B9ED8DB0EC52836DB {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-05"
      version             = "1.0"

      hash                = "eb9ae22d364a6eb1c7aa469cc25809f4040c8a9a7722ac87ca041123e97d35ae"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SIU PHYUT"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:ff:6f:8e:b1:69:61:44:7b:9e:d8:db:0e:c5:28:36:db"
      cert_thumbprint     = "B12A0AA65C9005CDB0D2F9DC092A4B937FF322CF"
      cert_valid_from     = "2023-04-05"
      cert_valid_to       = "2026-04-04"

      country             = "VN"
      state               = "Gia Lai"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:ff:6f:8e:b1:69:61:44:7b:9e:d8:db:0e:c5:28:36:db"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_012E3520CF2A48ABE44FF45C532FEB12 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-02"
      version             = "1.0"

      hash                = "652b6a4cc3727974f457a0ce43f5a42ee03cd9135faf3fcae83b8155b3944086"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "amir dow"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "01:2e:35:20:cf:2a:48:ab:e4:4f:f4:5c:53:2f:eb:12"
      cert_thumbprint     = "2735C134B87B896909C315945DEDFBB1A4AC79BA"
      cert_valid_from     = "2024-10-02"
      cert_valid_to       = "2027-10-02"

      country             = "IL"
      state               = "Northern"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "01:2e:35:20:cf:2a:48:ab:e4:4f:f4:5c:53:2f:eb:12"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_059D20D33CD12FCFFDBBDA534FD1C675 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-27"
      version             = "1.0"

      hash                = "00247c4c6aa56c58e4661317a7c4253245d8280d1d07502c9cb0b23d675edf3f"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "万宁市领新创维工程有限公司"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "05:9d:20:d3:3c:d1:2f:cf:fd:bb:da:53:4f:d1:c6:75"
      cert_thumbprint     = "995ADC0A5AF35672C35E3B14C13DA808783D992E"
      cert_valid_from     = "2024-11-27"
      cert_valid_to       = "2025-11-27"

      country             = "CN"
      state               = "海南省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "914212005539498738"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "05:9d:20:d3:3c:d1:2f:cf:fd:bb:da:53:4f:d1:c6:75"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_1E074DA361479DD29F2E014AB6ACF5F2 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-15"
      version             = "1.0"

      hash                = "934f86cd47c0deb85fc6f6e382f55c591805d7056075f215a291a24388730ec1"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cockos Incorporated"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "1e:07:4d:a3:61:47:9d:d2:9f:2e:01:4a:b6:ac:f5:f2"
      cert_thumbprint     = "EA7B7AC4E637D8FBDDFE5D2FB691F1A0C10E3C43"
      cert_valid_from     = "2025-04-15"
      cert_valid_to       = "2025-12-18"

      country             = "US"
      state               = "New York"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "1e:07:4d:a3:61:47:9d:d2:9f:2e:01:4a:b6:ac:f5:f2"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_22CFC84BD7696394B5169DD21E1CF34D {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-07"
      version             = "1.0"

      hash                = "13bfddbe0cd6050de5d66030f14c4a0e66550845461429ebd70b642b7b70f741"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Cockos Incorporated"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "22:cf:c8:4b:d7:69:63:94:b5:16:9d:d2:1e:1c:f3:4d"
      cert_thumbprint     = "841CB9672DD77039E8EA94FFE95E891BC0799442"
      cert_valid_from     = "2025-04-07"
      cert_valid_to       = "2025-12-18"

      country             = "US"
      state               = "New York"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "22:cf:c8:4b:d7:69:63:94:b5:16:9d:d2:1e:1c:f3:4d"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_23789C7CB908269A8329C5C9C08AD4C1 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-17"
      version             = "1.0"

      hash                = "90d7f4352676535a9f76083ac0a63a6c0e11e08dbd1084f6ba28ec0eb69ada3e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Pingding Jiangxin Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "23:78:9c:7c:b9:08:26:9a:83:29:c5:c9:c0:8a:d4:c1"
      cert_thumbprint     = "D046DC77B12EDD154CDF15B9D419915AC8401CA3"
      cert_valid_from     = "2025-06-17"
      cert_valid_to       = "2026-06-17"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "23:78:9c:7c:b9:08:26:9a:83:29:c5:c9:c0:8a:d4:c1"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_3B1955CFEAA2C9C392292E00287D4A6C {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-25"
      version             = "1.0"

      hash                = "f1787b9553ce260b889cbb40b456d62f2cfa01b10f7e512a3528790c65640669"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MECHA MANGA - FZCO"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "3b:19:55:cf:ea:a2:c9:c3:92:29:2e:00:28:7d:4a:6c"
      cert_thumbprint     = "1F3CCE31883C9EF47711A1EE96294E479CE69CFB"
      cert_valid_from     = "2024-03-25"
      cert_valid_to       = "2025-03-25"

      country             = "AE"
      state               = "Dubai"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "3b:19:55:cf:ea:a2:c9:c3:92:29:2e:00:28:7d:4a:6c"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_3FF70CFB935B5B7136DC064BC320EAF7 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-22"
      version             = "1.0"

      hash                = "4183d7c1b16555019f5cfc6b24a1314d166b9558f35c68e10583d8e4d02fa87e"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "周伟"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "3f:f7:0c:fb:93:5b:5b:71:36:dc:06:4b:c3:20:ea:f7"
      cert_thumbprint     = "C26C07A0BC6AEA3866472A8323F93477DD87E2DC"
      cert_valid_from     = "2023-03-22"
      cert_valid_to       = "2026-03-21"

      country             = "CN"
      state               = "湖南省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "3f:f7:0c:fb:93:5b:5b:71:36:dc:06:4b:c3:20:ea:f7"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_4E8FD0366C20091348C62BE2F2976CC9 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-10-03"
      version             = "1.0"

      hash                = "764e4ce9385a20a680e34b80792846340a32e68e733bf50ad8424a896266590d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Tommy Tech LTD"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "4e:8f:d0:36:6c:20:09:13:48:c6:2b:e2:f2:97:6c:c9"
      cert_thumbprint     = "9150D859C1E2041134603E703FBD6650D7D73C12"
      cert_valid_from     = "2023-10-03"
      cert_valid_to       = "2026-10-03"

      country             = "IL"
      state               = "Haifa"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "516196565"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "4e:8f:d0:36:6c:20:09:13:48:c6:2b:e2:f2:97:6c:c9"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_573FD429CFC430E46C5797AC5B84BCBD {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-22"
      version             = "1.0"

      hash                = "8ecd3c8c126be7128bf654456d171284f03e4f212c27e1b33f875b8907a7bc65"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "App Interplace LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "57:3f:d4:29:cf:c4:30:e4:6c:57:97:ac:5b:84:bc:bd"
      cert_thumbprint     = "3EBBB02A48F7DB26B708F5E535E8DCE8EFF2CAEA"
      cert_valid_from     = "2025-01-22"
      cert_valid_to       = "2028-01-22"

      country             = "US"
      state               = "Delaware"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "57:3f:d4:29:cf:c4:30:e4:6c:57:97:ac:5b:84:bc:bd"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_5C0250B49652EA243EBC0F2253844A8E {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-26"
      version             = "1.0"

      hash                = "05eed8d83fbcba33734cf113ee97cca5d760fc66052c32b3e7c791cda6e44865"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Hibernation Holdings, LLC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "5c:02:50:b4:96:52:ea:24:3e:bc:0f:22:53:84:4a:8e"
      cert_thumbprint     = "257A074A90E6243B65EF49C092AE9CCE61EBEE19"
      cert_valid_from     = "2024-08-26"
      cert_valid_to       = "2025-08-26"

      country             = "US"
      state               = "New York"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "5c:02:50:b4:96:52:ea:24:3e:bc:0f:22:53:84:4a:8e"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_736E809F29D85F0391217FC62D8530C6 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-06"
      version             = "1.0"

      hash                = "1af7e7bf85eee6839a20db4c8c01c842490211e76051e65e0796726af2dbc1fd"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhiya Yunke (Chengdu) Finance and Tax Service Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "73:6e:80:9f:29:d8:5f:03:91:21:7f:c6:2d:85:30:c6"
      cert_thumbprint     = "08A781ABE2FFEDE9C3DD65CBDA3CB0C8F9056D04"
      cert_valid_from     = "2023-03-06"
      cert_valid_to       = "2025-03-05"

      country             = "CN"
      state               = "四川省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "73:6e:80:9f:29:d8:5f:03:91:21:7f:c6:2d:85:30:c6"
      )
}

rule MAL_Compromised_Cert_Unknown_Sectigo_E9AAD8A3D342FEE128133E0B0A3C51D0 {
   meta:
      description         = "Detects Unknown with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-13"
      version             = "1.0"

      hash                = "839c4e05847d6a8662bc3ade6298372e6fd546e74d7e205e549419782043899d"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "55.604.504 Rafael Ferreira de Carvalho"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "e9:aa:d8:a3:d3:42:fe:e1:28:13:3e:0b:0a:3c:51:d0"
      cert_thumbprint     = "a620cf23dbe296979675f9a0eb5c003595b7b48ac7d0067b5760a1d31545e030"
      cert_valid_from     = "2025-01-13"
      cert_valid_to       = "2025-10-30"

      country             = "BR"
      state               = "Distrito Federal"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "55.604.504/0001-02"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "e9:aa:d8:a3:d3:42:fe:e1:28:13:3e:0b:0a:3c:51:d0"
      )
}

rule MAL_Compromised_Cert_Unknown_Verokey_01ADCD97B8AE44D40185DC60C1D2AE56 {
   meta:
      description         = "Detects Unknown with compromised cert (Verokey)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-21"
      version             = "1.0"

      hash                = "00748bd6b97e6ea3b46750c45691689401ab32505387d963c3efdcfa758b6227"
      malware             = "Unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "山西荣升源科贸有限公司"
      cert_issuer_short   = "Verokey"
      cert_issuer         = "Verokey Secure Code"
      cert_serial         = "01:ad:cd:97:b8:ae:44:d4:01:85:dc:60:c1:d2:ae:56"
      cert_thumbprint     = "B5EA2F1CEAB2BD463277A47A356C7CA4FB048469"
      cert_valid_from     = "2025-01-21"
      cert_valid_to       = "2025-06-13"

      country             = "CN"
      state               = "山西省"
      locality            = "太原市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Verokey Secure Code" and
         sig.serial == "01:ad:cd:97:b8:ae:44:d4:01:85:dc:60:c1:d2:ae:56"
      )
}

rule MAL_Compromised_Cert_Unknown_bootkit_SSL_com_767FCD8623FB84E3D6E7CF6F8A8078A8 {
   meta:
      description         = "Detects Unknown, bootkit? with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-12-12"
      version             = "1.0"

      hash                = "233ba2ed10b866b03a8f969e68c1c35384e6c08fe58adc5953a5f99a4f6c71db"
      malware             = "Unknown, bootkit?"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sichuan Mingchuang Sealing Technology Co., Ltd."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "76:7f:cd:86:23:fb:84:e3:d6:e7:cf:6f:8a:80:78:a8"
      cert_thumbprint     = "7C046F80E9C41C32A7B488C9E1FA6E782425C520"
      cert_valid_from     = "2023-12-12"
      cert_valid_to       = "2024-12-11"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA62JN364R"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "76:7f:cd:86:23:fb:84:e3:d6:e7:cf:6f:8a:80:78:a8"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_0582253D22D291481B75770C1556C56F {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-14"
      version             = "1.0"

      hash                = "4ceb4a501721f0277072a14220ff435eecedee9930b150adf11057603cf08842"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Open Source Developer, Hao Chen"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "05:82:25:3d:22:d2:91:48:1b:75:77:0c:15:56:c5:6f"
      cert_thumbprint     = "F5EAE4A53268644837FEED29FED03925523B7005"
      cert_valid_from     = "2025-06-14"
      cert_valid_to       = "2026-06-14"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Hanyuan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "05:82:25:3d:22:d2:91:48:1b:75:77:0c:15:56:c5:6f"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_05E39C93D531D6E0DDDCC6774C003F3C {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-04"
      version             = "1.0"

      hash                = "46149a4e6bd7f01e816ff0e98d10e2248f6560b8dc075a2bd00a48d7095c51d5"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "湖南蒂角企业管理服务有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "05:e3:9c:93:d5:31:d6:e0:dd:dc:c6:77:4c:00:3f:3c"
      cert_thumbprint     = "A88E8CD81805E8E4768419711DA1575B76C1B2BC"
      cert_valid_from     = "2025-11-04"
      cert_valid_to       = "2026-11-04"

      country             = "CN"
      state               = "Hunan"
      locality            = "Changsha"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "05:e3:9c:93:d5:31:d6:e0:dd:dc:c6:77:4c:00:3f:3c"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_097B634740A6CF3A61F0AA5A62E940A6 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-17"
      version             = "1.0"

      hash                = "731a144baa1d2bd6b316a3b4408fe280a15d39c6998374169e5cec803ff0729a"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "武汉市领曼盾数字科技有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "09:7b:63:47:40:a6:cf:3a:61:f0:aa:5a:62:e9:40:a6"
      cert_thumbprint     = "E5BE43DC8A6C2E90443F3540B43540BE1CE5B81D"
      cert_valid_from     = "2025-11-17"
      cert_valid_to       = "2026-11-17"

      country             = "CN"
      state               = "Hubei"
      locality            = "Wuhan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "09:7b:63:47:40:a6:cf:3a:61:f0:aa:5a:62:e9:40:a6"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_12248CFBA203C55278C33B413A81FFB3 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-05"
      version             = "1.0"

      hash                = "fce7f7ad1d7b17e7106639ca23cc49d2cf642bcea024d8ba838f3f559c99e34c"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Open Source Developer, Yu Zeng"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "12:24:8c:fb:a2:03:c5:52:78:c3:3b:41:3a:81:ff:b3"
      cert_thumbprint     = "E5D9BC152B169F444E270B9FAA3AF9C3F451AB46"
      cert_valid_from     = "2025-08-05"
      cert_valid_to       = "2026-08-05"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Jintang"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "12:24:8c:fb:a2:03:c5:52:78:c3:3b:41:3a:81:ff:b3"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_1C8307F5D992FECE41129D7C5153A17F {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-19"
      version             = "1.0"

      hash                = "9c1a85f711fb500d70760d40e9e57854555dfc225fae68bb035f4a0167324e29"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "陕西斯慧嘉网络科技有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "1c:83:07:f5:d9:92:fe:ce:41:12:9d:7c:51:53:a1:7f"
      cert_thumbprint     = "EA71A12738E997CE48A9A5A194D1666B1A6533C7"
      cert_valid_from     = "2024-06-19"
      cert_valid_to       = "2025-06-19"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Xi'an"
      email               = "???"
      rdn_serial_number   = "91610104MAC98H859T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "1c:83:07:f5:d9:92:fe:ce:41:12:9d:7c:51:53:a1:7f"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_4C4C225E13B1CBEA59C3A9B50AE2B94D {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "1107160996aad02e3d44572030599713712db1e7538a346d5bd885f1ff88fdaa"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "合肥高好频商贸有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "4c:4c:22:5e:13:b1:cb:ea:59:c3:a9:b5:0a:e2:b9:4d"
      cert_thumbprint     = "A7C18AAF8AC708C18BAA8C8F0CD19C2780EF8F42"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-21"

      country             = "CN"
      state               = "安徽"
      locality            = "合肥"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "4c:4c:22:5e:13:b1:cb:ea:59:c3:a9:b5:0a:e2:b9:4d"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_4C4C9F16877C6C8508A12BDD7C94607D {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-03"
      version             = "1.0"

      hash                = "43130df9d6c99e0d01470a57e0a21215a9afbb1c9b191e1b86fcb046316de6d1"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xiangyang Dianjue Trading Store (Sole Proprietorship)"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "4c:4c:9f:16:87:7c:6c:85:08:a1:2b:dd:7c:94:60:7d"
      cert_thumbprint     = "EDDFDB2DC4308CDCBE96650D7B19F4C7B773D13E"
      cert_valid_from     = "2025-03-03"
      cert_valid_to       = "2026-03-03"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "4c:4c:9f:16:87:7c:6c:85:08:a1:2b:dd:7c:94:60:7d"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_4DDD9F79FFA78EB06C8C638334836ACF {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-23"
      version             = "1.0"

      hash                = "bcbb74f7b54f471f5d98ef24ae9b472f2cbe3efe04d6c6ff1088c63ddce290cf"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "成都金源启铭网络有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "4d:dd:9f:79:ff:a7:8e:b0:6c:8c:63:83:34:83:6a:cf"
      cert_thumbprint     = "45CD69622857EC75D216B7AFF0F02B4B7B464968"
      cert_valid_from     = "2025-07-23"
      cert_valid_to       = "2026-07-23"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "4d:dd:9f:79:ff:a7:8e:b0:6c:8c:63:83:34:83:6a:cf"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_5E0016A3D3E00463E5BF0753D80CDED2 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-28"
      version             = "1.0"

      hash                = "232d2526c54d5e0795bc7bd077362de5f18d9089d4ae25d6e9a709f2f3ef940a"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Gucheng County Qizhishang Trading Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "5e:00:16:a3:d3:e0:04:63:e5:bf:07:53:d8:0c:de:d2"
      cert_thumbprint     = "06E24900DD5E7E64D30AB8288AFA895D2533DFE0"
      cert_valid_from     = "2025-03-28"
      cert_valid_to       = "2026-03-28"

      country             = "CN"
      state               = "Hubei"
      locality            = "Xiangyang"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "5e:00:16:a3:d3:e0:04:63:e5:bf:07:53:d8:0c:de:d2"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_5EAC92D72A8D601A4E4833703F78001D {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-29"
      version             = "1.0"

      hash                = "65537499abd5e2915a79d1df00fcf6adb9d17628f9cb5ae26d8b45303333c523"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "成都航迈源动科技有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5e:ac:92:d7:2a:8d:60:1a:4e:48:33:70:3f:78:00:1d"
      cert_thumbprint     = "54871153335B5ED2AC9EA5101327CCFB726E9431"
      cert_valid_from     = "2025-08-29"
      cert_valid_to       = "2026-08-29"

      country             = "CN"
      state               = "四川"
      locality            = "成都"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5e:ac:92:d7:2a:8d:60:1a:4e:48:33:70:3f:78:00:1d"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_7365D3835BB5D34BD1A3F9EE0B8E728C {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-28"
      version             = "1.0"

      hash                = "877dadf7ce4684878ea086cbd4c111d5dfb87c2659366f6df5079047fbea13db"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yangzhou Bai'ao Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "73:65:d3:83:5b:b5:d3:4b:d1:a3:f9:ee:0b:8e:72:8c"
      cert_thumbprint     = "4C3BF297DCE27630DB010B618A7F0C630F704B99"
      cert_valid_from     = "2025-11-28"
      cert_valid_to       = "2026-11-28"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Yangzhou"
      email               = "???"
      rdn_serial_number   = "91321091MAEWX1H02N"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "73:65:d3:83:5b:b5:d3:4b:d1:a3:f9:ee:0b:8e:72:8c"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Certum_7491B67258319908F62F222370446CD5 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "d8ec7795909f69b8e4945c38bd362d321f3041a71d2d6cd98d146f6bd47a1e0c"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Zhijiang Tangqin Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "74:91:b6:72:58:31:99:08:f6:2f:22:23:70:44:6c:d5"
      cert_thumbprint     = "BF8029487FBCED42B7F8959D180E892475AE4C53"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2026-05-09"

      country             = "CN"
      state               = "Hubei"
      locality            = "Zhijiang"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "74:91:b6:72:58:31:99:08:f6:2f:22:23:70:44:6c:d5"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_DigiCert_0B88E4D595E84A1C9D96733EF7DE5546 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-10"
      version             = "1.0"

      hash                = "37d27fc9336fd3f8cfe7aa2250f00e4e61320aef8a39542c8eb79a853150e692"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DONGQI TRADE LIMITED"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0b:88:e4:d5:95:e8:4a:1c:9d:96:73:3e:f7:de:55:46"
      cert_thumbprint     = "8206C09E53F2378FBFC0D499B394BC89A6DD74B3"
      cert_valid_from     = "2025-10-10"
      cert_valid_to       = "2026-10-09"

      country             = "HK"
      state               = "???"
      locality            = "Tai Kok Tsui"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0b:88:e4:d5:95:e8:4a:1c:9d:96:73:3e:f7:de:55:46"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_DigiCert_0D62A5672BBBCE5A3B7441F3A33426B3 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-17"
      version             = "1.0"

      hash                = "3f78ec4bd0a0ccff1c5e0fda4f47531abb343a9835682c40f538bebab5b770e8"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "咸宁创翼互联网科技有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:62:a5:67:2b:bb:ce:5a:3b:74:41:f3:a3:34:26:b3"
      cert_thumbprint     = "64FEDDCC08A4EA49D603262FA1B2750695A03A18"
      cert_valid_from     = "2025-07-17"
      cert_valid_to       = "2025-08-13"

      country             = "CN"
      state               = "湖北省"
      locality            = "咸宁市"
      email               = "???"
      rdn_serial_number   = "91422300MAEA9BX51L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:62:a5:67:2b:bb:ce:5a:3b:74:41:f3:a3:34:26:b3"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_DigiCert_0F4B2115767EFD289B85292362B118AE {
   meta:
      description         = "Detects ValleyRAT with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "123baf5762064dac90572c7d7815f47ad4dc930b0ee2f14939cac54378cb25d9"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "咸宁创翼互联网科技有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0f:4b:21:15:76:7e:fd:28:9b:85:29:23:62:b1:18:ae"
      cert_thumbprint     = "CFAAF563A96933C9DFAD66549DA2A793A946F7E0"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2025-07-16"

      country             = "CN"
      state               = "湖北省"
      locality            = "咸宁市"
      email               = "???"
      rdn_serial_number   = "91422300MAEA9BX51L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0f:4b:21:15:76:7e:fd:28:9b:85:29:23:62:b1:18:ae"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_GlobalSign_05B4BC293E3AC7D14DAEBF6E {
   meta:
      description         = "Detects ValleyRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-18"
      version             = "1.0"

      hash                = "2b2363d3759ef8b676f398fc413c56a1058b8bc9c5633f24c55538e5ba501afb"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nanjing Yueyue Kunkun Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "05:b4:bc:29:3e:3a:c7:d1:4d:ae:bf:6e"
      cert_thumbprint     = "9D2B08A9463C6B9040544DC6547E52C85D9DD645"
      cert_valid_from     = "2025-07-18"
      cert_valid_to       = "2026-07-19"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Nanjing"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "05:b4:bc:29:3e:3a:c7:d1:4d:ae:bf:6e"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_GlobalSign_0CBAF79465EBF8404FBF0EAA {
   meta:
      description         = "Detects ValleyRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-20"
      version             = "1.0"

      hash                = "7ffd77507493be9e2370139ae1116a8175ca7358378e121d6cb2ccdc27fe6912"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xi'an Vanci Electronic Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0c:ba:f7:94:65:eb:f8:40:4f:bf:0e:aa"
      cert_thumbprint     = "F3CC4793FAD912A4E2B628DF42D51627231CA2C5"
      cert_valid_from     = "2025-05-20"
      cert_valid_to       = "2027-05-21"

      country             = "CN"
      state               = "Shaanxi"
      locality            = "Xi'an"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0c:ba:f7:94:65:eb:f8:40:4f:bf:0e:aa"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Sectigo_009CF337C12EFC4445ECAFCB35D02D64BE {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-27"
      version             = "1.0"

      hash                = "124e8f7ca958fd8cb2a3baf91681513f93f73d9cfa4efea6f4a1f165d8cbc8d9"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Weihai Mingjun Information Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:9c:f3:37:c1:2e:fc:44:45:ec:af:cb:35:d0:2d:64:be"
      cert_thumbprint     = "9CBD74EBBD51F5E775142670B53B09F81C72EADD"
      cert_valid_from     = "2025-11-27"
      cert_valid_to       = "2026-11-27"

      country             = "CN"
      state               = "Shandong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91371000MA3WAC7627"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:9c:f3:37:c1:2e:fc:44:45:ec:af:cb:35:d0:2d:64:be"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Sectigo_00B73548A6B5D65D00DFE76D49555D4DD1 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-13"
      version             = "1.0"

      hash                = "7e9078fd8654028df65a47ccba18f25fd3bdfb1b7716495e063b95b9ff1fd06e"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Yiwu Liangheng Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:b7:35:48:a6:b5:d6:5d:00:df:e7:6d:49:55:5d:4d:d1"
      cert_thumbprint     = "F6DCDE1F48BA82AEC496DFF289537FFFE8F73008"
      cert_valid_from     = "2025-08-13"
      cert_valid_to       = "2028-08-12"

      country             = "CN"
      state               = "浙江省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:b7:35:48:a6:b5:d6:5d:00:df:e7:6d:49:55:5d:4d:d1"
      )
}

rule MAL_Compromised_Cert_ValleyRAT_Verokey_0CBA02A32BEAB6BFAC34A7511A8B0E22 {
   meta:
      description         = "Detects ValleyRAT with compromised cert (Verokey)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-15"
      version             = "1.0"

      hash                = "8b83e7a8abe5779edde1bf8b753cb1aec232d31c1c25e4df69510cf36110bdfe"
      malware             = "ValleyRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "山西荣升源科贸有限公司"
      cert_issuer_short   = "Verokey"
      cert_issuer         = "Verokey High Assurance Secure Code EV"
      cert_serial         = "0c:ba:02:a3:2b:ea:b6:bf:ac:34:a7:51:1a:8b:0e:22"
      cert_thumbprint     = "0d54e75f5be0f646df256098171ee2d1ba24959af6d4008f89aa3397d5aa4f3b"
      cert_valid_from     = "2025-05-15"
      cert_valid_to       = "2026-06-18"

      country             = "CN"
      state               = "山西省"
      locality            = "太原市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Verokey High Assurance Secure Code EV" and
         sig.serial == "0c:ba:02:a3:2b:ea:b6:bf:ac:34:a7:51:1a:8b:0e:22"
      )
}

rule MAL_Compromised_Cert_ValleyRat_Certum_65620C1D74A8FD9630E9F2BF6281A61A {
   meta:
      description         = "Detects ValleyRat with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-11"
      version             = "1.0"

      hash                = "5085b09b4bb5a017f13e0d4c970184518370b93d5e464bf5fbad8d522b42fd57"
      malware             = "ValleyRat"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Meisi Software Development （Guangxi）Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "65:62:0c:1d:74:a8:fd:96:30:e9:f2:bf:62:81:a6:1a"
      cert_thumbprint     = "6366384F040F581885BBC875C4C641B347692B55"
      cert_valid_from     = "2025-07-11"
      cert_valid_to       = "2026-07-11"

      country             = "CN"
      state               = "Guangxi"
      locality            = "Yulin"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "65:62:0c:1d:74:a8:fd:96:30:e9:f2:bf:62:81:a6:1a"
      )
}

rule MAL_Compromised_Cert_ValleyRat_Sectigo_00ADC445B14C3C850CC30C6C0007EA9920 {
   meta:
      description         = "Detects ValleyRat with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-27"
      version             = "1.0"

      hash                = "1a0fcd81af6b14b367f1ac93aa7a7b650450405f7652a17e667604e681d457b0"
      malware             = "ValleyRat"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Acoustica, Inc"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "00:ad:c4:45:b1:4c:3c:85:0c:c3:0c:6c:00:07:ea:99:20"
      cert_thumbprint     = "3F47F08CC583158F7F5B5CB22D1657CE2EBCB4CB"
      cert_valid_from     = "2025-04-27"
      cert_valid_to       = "2026-04-23"

      country             = "US"
      state               = "California"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "00:ad:c4:45:b1:4c:3c:85:0c:c3:0c:6c:00:07:ea:99:20"
      )
}

rule MAL_Compromised_Cert_VenomRat_GoGetSSL_01102CCEFAAD00D62684635B105FFC57 {
   meta:
      description         = "Detects VenomRat with compromised cert (GoGetSSL)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-21"
      version             = "1.0"

      hash                = "6f9d8640168fb34aff3b829d7f08246eb772228c37bcb0f5b2621260704df159"
      malware             = "VenomRat"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Atik Mekanik Endüstriyel İzolasyon Mühendislik Dış Ticaret A.Ş"
      cert_issuer_short   = "GoGetSSL"
      cert_issuer         = "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1"
      cert_serial         = "01:10:2c:ce:fa:ad:00:d6:26:84:63:5b:10:5f:fc:57"
      cert_thumbprint     = "61656971F3472069AF5080454C02A6D76A4D337A"
      cert_valid_from     = "2025-02-21"
      cert_valid_to       = "2026-02-20"

      country             = "TR"
      state               = "İstanbul"
      locality            = "Beykoz"
      email               = "???"
      rdn_serial_number   = "391452-5"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GoGetSSL G4 CS RSA4096 SHA256 2022 CA-1" and
         sig.serial == "01:10:2c:ce:fa:ad:00:d6:26:84:63:5b:10:5f:fc:57"
      )
}

rule MAL_Compromised_Cert_Vidar_GlobalSign_1DE5FF31646F82FF3603D44B {
   meta:
      description         = "Detects Vidar with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-19"
      version             = "1.0"

      hash                = "645792d4d009f52135a1e760e45d440dbdf2e283f5ad33b949b894ada8d0d602"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Webber Air Investments LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "1d:e5:ff:31:64:6f:82:ff:36:03:d4:4b"
      cert_thumbprint     = "5458C95F64BC96AEA8614EABA89D587C49BDAD03"
      cert_valid_from     = "2025-02-19"
      cert_valid_to       = "2026-02-20"

      country             = "US"
      state               = "Alaska"
      locality            = "Ketchikan"
      email               = "???"
      rdn_serial_number   = "10076154"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "1d:e5:ff:31:64:6f:82:ff:36:03:d4:4b"
      )
}

rule MAL_Compromised_Cert_Vidar_GlobalSign_4FC321AB7EFF27443F9568D1 {
   meta:
      description         = "Detects Vidar with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-29"
      version             = "1.0"

      hash                = "8f1b55ae725ecf5c3043d390b17eb3d03e9b9681fede65bfea1f6e7cba8e3073"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Legal Center"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4f:c3:21:ab:7e:ff:27:44:3f:95:68:d1"
      cert_thumbprint     = "AE0EDCDB222729CC469304BAFB5F5F8F2AAEF2BB"
      cert_valid_from     = "2025-09-29"
      cert_valid_to       = "2026-04-11"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4f:c3:21:ab:7e:ff:27:44:3f:95:68:d1"
      )
}

rule MAL_Compromised_Cert_Vidar_GlobalSign_5777A8DF6F72D25809EF51F2 {
   meta:
      description         = "Detects Vidar with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-07"
      version             = "1.0"

      hash                = "f8c14349fab2076bce42b0962586196baf6caadba2eb1e4dde0a2e974d283a82"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AMBER GUSTO LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "57:77:a8:df:6f:72:d2:58:09:ef:51:f2"
      cert_thumbprint     = "E70D63D271BFF21E7285F74081AF50562F86B7D4"
      cert_valid_from     = "2025-04-07"
      cert_valid_to       = "2026-04-08"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "???"
      rdn_serial_number   = "1217800200970"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "57:77:a8:df:6f:72:d2:58:09:ef:51:f2"
      )
}

rule MAL_Compromised_Cert_Vidar_Microsoft_33000518E15B387314896695710000000518E1 {
   meta:
      description         = "Detects Vidar with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-29"
      version             = "1.0"

      hash                = "f92df84e92093e0e6e0ab44630a777689157f5433c7b007e590f917a5524068b"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "EARNEST PROJECTS INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:18:e1:5b:38:73:14:89:66:95:71:00:00:00:05:18:e1"
      cert_thumbprint     = "C9A76002341946F2890FF614355D360BE55CEE4E"
      cert_valid_from     = "2025-10-29"
      cert_valid_to       = "2025-11-01"

      country             = "CA"
      state               = "British Columbia"
      locality            = "Richmond"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:18:e1:5b:38:73:14:89:66:95:71:00:00:00:05:18:e1"
      )
}

rule MAL_Compromised_Cert_Vidar_Microsoft_3300058A3280579A5F80EC354D000000058A32 {
   meta:
      description         = "Detects Vidar with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-30"
      version             = "1.0"

      hash                = "0fa64636b0b9f82665759aedc9a553e0a9b1c377823a350775fc8fb1a82df995"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Linkus Corporation"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS EOC CA 01"
      cert_serial         = "33:00:05:8a:32:80:57:9a:5f:80:ec:35:4d:00:00:00:05:8a:32"
      cert_thumbprint     = "79F42327460B0E95B283395746C80DEA1317B939"
      cert_valid_from     = "2025-11-30"
      cert_valid_to       = "2025-12-03"

      country             = "US"
      state               = "Colorado"
      locality            = "Brighton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS EOC CA 01" and
         sig.serial == "33:00:05:8a:32:80:57:9a:5f:80:ec:35:4d:00:00:00:05:8a:32"
      )
}

rule MAL_Compromised_Cert_Vidar_Microsoft_3300068E61CBE2F34C2A85C551000000068E61 {
   meta:
      description         = "Detects Vidar with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-12-04"
      version             = "1.0"

      hash                = "296333066462e036aa27e2b15300f88099564ac7737bd99af585bfcb4f6cd438"
      malware             = "Vidar"
      malware_type        = "Infostealer"
      malware_notes       = "A popular information stealing malware in 2025. This was likely delivered to victims disguised as a document."

      signer              = "Linkus Corporation"
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 01"
      cert_serial         = "33:00:06:8e:61:cb:e2:f3:4c:2a:85:c5:51:00:00:00:06:8e:61"
      cert_thumbprint     = "4969ADC0E8FDB19AC003A625DB2A8523140A8CFE"
      cert_valid_from     = "2025-12-04"
      cert_valid_to       = "2025-12-07"

      country             = "US"
      state               = "Colorado"
      locality            = "Brighton"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 01" and
         sig.serial == "33:00:06:8e:61:cb:e2:f3:4c:2a:85:c5:51:00:00:00:06:8e:61"
      )
}

rule MAL_Compromised_Cert_Vidar_SSL_com_0AD7C373F578C648F98330332B4F3C1A {
   meta:
      description         = "Detects Vidar with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-27"
      version             = "1.0"

      hash                = "6d2ecf5fd4645d4b83401d08dae2e4582bdc0b8162c711edc0de51b9884a883a"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Trazel, LLC"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "0a:d7:c3:73:f5:78:c6:48:f9:83:30:33:2b:4f:3c:1a"
      cert_thumbprint     = "D326D1717D831D5475A7732D306C7BBC69411FD5"
      cert_valid_from     = "2025-05-27"
      cert_valid_to       = "2026-05-27"

      country             = "US"
      state               = "Texas"
      locality            = "Richmond"
      email               = "???"
      rdn_serial_number   = "804013133"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "0a:d7:c3:73:f5:78:c6:48:f9:83:30:33:2b:4f:3c:1a"
      )
}

rule MAL_Compromised_Cert_Vidar_SSL_com_70044DC752FEE75A0835741593072573 {
   meta:
      description         = "Detects Vidar with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "fda2f164f9151d249283e92213f038455a0bb3968a3d6960a58abf08eef03cf2"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "2S-Software AG"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "70:04:4d:c7:52:fe:e7:5a:08:35:74:15:93:07:25:73"
      cert_thumbprint     = "D2637FE9093F76C98DE460DD6D5052C4D55F689C"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2026-07-03"

      country             = "CH"
      state               = "canton of Zürich"
      locality            = "Andelfingen"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "70:04:4d:c7:52:fe:e7:5a:08:35:74:15:93:07:25:73"
      )
}

rule MAL_Compromised_Cert_Vidar_Sectigo_00999F34F2243AB715E122175A26DCE974 {
   meta:
      description         = "Detects Vidar with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-28"
      version             = "1.0"

      hash                = "254e367cbd0d77e7423428a8421136100d95800a6cf809f85747da30605e38a0"
      malware             = "Vidar"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Guangzhou Vance Photoelectric Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:99:9f:34:f2:24:3a:b7:15:e1:22:17:5a:26:dc:e9:74"
      cert_thumbprint     = "A5E30987BCDB1159EFA2B1574E7C6932C82BD5AB"
      cert_valid_from     = "2024-10-28"
      cert_valid_to       = "2025-10-28"

      country             = "CN"
      state               = "Guangdong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:99:9f:34:f2:24:3a:b7:15:e1:22:17:5a:26:dc:e9:74"
      )
}

rule MAL_Compromised_Cert_VileRAT_GlobalSign_5EDBCCFBE91A2DF04D7CC795 {
   meta:
      description         = "Detects VileRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-08-07"
      version             = "1.0"

      hash                = "21ae1d88e675c9a2d51a2f68beadf24a21c1b16f58fc042ff97ad8e52501300d"
      malware             = "VileRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "GLOSUB LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5e:db:cc:fb:e9:1a:2d:f0:4d:7c:c7:95"
      cert_thumbprint     = "365EE3CB9639107C7ABE51F1756ECA61D6904166"
      cert_valid_from     = "2023-08-07"
      cert_valid_to       = "2024-08-07"

      country             = "UA"
      state               = "Kyiv"
      locality            = "Kyiv"
      email               = "???"
      rdn_serial_number   = "42179512"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5e:db:cc:fb:e9:1a:2d:f0:4d:7c:c7:95"
      )
}

rule MAL_Compromised_Cert_Volaris_GlobalSign_0DC50E6E78F880FBA9AC5055 {
   meta:
      description         = "Detects Volaris with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-04"
      version             = "1.0"

      hash                = "edbf9a6f32030a6d785c60a0c3600d38d316b42d237aedb43e81bc2ceb372967"
      malware             = "Volaris"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "MEDIA4YU GmbH"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0d:c5:0e:6e:78:f8:80:fb:a9:ac:50:55"
      cert_thumbprint     = "71248E8575D821CDA8419FEAA11E8DA328C57F75"
      cert_valid_from     = "2025-07-04"
      cert_valid_to       = "2026-07-05"

      country             = "AT"
      state               = "Wien"
      locality            = "Wien"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0d:c5:0e:6e:78:f8:80:fb:a9:ac:50:55"
      )
}

rule MAL_Compromised_Cert_Volaris_GlobalSign_5FF0C92F07F4C38EDF789E75 {
   meta:
      description         = "Detects Volaris with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-02"
      version             = "1.0"

      hash                = "86f543ef0ab49d6c3ed3d6c55b5ff2371931b55b7e569233e11ed2ee1dcdcd4d"
      malware             = "Volaris"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "AN Marketing B.V."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "5f:f0:c9:2f:07:f4:c3:8e:df:78:9e:75"
      cert_thumbprint     = "88719D6BDBE9ABC3CD99828F040AAF9CD1688A9D"
      cert_valid_from     = "2025-07-02"
      cert_valid_to       = "2026-07-03"

      country             = "NL"
      state               = "Noord-Holland"
      locality            = "Amsterdam-Duivendrecht"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "5f:f0:c9:2f:07:f4:c3:8e:df:78:9e:75"
      )
}

rule MAL_Compromised_Cert_Volaris_Microsoft_33000498BFEC9593C7FC832F770000000498BF {
   meta:
      description         = "Detects Volaris with compromised cert (Microsoft)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-25"
      version             = "1.0"

      hash                = "71415f0855b5e95b8e73a39b6be65f8c2a775893689775aec452708045ca7c13"
      malware             = "Volaris"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DELPA SOLUTIONS INC."
      cert_issuer_short   = "Microsoft"
      cert_issuer         = "Microsoft ID Verified CS AOC CA 02"
      cert_serial         = "33:00:04:98:bf:ec:95:93:c7:fc:83:2f:77:00:00:00:04:98:bf"
      cert_thumbprint     = "E00FD161632E05FBE6A99EE0A1E2199390C05F18"
      cert_valid_from     = "2025-07-25"
      cert_valid_to       = "2025-07-28"

      country             = "CA"
      state               = "Québec"
      locality            = "STE ANNE DE BELLEVUE"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Microsoft ID Verified CS AOC CA 02" and
         sig.serial == "33:00:04:98:bf:ec:95:93:c7:fc:83:2f:77:00:00:00:04:98:bf"
      )
}

rule MAL_Compromised_Cert_Volaris_SSL_com_193AD87A68C6A7957F5D36E996073887 {
   meta:
      description         = "Detects Volaris with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-22"
      version             = "1.0"

      hash                = "67aa59b0e9cee6279e2ebe9d18a11574d18dd195a86d24f2b87b1824c390f2b5"
      malware             = "Volaris"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CAPELLO MEDIA SOLUTIONS LTD"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "19:3a:d8:7a:68:c6:a7:95:7f:5d:36:e9:96:07:38:87"
      cert_thumbprint     = "5ABD272A417A6DF253685679C4DCDB3A4CB24A4D"
      cert_valid_from     = "2025-07-22"
      cert_valid_to       = "2026-06-30"

      country             = "GB"
      state               = "???"
      locality            = "ALTRINCHAM"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "19:3a:d8:7a:68:c6:a7:95:7f:5d:36:e9:96:07:38:87"
      )
}

rule MAL_Compromised_Cert_WagmiTraffer_GlobalSign_3A48F81C499161FD0C9C072A {
   meta:
      description         = "Detects WagmiTraffer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-26"
      version             = "1.0"

      hash                = "721102a038d4bcb4828d2bea12e6b31d2818c4c8f8cff36c1fd0ad88ab29d616"
      malware             = "WagmiTraffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LISTERA LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3a:48:f8:1c:49:91:61:fd:0c:9c:07:2a"
      cert_thumbprint     = "7D7C67575E2B7684887BB60BE3F138B6522080F4"
      cert_valid_from     = "2025-05-26"
      cert_valid_to       = "2026-05-16"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3a:48:f8:1c:49:91:61:fd:0c:9c:07:2a"
      )
}

rule MAL_Compromised_Cert_Wagmi_Traffer_Team_GlobalSign_25866F3E001AC42FBBE8C679 {
   meta:
      description         = "Detects Wagmi Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-31"
      version             = "1.0"

      hash                = "f08cafea466576fb980b2d4729234a94258343ce40412ba45cd391fcf7773c68"
      malware             = "Wagmi Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ZONALS COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "25:86:6f:3e:00:1a:c4:2f:bb:e8:c6:79"
      cert_thumbprint     = "28921D40E2EFE51D8B1C9891ED0B72AEE137327A"
      cert_valid_from     = "2025-03-31"
      cert_valid_to       = "2026-04-01"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "C.151394"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "25:86:6f:3e:00:1a:c4:2f:bb:e8:c6:79"
      )
}

rule MAL_Compromised_Cert_Wagmi_Traffer_Team_GlobalSign_34C5D23C18AC223122E893E5 {
   meta:
      description         = "Detects Wagmi Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-24"
      version             = "1.0"

      hash                = "CFFA1F0F88F5311AFC6AEDF2B19F1B24FDCA7E7CEB55FFDBC1428DF7B1191B2A"
      malware             = "Wagmi Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Unitek"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:c5:d2:3c:18:ac:22:31:22:e8:93:e5"
      cert_thumbprint     = ""
      cert_valid_from     = "2025-04-24"
      cert_valid_to       = "2026-04-25"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:c5:d2:3c:18:ac:22:31:22:e8:93:e5"
      )
}

rule MAL_Compromised_Cert_Wagmi_Traffer_Team_GlobalSign_407678F5814F5C443165FA66 {
   meta:
      description         = "Detects Wagmi Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-24"
      version             = "1.0"

      hash                = "A092E37CBFA79887D68BD1F485BD124A689F4DBAF065B91B3B298FB013531041"
      malware             = "Wagmi Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Pik Harmony"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "40:76:78:f5:81:4f:5c:44:31:65:fa:66"
      cert_thumbprint     = ""
      cert_valid_from     = "2025-04-24"
      cert_valid_to       = "2026-04-25"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "40:76:78:f5:81:4f:5c:44:31:65:fa:66"
      )
}

rule MAL_Compromised_Cert_Wagmi_Traffer_Team_GlobalSign_525DB6D9E035E547A81A3A8D {
   meta:
      description         = "Detects Wagmi Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-16"
      version             = "1.0"

      hash                = "1868b95455df42b9d6968e1f748f1786467bde865c69461444437625ec851c5d"
      malware             = "Wagmi Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SOI TREE LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "52:5d:b6:d9:e0:35:e5:47:a8:1a:3a:8d"
      cert_thumbprint     = "B8FB7476817DE65A446D5A7F138560AFAD883E0E"
      cert_valid_from     = "2025-04-16"
      cert_valid_to       = "2026-04-17"

      country             = "KE"
      state               = "Nairobi"
      locality            = "Nairobi"
      email               = "???"
      rdn_serial_number   = "CPR/2013/108876"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "52:5d:b6:d9:e0:35:e5:47:a8:1a:3a:8d"
      )
}

rule MAL_Compromised_Cert_Wagmi_Traffer_Team_GlobalSign_75D0F25D4BFA30C1461F3721 {
   meta:
      description         = "Detects Wagmi Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-14"
      version             = "1.0"

      hash                = "dfe856eed36f45524421ba2dda6cdbf9b048e900a87eb74daf76e76dc8b157dd"
      malware             = "Wagmi Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "HUNG KHIEM TRANSPORT COMPANY LIMITED"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "75:d0:f2:5d:4b:fa:30:c1:46:1f:37:21"
      cert_thumbprint     = ""
      cert_valid_from     = "2025-04-14"
      cert_valid_to       = "2026-04-15"

      country             = "VN"
      state               = "Ninh Binh"
      locality            = "Ninh Binh"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "75:d0:f2:5d:4b:fa:30:c1:46:1f:37:21"
      )
}

rule MAL_Compromised_Cert_WarmCookie_SSL_com_7AD3A37E018A0708865FBA3EF5EFC572 {
   meta:
      description         = "Detects WarmCookie with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-28"
      version             = "1.0"

      hash                = "f75158de839346c9a029d30fb806cb6b4cefa12cd2eb2fe6b58703e91261c27a"
      malware             = "WarmCookie"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "DEVELOPMENT CORPORATE CONSULTANCY LIMITED"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "7a:d3:a3:7e:01:8a:07:08:86:5f:ba:3e:f5:ef:c5:72"
      cert_thumbprint     = "E3A6E0E07B935F225C45E01CCE97F38EC6D80DC7"
      cert_valid_from     = "2024-11-28"
      cert_valid_to       = "2025-11-28"

      country             = "GB"
      state               = "???"
      locality            = "Bath"
      email               = "???"
      rdn_serial_number   = "10672092"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "7a:d3:a3:7e:01:8a:07:08:86:5f:ba:3e:f5:ef:c5:72"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_Certum_3C2FB1526D1491EAF1D1ABB3EB81013E {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-11"
      version             = "1.0"

      hash                = "038f21a41ff6cb0bdcd47323e4c612a8733d8953a5b059fa1168c65185bba4f9"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "Optyprism Limited"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "3c:2f:b1:52:6d:14:91:ea:f1:d1:ab:b3:eb:81:01:3e"
      cert_thumbprint     = "7BB22A166D2B74CF6B2682AAD92C934705C07978"
      cert_valid_from     = "2024-06-11"
      cert_valid_to       = "2025-06-11"

      country             = "GB"
      state               = "???"
      locality            = "LONDON"
      email               = "???"
      rdn_serial_number   = "12843522"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "3c:2f:b1:52:6d:14:91:ea:f1:d1:ab:b3:eb:81:01:3e"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_0438829B9540367BE3630F7D {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-29"
      version             = "1.0"

      hash                = "a34bfc8c1c24202c196092d56ed01b498c9f75e10ea7ccd1f923138ca4919be3"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "Lina LLC"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "04:38:82:9b:95:40:36:7b:e3:63:0f:7d"
      cert_thumbprint     = "724D9BCB326E10BE87C318E5339891F6ACD86F74"
      cert_valid_from     = "2025-04-29"
      cert_valid_to       = "2026-04-30"

      country             = "RU"
      state               = "Leningrad Oblast"
      locality            = "Kirovsk"
      email               = "???"
      rdn_serial_number   = "1174704011162"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "04:38:82:9b:95:40:36:7b:e3:63:0f:7d"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_072FCD62316944B9FD844A0C {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-19"
      version             = "1.0"

      hash                = "0592b13ded6c3a5ab5ec5aff7ba704ba26f22587027ebd1277797519beb9b164"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Ecoenergoresurs"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "07:2f:cd:62:31:69:44:b9:fd:84:4a:0c"
      cert_thumbprint     = "BF114710C202BA6436ABF95CFC8B3D2FB39ACEA9"
      cert_valid_from     = "2025-06-19"
      cert_valid_to       = "2026-06-20"

      country             = "RU"
      state               = "Novosibirsk Oblast"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "1235400034352"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "07:2f:cd:62:31:69:44:b9:fd:84:4a:0c"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_0D8BE802B2D246075390D123 {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-27"
      version             = "1.0"

      hash                = "01c3b49ff55dfbe738b6c9370681b1985abd34641a75803fea1468e102b726c9"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Gazovaya Kompaniya"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "0d:8b:e8:02:b2:d2:46:07:53:90:d1:23"
      cert_thumbprint     = "A301ADB5BC8DB6096B09E729C1E420580652DFB9"
      cert_valid_from     = "2025-05-27"
      cert_valid_to       = "2026-05-28"

      country             = "RU"
      state               = "Chelyabinsk Oblast"
      locality            = "Miass"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "0d:8b:e8:02:b2:d2:46:07:53:90:d1:23"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_113FB829E69DBFBC6581AD49 {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-17"
      version             = "1.0"

      hash                = "74c9175036bcaa239f433a98606df3a3be60ab9246f2067f500cea4b2be09a8f"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Stroytorg"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "11:3f:b8:29:e6:9d:bf:bc:65:81:ad:49"
      cert_thumbprint     = "17E9E652B7EC3D4BBB726CDA4B8EE0E3490936B2"
      cert_valid_from     = "2025-06-17"
      cert_valid_to       = "2026-06-18"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "11:3f:b8:29:e6:9d:bf:bc:65:81:ad:49"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_12D7480FA2F83AD92D8F01E5 {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-20"
      version             = "1.0"

      hash                = "bda71a81ee8959960d868f1806154035730ad107ecf01cad37b8349fd0e89a34"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Resurs"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "12:d7:48:0f:a2:f8:3a:d9:2d:8f:01:e5"
      cert_thumbprint     = "6FF61050D30E5F52E64EC31CEA3870BE67B855E5"
      cert_valid_from     = "2025-06-20"
      cert_valid_to       = "2026-06-21"

      country             = "RU"
      state               = "Novosibirsk Oblast"
      locality            = "Novosibirsk"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "12:d7:48:0f:a2:f8:3a:d9:2d:8f:01:e5"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_222199BBBF3A5275FAAF58D5 {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-15"
      version             = "1.0"

      hash                = "4297fccd1a4d3508ba166c3d32eaf6ac47a6267d2743eed2793de66d9c16a154"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Kraft Market"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "22:21:99:bb:bf:3a:52:75:fa:af:58:d5"
      cert_thumbprint     = "A8F4F99311A9B3B59E85A4C2387554638476326D"
      cert_valid_from     = "2025-04-15"
      cert_valid_to       = "2026-04-16"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "22:21:99:bb:bf:3a:52:75:fa:af:58:d5"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_2BBF1086EEA9937F53C919CF {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-10"
      version             = "1.0"

      hash                = "5f1e34873b39ae174dda32296ec2fd7347487def3480450f7c327f3fb9587090"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC DITRIX"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2b:bf:10:86:ee:a9:93:7f:53:c9:19:cf"
      cert_thumbprint     = "D7340B019C3FC16FA659325EB16AC4821FD7D070"
      cert_valid_from     = "2025-04-10"
      cert_valid_to       = "2026-04-11"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1047796821434"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2b:bf:10:86:ee:a9:93:7f:53:c9:19:cf"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_34AABED10099B75AD5C66580 {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-09"
      version             = "1.0"

      hash                = "4e8dcef6a5c8c44a2910d0dc0b300f4d88ee5d4c71c9e5a710564062ca1c5f9f"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Torgovyi Dom Energia"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:aa:be:d1:00:99:b7:5a:d5:c6:65:80"
      cert_thumbprint     = "7EB16B979B013FBC4FD343342E533492B8CB6AF6"
      cert_valid_from     = "2025-05-09"
      cert_valid_to       = "2026-05-10"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "5177746130942"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:aa:be:d1:00:99:b7:5a:d5:c6:65:80"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_34B7362F038107A8B81AD64F {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "5c0c17f5c2f3371e3dcfaeee5c68f54b97a62e1d08dffb48f50513637ae06a86"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Professional"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "34:b7:36:2f:03:81:07:a8:b8:1a:d6:4f"
      cert_thumbprint     = "9875F3395C8EEB0008D6A92535D769BF38DB9D64"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-26"

      country             = "RU"
      state               = "Chelyabinsk Oblast"
      locality            = "Magnitogorsk"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "34:b7:36:2f:03:81:07:a8:b8:1a:d6:4f"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_3D0315EAEA4D46B62AC9295C {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-19"
      version             = "1.0"

      hash                = "e48eba9d41a2d46d963c1117604005f53afce3e7e1ac5e0a7cca3b642720e7c2"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Fashion One"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3d:03:15:ea:ea:4d:46:b6:2a:c9:29:5c"
      cert_thumbprint     = "D84CC8EBF3AB53A22F4824354AEEEC0B59F958CA"
      cert_valid_from     = "2025-06-19"
      cert_valid_to       = "2026-06-20"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3d:03:15:ea:ea:4d:46:b6:2a:c9:29:5c"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_49FBB628F4E8F14982A48AFA {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-15"
      version             = "1.0"

      hash                = "58ffc7ad61b7d8038b45e1e2162b98d7e011b29fec1601068a98f6a272611b3e"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC MIR RTI"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "49:fb:b6:28:f4:e8:f1:49:82:a4:8a:fa"
      cert_thumbprint     = ""
      cert_valid_from     = "2025-04-15"
      cert_valid_to       = "2026-04-16"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = ""
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "49:fb:b6:28:f4:e8:f1:49:82:a4:8a:fa"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_4E13389A39911B3E1D34A95E {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-25"
      version             = "1.0"

      hash                = "701e417355a8aa5091aaa2821ae870c8487ed3d3754095f9881a4e775e3f87af"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC KARAPUZ Publishing house"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "4e:13:38:9a:39:91:1b:3e:1d:34:a9:5e"
      cert_thumbprint     = "5E13F6FFCF2E79EC70801D5DA0B94531406E020C"
      cert_valid_from     = "2025-06-25"
      cert_valid_to       = "2026-06-26"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "4e:13:38:9a:39:91:1b:3e:1d:34:a9:5e"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_56B3CD7E23410ECB1C9E4394 {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-19"
      version             = "1.0"

      hash                = "d781e95428147e6fd463a1de16c740f87415ccf0511f07559c3d79c635c313a5"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Lusso"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "56:b3:cd:7e:23:41:0e:cb:1c:9e:43:94"
      cert_thumbprint     = "A9BDCEE394EE4963207F4937AA600A5BE9B81F78"
      cert_valid_from     = "2025-06-19"
      cert_valid_to       = "2026-06-20"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "56:b3:cd:7e:23:41:0e:cb:1c:9e:43:94"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_72ED6A7A94922577560198BC {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-01"
      version             = "1.0"

      hash                = "fb35436322e9429a498f79b9abea24ca419fafab93117582c3e97f9beab3a034"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Promtrade"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "72:ed:6a:7a:94:92:25:77:56:01:98:bc"
      cert_thumbprint     = "EABE656511CB509B2EF42FC86077010C40F03FF2"
      cert_valid_from     = "2025-05-01"
      cert_valid_to       = "2026-05-02"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "72:ed:6a:7a:94:92:25:77:56:01:98:bc"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_GlobalSign_7D22359AECAEF621B0B6C46F {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-30"
      version             = "1.0"

      hash                = "e645e195517a817473a01ed82488e5148c60abd02d83dc097df0b00195f85936"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "LLC Stroy Project 77"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7d:22:35:9a:ec:ae:f6:21:b0:b6:c4:6f"
      cert_thumbprint     = "58118FD44069DC5D54E0C46914982F198EDF5F72"
      cert_valid_from     = "2025-06-30"
      cert_valid_to       = "2026-07-01"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7d:22:35:9a:ec:ae:f6:21:b0:b6:c4:6f"
      )
}

rule MAL_Compromised_Cert_WeEvilProxy_SSL_com_2F8440CF0284CB8329777B52EF44CA8A {
   meta:
      description         = "Detects WeEvilProxy with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-31"
      version             = "1.0"

      hash                = "7c66e462325232e88681b37e73f118d35ac23f54da59e3786f89c88da193f729"
      malware             = "WeEvilProxy"
      malware_type        = "Infostealer"
      malware_notes       = "This malware primarily targets cryptocurrencies. It is distributed through advertisements targing crypto users: https://labs.withsecure.com/publications/weevilproxy"

      signer              = "IT Consulting Timo Lehtinen Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2f:84:40:cf:02:84:cb:83:29:77:7b:52:ef:44:ca:8a"
      cert_thumbprint     = "84A6BCF027BA5DFE74586F937A437BA6D2309E17"
      cert_valid_from     = "2025-03-31"
      cert_valid_to       = "2026-03-31"

      country             = "FI"
      state               = "Uusimaa"
      locality            = "Helsinki"
      email               = "???"
      rdn_serial_number   = "2147547-8"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2f:84:40:cf:02:84:cb:83:29:77:7b:52:ef:44:ca:8a"
      )
}

rule MAL_Compromised_Cert_WebCompanion_Adware_SSL_com_05582E18BF2CBA8BA45073BBAED945F8 {
   meta:
      description         = "Detects WebCompanion Adware with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-04-04"
      version             = "1.0"

      hash                = "b0455e876ebafb3da28d545c4b1bba3c945a0360dac165db22e74b89053edbb9"
      malware             = "WebCompanion Adware"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Eclipse Media Inc"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "05:58:2e:18:bf:2c:ba:8b:a4:50:73:bb:ae:d9:45:f8"
      cert_thumbprint     = "3929E3C4FBC9A6E06D46CFAEEAB579CC7AEE39AB"
      cert_valid_from     = "2023-04-04"
      cert_valid_to       = "2026-04-03"

      country             = "PA"
      state               = "???"
      locality            = "Panama City"
      email               = "???"
      rdn_serial_number   = "155704432"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "05:58:2e:18:bf:2c:ba:8b:a4:50:73:bb:ae:d9:45:f8"
      )
}

rule MAL_Compromised_Cert_WebCompanion_Entrust_06ECC76A7973D9D7D97F3318994476BF {
   meta:
      description         = "Detects WebCompanion with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-02"
      version             = "1.0"

      hash                = "af347c357858ad3d468614b35930b2f56c31acbcdc0fa5f36788513b58702710"
      malware             = "WebCompanion"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "7270356 Canada Inc."
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "06:ec:c7:6a:79:73:d9:d7:d9:7f:33:18:99:44:76:bf"
      cert_thumbprint     = "56F38BE28047D9123F6DC63C0F26D557F815011F"
      cert_valid_from     = "2025-04-02"
      cert_valid_to       = "2026-04-02"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = ""

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "06:ec:c7:6a:79:73:d9:d7:d9:7f:33:18:99:44:76:bf"
      )
}

rule MAL_Compromised_Cert_WebCompanion_Entrust_25D0CB9D7B0D6C700CDAE43D243AB1C6 {
   meta:
      description         = "Detects WebCompanion with compromised cert (Entrust)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-01"
      version             = "1.0"

      hash                = "38b605a45b286c4827327bc6e10d08afc71e5dd8d2c9b4f717b1d8039e0f92c8"
      malware             = "WebCompanion"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "7270356 Canada Inc."
      cert_issuer_short   = "Entrust"
      cert_issuer         = "Entrust Extended Validation Code Signing CA - EVCS2"
      cert_serial         = "25:d0:cb:9d:7b:0d:6c:70:0c:da:e4:3d:24:3a:b1:c6"
      cert_thumbprint     = "EA06433E6F12D2AADA040F4A6EF7C927404A4CBA"
      cert_valid_from     = "2024-05-01"
      cert_valid_to       = "2025-05-01"

      country             = "???"
      state               = "???"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = ""

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Entrust Extended Validation Code Signing CA - EVCS2" and
         sig.serial == "25:d0:cb:9d:7b:0d:6c:70:0c:da:e4:3d:24:3a:b1:c6"
      )
}

rule MAL_Compromised_Cert_WebCompanion_Unknown_397040964E49A912BD2B2EAC53D98363 {
   meta:
      description         = "Detects WebCompanion with compromised cert (Unknown)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2019-08-27"
      version             = "1.0"

      hash                = "bd35c7a5f4b699d42563e773d234c3fba32577673f35aeb274893d4925cb5f64"
      malware             = "WebCompanion"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "BULLY UNITY LTD"
      cert_issuer_short   = "Unknown"
      cert_issuer         = "Domain The Net Technologies Ltd CA for Code Signing R2"
      cert_serial         = "39:70:40:96:4e:49:a9:12:bd:2b:2e:ac:53:d9:83:63"
      cert_thumbprint     = "93721992237099EC415EDBF574FA028FB7A08020"
      cert_valid_from     = "2019-08-27"
      cert_valid_to       = "2020-08-26"

      country             = "IL"
      state               = "Israel"
      locality            = "Jerusalem"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Domain The Net Technologies Ltd CA for Code Signing R2" and
         sig.serial == "39:70:40:96:4e:49:a9:12:bd:2b:2e:ac:53:d9:83:63"
      )
}

rule MAL_Compromised_Cert_WikiLoader_GlobalSign_2DDFCE3F64D9D03113A1EC75 {
   meta:
      description         = "Detects WikiLoader with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-26"
      version             = "1.0"

      hash                = "21689eafdfd6005ae75683a423b7816592cdf9aae03d983782d9272bb71787b9"
      malware             = "WikiLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Canton Pure Jonna Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2d:df:ce:3f:64:d9:d0:31:13:a1:ec:75"
      cert_thumbprint     = "3E6B9866607BBB91020938BF77CD7A8E919692B0"
      cert_valid_from     = "2024-08-26"
      cert_valid_to       = "2025-08-27"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440114MACL0TN54Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2d:df:ce:3f:64:d9:d0:31:13:a1:ec:75"
      )
}

rule MAL_Compromised_Cert_Win64_Kryptik_FHR_Certum_33C6CBB8827B6F181A449D2027A94E45 {
   meta:
      description         = "Detects Win64/Kryptik.FHR with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-27"
      version             = "1.0"

      hash                = "b6b97a6ae3851e90e39239363580afa054f57cd225f745b167857bf493a06b8e"
      malware             = "Win64/Kryptik.FHR"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Capybara Technology Ltd"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "33:c6:cb:b8:82:7b:6f:18:1a:44:9d:20:27:a9:4e:45"
      cert_thumbprint     = "937b9ea609fa9f33a542ebb196733740509c7c720bd72f5e16c9d1921f32ef57"
      cert_valid_from     = "2025-04-27"
      cert_valid_to       = "2026-04-27"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "33:c6:cb:b8:82:7b:6f:18:1a:44:9d:20:27:a9:4e:45"
      )
}

rule MAL_Compromised_Cert_Winos_SSL_com_2C8C8943925A595FD69F063B98D83B1D {
   meta:
      description         = "Detects Winos with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-08"
      version             = "1.0"

      hash                = "7102e9a86b47b65aeebc1bef98abe0928388f122af98eb62bf61622a42303f67"
      malware             = "Winos"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Sid Narayanan Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "2c:8c:89:43:92:5a:59:5f:d6:9f:06:3b:98:d8:3b:1d"
      cert_thumbprint     = "FFAD91F59C7C87FD132FF491DDE1C4654AC5FFC8"
      cert_valid_from     = "2024-08-08"
      cert_valid_to       = "2025-08-07"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "11953295"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "2c:8c:89:43:92:5a:59:5f:d6:9f:06:3b:98:d8:3b:1d"
      )
}

rule MAL_Compromised_Cert_Winos_SSL_com_72C9DB722E93A08BF09A00BD7963687C {
   meta:
      description         = "Detects Winos with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-18"
      version             = "1.0"

      hash                = "18fa694a30be09438ae1e94e23806bfe5edc7c4f2edbe15ff63c9016ddc94112"
      malware             = "Winos"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ZELCORE TECHNOLOGIES INC."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "72:c9:db:72:2e:93:a0:8b:f0:9a:00:bd:79:63:68:7c"
      cert_thumbprint     = "FD450B62877A6EC9D1D72D3D31125FAE70B86C3F"
      cert_valid_from     = "2024-11-18"
      cert_valid_to       = "2025-11-22"

      country             = "US"
      state               = "Delaware"
      locality            = "Dover"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "72:c9:db:72:2e:93:a0:8b:f0:9a:00:bd:79:63:68:7c"
      )
}

rule MAL_Compromised_Cert_XMAS_Traffer_Team_GlobalSign_5731AFDC3A41C9A004C5D636 {
   meta:
      description         = "Detects XMAS Traffer Team with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-16"
      version             = "1.0"

      hash                = "f93cfed22f012735e4deffc5b95d32747d18e58f9853a700317d6a552edfd719"
      malware             = "XMAS Traffer Team"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Yubileiny"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "57:31:af:dc:3a:41:c9:a0:04:c5:d6:36"
      cert_thumbprint     = "1D1DF932EC5AEED2EFD08BFE7A49CD5CEAACA275"
      cert_valid_from     = "2025-04-16"
      cert_valid_to       = "2026-04-17"

      country             = "RU"
      state               = "Moscow Oblast"
      locality            = "Podolsk"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "57:31:af:dc:3a:41:c9:a0:04:c5:d6:36"
      )
}

rule MAL_Compromised_Cert_XRed_DigiCert_0C03E51062B12016402733A20D6AB2E2 {
   meta:
      description         = "Detects XRed with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-14"
      version             = "1.0"

      hash                = "5071cd8e8dd184b8eb564f084fc0afb2663b1f7c1cfa84c89a737c4c38f298e0"
      malware             = "XRed"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RONALDO RODRIGUES SANTANA 22670573878"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0c:03:e5:10:62:b1:20:16:40:27:33:a2:0d:6a:b2:e2"
      cert_thumbprint     = "5C84CE57008546AA49AEF5DEA5F3680247137D0D"
      cert_valid_from     = "2024-08-14"
      cert_valid_to       = "2025-08-14"

      country             = "BR"
      state               = "Sao Paulo"
      locality            = "CAMPINAS"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0c:03:e5:10:62:b1:20:16:40:27:33:a2:0d:6a:b2:e2"
      )
}

rule MAL_Compromised_Cert_XRed_DigiCert_0D9D72F1DDA9ED4E39F88FCA66081E67 {
   meta:
      description         = "Detects XRed with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2022-07-01"
      version             = "1.0"

      hash                = "bed60ace690e1e5b186bed92f8a10542082ef415bdf02967ecf6e48e95a331b5"
      malware             = "XRed"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Wuxi Instant Microelectronics Co., Ltd."
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0d:9d:72:f1:dd:a9:ed:4e:39:f8:8f:ca:66:08:1e:67"
      cert_thumbprint     = "D433B32FFBEDE8E547211C73D3615B1F7EE7721B"
      cert_valid_from     = "2022-07-01"
      cert_valid_to       = "2025-07-02"

      country             = "CN"
      state               = "江苏省"
      locality            = "无锡市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0d:9d:72:f1:dd:a9:ed:4e:39:f8:8f:ca:66:08:1e:67"
      )
}

rule MAL_Compromised_Cert_XRed_DigiCert_0F550E72660DADB4E28C137E99C79C47 {
   meta:
      description         = "Detects XRed with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-22"
      version             = "1.0"

      hash                = "87d8965e3236ee05e583f98b2888baf145c5276975feac5868a5a904b0a820e4"
      malware             = "XRed"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "深圳市志仕智能科技有限公司"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0f:55:0e:72:66:0d:ad:b4:e2:8c:13:7e:99:c7:9c:47"
      cert_thumbprint     = "BE0BC9065321A3AD4DCA60DA13FF66FC8467FFB5"
      cert_valid_from     = "2025-05-22"
      cert_valid_to       = "2026-05-21"

      country             = "CN"
      state               = "广东省"
      locality            = "深圳市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0f:55:0e:72:66:0d:ad:b4:e2:8c:13:7e:99:c7:9c:47"
      )
}

rule MAL_Compromised_Cert_XRed_GlobalSign_50A2CABF817DCB14F6313DE6 {
   meta:
      description         = "Detects XRed with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-23"
      version             = "1.0"

      hash                = "70ed363667ec9761867c6e5da32a6486d2c52e846e03e6c535545ad4a2a973f5"
      malware             = "XRed"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen Renren Aipin Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:a2:ca:bf:81:7d:cb:14:f6:31:3d:e6"
      cert_thumbprint     = "C4FA6706FB6CCA2CBEDC6638905B4CF08B4984B1"
      cert_valid_from     = "2025-07-23"
      cert_valid_to       = "2026-07-24"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:a2:ca:bf:81:7d:cb:14:f6:31:3d:e6"
      )
}

rule MAL_Compromised_Cert_XRed_GlobalSign_7E67FCC70CFA4989670E6D23 {
   meta:
      description         = "Detects XRed with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-03"
      version             = "1.0"

      hash                = "b27c43cf62df0388d7be0f26191f2ed5c39e485a2fd877bc7c715b3c9a558afc"
      malware             = "XRed"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shenzhen UCL Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:67:fc:c7:0c:fa:49:89:67:0e:6d:23"
      cert_thumbprint     = "047CD4B8D05B99A1934E8E27C751C00C10338472"
      cert_valid_from     = "2025-07-03"
      cert_valid_to       = "2025-11-14"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:67:fc:c7:0c:fa:49:89:67:0e:6d:23"
      )
}

rule MAL_Compromised_Cert_XWorm_Certum_5CB4CC8D31F6B00C0CAF09CB23945CFD {
   meta:
      description         = "Detects XWorm with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-28"
      version             = "1.0"

      hash                = "4e196693e5613b4585e4dd4ae694e21a0bf90854d916629e465ad2cfcc1e945a"
      malware             = "XWorm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Open Source Developer, Qiang Zhang"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Code Signing 2021 CA"
      cert_serial         = "5c:b4:cc:8d:31:f6:b0:0c:0c:af:09:cb:23:94:5c:fd"
      cert_thumbprint     = "68B94BAF09EDC2422CB70291143980A518EFF2B1"
      cert_valid_from     = "2024-10-28"
      cert_valid_to       = "2025-10-28"

      country             = "CN"
      state               = "陕西省"
      locality            = "汉中市"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Code Signing 2021 CA" and
         sig.serial == "5c:b4:cc:8d:31:f6:b0:0c:0c:af:09:cb:23:94:5c:fd"
      )
}

rule MAL_Compromised_Cert_XWorm_DigiCert_0C03E51062B12016402733A20D6AB2E2 {
   meta:
      description         = "Detects XWorm with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-08-14"
      version             = "1.0"

      hash                = "7fb45016511c46705971d2a3185f805bf7c0b0c7668cd77fae4c46f00d4f8454"
      malware             = "XWorm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "RONALDO RODRIGUES SANTANA 22670573878"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "0c:03:e5:10:62:b1:20:16:40:27:33:a2:0d:6a:b2:e2"
      cert_thumbprint     = "c78e08b801eb94a3b70076bb0b5c6a828b7a43c508411e488424ec989cb03799"
      cert_valid_from     = "2024-08-14"
      cert_valid_to       = "2025-08-13"

      country             = "BR"
      state               = "Sao Paulo"
      locality            = "CAMPINAS"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "0c:03:e5:10:62:b1:20:16:40:27:33:a2:0d:6a:b2:e2"
      )
}

rule MAL_Compromised_Cert_XWorm_SSL_com_51554DAD826DA2EE44D163AA61EA5615 {
   meta:
      description         = "Detects XWorm with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-28"
      version             = "1.0"

      hash                = "578036563087d55a9ebd0d4e82495bffb08a3c914d52f3f01a25951bb0539f7f"
      malware             = "XWorm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "PEDRO HENRIQUE SILVA DE JESUS 13812209756"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "51:55:4d:ad:82:6d:a2:ee:44:d1:63:aa:61:ea:56:15"
      cert_thumbprint     = "00A98A0118CF09C528DE9E3FC75C7A69DA0E2A6A"
      cert_valid_from     = "2024-11-28"
      cert_valid_to       = "2025-11-28"

      country             = "BR"
      state               = "Rio de Janeiro"
      locality            = "Rio de Janeiro"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "51:55:4d:ad:82:6d:a2:ee:44:d1:63:aa:61:ea:56:15"
      )
}

rule MAL_Compromised_Cert_Xtract_trojan_productivity_tool_GlobalSign_17B85C86D451E2EAEE121A47 {
   meta:
      description         = "Detects Xtract,trojan productivity tool with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-22"
      version             = "1.0"

      hash                = "2063c4a79c44b398869e1296447f5e687d428113f62f1f22665d8bb5d9c9dda6"
      malware             = "Xtract,trojan productivity tool"
      malware_type        = "Trojan"
      malware_notes       = "Trojan productivity tool"

      signer              = "BITTERN SKY LTD"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "17:b8:5c:86:d4:51:e2:ea:ee:12:1a:47"
      cert_thumbprint     = "EB855C3C179411119FF93093593AA6FA9DC95178"
      cert_valid_from     = "2025-05-22"
      cert_valid_to       = "2026-05-23"

      country             = "IL"
      state               = "Central District"
      locality            = "Ra'anana"
      email               = "contactus@bitternskyltd.com"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "17:b8:5c:86:d4:51:e2:ea:ee:12:1a:47"
      )
}

rule MAL_Compromised_Cert_Xworm_Certum_2D62E539DA36F1532DEC45AF6D991A09 {
   meta:
      description         = "Detects Xworm with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-26"
      version             = "1.0"

      hash                = "307b77d2b1e2f81de47851567840a0b44e53ac74b9ad2c0c9aa91228e8581aab"
      malware             = "Xworm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "珠海康晶科技有限公司"
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "2d:62:e5:39:da:36:f1:53:2d:ec:45:af:6d:99:1a:09"
      cert_thumbprint     = "ABBF9EEBE893B9EC0B5F9664589D0202444784D5"
      cert_valid_from     = "2024-04-26"
      cert_valid_to       = "2025-04-26"

      country             = "CN"
      state               = "广东"
      locality            = "珠海"
      email               = "???"
      rdn_serial_number   = "91440400MA55GU3W0F"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "2d:62:e5:39:da:36:f1:53:2d:ec:45:af:6d:99:1a:09"
      )
}

rule MAL_Compromised_Cert_Xworm_Certum_4AEA2FD2D3DD61D454B29A9035C7443E {
   meta:
      description         = "Detects Xworm with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-09-30"
      version             = "1.0"

      hash                = "0cf06c833517acebaebf18e5b36edccb4903a112117dbee1a19f9b76c7a7b36f"
      malware             = "Xworm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Xiamen Huixiantong Network Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "4a:ea:2f:d2:d3:dd:61:d4:54:b2:9a:90:35:c7:44:3e"
      cert_thumbprint     = "B0D949125202A88EF756E702FF910631B5E1C674"
      cert_valid_from     = "2024-09-30"
      cert_valid_to       = "2025-09-30"

      country             = "CN"
      state               = "Fujian"
      locality            = "Xiamen"
      email               = "???"
      rdn_serial_number   = "91350211MA31JF8419"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "4a:ea:2f:d2:d3:dd:61:d4:54:b2:9a:90:35:c7:44:3e"
      )
}

rule MAL_Compromised_Cert_Xworm_GlobalSign_4C0354CE17E2C3642C3D064C {
   meta:
      description         = "Detects Xworm with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-29"
      version             = "1.0"

      hash                = "b75dec6f19a3dec025862a0d6e7dd565ad49c327cd85c21d5135ccffef60e68f"
      malware             = "Xworm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "SyncFutureTec Company Limited"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 CodeSigning CA 2020"
      cert_serial         = "4c:03:54:ce:17:e2:c3:64:2c:3d:06:4c"
      cert_thumbprint     = "F9EAAB0F05BD38A251427A05F95386CA7CEDDCE8"
      cert_valid_from     = "2023-03-29"
      cert_valid_to       = "2025-03-29"

      country             = "CN"
      state               = "Jiangsu"
      locality            = "Nanjing"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 CodeSigning CA 2020" and
         sig.serial == "4c:03:54:ce:17:e2:c3:64:2c:3d:06:4c"
      )
}

rule MAL_Compromised_Cert_Xworm_GlobalSign_6BF56A335E58AE8C94C8C99D {
   meta:
      description         = "Detects Xworm with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-18"
      version             = "1.0"

      hash                = "0467ee83070e28023faf9b096a7710b9b58a4b3b937b80cb3406e30b9fbee853"
      malware             = "Xworm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Pay 2 Services Company Limited"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "6b:f5:6a:33:5e:58:ae:8c:94:c8:c9:9d"
      cert_thumbprint     = "4C4DD9838D8862724A9BE9F7142B7D6A5632BB18"
      cert_valid_from     = "2024-11-18"
      cert_valid_to       = "2025-11-19"

      country             = "VN"
      state               = "Hồ Chí Minh"
      locality            = "Hồ Chí Minh"
      email               = "???"
      rdn_serial_number   = "0314605239"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "6b:f5:6a:33:5e:58:ae:8c:94:c8:c9:9d"
      )
}

rule MAL_Compromised_Cert_Xworm_SSL_com_1C26AAC9A6E9385EDCBFE1CF495409FC {
   meta:
      description         = "Detects Xworm with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-17"
      version             = "1.0"

      hash                = "b067a06d797c4563c036c1de2668c6bc1a7dbfbd0d07755066287b8b1822b588"
      malware             = "Xworm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "N SILVA COMERCIO E SERVICOS TURISTICOS LTDA"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "1c:26:aa:c9:a6:e9:38:5e:dc:bf:e1:cf:49:54:09:fc"
      cert_thumbprint     = "E9563CF80F9A2BF08BD60D692E86618D0897B9B9"
      cert_valid_from     = "2025-07-17"
      cert_valid_to       = "2026-07-17"

      country             = "BR"
      state               = "Bahia"
      locality            = "Santa Cruz da Vitória"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "1c:26:aa:c9:a6:e9:38:5e:dc:bf:e1:cf:49:54:09:fc"
      )
}

rule MAL_Compromised_Cert_ZLoader_Sectigo_4797D7B279BE40DE071A6D59B2D7B8D4 {
   meta:
      description         = "Detects ZLoader with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2020-10-09"
      version             = "1.0"

      hash                = "78c6567201eeeaa1a359ab8929325de30abf18c22993de371a08b7c9bc0af04c"
      malware             = "ZLoader"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "NALA LIMITED"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo RSA Code Signing CA"
      cert_serial         = "47:97:d7:b2:79:be:40:de:07:1a:6d:59:b2:d7:b8:d4"
      cert_thumbprint     = "293B74A66F8F54B1EB4D9EE5EAE0D06F3B5EFD80"
      cert_valid_from     = "2020-10-09"
      cert_valid_to       = "2021-10-09"

      country             = "GB"
      state               = "???"
      locality            = "London"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo RSA Code Signing CA" and
         sig.serial == "47:97:d7:b2:79:be:40:de:07:1a:6d:59:b2:d7:b8:d4"
      )
}

rule MAL_Compromised_Cert_ZeroDayTraffer_SSL_com_39D6C425AB7C43EA309C2D64F62E86D6 {
   meta:
      description         = "Detects ZeroDayTraffer with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-15"
      version             = "1.0"

      hash                = "890f619b890b0a30d5f88a7acb523b670eea902683d9233f1d7f8d08b64500b8"
      malware             = "ZeroDayTraffer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "THE PACK (Shanghai) Corp."
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "39:d6:c4:25:ab:7c:43:ea:30:9c:2d:64:f6:2e:86:d6"
      cert_thumbprint     = "85F8A46CA3002846015A6D3048BB9058B844D63E"
      cert_valid_from     = "2025-02-15"
      cert_valid_to       = "2026-02-11"

      country             = "CN"
      state               = "???"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "913100007862663014"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "39:d6:c4:25:ab:7c:43:ea:30:9c:2d:64:f6:2e:86:d6"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_Certum_30F927F04880D925FB28775A412E8C13 {
   meta:
      description         = "Detects ZhongStealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-21"
      version             = "1.0"

      hash                = "b2ef6a86983e15d0f70e5941b79d03419d4c7bcd4b1c58223f6b8334ed800deb"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "Loads payloads from AWS S3 bucket. downloads 503 JPG from bucket as decoy: https://tria.ge/251129-r55s4szpem/behavioral1"

      signer              = "Shanghai Baiyang Information Technology Development Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "30:f9:27:f0:48:80:d9:25:fb:28:77:5a:41:2e:8c:13"
      cert_thumbprint     = "CC2172E282D7443E956F090A6795E33BF817A927"
      cert_valid_from     = "2025-11-21"
      cert_valid_to       = "2026-11-21"

      country             = "CN"
      state               = "上海市"
      locality            = "上海市"
      email               = "???"
      rdn_serial_number   = "91310000MADNJP1G00"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "30:f9:27:f0:48:80:d9:25:fb:28:77:5a:41:2e:8c:13"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_GlobalSign_74B936AB655DB6CA62761A5C {
   meta:
      description         = "Detects ZhongStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-07-09"
      version             = "1.0"

      hash                = "4de8a71b4e5e37f040532aaf31908311910f449c1a64db9141a485960bbae534"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "合肥亲爱的译官信息科技有限公司"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "74:b9:36:ab:65:5d:b6:ca:62:76:1a:5c"
      cert_thumbprint     = "25745917F9D93F19CF8C796B660A9A27E3FA3833"
      cert_valid_from     = "2024-07-09"
      cert_valid_to       = "2025-08-14"

      country             = "CN"
      state               = "安徽"
      locality            = "合肥"
      email               = "???"
      rdn_serial_number   = "91340100MA8PA6TBXY"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "74:b9:36:ab:65:5d:b6:ca:62:76:1a:5c"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_GlobalSign_7EAD677A7DD7F660379D116A {
   meta:
      description         = "Detects ZhongStealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-01"
      version             = "1.0"

      hash                = "d58859ddc52f98e48d32f47b000970ad03e807b8eeb3a1aae7d4af2721b43ecf"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Hena Luxion Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7e:ad:67:7a:7d:d7:f6:60:37:9d:11:6a"
      cert_thumbprint     = "6DEC33D0A800435FB16E222F8F48D6F0BD650F0D"
      cert_valid_from     = "2024-11-01"
      cert_valid_to       = "2025-11-02"

      country             = "CN"
      state               = "Henan"
      locality            = "Zhengzhou"
      email               = "???"
      rdn_serial_number   = "91410104MA447T3JX7"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7e:ad:67:7a:7d:d7:f6:60:37:9d:11:6a"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_Sectigo_22705DBF157ED535146911BAADB3B64A {
   meta:
      description         = "Detects ZhongStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-27"
      version             = "1.0"

      hash                = "a508358a0786ddf2ad9496bb9374d54e71c5044df9c10fe686d43fc70484e54c"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "The malware was downloaded via storage[.]googleapis[.]com/hongkongwork1/ and is disguised as a  image using the filename photo202512176896m.pif, but is an executable."

      signer              = "Weihai Mingjun Information Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "22:70:5d:bf:15:7e:d5:35:14:69:11:ba:ad:b3:b6:4a"
      cert_thumbprint     = "A947B270081E9E496FF347F4F89FBE3EC9CB2B72"
      cert_valid_from     = "2025-11-27"
      cert_valid_to       = "2026-11-27"

      country             = "CN"
      state               = "Shandong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91371000MA3WAC7627"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "22:70:5d:bf:15:7e:d5:35:14:69:11:ba:ad:b3:b6:4a"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_Sectigo_4C3EDBD0B6450CB8BF2B506032A5B7B2 {
   meta:
      description         = "Detects ZhongStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-06-07"
      version             = "1.0"

      hash                = "1718b2f1372dbbe9df071205fe749bcefe8857af7e376c812168f2590e1dcb27"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware often hosts secondary payloads on CDNs. This signer name is \"Kingston Technology Company, Inc\"; but was confirmed not to be a legitimate certificate used by Kingston."

      signer              = "Kingston Technology Company, Inc"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "4c:3e:db:d0:b6:45:0c:b8:bf:2b:50:60:32:a5:b7:b2"
      cert_thumbprint     = "8A99A90A9B2095B52AD670B1BF5CAC68A9784FF8"
      cert_valid_from     = "2025-06-07"
      cert_valid_to       = "2026-05-25"

      country             = "US"
      state               = "California"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "4c:3e:db:d0:b6:45:0c:b8:bf:2b:50:60:32:a5:b7:b2"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_Sectigo_4FA68807EFBBD22B25622E60F2EF3041 {
   meta:
      description         = "Detects ZhongStealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-11"
      version             = "1.0"

      hash                = "be5d6c4aa4b27548a06c2afaef3b4035abf65566e9a8bfd642b4a2032729656e"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "运城市盐湖区风颜商贸有限公司"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "4f:a6:88:07:ef:bb:d2:2b:25:62:2e:60:f2:ef:30:41"
      cert_thumbprint     = "A176736F8B6462141E4BFDFC1FEB5EC11663D684"
      cert_valid_from     = "2025-02-11"
      cert_valid_to       = "2026-05-12"

      country             = "CN"
      state               = "山西省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91140802MADALQC44B"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "4f:a6:88:07:ef:bb:d2:2b:25:62:2e:60:f2:ef:30:41"
      )
}

rule MAL_Compromised_Cert_ZhongStealer_Verokey_04EB8615F356CF0F5BF4DBCD08238DA4 {
   meta:
      description         = "Detects ZhongStealer with compromised cert (Verokey)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-24"
      version             = "1.0"

      hash                = "b5fb40289c795be46e746bce7cfb8641bd4d619e49fae62f4998c7915f831e5e"
      malware             = "ZhongStealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware relies on CDNs to pull down second stage components. See https://x.com/malwrhunterteam/status/1997368057702842676?s=20"

      signer              = "山西荣升源科贸有限公司"
      cert_issuer_short   = "Verokey"
      cert_issuer         = "Verokey High Assurance Secure Code EV"
      cert_serial         = "04:eb:86:15:f3:56:cf:0f:5b:f4:db:cd:08:23:8d:a4"
      cert_thumbprint     = "428FEE9B772BD7E56987E864AD8C83B5721E717F"
      cert_valid_from     = "2024-10-24"
      cert_valid_to       = "2026-06-18"

      country             = "CN"
      state               = "山西省"
      locality            = "太原市"
      email               = "???"
      rdn_serial_number   = "91140105MA0LK0WH8B"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Verokey High Assurance Secure Code EV" and
         sig.serial == "04:eb:86:15:f3:56:cf:0f:5b:f4:db:cd:08:23:8d:a4"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Certum_44E16F602A8BBC60E52ADFFBDA35ED09 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-27"
      version             = "1.0"

      hash                = "af982b9e203d5023b61f0a3758b1b1c1295ffa157d189a9eec3499f508d0e71d"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Wuhan Liansitong Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "44:e1:6f:60:2a:8b:bc:60:e5:2a:df:fb:da:35:ed:09"
      cert_thumbprint     = "3F5EF573974902B64A70A6A6A6E030752E8E4086"
      cert_valid_from     = "2025-10-27"
      cert_valid_to       = "2026-10-27"

      country             = "CN"
      state               = "湖北省"
      locality            = "武汉市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "44:e1:6f:60:2a:8b:bc:60:e5:2a:df:fb:da:35:ed:09"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Certum_5AE3A3B23CFA63ADFCED9BA9EF9A263C {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-21"
      version             = "1.0"

      hash                = "179b8af13000463b87f74c99828671f0069126fc4cf65d862c223e67991ff75b"
      malware             = "Zhong Stealer"
      malware_type        = "Stealer"
      malware_notes       = ""

      signer              = "Jinhua Suyu Intelligent Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5a:e3:a3:b2:3c:fa:63:ad:fc:ed:9b:a9:ef:9a:26:3c"
      cert_thumbprint     = "63813F758626A4071E571FA846955DF793961D7B"
      cert_valid_from     = "2025-11-21"
      cert_valid_to       = "2026-11-21"

      country             = "CN"
      state               = "浙江省"
      locality            = "金华市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5a:e3:a3:b2:3c:fa:63:ad:fc:ed:9b:a9:ef:9a:26:3c"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Certum_5BE7B13F587B8850573257DF55E5E39E {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-18"
      version             = "1.0"

      hash                = "873ea83b3507d8391b1b66f0f3d57cefff4307463b018eec09abbff601c83d30"
      malware             = "Zhong Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Shandong Saibo Information Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5b:e7:b1:3f:58:7b:88:50:57:32:57:df:55:e5:e3:9e"
      cert_thumbprint     = "9604C61D97B1AF3BF1E5C00E707DF524E1491678"
      cert_valid_from     = "2025-11-18"
      cert_valid_to       = "2026-11-18"

      country             = "CN"
      state               = "Shandong"
      locality            = "Taian"
      email               = "???"
      rdn_serial_number   = "91370902MAC7ANU62H"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5b:e7:b1:3f:58:7b:88:50:57:32:57:df:55:e5:e3:9e"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Certum_5CCC14BFA5980319E17B16F0360684FF {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Certum)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-11-07"
      version             = "1.0"

      hash                = "f0373871da028119a2726637859014eb63d2c7770924fe17b47199a6e6255aa6"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Changdu Wopu Technology Co., Ltd."
      cert_issuer_short   = "Certum"
      cert_issuer         = "Certum Extended Validation Code Signing 2021 CA"
      cert_serial         = "5c:cc:14:bf:a5:98:03:19:e1:7b:16:f0:36:06:84:ff"
      cert_thumbprint     = "E5A604EE112216277E35FA9536A2E9086991EDC8"
      cert_valid_from     = "2025-11-07"
      cert_valid_to       = "2026-11-07"

      country             = "CN"
      state               = "西藏自治区"
      locality            = "昌都市"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Certum Extended Validation Code Signing 2021 CA" and
         sig.serial == "5c:cc:14:bf:a5:98:03:19:e1:7b:16:f0:36:06:84:ff"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_DigiCert_0497D45997C350D2867A7764017C3F3F {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-05-02"
      version             = "1.0"

      hash                = "d62dfb0d94b292d6fbedbe98757e796f886c32e8d29d347b7b0cee06e863fccb"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Eugene Investment & Securities Co.,Ltd"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1"
      cert_serial         = "04:97:d4:59:97:c3:50:d2:86:7a:77:64:01:7c:3f:3f"
      cert_thumbprint     = "9CB771C734F6C0BF6371B2B2E7B1C3C494DA6FAD"
      cert_valid_from     = "2023-05-02"
      cert_valid_to       = "2026-05-04"

      country             = "KR"
      state               = "Seoul"
      locality            = "Yeongdeungpo-gu"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" and
         sig.serial == "04:97:d4:59:97:c3:50:d2:86:7a:77:64:01:7c:3f:3f"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_DigiCert_0A04CAF1BB3BC17A33C6E155EC4F5883 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (DigiCert)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-10"
      version             = "1.0"

      hash                = "945d0516c078c0255dfb8476056580daee0309bf6cc4bb1542671686e42d85ff"
      malware             = "Zhong Stealer"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Keroro Software LLC"
      cert_issuer_short   = "DigiCert"
      cert_issuer         = "DigiCert Global G3 Code Signing ECC SHA384 2021 CA1"
      cert_serial         = "0a:04:ca:f1:bb:3b:c1:7a:33:c6:e1:55:ec:4f:58:83"
      cert_thumbprint     = "07AAE8AA3A5356061AC23E963CA76156351737D2"
      cert_valid_from     = "2025-07-10"
      cert_valid_to       = "2028-09-26"

      country             = "CN"
      state               = "广东省"
      locality            = "深圳市"
      email               = "???"
      rdn_serial_number   = "91440300MA5FAR1W6E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "DigiCert Global G3 Code Signing ECC SHA384 2021 CA1" and
         sig.serial == "0a:04:ca:f1:bb:3b:c1:7a:33:c6:e1:55:ec:4f:58:83"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_07CD057EFB53D6F2C5C839FC {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-05-28"
      version             = "1.0"

      hash                = "7a2adf0acbc37d870138bb65551e258a3d1bd4ab6bf50df0a7c66d770cc0f787"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Klimine Far Year Electronic Commerce Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "07:cd:05:7e:fb:53:d6:f2:c5:c8:39:fc"
      cert_thumbprint     = "FCAEEA9A9EBEC63DCC5E393DEB77DA0A2305166B"
      cert_valid_from     = "2024-05-28"
      cert_valid_to       = "2025-05-29"

      country             = "CN"
      state               = "Yunnan"
      locality            = "Kunming"
      email               = "???"
      rdn_serial_number   = "91530111MACH7ART91"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "07:cd:05:7e:fb:53:d6:f2:c5:c8:39:fc"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_172C26AE164BCD6BEFEC180E {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-01-03"
      version             = "1.0"

      hash                = "3a338725967f6bb7fc3d5245bc40371742f46caae99f0db23e52f81c748091ab"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Shenzhen Xiangyou Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "17:2c:26:ae:16:4b:cd:6b:ef:ec:18:0e"
      cert_thumbprint     = "da71e8a37f0f99dd7652d95fec40361409dd16ed"
      cert_valid_from     = "2025-01-03"
      cert_valid_to       = "2026-01-04"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Shenzhen"
      email               = "???"
      rdn_serial_number   = "91440300MA5EFLM089"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "17:2c:26:ae:16:4b:cd:6b:ef:ec:18:0e"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_29494FD2ACB61616AAEAA470 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-20"
      version             = "1.0"

      hash                = "d19ca1798eaa49f3a803294d240c7bcf121b8c1f0f261aa7d7a30011fafb2385"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Taiyuan Jiedong Trading Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "29:49:4f:d2:ac:b6:16:16:aa:ea:a4:70"
      cert_thumbprint     = "3B0BB0BB9C0B9E86454C6D2EBE5A8D93E7D8DD92"
      cert_valid_from     = "2025-05-20"
      cert_valid_to       = "2026-05-21"

      country             = "CN"
      state               = "Shanxi"
      locality            = "Taiyuan"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "29:49:4f:d2:ac:b6:16:16:aa:ea:a4:70"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_2F93FA58F00445EEDC313273 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-22"
      version             = "1.0"

      hash                = "16e01dd4c60462c0a870bf55ec987514e122f27b306858e73f71a8ca4b896423"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Chengdu Nuoxin Times Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "2f:93:fa:58:f0:04:45:ee:dc:31:32:73"
      cert_thumbprint     = "3CF1146EDC6B0C3595D5C8C015BF52E77BA1C74C"
      cert_valid_from     = "2025-04-22"
      cert_valid_to       = "2026-08-14"

      country             = "CN"
      state               = "Sichuan"
      locality            = "Chengdu"
      email               = "???"
      rdn_serial_number   = "91510100MA65214R21"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "2f:93:fa:58:f0:04:45:ee:dc:31:32:73"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_424E89A44FF616A6183251F7 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-11"
      version             = "1.0"

      hash                = "1f0f5173c6aae129e6cd5994da53b510497be2ba7f2ebf50fb0cb298314b0c8a"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "PrimeSnap Technologies Network Company"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "42:4e:89:a4:4f:f6:16:a6:18:32:51:f7"
      cert_thumbprint     = "FF9B29C594ECC88BDE9AB852D7195CAFECFB2060"
      cert_valid_from     = "2024-11-11"
      cert_valid_to       = "2025-11-12"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440101078418722E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "42:4e:89:a4:4f:f6:16:a6:18:32:51:f7"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_5076171603477D5BD6AEB984 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-04-11"
      version             = "1.0"

      hash                = "33a942276ace165ccbc9db4966b18d0a767e2e78f4a09d2bf0845bcd2c8a356c"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "GZ.PurestJone Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "50:76:17:16:03:47:7d:5b:d6:ae:b9:84"
      cert_thumbprint     = "8C53168E668EF0CB2F20C3D7770830EF3CB73077"
      cert_valid_from     = "2024-04-11"
      cert_valid_to       = "2025-04-12"

      country             = "CN"
      state               = "Guangdong"
      locality            = "Guangzhou"
      email               = "???"
      rdn_serial_number   = "91440114MACL0TN54Q"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "50:76:17:16:03:47:7d:5b:d6:ae:b9:84"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_623D84F3FD52F1A872E1BF83 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-24"
      version             = "1.0"

      hash                = "ee4589553dadaae174dce6ce9b62804186717f24e9d01c8a41ed8643cc8024e9"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Shanghai Linyao Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "62:3d:84:f3:fd:52:f1:a8:72:e1:bf:83"
      cert_thumbprint     = "E565FD587547A22B363100369D6265E2E83842DF"
      cert_valid_from     = "2024-12-24"
      cert_valid_to       = "2025-12-24"

      country             = "CN"
      state               = "Shanghai"
      locality            = "Shanghai"
      email               = "???"
      rdn_serial_number   = "91310120MA1HY6532E"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "62:3d:84:f3:fd:52:f1:a8:72:e1:bf:83"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_GlobalSign_648B06C27B37237B6D204BB5 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-12"
      version             = "1.0"

      hash                = "97a2d5e70f82ba56cdc8e7180c63d1fcd165704389e7362ed142f968c5b1ccaa"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Hoozoou Leeser Smart Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:8b:06:c2:7b:37:23:7b:6d:20:4b:b5"
      cert_thumbprint     = "4B9D36A0525303CC0F97567BC8755E9A61DA6C78"
      cert_valid_from     = "2025-03-12"
      cert_valid_to       = "2026-03-13"

      country             = "CN"
      state               = "Zhejiang"
      locality            = "Hangzhou"
      email               = "???"
      rdn_serial_number   = "91330108MA2B16Q83M"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:8b:06:c2:7b:37:23:7b:6d:20:4b:b5"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_008B3F8F725F80DECBDB4920ADA8817F3A {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2023-03-21"
      version             = "1.0"

      hash                = "f9ebdee82173f0cd71a90d189d89947952e23756651da241d675328616a35ea2"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "BLOOMTECHNOLOGY.INC"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:8b:3f:8f:72:5f:80:de:cb:db:49:20:ad:a8:81:7f:3a"
      cert_thumbprint     = "70C5CF27162A4EE6305CE63E53C948411C3EDC28"
      cert_valid_from     = "2023-03-21"
      cert_valid_to       = "2026-03-20"

      country             = "KR"
      state               = "Gyeonggi-do"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:8b:3f:8f:72:5f:80:de:cb:db:49:20:ad:a8:81:7f:3a"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_00C86D943E4E146E5FDF9694F06DA41F2B {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-16"
      version             = "1.0"

      hash                = "a04f1e64fd7e2ef6decbfd2e26ad2a3066862fbe039a3bbed5cc9b6eacd4edf9"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Harman International Industries, Incorporated"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:c8:6d:94:3e:4e:14:6e:5f:df:96:94:f0:6d:a4:1f:2b"
      cert_thumbprint     = "7DD79011F697349E20682B25CFD670EACF1CED73"
      cert_valid_from     = "2025-05-16"
      cert_valid_to       = "2026-04-28"

      country             = "US"
      state               = "Connecticut"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "1080291"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:c8:6d:94:3e:4e:14:6e:5f:df:96:94:f0:6d:a4:1f:2b"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_00EE3A88EF4AB47D8617E4EDC56736C75F {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-11-28"
      version             = "1.0"

      hash                = "441ef8aa13409660cedb9a557619f60cbf90c3f0d28f7191b8385a6d147acf46"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "邢台鸭梨智能科技有限公司"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "00:ee:3a:88:ef:4a:b4:7d:86:17:e4:ed:c5:67:36:c7:5f"
      cert_thumbprint     = "1F4036E52F236004A8229D7AD0E18024423044B9"
      cert_valid_from     = "2024-11-28"
      cert_valid_to       = "2025-11-28"

      country             = "CN"
      state               = "河北省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "00:ee:3a:88:ef:4a:b4:7d:86:17:e4:ed:c5:67:36:c7:5f"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_191E24F6C98E31D04F876A2E26E0CC71 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-21"
      version             = "1.0"

      hash                = "1a80f721ab125b88e5baf77dd2bf01be92ff5299665356621b21306a71c86672"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Meizhou Fisherman Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "19:1e:24:f6:c9:8e:31:d0:4f:87:6a:2e:26:e0:cc:71"
      cert_thumbprint     = "90AB62209A3C3CDF63229669BBF1EE3546C7D34B"
      cert_valid_from     = "2025-05-21"
      cert_valid_to       = "2026-05-21"

      country             = "CN"
      state               = "Guangdong Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "19:1e:24:f6:c9:8e:31:d0:4f:87:6a:2e:26:e0:cc:71"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_34E947F11A0DA31561875BFC5FBCC5AB {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-08"
      version             = "1.0"

      hash                = "06663c82d1e6df0eff9712b4250e4a189a076e2592feae7753485c1dd97c6bf6"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "海口市勤莱佳科技有限公司"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "34:e9:47:f1:1a:0d:a3:15:61:87:5b:fc:5f:bc:c5:ab"
      cert_thumbprint     = "9042ED33AEA56BC28C4CF03E8D03036EB8BFCF6A"
      cert_valid_from     = "2025-04-08"
      cert_valid_to       = "2026-04-08"

      country             = "CN"
      state               = "海南省"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "91460000MABXCETU0T"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "34:e9:47:f1:1a:0d:a3:15:61:87:5b:fc:5f:bc:c5:ab"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_6559999436BD29785FBF07D0F472E994 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-11"
      version             = "1.0"

      hash                = "1052924f914229325270e7cc862ab1ef6fcc73da22dd9afff222f7168b3f8343"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "RichQuest Network Technology Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "65:59:99:94:36:bd:29:78:5f:bf:07:d0:f4:72:e9:94"
      cert_thumbprint     = "59B7B2C37523F7CA057C2CDCC0C6C0482740E9A1"
      cert_valid_from     = "2025-08-11"
      cert_valid_to       = "2026-08-11"

      country             = "CN"
      state               = "Jilin Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "65:59:99:94:36:bd:29:78:5f:bf:07:d0:f4:72:e9:94"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_67E44E108CF60C941B913A00A7F5C290 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-10-31"
      version             = "1.0"

      hash                = "778f20d1c46f2427238c3e8c38fb3825fd3af80a022d03aa56be0dca2a1a593a"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Gemini Technologies Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "67:e4:4e:10:8c:f6:0c:94:1b:91:3a:00:a7:f5:c2:90"
      cert_thumbprint     = "D0C56580D299E65612564CBE9D875E5EAA470AB6"
      cert_valid_from     = "2025-10-31"
      cert_valid_to       = "2026-10-31"

      country             = "CN"
      state               = "Sichuan Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "67:e4:4e:10:8c:f6:0c:94:1b:91:3a:00:a7:f5:c2:90"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_70205E32FEFDB3E3D948AF5E67472901 {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-05-23"
      version             = "1.0"

      hash                = "749edc4ed6c6e9c861dcdf452c7acc7ec521cd1b4ac91ffee4158ab53ec57730"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Ventis Media, Inc."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA E36"
      cert_serial         = "70:20:5e:32:fe:fd:b3:e3:d9:48:af:5e:67:47:29:01"
      cert_thumbprint     = "758253C0037839EBAAFEA8EAC9AAD6311399E8B3"
      cert_valid_from     = "2025-05-23"
      cert_valid_to       = "2026-01-01"

      country             = "CA"
      state               = "Quebec"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA E36" and
         sig.serial == "70:20:5e:32:fe:fd:b3:e3:d9:48:af:5e:67:47:29:01"
      )
}

rule MAL_Compromised_Cert_Zhong_Stealer_Sectigo_754022596DA5B16478C5E880ED2D730F {
   meta:
      description         = "Detects Zhong Stealer with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-09-16"
      version             = "1.0"

      hash                = "36d4a0c46a0b9613b7f4ab38a9bf1a8ee3d54e059f2451f20e999a7b49b9af56"
      malware             = "Zhong Stealer"
      malware_type        = "Infostealer"
      malware_notes       = "This malware leverages cloud hosting to hold additional components. The components are TASLogin and its associated DLL: medium.com/@anyrun/zhong-stealer-analysis-new-malware-targeting-fintech-and-cryptocurrency-71d4a3cce42c"

      signer              = "Yongji Xiaodong Network Technology Co., Ltd."
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV R36"
      cert_serial         = "75:40:22:59:6d:a5:b1:64:78:c5:e8:80:ed:2d:73:0f"
      cert_thumbprint     = "3148D6576C067EE43DAACBFD3B34C033EEE1DB53"
      cert_valid_from     = "2025-09-16"
      cert_valid_to       = "2026-09-16"

      country             = "CN"
      state               = "Shanxi Sheng"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "???"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV R36" and
         sig.serial == "75:40:22:59:6d:a5:b1:64:78:c5:e8:80:ed:2d:73:0f"
      )
}

rule MAL_Compromised_Cert_asyncrat_GlobalSign_310E2734DDD4AA4754E205F4 {
   meta:
      description         = "Detects asyncrat with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-18"
      version             = "1.0"

      hash                = "f286629a9391e4bd928c9c07e604d452062a45e077a48c550f95dc00549369a5"
      malware             = "asyncrat"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Jerloosr Kliokery Innovation Institute Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "31:0e:27:34:dd:d4:aa:47:54:e2:05:f4"
      cert_thumbprint     = "13B0F07E1F60124E1C55E8488DDCDCE4BF7E378E"
      cert_valid_from     = "2025-03-18"
      cert_valid_to       = "2026-03-19"

      country             = "CN"
      state               = "Shandong"
      locality            = "Tai'an"
      email               = "???"
      rdn_serial_number   = "91370900MA3N89RR4L"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "31:0e:27:34:dd:d4:aa:47:54:e2:05:f4"
      )
}

rule MAL_Compromised_Cert_donut_GlobalSign_3B7EAC8B20F3EDCB557300BE {
   meta:
      description         = "Detects donut with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-04-17"
      version             = "1.0"

      hash                = "f581f89ed99982ebd1eb16913d9128d09655cfacf922b5c62697b36b3469872d"
      malware             = "donut"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "LLC Service Stroy TK"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "3b:7e:ac:8b:20:f3:ed:cb:55:73:00:be"
      cert_thumbprint     = "3F6BE09D1813092FD3AC7D3C28D3600343426976"
      cert_valid_from     = "2025-04-17"
      cert_valid_to       = "2026-04-18"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1177746889099"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "3b:7e:ac:8b:20:f3:ed:cb:55:73:00:be"
      )
}

rule MAL_Compromised_Cert_gh0stRAT_GlobalSign_40E90E0B6789811000910DBD {
   meta:
      description         = "Detects gh0stRAT with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-10-11"
      version             = "1.0"

      hash                = "9e78f89ffa70b6426595e1007db89bc2bd9fd39600d659a347f4689c5a1e67ad"
      malware             = "gh0stRAT"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "CubTiger Network Technology Co., Ltd."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "40:e9:0e:0b:67:89:81:10:00:91:0d:bd"
      cert_thumbprint     = "C6F65585AA0FFFFCF16DB62E8E6AA49B87F2A0A3"
      cert_valid_from     = "2024-10-11"
      cert_valid_to       = "2025-10-12"

      country             = "CN"
      state               = "Beijing"
      locality            = "Beijing"
      email               = "???"
      rdn_serial_number   = "91110229MA01R14F61"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "40:e9:0e:0b:67:89:81:10:00:91:0d:bd"
      )
}

rule MAL_Compromised_Cert_latrodectus_SSL_com_611E5DC57B210DC08205140F6D57063F {
   meta:
      description         = "Detects latrodectus with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-08-11"
      version             = "1.0"

      hash                = "87c787ea53a4dad92afd36c13a4fc5da7af1ea8dbe5634e4e3b011f289c9c91b"
      malware             = "latrodectus"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "ASTRA PROPERTY MANAGEMENT, SRL"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA ECC R2"
      cert_serial         = "61:1e:5d:c5:7b:21:0d:c0:82:05:14:0f:6d:57:06:3f"
      cert_thumbprint     = "6ed1e4c622f0ddb484716df01b3cde1781181c45c07fac22eebc07e7ba8559c3"
      cert_valid_from     = "2025-08-11"
      cert_valid_to       = "2026-08-11"

      country             = "MD"
      state               = "Bălți Municipality"
      locality            = "Bălţi"
      email               = "???"
      rdn_serial_number   = "1017602002645"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA ECC R2" and
         sig.serial == "61:1e:5d:c5:7b:21:0d:c0:82:05:14:0f:6d:57:06:3f"
      )
}

rule MAL_Compromised_Cert_lumma_GlobalSign_3321E36953436779598030B7 {
   meta:
      description         = "Detects lumma with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-12-26"
      version             = "1.0"

      hash                = "ac52dc2ae20931a9117b10a357331b88ac7533b2f1531b845019e5ccf0e18cde"
      malware             = "lumma"
      malware_type        = "Infostealer"
      malware_notes       = "This malware was sold as a service and was the most popular infostealer in 2024."

      signer              = "Ascension Design Inc."
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "33:21:e3:69:53:43:67:79:59:80:30:b7"
      cert_thumbprint     = "c208820b6e60609cca87a87517fd9eca51597dac52d5e7829f684087bf39a8f1"
      cert_valid_from     = "2024-12-26"
      cert_valid_to       = "2025-12-27"

      country             = "CA"
      state               = "Ontario"
      locality            = "Ottawa"
      email               = "???"
      rdn_serial_number   = "1231583-1"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "33:21:e3:69:53:43:67:79:59:80:30:b7"
      )
}

rule MAL_Compromised_Cert_mimikatz_Sectigo_00D39EFE480DF9D800D281896AE3800F2D {
   meta:
      description         = "Detects mimikatz with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-06-04"
      version             = "1.0"

      hash                = "f20e0114c8038b9d66bd45049c9396254586f307390479746a6c67f5e1abce2d"
      malware             = "mimikatz"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "McDonald's Corporation"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA R36"
      cert_serial         = "00:d3:9e:fe:48:0d:f9:d8:00:d2:81:89:6a:e3:80:0f:2d"
      cert_thumbprint     = "22EACBF575EA3FF19A6F639E80E8768405C9BDFE"
      cert_valid_from     = "2024-06-04"
      cert_valid_to       = "2025-06-04"

      country             = "US"
      state               = "Illinois"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA R36" and
         sig.serial == "00:d3:9e:fe:48:0d:f9:d8:00:d2:81:89:6a:e3:80:0f:2d"
      )
}

rule MAL_Compromised_Cert_oyster_GlobalSign_7C75A58852CA4C72348CF24D {
   meta:
      description         = "Detects oyster with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-07-04"
      version             = "1.0"

      hash                = "eef6d4b6bdf48a605cade0b517d5a51fc4f4570e505f3d8b9b66158902dcd4af"
      malware             = "oyster"
      malware_type        = "Initial access tool"
      malware_notes       = "An initial access tool used by the Rhysida ransomware gang. See https://expel.com/blog/certified-oysterloader-tracking-rhysida-ransomware-gang-activity-via-code-signing-certificates/ for more details."

      signer              = "LLC Bravery"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "7c:75:a5:88:52:ca:4c:72:34:8c:f2:4d"
      cert_thumbprint     = "FB85AA1E12C09130035D3EB72B50EBF5CCE092C7"
      cert_valid_from     = "2025-07-04"
      cert_valid_to       = "2026-07-05"

      country             = "RU"
      state               = "Moscow"
      locality            = "Moscow"
      email               = "???"
      rdn_serial_number   = "1226100007077"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "7c:75:a5:88:52:ca:4c:72:34:8c:f2:4d"
      )
}

rule MAL_Compromised_Cert_rhadamanthys_GlobalSign_640292DB1F7DFE0D4780428D {
   meta:
      description         = "Detects rhadamanthys with compromised cert (GlobalSign)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-19"
      version             = "1.0"

      hash                = "434548803c79dbf1d6627e039b99c5e9481f3413eaae4e27b8a2e2e0bd41519a"
      malware             = "rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "OOO Pandora"
      cert_issuer_short   = "GlobalSign"
      cert_issuer         = "GlobalSign GCC R45 EV CodeSigning CA 2020"
      cert_serial         = "64:02:92:db:1f:7d:fe:0d:47:80:42:8d"
      cert_thumbprint     = "9E15BD691057FC9ECEC0DA7A3389D47A0B0F1A20"
      cert_valid_from     = "2025-02-19"
      cert_valid_to       = "2026-02-20"

      country             = "RU"
      state               = "Saint Petersburg"
      locality            = "Saint Petersburg"
      email               = "pandoracomp@mail.ru"
      rdn_serial_number   = "1187847297318"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "GlobalSign GCC R45 EV CodeSigning CA 2020" and
         sig.serial == "64:02:92:db:1f:7d:fe:0d:47:80:42:8d"
      )
}

rule MAL_Compromised_Cert_rhadamanthys_SSL_com_4C86947863FAA56934B0383316C55484 {
   meta:
      description         = "Detects rhadamanthys with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-03-17"
      version             = "1.0"

      hash                = "76ab8496660eab79e88ce5f94f340201c923d5731706a3d788922c9c3bff2f1c"
      malware             = "rhadamanthys"
      malware_type        = "Infostealer"
      malware_notes       = "An module infostealer malware: https://research.checkpoint.com/2025/rhadamanthys-0-9-x-walk-through-the-updates/"

      signer              = "Soft-cloud Oy"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com EV Code Signing Intermediate CA RSA R3"
      cert_serial         = "4c:86:94:78:63:fa:a5:69:34:b0:38:33:16:c5:54:84"
      cert_thumbprint     = "6DC85EA85373932064AAACB2E2700E07C10DE0E1"
      cert_valid_from     = "2025-03-17"
      cert_valid_to       = "2026-03-17"

      country             = "FI"
      state               = "Satakunta"
      locality            = "Säkylä"
      email               = "???"
      rdn_serial_number   = "3112306-2"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com EV Code Signing Intermediate CA RSA R3" and
         sig.serial == "4c:86:94:78:63:fa:a5:69:34:b0:38:33:16:c5:54:84"
      )
}

rule MAL_Compromised_Cert_sportjump_autoit_SSL_com_3BDB5C709D953CBE45FFEC02D8A4D7A5 {
   meta:
      description         = "Detects sportjump_autoit with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-28"
      version             = "1.0"

      hash                = "5e152be0bec7debd19c26c4daa67e16a8c037b1c0fa112dc13e151037c84a985"
      malware             = "sportjump_autoit"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Dupa Innovation Ltd"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "3b:db:5c:70:9d:95:3c:be:45:ff:ec:02:d8:a4:d7:a5"
      cert_thumbprint     = "52977AEDE5D3054EEEAB2CD53B08E5E920C84217"
      cert_valid_from     = "2024-03-28"
      cert_valid_to       = "2025-03-28"

      country             = "GB"
      state               = "Wales"
      locality            = "Penarth"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "3b:db:5c:70:9d:95:3c:be:45:ff:ec:02:d8:a4:d7:a5"
      )
}

rule MAL_Compromised_Cert_unknown_SSL_com_4E2CE404AEF344EBB3B87654F2C98422 {
   meta:
      description         = "Detects unknown with compromised cert (SSL.com)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2024-03-15"
      version             = "1.0"

      hash                = "7e33a3b6de352650c44163c2ff989cad764017c508e13b240f783c08c736f2c5"
      malware             = "unknown"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Max Biotech Limited"
      cert_issuer_short   = "SSL.com"
      cert_issuer         = "SSL.com Code Signing Intermediate CA RSA R1"
      cert_serial         = "4e:2c:e4:04:ae:f3:44:eb:b3:b8:76:54:f2:c9:84:22"
      cert_thumbprint     = "5A6D836E89DE99ADEF95667B3A921B7DA044B3F8"
      cert_valid_from     = "2024-03-15"
      cert_valid_to       = "2025-03-15"

      country             = "GB"
      state               = "???"
      locality            = "Caterham"
      email               = "???"
      rdn_serial_number   = "Not Specified"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "SSL.com Code Signing Intermediate CA RSA R1" and
         sig.serial == "4e:2c:e4:04:ae:f3:44:eb:b3:b8:76:54:f2:c9:84:22"
      )
}

rule MAL_Compromised_Cert_xworm_Sectigo_00B73BB37898F19823F543EB991D9AEFAD {
   meta:
      description         = "Detects xworm with compromised cert (Sectigo)"
      author              = "CertGraveyard-YARA-Generator"
      reference           = "https://certgraveyard.org"
      date                = "2025-02-04"
      version             = "1.0"

      hash                = "4b73f071b37da9dc75fc66c196d7aabc2788ecde9041972d0a9599afdd7321c6"
      malware             = "xworm"
      malware_type        = "Unknown"
      malware_notes       = ""

      signer              = "Nextgensoftware Company Limited"
      cert_issuer_short   = "Sectigo"
      cert_issuer         = "Sectigo Public Code Signing CA EV E36"
      cert_serial         = "00:b7:3b:b3:78:98:f1:98:23:f5:43:eb:99:1d:9a:ef:ad"
      cert_thumbprint     = "EC90F0D8C878081D9362937124E56BCE10DE97BC"
      cert_valid_from     = "2025-02-04"
      cert_valid_to       = "2026-02-04"

      country             = "VN"
      state               = "Ho Chi Minh"
      locality            = "???"
      email               = "???"
      rdn_serial_number   = "0318797820"

   condition:
      uint16(0) == 0x5a4d and
      for any sig in pe.signatures : (
         sig.issuer contains "Sectigo Public Code Signing CA EV E36" and
         sig.serial == "00:b7:3b:b3:78:98:f1:98:23:f5:43:eb:99:1d:9a:ef:ad"
      )
}